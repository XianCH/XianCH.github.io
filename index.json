[{"content":"123.com å’Œ www.123.com æ˜¯ä¸¤ä¸ªä¸åŒçš„å­åŸŸåï¼Œä½ éœ€è¦åœ¨ DNS å’Œ Web æœåŠ¡å™¨ä¸­é…ç½®å®ƒä»¬çš„å…³ç³»ï¼ˆé€šå¸¸ä¼šè®¾ç½®ä¸ºè‡ªåŠ¨è·³è½¬æˆ–éƒ½æŒ‡å‘åŒä¸€ä¸ªå†…å®¹ï¼‰ã€‚ å…·ä½“åŸå› åˆ†æ\nDNS é…ç½®ä¸ä¸€è‡´\n123.com æ˜¯ä¸»åŸŸåï¼ˆæ ¹åŸŸåï¼‰ã€‚\nwww.123.com æ˜¯ä¸»åŸŸåä¸‹çš„ä¸€ä¸ªå­åŸŸåï¼ˆwww æ˜¯å­åŸŸåï¼‰ã€‚\nå¦‚æœä½ çš„ DNS æœåŠ¡å•†ï¼ˆå¦‚é˜¿é‡Œäº‘ã€Cloudflareã€DNSPod ç­‰ï¼‰ä¸­ï¼š\nåªé…ç½®äº†ä¸€ä¸ª A è®°å½•ï¼ˆå¦‚ www.123.com -\u0026gt; IPåœ°å€ï¼‰ é‚£ä¹ˆ 123.com è®¿é—®æ—¶å¯èƒ½æ— æ³•æ­£ç¡®è§£æï¼Œæˆ–è®¿é—®åˆ°ä¸åŒæœåŠ¡ã€‚ æœåŠ¡å™¨æœªåšç»Ÿä¸€è·³è½¬æˆ–ç»‘å®š\nWeb æœåŠ¡å™¨ï¼ˆå¦‚ Nginxã€Apacheï¼‰å¯ä»¥åŒºåˆ†ä½ è®¿é—®çš„æ˜¯ 123.com è¿˜æ˜¯ www.123.comï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒä»¬æ˜¯ä¸¤ä¸ªä¸åŒçš„ Host è¯·æ±‚ï¼š\nå¦‚æœä½ åªç»‘å®šäº† server_name www.123.comï¼Œé‚£è®¿é—® 123.com ä¼š 404 æˆ–è·³åˆ°é»˜è®¤ç«™ç‚¹ã€‚ å¦‚æœä½ æ²¡æœ‰è®¾ç½®é‡å®šå‘ç­–ç•¥ï¼Œç”¨æˆ·è®¿é—®å“ªä¸ªå°±æ˜¾ç¤ºå“ªä¸ªï¼Œä¸ç»Ÿä¸€ã€‚ âœ… æ¨èè§£å†³æ–¹æ¡ˆ âœ… æ–¹æ³• 1ï¼šåœ¨ DNS ä¸­åŒæ—¶æ·»åŠ è¿™ä¸¤ä¸ªè®°å½• ä¸»æœºè®°å½•\tè®°å½•ç±»å‹\tè®°å½•å€¼ @\tA\tIP åœ°å€ www\tA\tIP åœ°å€\n@ è¡¨ç¤ºæ ¹åŸŸåï¼ˆ123.comï¼‰ âœ… æ–¹æ³• 2ï¼šNginx ä¸­è®¾ç½®ç»Ÿä¸€è·³è½¬ï¼ˆæ¨èï¼‰ ç¤ºä¾‹ï¼šå¼ºåˆ¶å°† 123.com è·³è½¬åˆ° www.123.com\nç›‘å¬ 123.com çš„è¯·æ±‚å¹¶é‡å®šå‘åˆ° www.123.com server { listen 80; server_name 123.com; return 301 http://www.123.com$request_uri; }\næ­£å¸¸æœåŠ¡çš„ www.123.com server { listen 80; server_name www.123.com; root /var/www/your_site; index index.html; }\nè¿™æ ·ä¸ç®¡ç”¨æˆ·è¾“å…¥å“ªä¸ªåœ°å€ï¼Œéƒ½ä¼šç»Ÿä¸€è·³è½¬åˆ° www.123.comï¼Œé¿å… SEO é—®é¢˜ã€Cookie æ··ä¹±ç­‰é—®é¢˜ã€‚ âœ… ä¸€ã€ä»é˜¿é‡Œäº‘ä¸‹è½½è¯ä¹¦\nç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å° â†’ SSLè¯ä¹¦æœåŠ¡ â†’ é€‰æ‹©å·²ç­¾å‘çš„è¯ä¹¦\nç‚¹å‡»ã€ä¸‹è½½è¯ä¹¦ã€‘ï¼Œé€‰æ‹©æœåŠ¡å™¨ç±»å‹ï¼š\nå¦‚æœä½ ç”¨çš„æ˜¯ Nginxï¼Œå°±é€‰æ‹© Nginx\nå¦‚æœæ˜¯ Apacheï¼Œå°±é€‰ Apache\nä¸‹è½½åä½ ä¼šè·å¾—ä¸€ä¸ª .zip å‹ç¼©åŒ…ï¼Œé‡Œé¢é€šå¸¸æœ‰è¿™äº›æ–‡ä»¶ï¼š\nâœ… Nginx è¯ä¹¦åŒ…ç¤ºä¾‹å†…å®¹ï¼š\nyourdomain.pem # è¯ä¹¦ï¼ˆåŒ…æ‹¬ä¸­é—´è¯ä¹¦ï¼‰ yourdomain.key # ç§é’¥\nâœ… Apache è¯ä¹¦åŒ…ç¤ºä¾‹å†…å®¹ï¼š\nyourdomain.crt # è¯ä¹¦ yourdomain.key # ç§é’¥ chain.pem # ä¸­é—´è¯ä¹¦\nâœ… äºŒã€ä¸Šä¼ è¯ä¹¦åˆ°æœåŠ¡å™¨\nå»ºè®®ä¸Šä¼ åˆ° /etc/ssl/yourdomain/ï¼ˆæˆ–ä½ è‡ªå®šä¹‰çš„è·¯å¾„ï¼‰ï¼š\nscp yourdomain.* root@your_server:/etc/ssl/yourdomain/\nâœ… ä¸‰ã€é…ç½®æœåŠ¡å™¨ï¼ˆNginx / Apacheï¼‰ ğŸ”§ Nginx é…ç½®ç¤ºä¾‹\nç¼–è¾‘ä½ çš„ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼ˆå¦‚ /etc/nginx/conf.d/yourdomain.confï¼‰ï¼š\nserver { listen 80; server_name yourdomain.com www.yourdomain.com; return 301 https://$host$request_uri; } server { listen 443 ssl; server_name yourdomain.com www.yourdomain.com; ssl_certificate /etc/ssl/yourdomain/yourdomain.pem; ssl_certificate_key /etc/ssl/yourdomain/yourdomain.key; ssl_session_cache shared:SSL:1m; ssl_session_timeout 10m; ssl_protocols TLSv1.2 TLSv1.3; ssl_ciphers HIGH:!aNULL:!MD5; root /var/www/your_site; index index.html index.htm; }\nç„¶åé‡å¯ Nginxï¼š sudo nginx -t # æ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡® sudo systemctl reload nginx\nğŸ”§ Apache é…ç½®ç¤ºä¾‹\nç¼–è¾‘è™šæ‹Ÿä¸»æœºé…ç½®ï¼ˆå¦‚ /etc/httpd/conf.d/ssl.conf æˆ– /etc/apache2/sites-available/yourdomain.confï¼‰ï¼š\n\u0026lt;VirtualHost *:443\u0026gt; ServerName yourdomain.com ServerAlias www.yourdomain.com\nDocumentRoot /var/www/your_site SSLEngine on SSLCertificateFile /etc/ssl/yourdomain/yourdomain.crt SSLCertificateKeyFile /etc/ssl/yourdomain/yourdomain.key SSLCertificateChainFile /etc/ssl/yourdomain/chain.pem \u0026lt;Directory \u0026quot;/var/www/your_site\u0026quot;\u0026gt; Options Indexes FollowSymLinks AllowOverride All Require all granted \u0026lt;/Directory\u0026gt; å¯é€‰ï¼šå¼ºåˆ¶ HTTP è·³è½¬åˆ° HTTPS \u0026lt;VirtualHost *:80\u0026gt; ServerName yourdomain.com ServerAlias www.yourdomain.com Redirect permanent / https://yourdomain.com/ é‡å¯ Apacheï¼š Ubuntu/Debian sudo a2enmod ssl sudo systemctl reload apache2\nCentOS sudo systemctl reload httpd\nâœ… å››ã€éªŒè¯æ˜¯å¦ç”Ÿæ•ˆ\nè®¿é—® https://yourdomain.com çœ‹æ˜¯å¦è·³è½¬æˆåŠŸ ç”¨æµè§ˆå™¨ç‚¹ HTTPS å°é” â†’ æŸ¥çœ‹è¯ä¹¦æ˜¯å¦æ˜¯é˜¿é‡Œäº‘é¢å‘çš„ å¯ä½¿ç”¨ SSL æ£€æµ‹å·¥å…·ï¼š https://www.ssllabs.com/ssltest/ ","permalink":"https://XianCH.github.io/posts/tech/web/server_setup/","summary":"\u003cpre\u003e\u003ccode\u003e123.com å’Œ www.123.com æ˜¯ä¸¤ä¸ªä¸åŒçš„å­åŸŸåï¼Œä½ éœ€è¦åœ¨ DNS å’Œ Web æœåŠ¡å™¨ä¸­é…ç½®å®ƒä»¬çš„å…³ç³»ï¼ˆé€šå¸¸ä¼šè®¾ç½®ä¸ºè‡ªåŠ¨è·³è½¬æˆ–éƒ½æŒ‡å‘åŒä¸€ä¸ªå†…å®¹ï¼‰ã€‚\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eå…·ä½“åŸå› åˆ†æ\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eDNS é…ç½®ä¸ä¸€è‡´\u003c/p\u003e\n\u003cp\u003e123.com æ˜¯ä¸»åŸŸåï¼ˆæ ¹åŸŸåï¼‰ã€‚\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.123.com\"\u003ewww.123.com\u003c/a\u003e æ˜¯ä¸»åŸŸåä¸‹çš„ä¸€ä¸ªå­åŸŸåï¼ˆwww æ˜¯å­åŸŸåï¼‰ã€‚\u003c/p\u003e\n\u003cp\u003eå¦‚æœä½ çš„ DNS æœåŠ¡å•†ï¼ˆå¦‚é˜¿é‡Œäº‘ã€Cloudflareã€DNSPod ç­‰ï¼‰ä¸­ï¼š\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e åªé…ç½®äº†ä¸€ä¸ª A è®°å½•ï¼ˆå¦‚ www.123.com -\u0026gt; IPåœ°å€ï¼‰\n\n é‚£ä¹ˆ 123.com è®¿é—®æ—¶å¯èƒ½æ— æ³•æ­£ç¡®è§£æï¼Œæˆ–è®¿é—®åˆ°ä¸åŒæœåŠ¡ã€‚\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eæœåŠ¡å™¨æœªåšç»Ÿä¸€è·³è½¬æˆ–ç»‘å®š\u003c/p\u003e","title":"Server_setup"},{"content":"JavaScript 01_åŸºæœ¬è¯­æ³•å’Œæ•°æ®ç±»å‹ å˜é‡ã€æ•°æ®ç±»å‹ã€è¿ç®—ç¬¦ã€æ¡ä»¶è¯­å¥ã€å¾ªç¯è¯­å¥ç­‰åŸºæœ¬è¯­æ³•å’Œæ•°æ®ç±»å‹ã€‚\n// å˜é‡å£°æ˜å’Œèµ‹å€¼ let name = \u0026#34;John\u0026#34;; const age = 30; var isAdmin = true; // æ•°æ®ç±»å‹ let num = 10; // Number let str = \u0026#34;Hello\u0026#34;; // String let bool = true; // Boolean let arr = [1, 2, 3]; // Array let obj = { name: \u0026#34;John\u0026#34;, age: 30 }; // Object let n = null; // Null let u = undefined; // Undefined // è¿ç®—ç¬¦ let sum = 10 + 5; // åŠ æ³• let difference = 10 - 5; // å‡æ³• let product = 10 * 5; // ä¹˜æ³• let quotient = 10 / 5; // é™¤æ³• let remainder = 10 % 3; // å–ä½™ let increment = 10++; // è‡ªå¢ let decrement = 10--; // è‡ªå‡ // æ¡ä»¶è¯­å¥ if (isAdmin) { console.log(\u0026#34;User is an admin\u0026#34;); } else if (age \u0026gt;= 18) { console.log(\u0026#34;User is an adult\u0026#34;); } else { console.log(\u0026#34;User is a minor\u0026#34;); } // å¾ªç¯è¯­å¥ for (let i = 0; i \u0026lt; arr.length; i++) { console.log(arr[i]); } let i = 0; while (i \u0026lt; arr.length) { console.log(arr[i]); i++; } // å‡½æ•°å£°æ˜ function greet(name) { console.log(\u0026#34;Hello, \u0026#34; + name + \u0026#34;!\u0026#34;); } // è°ƒç”¨å‡½æ•° greet(\u0026#34;John\u0026#34;); 02_å‡½æ•°å’Œä½œç”¨åŸŸ å‡½æ•°çš„å®šä¹‰ã€è°ƒç”¨ã€å‚æ•°ä¼ é€’ã€ä½œç”¨åŸŸé“¾ã€é—­åŒ…ç­‰ç›¸å…³æ¦‚å¿µå’Œç”¨æ³•ã€‚\n// å‡½æ•°çš„å®šä¹‰å’Œè°ƒç”¨ function greet(name) { console.log(\u0026#34;Hello, \u0026#34; + name + \u0026#34;!\u0026#34;); } // è°ƒç”¨å‡½æ•° greet(\u0026#34;John\u0026#34;); // å‡½æ•°å‚æ•°ä¼ é€’ function add(a, b) { return a + b; } let result = add(5, 3); console.log(\u0026#34;Sum:\u0026#34;, result); // å‡½æ•°ä½œç”¨åŸŸ let x = 10; function printX() { let y = 20; console.log(\u0026#34;x inside function:\u0026#34;, x); // x æ˜¯å…¨å±€å˜é‡ï¼Œåœ¨å‡½æ•°å†…éƒ¨å¯ä»¥è®¿é—® console.log(\u0026#34;y inside function:\u0026#34;, y); // y æ˜¯å‡½æ•°å†…éƒ¨å®šä¹‰çš„å±€éƒ¨å˜é‡ } printX(); console.log(\u0026#34;x outside function:\u0026#34;, x); // x æ˜¯å…¨å±€å˜é‡ï¼Œåœ¨å‡½æ•°å¤–éƒ¨å¯ä»¥è®¿é—® // console.log(\u0026#34;y outside function:\u0026#34;, y); // y æ˜¯å‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡ï¼Œåœ¨å‡½æ•°å¤–éƒ¨æ— æ³•è®¿é—®ï¼Œä¼šæŠ¥é”™ // é—­åŒ… function outerFunction() { let outerVar = \u0026#34;I\u0026#39;m outer!\u0026#34;; function innerFunction() { console.log(outerVar); // å†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°çš„å˜é‡ } return innerFunction; } let innerFunc = outerFunction(); innerFunc(); // è°ƒç”¨å†…éƒ¨å‡½æ•°ï¼Œæ‰“å° \u0026#34;I\u0026#39;m outer!\u0026#34; 03_å¯¹è±¡å’ŒåŸå‹é“¾ å¯¹è±¡çš„åˆ›å»ºã€å±æ€§å’Œæ–¹æ³•çš„æ·»åŠ ã€è®¿é—®ã€åŸå‹å’ŒåŸå‹é“¾çš„æ¦‚å¿µï¼Œä»¥åŠæ„é€ å‡½æ•°å’ŒåŸå‹ç»§æ‰¿ç­‰ã€‚\n// å¯¹è±¡çš„åˆ›å»ºå’Œå±æ€§è®¿é—® let person = { name: \u0026#34;John\u0026#34;, age: 30, greet: function () { console.log( \u0026#34;Hello, my name is \u0026#34; + this.name + \u0026#34; and I\u0026#39;m \u0026#34; + this.age + \u0026#34; years old.\u0026#34;, ); }, }; console.log(\u0026#34;Name:\u0026#34;, person.name); // è®¿é—®å¯¹è±¡å±æ€§ console.log(\u0026#34;Age:\u0026#34;, person[\u0026#34;age\u0026#34;]); // ä½¿ç”¨æ–¹æ‹¬å·è®¿é—®å¯¹è±¡å±æ€§ person.greet(); // è°ƒç”¨å¯¹è±¡æ–¹æ³• // æ„é€ å‡½æ•°å’ŒåŸå‹ function Person(name, age) { this.name = name; this.age = age; } Person.prototype.greet = function () { console.log( \u0026#34;Hello, my name is \u0026#34; + this.name + \u0026#34; and I\u0026#39;m \u0026#34; + this.age + \u0026#34; years old.\u0026#34;, ); }; let john = new Person(\u0026#34;John\u0026#34;, 30); console.log(\u0026#34;Name:\u0026#34;, john.name); console.log(\u0026#34;Age:\u0026#34;, john.age); john.greet(); // åŸå‹é“¾ç»§æ‰¿ function Student(name, age, grade) { Person.call(this, name, age); // è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•° this.grade = grade; } Student.prototype = Object.create(Person.prototype); // è®¾ç½®åŸå‹é“¾ Student.prototype.constructor = Student; // ä¿®å¤æ„é€ å‡½æ•°æŒ‡å‘ let jane = new Student(\u0026#34;Jane\u0026#34;, 25, \u0026#34;A\u0026#34;); console.log(\u0026#34;Name:\u0026#34;, jane.name); console.log(\u0026#34;Age:\u0026#34;, jane.age); console.log(\u0026#34;Grade:\u0026#34;, jane.grade); jane.greet(); // å­ç±»ç»§æ‰¿çˆ¶ç±»æ–¹æ³• 04_å¼‚æ­¥ç¼–ç¨‹ äº‹ä»¶å¾ªç¯ã€å›è°ƒå‡½æ•°ã€Promiseã€async/awaitç­‰ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œçš„æ–¹å¼ã€‚\n// å›è°ƒå‡½æ•°ç¤ºä¾‹ function fetchData(callback) { setTimeout(() =\u0026gt; { callback(\u0026#34;Data fetched successfully\u0026#34;); }, 1000); } fetchData((data) =\u0026gt; { console.log(data); }); // Promise ç¤ºä¾‹ function fetchDataPromise() { return new Promise((resolve, reject) =\u0026gt; { setTimeout(() =\u0026gt; { resolve(\u0026#34;Data fetched successfully\u0026#34;); }, 1000); }); } fetchDataPromise() .then((data) =\u0026gt; { console.log(data); }) .catch((error) =\u0026gt; { console.error(\u0026#34;Error:\u0026#34;, error); }); // async/await ç¤ºä¾‹ async function fetchDataAsync() { return new Promise((resolve, reject) =\u0026gt; { setTimeout(() =\u0026gt; { resolve(\u0026#34;Data fetched successfully\u0026#34;); }, 1000); }); } async function fetchDataWrapper() { try { const data = await fetchDataAsync(); console.log(data); } catch (error) { console.error(\u0026#34;Error:\u0026#34;, error); } } fetchDataWrapper(); 05_DOMæ“ä½œ é€šè¿‡JavaScriptæ“ä½œæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ˆDOMï¼‰å®ç°é¡µé¢äº¤äº’ã€åŠ¨æ€å†…å®¹æ›´æ–°ç­‰ã€‚\nè·å–å…ƒç´ ï¼š getElementById(id)ï¼šæ ¹æ® id è·å–å…ƒç´ ã€‚ getElementsByClassName(className)ï¼šæ ¹æ®ç±»åè·å–å…ƒç´ é›†åˆã€‚ getElementsByTagName(tagName)ï¼šæ ¹æ®æ ‡ç­¾åè·å–å…ƒç´ é›†åˆã€‚ querySelector(selector)ï¼šæ ¹æ® CSS é€‰æ‹©å™¨è·å–ç¬¬ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ ã€‚ querySelectorAll(selector)ï¼šæ ¹æ® CSS é€‰æ‹©å™¨è·å–æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ã€‚ æ·»åŠ ã€ç§»é™¤å’Œæ›¿æ¢å…ƒç´ ï¼š appendChild(node)ï¼šåœ¨æŒ‡å®šèŠ‚ç‚¹çš„å­èŠ‚ç‚¹åˆ—è¡¨æœ«å°¾æ·»åŠ æ–°çš„å­èŠ‚ç‚¹ã€‚ removeChild(node)ï¼šä»çˆ¶èŠ‚ç‚¹ä¸­ç§»é™¤å­èŠ‚ç‚¹ã€‚ replaceChild(newNode, oldNode)ï¼šç”¨æ–°èŠ‚ç‚¹æ›¿æ¢æ—§èŠ‚ç‚¹ã€‚ æ ·å¼æ“ä½œï¼š element.style.property = valueï¼šç›´æ¥ä¿®æ”¹å…ƒç´ çš„å†…è”æ ·å¼ã€‚ classList.add(className)ï¼šå‘å…ƒç´ æ·»åŠ ç±»ã€‚ classList.remove(className)ï¼šä»å…ƒç´ ä¸­ç§»é™¤ç±»ã€‚ classList.toggle(className)ï¼šå¦‚æœå­˜åœ¨ï¼ˆä¸å­˜åœ¨ï¼‰å°±åˆ é™¤ï¼ˆæ·»åŠ ï¼‰ä¸€ä¸ªç±»ã€‚ å†…å®¹æ“ä½œï¼š innerHTMLï¼šè·å–æˆ–è®¾ç½®å…ƒç´ çš„ HTML å†…å®¹ã€‚ textContentï¼šè·å–æˆ–è®¾ç½®å…ƒç´ çš„æ–‡æœ¬å†…å®¹ã€‚ å±æ€§æ“ä½œï¼š getAttribute(name)ï¼šè·å–å…ƒç´ çš„æŒ‡å®šå±æ€§å€¼ã€‚ setAttribute(name, value)ï¼šè®¾ç½®å…ƒç´ çš„æŒ‡å®šå±æ€§å€¼ã€‚ éå†èŠ‚ç‚¹ï¼š parentNodeï¼šè·å–çˆ¶èŠ‚ç‚¹ã€‚ childNodesï¼šè·å–æ‰€æœ‰å­èŠ‚ç‚¹ã€‚ nextSibling å’Œ previousSiblingï¼šè·å–ä¸‹ä¸€ä¸ªå’Œä¸Šä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ã€‚ äº‹ä»¶ç›‘å¬ï¼š element.addEventListener(event, function)ï¼šå‘æŒ‡å®šå…ƒç´ æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ã€‚ element.removeEventListener(event, function)ï¼šä»æŒ‡å®šå…ƒç´ ç§»é™¤äº‹ä»¶ç›‘å¬å™¨ã€‚ 06_æµè§ˆå™¨äº‹ä»¶ å¤„ç†ç”¨æˆ·äº¤äº’äº‹ä»¶ï¼Œä¾‹å¦‚ç‚¹å‡»ã€è¾“å…¥ã€é¼ æ ‡ç§»åŠ¨ç­‰ã€‚\nclick:é¼ æ ‡ç‚¹å‡»çš„æ—¶å€™å‡ºå‘ mouseoverï¼šé¼ æ ‡ç§»åŠ¨åˆ°å…ƒç´ ä¸Šæ–¹æ—¶è§¦å‘ã€‚ mouseoutï¼šé¼ æ ‡ç§»å‡ºå…ƒç´ æ—¶è§¦å‘ã€‚ mousedownï¼šé¼ æ ‡æŒ‰ä¸‹æ—¶è§¦å‘ã€‚ mouseupï¼šé¼ æ ‡æ¾å¼€æ—¶è§¦å‘ã€‚ mousemoveï¼šé¼ æ ‡ç§»åŠ¨æ—¶è§¦å‘ã€‚ keydownï¼šé”®ç›˜æŒ‰ä¸‹æ—¶è§¦å‘ã€‚ keyupï¼šé”®ç›˜æ¾å¼€æ—¶è§¦å‘ã€‚ focusï¼šå…ƒç´ è·å¾—ç„¦ç‚¹æ—¶è§¦å‘ã€‚ blurï¼šå…ƒç´ å¤±å»ç„¦ç‚¹æ—¶è§¦å‘ã€‚ inputï¼šè¾“å…¥æ¡†çš„å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘ã€‚ changeï¼šè¡¨å•å…ƒç´ çš„å€¼å‘ç”Ÿæ”¹å˜æ—¶è§¦å‘ã€‚ tipï¼š\n\u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34; /\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34; /\u0026gt; \u0026lt;title\u0026gt;DOM äº‹ä»¶ç¤ºä¾‹\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;button id=\u0026#34;myButton\u0026#34;\u0026gt;ç‚¹å‡»æˆ‘\u0026lt;/button\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; id=\u0026#34;myInput\u0026#34; placeholder=\u0026#34;è¾“å…¥æ¡†\u0026#34; /\u0026gt; \u0026lt;!-- å¼•å…¥ JavaScript æ–‡ä»¶ --\u0026gt; \u0026lt;script src=\u0026#34;script.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; // è·å–æŒ‰é’®å…ƒç´  const button = document.getElementById(\u0026#34;myButton\u0026#34;); // æ·»åŠ  click äº‹ä»¶ç›‘å¬å™¨ button.addEventListener(\u0026#34;click\u0026#34;, function (event) { alert(\u0026#34;æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼\u0026#34;); }); // è·å–è¾“å…¥æ¡†å…ƒç´  const input = document.getElementById(\u0026#34;myInput\u0026#34;); // æ·»åŠ  input äº‹ä»¶ç›‘å¬å™¨ input.addEventListener(\u0026#34;input\u0026#34;, function (event) { console.log(\u0026#34;è¾“å…¥æ¡†çš„å†…å®¹å‘ç”Ÿå˜åŒ–ï¼š\u0026#34;, input.value); }); // æ·»åŠ  focus å’Œ blur äº‹ä»¶ç›‘å¬å™¨ input.addEventListener(\u0026#34;focus\u0026#34;, function (event) { console.log(\u0026#34;è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹\u0026#34;); }); input.addEventListener(\u0026#34;blur\u0026#34;, function (event) { console.log(\u0026#34;è¾“å…¥æ¡†å¤±å»ç„¦ç‚¹\u0026#34;); }); 07_AJAXå’ŒHTTPè¯·æ±‚ é€šè¿‡XMLHttpRequestæˆ–Fetch APIè¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œè·å–æ•°æ®å¹¶æ›´æ–°é¡µé¢ã€‚\nAJAXï¼ˆAsynchronous JavaScript and XMLï¼‰ï¼š\næ˜¯ä¸€ç§ä½¿ç”¨ JavaScript è¿›è¡Œå¼‚æ­¥é€šä¿¡çš„æŠ€æœ¯ï¼Œå¯ä»¥åœ¨ä¸é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡åœ¨åå°ä¸æœåŠ¡å™¨è¿›è¡Œæ•°æ®äº¤æ¢æ¥æ›´æ–°éƒ¨åˆ†ç½‘é¡µå†…å®¹ã€‚ AJAX æŠ€æœ¯é€šå¸¸ä½¿ç”¨ XMLHttpRequest å¯¹è±¡æ¥å®ç°ã€‚ tip:\n\u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34; /\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34; /\u0026gt; \u0026lt;title\u0026gt;AJAX Example\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;result\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script src=\u0026#34;ajax.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; // åˆ›å»º XMLHttpRequest å¯¹è±¡ var xhr = new XMLHttpRequest(); // é…ç½®è¯·æ±‚ xhr.open(\u0026#34;GET\u0026#34;, \u0026#34;https://jsonplaceholder.typicode.com/posts/1\u0026#34;, true); // ç›‘å¬è¯·æ±‚çŠ¶æ€å˜åŒ– xhr.onreadystatechange = function () { if (xhr.readyState === XMLHttpRequest.DONE) { if (xhr.status === 200) { // å¤„ç†æˆåŠŸå“åº” var responseData = JSON.parse(xhr.responseText); document.getElementById(\u0026#34;result\u0026#34;).innerText = responseData.title; } else { // å¤„ç†é”™è¯¯å“åº” console.error(\u0026#34;Request failed:\u0026#34;, xhr.status); } } }; // å‘é€è¯·æ±‚ xhr.send(); Fetch APIï¼š\næ˜¯ä¸€ç§æ–°çš„ Web APIï¼Œæä¾›äº†ä¸€ç§æ›´ç®€æ´ã€æ›´å¼ºå¤§çš„æ–¹å¼æ¥è¿›è¡Œç½‘ç»œè¯·æ±‚ã€‚ ä½¿ç”¨ Promise å¯¹è±¡å¤„ç†å¼‚æ­¥æ“ä½œï¼Œæä¾›äº†æ›´å¥½çš„è¯­æ³•å’ŒåŠŸèƒ½ã€‚ Fetch API ä¸é™äº XML æ•°æ®ï¼Œå¯ä»¥ä¸ JSONã€HTMLã€Text ç­‰å„ç§æ ¼å¼çš„æ•°æ®ä¸€èµ·ä½¿ç”¨ã€‚ tip:\n\u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34; /\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34; /\u0026gt; \u0026lt;title\u0026gt;Fetch API ç¤ºä¾‹\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Fetch API ç¤ºä¾‹\u0026lt;/h1\u0026gt; \u0026lt;button id=\u0026#34;fetchButton\u0026#34;\u0026gt;å‘èµ·è¯·æ±‚\u0026lt;/button\u0026gt; \u0026lt;div id=\u0026#34;result\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;script src=\u0026#34;script.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; document.getElementById(\u0026#34;fetchButton\u0026#34;).addEventListener(\u0026#34;click\u0026#34;, function () { const url = \u0026#34;https://jsonplaceholder.typicode.com/posts/1\u0026#34;; fetch(url) .then((response) =\u0026gt; { if (!response.ok) { throw new Error(\u0026#34;Network response was not ok\u0026#34;); } return response.json(); }) .then((data) =\u0026gt; { document.getElementById(\u0026#34;result\u0026#34;).innerText = JSON.stringify( data, null, 2, ); }) .catch((error) =\u0026gt; { console.error(\u0026#34;There was a problem with the fetch operation:\u0026#34;, error); }); }); 08_ES6åŠä»¥ä¸Šæ–°ç‰¹æ€§ ç®­å¤´å‡½æ•°ã€æ¨¡æ¿å­—ç¬¦ä¸²ã€è§£æ„èµ‹å€¼ã€ç±»ã€æ¨¡å—åŒ–ç­‰æ–°çš„JavaScriptè¯­è¨€ç‰¹æ€§ã€‚\n// æ¨¡å—åŒ– // user.js export class User { constructor(name, age) { this.name = name; this.age = age; } greet() { return `Hello, my name is ${this.name} and I am ${this.age} years old.`; } } // index.js import { User } from \u0026#34;./user.js\u0026#34;; // ç®­å¤´å‡½æ•° const printUserInfo = (user) =\u0026gt; { console.log(user.greet()); }; // è§£æ„èµ‹å€¼ const userData = { name: \u0026#34;Alice\u0026#34;, age: 30, }; const { name, age } = userData; // åˆ›å»ºç”¨æˆ·å®ä¾‹ const user = new User(name, age); // æ‰“å°ç”¨æˆ·ä¿¡æ¯ printUserInfo(user); 0_9é—­åŒ…å’Œé«˜é˜¶å‡½æ•°(todo ) åˆ©ç”¨é—­åŒ…å®ç°å‡½æ•°å°è£…å’Œä¿¡æ¯éšè—ï¼Œä»¥åŠé«˜é˜¶å‡½æ•°çš„æ¦‚å¿µå’Œåº”ç”¨ã€‚\n// é—­åŒ…ç¤ºä¾‹ function outerFunction() { let outerVariable = \u0026#34;I am from outer function\u0026#34;; function innerFunction() { console.log(outerVariable); } return innerFunction; } const innerFunc = outerFunction(); // å†…éƒ¨å‡½æ•° innerFunction æˆä¸ºé—­åŒ… innerFunc(); // æ‰“å° \u0026#34;I am from outer function\u0026#34; // é«˜é˜¶å‡½æ•°ç¤ºä¾‹ function add(a, b) { return a + b; } function subtract(a, b) { return a - b; } function calculate(operation, a, b) { return operation(a, b); } console.log(calculate(add, 5, 3)); // è°ƒç”¨ add å‡½æ•°ï¼Œæ‰“å° 8 console.log(calculate(subtract, 5, 3)); // è°ƒç”¨ subtract å‡½æ•°ï¼Œæ‰“å° 2 é”™è¯¯å¤„ç†å’Œè°ƒè¯•ï¼šå¤„ç†å¼‚å¸¸ã€è°ƒè¯•æŠ€å·§ã€é”™è¯¯æ—¥å¿—è®°å½•ç­‰ä¸é”™è¯¯å¤„ç†ç›¸å…³çš„çŸ¥è¯†ã€‚\nå¼‚å¸¸å¤„ç†ï¼ˆError Handlingï¼‰ï¼š try { // å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸çš„ä»£ç å— const result = someFunction(); console.log(result); } catch (error) { // æ•è·å¼‚å¸¸å¹¶è¿›è¡Œå¤„ç† console.error(\u0026#34;An error occurred:\u0026#34;, error.message); } finally { // å¯é€‰çš„ finally å—ï¼Œæ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸éƒ½ä¼šæ‰§è¡Œ console.log(\u0026#34;Finally block executed\u0026#34;); } åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œtry å—åŒ…å«äº†å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸çš„ä»£ç ï¼Œcatch å—ç”¨äºæ•è·å¼‚å¸¸å¹¶è¿›è¡Œå¤„ç†ï¼Œfinally å—æ˜¯å¯é€‰çš„ï¼Œæ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸éƒ½ä¼šæ‰§è¡Œã€‚\nè°ƒè¯•æŠ€å·§ï¼š // åœ¨ä»£ç ä¸­æ’å…¥æ–­ç‚¹ debugger; // ä½¿ç”¨ console.log() è¾“å‡ºè°ƒè¯•ä¿¡æ¯ console.log(\u0026#34;Debug message:\u0026#34;, variable); // ä½¿ç”¨ console.error() è¾“å‡ºé”™è¯¯ä¿¡æ¯ console.error(\u0026#34;Error occurred:\u0026#34;, error); // ä½¿ç”¨ console.trace() è¾“å‡ºå‡½æ•°è°ƒç”¨å †æ ˆ console.trace(); ä¸Šé¢å±•ç¤ºäº†ä¸€äº›å¸¸ç”¨çš„è°ƒè¯•æŠ€å·§ï¼ŒåŒ…æ‹¬æ’å…¥æ–­ç‚¹ã€ä½¿ç”¨ console.log() è¾“å‡ºè°ƒè¯•ä¿¡æ¯ã€ä½¿ç”¨ console.error() è¾“å‡ºé”™è¯¯ä¿¡æ¯ä»¥åŠä½¿ç”¨ console.trace() è¾“å‡ºå‡½æ•°è°ƒç”¨å †æ ˆã€‚\né”™è¯¯æ—¥å¿—è®°å½•ï¼ˆError Loggingï¼‰ï¼š // ä½¿ç”¨ try-catch æ•è·å¼‚å¸¸ï¼Œå¹¶å°†å¼‚å¸¸ä¿¡æ¯è®°å½•åˆ°æ—¥å¿—ä¸­ try { // å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸çš„ä»£ç å— const result = someFunction(); console.log(result); } catch (error) { // è®°å½•å¼‚å¸¸ä¿¡æ¯åˆ°æ—¥å¿—ä¸­ logError(error); } // æ—¥å¿—è®°å½•å‡½æ•° function logError(error) { // å°†é”™è¯¯ä¿¡æ¯å‘é€åˆ°æœåŠ¡å™¨æˆ–è€…ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ console.error(\u0026#34;Error logged:\u0026#34;, error); } åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå°†é”™è¯¯ä¿¡æ¯è®°å½•åˆ°æ—¥å¿—ä¸­ï¼Œä»¥ä¾¿åç»­åˆ†æå’Œæ’æŸ¥é—®é¢˜ã€‚å¯ä»¥å°†é”™è¯¯ä¿¡æ¯å‘é€åˆ°æœåŠ¡å™¨æˆ–è€…ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ã€‚\nJavaScriptæ¡†æ¶å’Œåº“ï¼šå­¦ä¹ å¸¸ç”¨çš„JavaScriptæ¡†æ¶å’Œåº“ï¼Œä¾‹å¦‚Reactã€Vueã€Angularç­‰ï¼Œä»¥åŠç›¸å…³çš„æ¦‚å¿µå’Œç”¨æ³•ã€‚ æµ‹è¯•å’Œä¼˜åŒ–ï¼šç¼–å†™JavaScriptå•å…ƒæµ‹è¯•ã€æ€§èƒ½ä¼˜åŒ–ã€ä»£ç è§„èŒƒç­‰ä¸ä»£ç è´¨é‡ç›¸å…³çš„çŸ¥è¯†ã€‚ ","permalink":"https://XianCH.github.io/posts/tech/front/javascript%E5%A4%8D%E4%B9%A0/","summary":"\u003ch1 id=\"javascript\"\u003eJavaScript\u003c/h1\u003e\n\u003ch2 id=\"01_åŸºæœ¬è¯­æ³•å’Œæ•°æ®ç±»å‹\"\u003e01_åŸºæœ¬è¯­æ³•å’Œæ•°æ®ç±»å‹\u003c/h2\u003e\n\u003cp\u003eå˜é‡ã€æ•°æ®ç±»å‹ã€è¿ç®—ç¬¦ã€æ¡ä»¶è¯­å¥ã€å¾ªç¯è¯­å¥ç­‰åŸºæœ¬è¯­æ³•å’Œæ•°æ®ç±»å‹ã€‚\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// å˜é‡å£°æ˜å’Œèµ‹å€¼\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ename\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;John\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eage\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e30\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003evar\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eisAdmin\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// æ•°æ®ç±»å‹\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003enum\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e// Number\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003estr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Hello\u0026#34;\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e// String\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ebool\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e// Boolean\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003earr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e]; \u003cspan style=\"color:#75715e\"\u003e// Array\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eobj\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e { \u003cspan style=\"color:#a6e22e\"\u003ename\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;John\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#a6e22e\"\u003eage\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e30\u003c/span\u003e }; \u003cspan style=\"color:#75715e\"\u003e// Object\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003en\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enull\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e// Null\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eu\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eundefined\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e// Undefined\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// è¿ç®—ç¬¦\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esum\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e// åŠ æ³•\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003edifference\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e// å‡æ³•\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eproduct\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e// ä¹˜æ³•\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003equotient\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e// é™¤æ³•\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eremainder\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e%\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e// å–ä½™\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eincrement\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e// è‡ªå¢\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003edecrement\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003e; \u003cspan style=\"color:#75715e\"\u003e// è‡ªå‡\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// æ¡ä»¶è¯­å¥\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003eisAdmin\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003econsole\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;User is an admin\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003eage\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e18\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003econsole\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;User is an adult\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e} \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003econsole\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;User is a minor\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// å¾ªç¯è¯­å¥\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e (\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e; \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003earr\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003elength\u003c/span\u003e; \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003econsole\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003earr\u003c/span\u003e[\u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003ewhile\u003c/span\u003e (\u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003earr\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003elength\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003econsole\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003earr\u003c/span\u003e[\u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003ei\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// å‡½æ•°å£°æ˜\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003efunction\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egreet\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ename\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003econsole\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003elog\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Hello, \u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ename\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;!\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// è°ƒç”¨å‡½æ•°\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003egreet\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;John\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"02_å‡½æ•°å’Œä½œç”¨åŸŸ\"\u003e02_å‡½æ•°å’Œä½œç”¨åŸŸ\u003c/h2\u003e\n\u003cp\u003eå‡½æ•°çš„å®šä¹‰ã€è°ƒç”¨ã€å‚æ•°ä¼ é€’ã€ä½œç”¨åŸŸé“¾ã€é—­åŒ…ç­‰ç›¸å…³æ¦‚å¿µå’Œç”¨æ³•ã€‚\u003c/p\u003e","title":"Javascriptå¤ä¹ "},{"content":"å‰è¨€ æœ€å¼€å§‹çš„æ—¶å€™ä¸»è¦æ˜¯ä¸ºäº†ç†Ÿæ‚‰vimæ“ä½œï¼Œæ‰€ä»¥å°±æ²¡æœ‰å¤šå…³ç³»é…ç½®æ–¹é¢çš„é—®é¢˜ ä¸€ç›´ä»¥æ¥ä¸€ç›´ä½¿ç”¨çš„æ˜¯ç½‘ä¸Šä¸€ä½å¤§ç¥ä½¿ç”¨çš„é…ç½®ã€‚ç”±äºä½¿ç”¨çš„æ˜¯åˆ«äººçš„é…ç½®ï¼Œæ‰€ä»¥ è‡ªå·±å†ä¸æ‡‚çš„æƒ…å†µä¸‹è¿˜æ˜¯ä¸çŸ¥é“æ€ä¹ˆï¼Œè¿™ç¯‡æ–‡ç« å°±æ˜¯è¦ç»™ä»¥å‰å·æ‡’çš„è‡ªå·±å¡«å‘ï¼Œä½œä¸º ä¸€ä¸ªå®ç”¨ä¸»ä¹‰è€…ï¼Œè¿˜æ˜¯ä»è‡ªå·±çš„éœ€æ±‚å‡ºå‘å§ï¼Œéœ€è¦ç”¨åˆ°ä»€ä¹ˆå°±é…ç½®ä»€ä¹ˆã€‚\néœ€æ±‚åˆ—è¡¨ æ–‡ä»¶ç®¡ç† æ–‡ä»¶æœç´¢ æ–‡ä»¶æŸ¥æ‰¾ æ–‡å­—æŸ¥æ‰¾ æ’ä»¶ç®¡ç† å¿«æ·é”®ç»‘å®š å†…åµŒç»ˆç«¯ debug è¯­è¨€æœåŠ¡ è¯­è¨€æ ¼å¼åŒ– è¾“å…¥æç¤º æ’ä»¶ç®¡ç† ä¸»é¢˜æ ·å¼ init.lua touch init.lua \u0026amp;\u0026amp; mkdir lua local option = vim.opt local buffer = vim.b local global = vim.g -- Globol Settings -- option.showmode = false option.backspace = { \u0026#34;indent\u0026#34;, \u0026#34;eol\u0026#34;, \u0026#34;start\u0026#34; } option.tabstop = 4 option.shiftwidth = 4 option.expandtab = true option.shiftround = true option.autoindent = true option.smartindent = true option.number = true option.relativenumber = true option.wildmenu = true option.hlsearch = false option.ignorecase = true option.smartcase = true option.completeopt = { \u0026#34;menu\u0026#34;, \u0026#34;menuone\u0026#34; } option.cursorline = true option.termguicolors = true option.signcolumn = \u0026#34;yes\u0026#34; option.autoread = true option.title = true option.swapfile = false option.backup = false option.updatetime = 50 option.mouse = \u0026#34;a\u0026#34; option.undofile = true option.undodir = vim.fn.expand(\u0026#39;$HOME/.local/share/nvim/undo\u0026#39;) option.exrc = true option.wrap = false option.splitright = true -- Buffer Settings -- buffer.fileenconding = \u0026#34;utf-8\u0026#34; -- Global Settings -- global.mapleader = \u0026#34; \u0026#34; -- Key mappings -- vim.keymap.set({ \u0026#34;n\u0026#34;, \u0026#34;i\u0026#34;, \u0026#34;v\u0026#34; }, \u0026#34;\u0026lt;Left\u0026gt;\u0026#34;, \u0026#34;\u0026lt;Nop\u0026gt;\u0026#34;) vim.keymap.set({ \u0026#34;n\u0026#34;, \u0026#34;i\u0026#34;, \u0026#34;v\u0026#34; }, \u0026#34;\u0026lt;Right\u0026gt;\u0026#34;, \u0026#34;\u0026lt;Nop\u0026gt;\u0026#34;) vim.keymap.set({ \u0026#34;n\u0026#34;, \u0026#34;i\u0026#34;, \u0026#34;v\u0026#34; }, \u0026#34;\u0026lt;Up\u0026gt;\u0026#34;, \u0026#34;\u0026lt;Nop\u0026gt;\u0026#34;) vim.keymap.set({ \u0026#34;n\u0026#34;, \u0026#34;i\u0026#34;, \u0026#34;v\u0026#34; }, \u0026#34;\u0026lt;Down\u0026gt;\u0026#34;, \u0026#34;\u0026lt;Nop\u0026gt;\u0026#34;) vim.keymap.set(\u0026#34;n\u0026#34;, \u0026#34;\u0026lt;A-Tab\u0026gt;\u0026#34;, \u0026#34;\u0026lt;cmd\u0026gt;bNext\u0026lt;CR\u0026gt;\u0026#34;) vim.keymap.set(\u0026#34;n\u0026#34;, \u0026#34;\u0026lt;leader\u0026gt;bc\u0026#34;, \u0026#34;\u0026lt;cmd\u0026gt;bd\u0026lt;CR\u0026gt;\u0026#34;) vim.keymap.set(\u0026#34;v\u0026#34;, \u0026#34;J\u0026#34;, \u0026#34;:m \u0026#39;\u0026gt;+1\u0026lt;CR\u0026gt;gv=gv\u0026#34;) vim.keymap.set(\u0026#34;v\u0026#34;, \u0026#34;K\u0026#34;, \u0026#34;:m \u0026#39;\u0026lt;-2\u0026lt;CR\u0026gt;gv=gv\u0026#34;) vim.keymap.set({ \u0026#34;v\u0026#34;, \u0026#34;n\u0026#34; }, \u0026#34;\u0026lt;leader\u0026gt;y\u0026#34;, \u0026#34;\\\u0026#34;+y\u0026#34;) æ’ä»¶ç®¡ç†ï¼ˆlazy.nvimï¼‰ githubåœ°å€ï¼šhttps://github.com/folke/lazy.nvim\n","permalink":"https://XianCH.github.io/posts/tech/linux/nvim_config/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eæœ€å¼€å§‹çš„æ—¶å€™ä¸»è¦æ˜¯ä¸ºäº†ç†Ÿæ‚‰vimæ“ä½œï¼Œæ‰€ä»¥å°±æ²¡æœ‰å¤šå…³ç³»é…ç½®æ–¹é¢çš„é—®é¢˜\nä¸€ç›´ä»¥æ¥ä¸€ç›´ä½¿ç”¨çš„æ˜¯ç½‘ä¸Šä¸€ä½å¤§ç¥ä½¿ç”¨çš„é…ç½®ã€‚ç”±äºä½¿ç”¨çš„æ˜¯åˆ«äººçš„é…ç½®ï¼Œæ‰€ä»¥\nè‡ªå·±å†ä¸æ‡‚çš„æƒ…å†µä¸‹è¿˜æ˜¯ä¸çŸ¥é“æ€ä¹ˆï¼Œè¿™ç¯‡æ–‡ç« å°±æ˜¯è¦ç»™ä»¥å‰å·æ‡’çš„è‡ªå·±å¡«å‘ï¼Œä½œä¸º\nä¸€ä¸ªå®ç”¨ä¸»ä¹‰è€…ï¼Œè¿˜æ˜¯ä»è‡ªå·±çš„éœ€æ±‚å‡ºå‘å§ï¼Œéœ€è¦ç”¨åˆ°ä»€ä¹ˆå°±é…ç½®ä»€ä¹ˆã€‚\u003c/p\u003e\n\u003ch2 id=\"éœ€æ±‚åˆ—è¡¨\"\u003eéœ€æ±‚åˆ—è¡¨\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eæ–‡ä»¶ç®¡ç†\u003c/li\u003e\n\u003cli\u003eæ–‡ä»¶æœç´¢\u003c/li\u003e\n\u003cli\u003eæ–‡ä»¶æŸ¥æ‰¾\u003c/li\u003e\n\u003cli\u003eæ–‡å­—æŸ¥æ‰¾\u003c/li\u003e\n\u003cli\u003eæ’ä»¶ç®¡ç†\u003c/li\u003e\n\u003cli\u003eå¿«æ·é”®ç»‘å®š\u003c/li\u003e\n\u003cli\u003eå†…åµŒç»ˆç«¯\u003c/li\u003e\n\u003cli\u003edebug\u003c/li\u003e\n\u003cli\u003eè¯­è¨€æœåŠ¡\u003c/li\u003e\n\u003cli\u003eè¯­è¨€æ ¼å¼åŒ–\u003c/li\u003e\n\u003cli\u003eè¾“å…¥æç¤º\u003c/li\u003e\n\u003cli\u003eæ’ä»¶ç®¡ç†\u003c/li\u003e\n\u003cli\u003eä¸»é¢˜æ ·å¼\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"initlua\"\u003einit.lua\u003c/h2\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003etouch init.lua \u0026amp;\u0026amp; mkdir lua\n\u003c/code\u003e\u003c/pre\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-lua\" data-lang=\"lua\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocal\u003c/span\u003e option \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e vim.opt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocal\u003c/span\u003e buffer \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e vim.b\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elocal\u003c/span\u003e global \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e vim.g\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- Globol Settings --\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.showmode \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.backspace \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e { \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;indent\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;eol\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;start\u0026#34;\u003c/span\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.tabstop \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.shiftwidth \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.expandtab \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.shiftround \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.autoindent \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.smartindent \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.number \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.relativenumber \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.wildmenu \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.hlsearch \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.ignorecase \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.smartcase \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.completeopt \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e { \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;menu\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;menuone\u0026#34;\u003c/span\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.cursorline \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.termguicolors \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.signcolumn \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;yes\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.autoread \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.title \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.swapfile \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.backup \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.updatetime \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.mouse \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;a\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.undofile \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.undodir \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e vim.fn.expand(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;$HOME/.local/share/nvim/undo\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.exrc \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.wrap \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoption.splitright \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- Buffer Settings --\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebuffer.fileenconding \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;utf-8\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- Global Settings --\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eglobal.mapleader \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- Key mappings --\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evim.keymap.set({ \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;i\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;v\u0026#34;\u003c/span\u003e }, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;Left\u0026gt;\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;Nop\u0026gt;\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evim.keymap.set({ \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;i\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;v\u0026#34;\u003c/span\u003e }, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;Right\u0026gt;\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;Nop\u0026gt;\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evim.keymap.set({ \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;i\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;v\u0026#34;\u003c/span\u003e }, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;Up\u0026gt;\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;Nop\u0026gt;\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evim.keymap.set({ \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;i\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;v\u0026#34;\u003c/span\u003e }, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;Down\u0026gt;\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;Nop\u0026gt;\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evim.keymap.set(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;A-Tab\u0026gt;\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;cmd\u0026gt;bNext\u0026lt;CR\u0026gt;\u0026#34;\u003c/span\u003e) \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evim.keymap.set(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;n\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;leader\u0026gt;bc\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;cmd\u0026gt;bd\u0026lt;CR\u0026gt;\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evim.keymap.set(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;v\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;J\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;:m \u0026#39;\u0026gt;+1\u0026lt;CR\u0026gt;gv=gv\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evim.keymap.set(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;v\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;K\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;:m \u0026#39;\u0026lt;-2\u0026lt;CR\u0026gt;gv=gv\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evim.keymap.set({ \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;v\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;n\u0026#34;\u003c/span\u003e }, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u0026lt;leader\u0026gt;y\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e+y\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"æ’ä»¶ç®¡ç†lazynvim\"\u003eæ’ä»¶ç®¡ç†ï¼ˆlazy.nvimï¼‰\u003c/h2\u003e\n\u003cp\u003egithubåœ°å€ï¼šhttps://github.com/folke/lazy.nvim\u003c/p\u003e","title":"Nvim_config(æŒ–å‘)"},{"content":"å…³äº2024æˆ‘çš„æƒ³æ³•æŒºç®€å•çš„ï¼Œæ‰¾ä¸€ä»½ç¨³å®šçš„å·¥ä½œï¼Œå¥½å¥½å­¦ä¹ ï¼Œè®¤çœŸå¯¹å¾…è®¡åˆ’å¥½çš„äº‹æƒ…ã€‚\næƒ³æ³• ç¼–å†™å¥½åšå®¢ å¤šè¯»ä¹¦ ç¼–å†™è‹±æ–‡æ–‡ç«  æ•°å­¦ç†è®ºçŸ¥è¯† å¯¹è®¡ç®—æœºåŸºç¡€åŸç†æœ‰æ›´æ·±å…¥çš„è®¤è¯† å°‘æŠ½çƒŸ å¤šè·Ÿçˆ¶æ¯äº¤æµ ","permalink":"https://XianCH.github.io/posts/life/2024%E8%AE%A1%E5%88%92%E5%92%8C%E6%83%B3%E6%B3%95/","summary":"\u003cp\u003eå…³äº2024æˆ‘çš„æƒ³æ³•æŒºç®€å•çš„ï¼Œæ‰¾ä¸€ä»½ç¨³å®šçš„å·¥ä½œï¼Œå¥½å¥½å­¦ä¹ ï¼Œè®¤çœŸå¯¹å¾…è®¡åˆ’å¥½çš„äº‹æƒ…ã€‚\u003c/p\u003e\n\u003ch2 id=\"æƒ³æ³•\"\u003eæƒ³æ³•\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eç¼–å†™å¥½åšå®¢\u003c/li\u003e\n\u003cli\u003eå¤šè¯»ä¹¦\u003c/li\u003e\n\u003cli\u003eç¼–å†™è‹±æ–‡æ–‡ç« \u003c/li\u003e\n\u003cli\u003eæ•°å­¦ç†è®ºçŸ¥è¯†\u003c/li\u003e\n\u003cli\u003eå¯¹è®¡ç®—æœºåŸºç¡€åŸç†æœ‰æ›´æ·±å…¥çš„è®¤è¯†\u003c/li\u003e\n\u003cli\u003eå°‘æŠ½çƒŸ\u003c/li\u003e\n\u003cli\u003eå¤šè·Ÿçˆ¶æ¯äº¤æµ\u003c/li\u003e\n\u003c/ol\u003e","title":"2024è®¡åˆ’å’Œæƒ³æ³•"},{"content":"é—®é¢˜æ±‡æ€» åå°è¿›ç¨‹ç®¡ç† æ–‡ä»¶ä¼ è¾“é—®é¢˜ nvim é…ç½® vpsé…ç½® æ— æ³•ä½¿ç”¨Chrome usb æ— æ³•æ¥å…¥ï¼ˆuç›˜é—®é¢˜ï¼‰ å¼€å…³æœºé—®é¢˜ é”å±ç•Œé¢é—®é¢˜ éŸ³ä¹æ’­æ”¾å™¨é—®é¢˜ï¼ˆä¸ä½¿ç”¨ç½‘æ˜“äº‘ï¼‰ å±å¹•åˆ†è¾¨ç‡é—®é¢˜ æ–‡ä»¶ç®¡ç†å·¥å…·é—®é¢˜ è§†å±æ’­æ”¾é—®é¢˜ è§†å±å½•åˆ¶é—®é¢˜ åº•éƒ¨çŠ¶æ€æ é—®é¢˜ ","permalink":"https://XianCH.github.io/posts/tech/arch/%E6%9C%AC%E6%9C%BAarchlinux%E8%B0%83%E6%95%B4/","summary":"\u003ch2 id=\"é—®é¢˜æ±‡æ€»\"\u003eé—®é¢˜æ±‡æ€»\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eåå°è¿›ç¨‹ç®¡ç†\u003c/li\u003e\n\u003cli\u003eæ–‡ä»¶ä¼ è¾“é—®é¢˜\u003c/li\u003e\n\u003cli\u003envim é…ç½®\u003c/li\u003e\n\u003cli\u003evpsé…ç½®\u003c/li\u003e\n\u003cli\u003eæ— æ³•ä½¿ç”¨Chrome\u003c/li\u003e\n\u003cli\u003eusb æ— æ³•æ¥å…¥ï¼ˆuç›˜é—®é¢˜ï¼‰\u003c/li\u003e\n\u003cli\u003eå¼€å…³æœºé—®é¢˜\u003c/li\u003e\n\u003cli\u003eé”å±ç•Œé¢é—®é¢˜\u003c/li\u003e\n\u003cli\u003eéŸ³ä¹æ’­æ”¾å™¨é—®é¢˜ï¼ˆä¸ä½¿ç”¨ç½‘æ˜“äº‘ï¼‰\u003c/li\u003e\n\u003cli\u003eå±å¹•åˆ†è¾¨ç‡é—®é¢˜\u003c/li\u003e\n\u003cli\u003eæ–‡ä»¶ç®¡ç†å·¥å…·é—®é¢˜\u003c/li\u003e\n\u003cli\u003eè§†å±æ’­æ”¾é—®é¢˜\u003c/li\u003e\n\u003cli\u003eè§†å±å½•åˆ¶é—®é¢˜\u003c/li\u003e\n\u003cli\u003eåº•éƒ¨çŠ¶æ€æ é—®é¢˜\u003c/li\u003e\n\u003c/ul\u003e","title":"æœ¬æœºarchlinuxè°ƒæ•´"},{"content":"bufio, io.Reader,bytes.NewBuffer,bytes.Read\nbufio.NewReader\n","permalink":"https://XianCH.github.io/posts/tech/go/golangio/","summary":"\u003cp\u003ebufio, io.Reader,bytes.NewBuffer,bytes.Read\u003c/p\u003e\n\u003cp\u003ebufio.NewReader\u003c/p\u003e","title":"GolangIO"},{"content":"","permalink":"https://XianCH.github.io/posts/tech/go/golang%E5%AE%9E%E7%8E%B0%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/","summary":"","title":"Golangå®ç°æ¶ˆæ¯é˜Ÿåˆ—"},{"content":"å­—ç¬¦ç¼–ç ç¬”è®°ï¼šASCIIï¼ŒUnicode å’Œ UTF-8 ä¸€ã€ASCII ç  æˆ‘ä»¬çŸ¥é“ï¼Œè®¡ç®—æœºå†…éƒ¨ï¼Œæ‰€æœ‰ä¿¡æ¯æœ€ç»ˆéƒ½æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å€¼ã€‚æ¯ä¸€ä¸ªäºŒè¿›åˆ¶ä½ï¼ˆbitï¼‰æœ‰0å’Œ1ä¸¤ç§çŠ¶æ€ï¼Œå› æ­¤å…«ä¸ªäºŒè¿›åˆ¶ä½å°±å¯ä»¥ç»„åˆå‡º256ç§çŠ¶æ€ï¼Œè¿™è¢«ç§°ä¸ºä¸€ä¸ªå­—èŠ‚ï¼ˆbyteï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå­—èŠ‚ä¸€å…±å¯ä»¥ç”¨æ¥è¡¨ç¤º256ç§ä¸åŒçš„çŠ¶æ€ï¼Œæ¯ä¸€ä¸ªçŠ¶æ€å¯¹åº”ä¸€ä¸ªç¬¦å·ï¼Œå°±æ˜¯256ä¸ªç¬¦å·ï¼Œä»00000000åˆ°11111111ã€‚\nä¸Šä¸ªä¸–çºª60å¹´ä»£ï¼Œç¾å›½åˆ¶å®šäº†ä¸€å¥—å­—ç¬¦ç¼–ç ï¼Œå¯¹è‹±è¯­å­—ç¬¦ä¸äºŒè¿›åˆ¶ä½ä¹‹é—´çš„å…³ç³»ï¼Œåšäº†ç»Ÿä¸€è§„å®šã€‚è¿™è¢«ç§°ä¸º ASCII ç ï¼Œä¸€ç›´æ²¿ç”¨è‡³ä»Šã€‚\nASCII ç ä¸€å…±è§„å®šäº†128ä¸ªå­—ç¬¦çš„ç¼–ç ï¼Œæ¯”å¦‚ç©ºæ ¼SPACEæ˜¯32ï¼ˆäºŒè¿›åˆ¶00100000ï¼‰ï¼Œå¤§å†™çš„å­—æ¯Aæ˜¯65ï¼ˆäºŒè¿›åˆ¶01000001ï¼‰ã€‚è¿™128ä¸ªç¬¦å·ï¼ˆåŒ…æ‹¬32ä¸ªä¸èƒ½æ‰“å°å‡ºæ¥çš„æ§åˆ¶ç¬¦å·ï¼‰ï¼Œåªå ç”¨äº†ä¸€ä¸ªå­—èŠ‚çš„åé¢7ä½ï¼Œæœ€å‰é¢çš„ä¸€ä½ç»Ÿä¸€è§„å®šä¸º0ã€‚\näºŒã€é ASCII ç¼–ç  è‹±è¯­ç”¨128ä¸ªç¬¦å·ç¼–ç å°±å¤Ÿäº†ï¼Œä½†æ˜¯ç”¨æ¥è¡¨ç¤ºå…¶ä»–è¯­è¨€ï¼Œ128ä¸ªç¬¦å·æ˜¯ä¸å¤Ÿçš„ã€‚æ¯”å¦‚ï¼Œåœ¨æ³•è¯­ä¸­ï¼Œå­—æ¯ä¸Šæ–¹æœ‰æ³¨éŸ³ç¬¦å·ï¼Œå®ƒå°±æ— æ³•ç”¨ ASCII ç è¡¨ç¤ºã€‚äºæ˜¯ï¼Œä¸€äº›æ¬§æ´²å›½å®¶å°±å†³å®šï¼Œåˆ©ç”¨å­—èŠ‚ä¸­é—²ç½®çš„æœ€é«˜ä½ç¼–å…¥æ–°çš„ç¬¦å·ã€‚æ¯”å¦‚ï¼Œæ³•è¯­ä¸­çš„Ã©çš„ç¼–ç ä¸º130ï¼ˆäºŒè¿›åˆ¶10000010ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¿™äº›æ¬§æ´²å›½å®¶ä½¿ç”¨çš„ç¼–ç ä½“ç³»ï¼Œå¯ä»¥è¡¨ç¤ºæœ€å¤š256ä¸ªç¬¦å·ã€‚\nä½†æ˜¯ï¼Œè¿™é‡Œåˆå‡ºç°äº†æ–°çš„é—®é¢˜ã€‚ä¸åŒçš„å›½å®¶æœ‰ä¸åŒçš„å­—æ¯ï¼Œå› æ­¤ï¼Œå“ªæ€•å®ƒä»¬éƒ½ä½¿ç”¨256ä¸ªç¬¦å·çš„ç¼–ç æ–¹å¼ï¼Œä»£è¡¨çš„å­—æ¯å´ä¸ä¸€æ ·ã€‚æ¯”å¦‚ï¼Œ130åœ¨æ³•è¯­ç¼–ç ä¸­ä»£è¡¨äº†Ã©ï¼Œåœ¨å¸Œä¼¯æ¥è¯­ç¼–ç ä¸­å´ä»£è¡¨äº†å­—æ¯Gimel (×’)ï¼Œåœ¨ä¿„è¯­ç¼–ç ä¸­åˆä¼šä»£è¡¨å¦ä¸€ä¸ªç¬¦å·ã€‚ä½†æ˜¯ä¸ç®¡æ€æ ·ï¼Œæ‰€æœ‰è¿™äº›ç¼–ç æ–¹å¼ä¸­ï¼Œ0\u0026ndash;127è¡¨ç¤ºçš„ç¬¦å·æ˜¯ä¸€æ ·çš„ï¼Œä¸ä¸€æ ·çš„åªæ˜¯128\u0026ndash;255çš„è¿™ä¸€æ®µã€‚\nè‡³äºäºšæ´²å›½å®¶çš„æ–‡å­—ï¼Œä½¿ç”¨çš„ç¬¦å·å°±æ›´å¤šäº†ï¼Œæ±‰å­—å°±å¤šè¾¾10ä¸‡å·¦å³ã€‚ä¸€ä¸ªå­—èŠ‚åªèƒ½è¡¨ç¤º256ç§ç¬¦å·ï¼Œè‚¯å®šæ˜¯ä¸å¤Ÿçš„ï¼Œå°±å¿…é¡»ä½¿ç”¨å¤šä¸ªå­—èŠ‚è¡¨è¾¾ä¸€ä¸ªç¬¦å·ã€‚æ¯”å¦‚ï¼Œç®€ä½“ä¸­æ–‡å¸¸è§çš„ç¼–ç æ–¹å¼æ˜¯ GB2312ï¼Œä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªæ±‰å­—ï¼Œæ‰€ä»¥ç†è®ºä¸Šæœ€å¤šå¯ä»¥è¡¨ç¤º 256 x 256 = 65536 ä¸ªç¬¦å·ã€‚\nä¸­æ–‡ç¼–ç çš„é—®é¢˜éœ€è¦ä¸“æ–‡è®¨è®ºï¼Œè¿™ç¯‡ç¬”è®°ä¸æ¶‰åŠã€‚è¿™é‡ŒåªæŒ‡å‡ºï¼Œè™½ç„¶éƒ½æ˜¯ç”¨å¤šä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œä½†æ˜¯GBç±»çš„æ±‰å­—ç¼–ç ä¸åæ–‡çš„ Unicode å’Œ UTF-8 æ˜¯æ¯«æ— å…³ç³»çš„ã€‚\nä¸‰. Unicode æ­£å¦‚ä¸Šä¸€èŠ‚æ‰€è¯´ï¼Œä¸–ç•Œä¸Šå­˜åœ¨ç€å¤šç§ç¼–ç æ–¹å¼ï¼ŒåŒä¸€ä¸ªäºŒè¿›åˆ¶æ•°å­—å¯ä»¥è¢«è§£é‡Šæˆä¸åŒçš„ç¬¦å·ã€‚å› æ­¤ï¼Œè¦æƒ³æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå°±å¿…é¡»çŸ¥é“å®ƒçš„ç¼–ç æ–¹å¼ï¼Œå¦åˆ™ç”¨é”™è¯¯çš„ç¼–ç æ–¹å¼è§£è¯»ï¼Œå°±ä¼šå‡ºç°ä¹±ç ã€‚ä¸ºä»€ä¹ˆç”µå­é‚®ä»¶å¸¸å¸¸å‡ºç°ä¹±ç ï¼Ÿå°±æ˜¯å› ä¸ºå‘ä¿¡äººå’Œæ”¶ä¿¡äººä½¿ç”¨çš„ç¼–ç æ–¹å¼ä¸ä¸€æ ·ã€‚\nå¯ä»¥æƒ³è±¡ï¼Œå¦‚æœæœ‰ä¸€ç§ç¼–ç ï¼Œå°†ä¸–ç•Œä¸Šæ‰€æœ‰çš„ç¬¦å·éƒ½çº³å…¥å…¶ä¸­ã€‚æ¯ä¸€ä¸ªç¬¦å·éƒ½ç»™äºˆä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ç¼–ç ï¼Œé‚£ä¹ˆä¹±ç é—®é¢˜å°±ä¼šæ¶ˆå¤±ã€‚è¿™å°±æ˜¯ Unicodeï¼Œå°±åƒå®ƒçš„åå­—éƒ½è¡¨ç¤ºçš„ï¼Œè¿™æ˜¯ä¸€ç§æ‰€æœ‰ç¬¦å·çš„ç¼–ç ã€‚\nUnicode å½“ç„¶æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„é›†åˆï¼Œç°åœ¨çš„è§„æ¨¡å¯ä»¥å®¹çº³100å¤šä¸‡ä¸ªç¬¦å·ã€‚æ¯ä¸ªç¬¦å·çš„ç¼–ç éƒ½ä¸ä¸€æ ·ï¼Œæ¯”å¦‚ï¼ŒU+0639è¡¨ç¤ºé˜¿æ‹‰ä¼¯å­—æ¯Ainï¼ŒU+0041è¡¨ç¤ºè‹±è¯­çš„å¤§å†™å­—æ¯Aï¼ŒU+4E25è¡¨ç¤ºæ±‰å­—ä¸¥ã€‚å…·ä½“çš„ç¬¦å·å¯¹åº”è¡¨ï¼Œå¯ä»¥æŸ¥è¯¢unicode.orgï¼Œæˆ–è€…ä¸“é—¨çš„æ±‰å­—å¯¹åº”è¡¨ã€‚\nå››ã€Unicode çš„é—®é¢˜ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒUnicode åªæ˜¯ä¸€ä¸ªç¬¦å·é›†ï¼Œå®ƒåªè§„å®šäº†ç¬¦å·çš„äºŒè¿›åˆ¶ä»£ç ï¼Œå´æ²¡æœ‰è§„å®šè¿™ä¸ªäºŒè¿›åˆ¶ä»£ç åº”è¯¥å¦‚ä½•å­˜å‚¨ã€‚\næ¯”å¦‚ï¼Œæ±‰å­—ä¸¥çš„ Unicode æ˜¯åå…­è¿›åˆ¶æ•°4E25ï¼Œè½¬æ¢æˆäºŒè¿›åˆ¶æ•°è¶³è¶³æœ‰15ä½ï¼ˆ100111000100101ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªç¬¦å·çš„è¡¨ç¤ºè‡³å°‘éœ€è¦2ä¸ªå­—èŠ‚ã€‚è¡¨ç¤ºå…¶ä»–æ›´å¤§çš„ç¬¦å·ï¼Œå¯èƒ½éœ€è¦3ä¸ªå­—èŠ‚æˆ–è€…4ä¸ªå­—èŠ‚ï¼Œç”šè‡³æ›´å¤šã€‚\nè¿™é‡Œå°±æœ‰ä¸¤ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚ä½•æ‰èƒ½åŒºåˆ« Unicode å’Œ ASCII ï¼Ÿè®¡ç®—æœºæ€ä¹ˆçŸ¥é“ä¸‰ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œè€Œä¸æ˜¯åˆ†åˆ«è¡¨ç¤ºä¸‰ä¸ªç¬¦å·å‘¢ï¼Ÿç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œè‹±æ–‡å­—æ¯åªç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºå°±å¤Ÿäº†ï¼Œå¦‚æœ Unicode ç»Ÿä¸€è§„å®šï¼Œæ¯ä¸ªç¬¦å·ç”¨ä¸‰ä¸ªæˆ–å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œé‚£ä¹ˆæ¯ä¸ªè‹±æ–‡å­—æ¯å‰éƒ½å¿…ç„¶æœ‰äºŒåˆ°ä¸‰ä¸ªå­—èŠ‚æ˜¯0ï¼Œè¿™å¯¹äºå­˜å‚¨æ¥è¯´æ˜¯æå¤§çš„æµªè´¹ï¼Œæ–‡æœ¬æ–‡ä»¶çš„å¤§å°ä¼šå› æ­¤å¤§å‡ºäºŒä¸‰å€ï¼Œè¿™æ˜¯æ— æ³•æ¥å—çš„ã€‚\nå®ƒä»¬é€ æˆçš„ç»“æœæ˜¯ï¼š1ï¼‰å‡ºç°äº† Unicode çš„å¤šç§å­˜å‚¨æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¯´æœ‰è®¸å¤šç§ä¸åŒçš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œå¯ä»¥ç”¨æ¥è¡¨ç¤º Unicodeã€‚2ï¼‰Unicode åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…æ— æ³•æ¨å¹¿ï¼Œç›´åˆ°äº’è”ç½‘çš„å‡ºç°ã€‚\näº”ã€UTF-8 äº’è”ç½‘çš„æ™®åŠï¼Œå¼ºçƒˆè¦æ±‚å‡ºç°ä¸€ç§ç»Ÿä¸€çš„ç¼–ç æ–¹å¼ã€‚UTF-8 å°±æ˜¯åœ¨äº’è”ç½‘ä¸Šä½¿ç”¨æœ€å¹¿çš„ä¸€ç§ Unicode çš„å®ç°æ–¹å¼ã€‚å…¶ä»–å®ç°æ–¹å¼è¿˜åŒ…æ‹¬ UTF-16ï¼ˆå­—ç¬¦ç”¨ä¸¤ä¸ªå­—èŠ‚æˆ–å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼‰å’Œ UTF-32ï¼ˆå­—ç¬¦ç”¨å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼‰ï¼Œä¸è¿‡åœ¨äº’è”ç½‘ä¸ŠåŸºæœ¬ä¸ç”¨ã€‚é‡å¤ä¸€éï¼Œè¿™é‡Œçš„å…³ç³»æ˜¯ï¼ŒUTF-8 æ˜¯ Unicode çš„å®ç°æ–¹å¼ä¹‹ä¸€ã€‚\nUTF-8 æœ€å¤§çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯å®ƒæ˜¯ä¸€ç§å˜é•¿çš„ç¼–ç æ–¹å¼ã€‚å®ƒå¯ä»¥ä½¿ç”¨1~4ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œæ ¹æ®ä¸åŒçš„ç¬¦å·è€Œå˜åŒ–å­—èŠ‚é•¿åº¦ã€‚\nUTF-8 çš„ç¼–ç è§„åˆ™å¾ˆç®€å•ï¼Œåªæœ‰äºŒæ¡ï¼š\n1ï¼‰å¯¹äºå•å­—èŠ‚çš„ç¬¦å·ï¼Œå­—èŠ‚çš„ç¬¬ä¸€ä½è®¾ä¸º0ï¼Œåé¢7ä½ä¸ºè¿™ä¸ªç¬¦å·çš„ Unicode ç ã€‚å› æ­¤å¯¹äºè‹±è¯­å­—æ¯ï¼ŒUTF-8 ç¼–ç å’Œ ASCII ç æ˜¯ç›¸åŒçš„ã€‚\n2ï¼‰å¯¹äºnå­—èŠ‚çš„ç¬¦å·ï¼ˆn \u0026gt; 1ï¼‰ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚çš„å‰nä½éƒ½è®¾ä¸º1ï¼Œç¬¬n + 1ä½è®¾ä¸º0ï¼Œåé¢å­—èŠ‚çš„å‰ä¸¤ä½ä¸€å¾‹è®¾ä¸º10ã€‚å‰©ä¸‹çš„æ²¡æœ‰æåŠçš„äºŒè¿›åˆ¶ä½ï¼Œå…¨éƒ¨ä¸ºè¿™ä¸ªç¬¦å·çš„ Unicode ç ã€‚\nä¸‹è¡¨æ€»ç»“äº†ç¼–ç è§„åˆ™ï¼Œå­—æ¯xè¡¨ç¤ºå¯ç”¨ç¼–ç çš„ä½ã€‚\nUnicodeç¬¦å·èŒƒå›´ | UTF-8ç¼–ç æ–¹å¼ (åå…­è¿›åˆ¶) | ï¼ˆäºŒè¿›åˆ¶ï¼‰ ----------------------+--------------------------------------------- 0000 0000-0000 007F | 0xxxxxxx 0000 0080-0000 07FF | 110xxxxx 10xxxxxx 0000 0800-0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx 0001 0000-0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx è·Ÿæ®ä¸Šè¡¨ï¼Œè§£è¯» UTF-8 ç¼–ç éå¸¸ç®€å•ã€‚å¦‚æœä¸€ä¸ªå­—èŠ‚çš„ç¬¬ä¸€ä½æ˜¯0ï¼Œåˆ™è¿™ä¸ªå­—èŠ‚å•ç‹¬å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼›å¦‚æœç¬¬ä¸€ä½æ˜¯1ï¼Œåˆ™è¿ç»­æœ‰å¤šå°‘ä¸ª1ï¼Œå°±è¡¨ç¤ºå½“å‰å­—ç¬¦å ç”¨å¤šå°‘ä¸ªå­—èŠ‚ã€‚\nä¸‹é¢ï¼Œè¿˜æ˜¯ä»¥æ±‰å­—ä¸¥ä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•å®ç° UTF-8 ç¼–ç ã€‚\nä¸¥çš„ Unicode æ˜¯4E25ï¼ˆ100111000100101ï¼‰ï¼Œæ ¹æ®ä¸Šè¡¨ï¼Œå¯ä»¥å‘ç°4E25å¤„åœ¨ç¬¬ä¸‰è¡Œçš„èŒƒå›´å†…ï¼ˆ0000 0800 - 0000 FFFFï¼‰ï¼Œå› æ­¤ä¸¥çš„ UTF-8 ç¼–ç éœ€è¦ä¸‰ä¸ªå­—èŠ‚ï¼Œå³æ ¼å¼æ˜¯1110xxxx 10xxxxxx 10xxxxxxã€‚ç„¶åï¼Œä»ä¸¥çš„æœ€åä¸€ä¸ªäºŒè¿›åˆ¶ä½å¼€å§‹ï¼Œä¾æ¬¡ä»åå‘å‰å¡«å…¥æ ¼å¼ä¸­çš„xï¼Œå¤šå‡ºçš„ä½è¡¥0ã€‚è¿™æ ·å°±å¾—åˆ°äº†ï¼Œä¸¥çš„ UTF-8 ç¼–ç æ˜¯11100100 10111000 10100101ï¼Œè½¬æ¢æˆåå…­è¿›åˆ¶å°±æ˜¯E4B8A5ã€‚\nå…­ã€Unicode ä¸ UTF-8 ä¹‹é—´çš„è½¬æ¢ é€šè¿‡ä¸Šä¸€èŠ‚çš„ä¾‹å­ï¼Œå¯ä»¥çœ‹åˆ°ä¸¥çš„ Unicodeç  æ˜¯4E25ï¼ŒUTF-8 ç¼–ç æ˜¯E4B8A5ï¼Œä¸¤è€…æ˜¯ä¸ä¸€æ ·çš„ã€‚å®ƒä»¬ä¹‹é—´çš„è½¬æ¢å¯ä»¥é€šè¿‡ç¨‹åºå®ç°ã€‚\nWindowså¹³å°ï¼Œæœ‰ä¸€ä¸ªæœ€ç®€å•çš„è½¬åŒ–æ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨å†…ç½®çš„è®°äº‹æœ¬å°ç¨‹åºnotepad.exeã€‚æ‰“å¼€æ–‡ä»¶åï¼Œç‚¹å‡»æ–‡ä»¶èœå•ä¸­çš„å¦å­˜ä¸ºå‘½ä»¤ï¼Œä¼šè·³å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œåœ¨æœ€åº•éƒ¨æœ‰ä¸€ä¸ªç¼–ç çš„ä¸‹æ‹‰æ¡ã€‚\né‡Œé¢æœ‰å››ä¸ªé€‰é¡¹ï¼šANSIï¼ŒUnicodeï¼ŒUnicode big endianå’ŒUTF-8ã€‚\n1ï¼‰ANSIæ˜¯é»˜è®¤çš„ç¼–ç æ–¹å¼ã€‚å¯¹äºè‹±æ–‡æ–‡ä»¶æ˜¯ASCIIç¼–ç ï¼Œå¯¹äºç®€ä½“ä¸­æ–‡æ–‡ä»¶æ˜¯GB2312ç¼–ç ï¼ˆåªé’ˆå¯¹ Windows ç®€ä½“ä¸­æ–‡ç‰ˆï¼Œå¦‚æœæ˜¯ç¹ä½“ä¸­æ–‡ç‰ˆä¼šé‡‡ç”¨ Big5 ç ï¼‰ã€‚\n2ï¼‰Unicodeç¼–ç è¿™é‡ŒæŒ‡çš„æ˜¯notepad.exeä½¿ç”¨çš„ UCS-2 ç¼–ç æ–¹å¼ï¼Œå³ç›´æ¥ç”¨ä¸¤ä¸ªå­—èŠ‚å­˜å…¥å­—ç¬¦çš„ Unicode ç ï¼Œè¿™ä¸ªé€‰é¡¹ç”¨çš„ little endian æ ¼å¼ã€‚\n3ï¼‰Unicode big endianç¼–ç ä¸ä¸Šä¸€ä¸ªé€‰é¡¹ç›¸å¯¹åº”ã€‚æˆ‘åœ¨ä¸‹ä¸€èŠ‚ä¼šè§£é‡Š little endian å’Œ big endian çš„æ¶µä¹‰ã€‚\n4ï¼‰UTF-8ç¼–ç ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€èŠ‚è°ˆåˆ°çš„ç¼–ç æ–¹æ³•ã€‚\né€‰æ‹©å®Œ\u0026quot;ç¼–ç æ–¹å¼\u0026quot;åï¼Œç‚¹å‡»\u0026quot;ä¿å­˜\u0026quot;æŒ‰é’®ï¼Œæ–‡ä»¶çš„ç¼–ç æ–¹å¼å°±ç«‹åˆ»è½¬æ¢å¥½äº†ã€‚\nä¸ƒã€Little endian å’Œ Big endian ä¸Šä¸€èŠ‚å·²ç»æåˆ°ï¼ŒUCS-2 æ ¼å¼å¯ä»¥å­˜å‚¨ Unicode ç ï¼ˆç ç‚¹ä¸è¶…è¿‡0xFFFFï¼‰ã€‚ä»¥æ±‰å­—ä¸¥ä¸ºä¾‹ï¼ŒUnicode ç æ˜¯4E25ï¼Œéœ€è¦ç”¨ä¸¤ä¸ªå­—èŠ‚å­˜å‚¨ï¼Œä¸€ä¸ªå­—èŠ‚æ˜¯4Eï¼Œå¦ä¸€ä¸ªå­—èŠ‚æ˜¯25ã€‚å­˜å‚¨çš„æ—¶å€™ï¼Œ4Eåœ¨å‰ï¼Œ25åœ¨åï¼Œè¿™å°±æ˜¯ Big endian æ–¹å¼ï¼›25åœ¨å‰ï¼Œ4Eåœ¨åï¼Œè¿™æ˜¯ Little endian æ–¹å¼ã€‚\nè¿™ä¸¤ä¸ªå¤æ€ªçš„åç§°æ¥è‡ªè‹±å›½ä½œå®¶æ–¯å¨å¤«ç‰¹çš„ã€Šæ ¼åˆ—ä½›æ¸¸è®°ã€‹ã€‚åœ¨è¯¥ä¹¦ä¸­ï¼Œå°äººå›½é‡Œçˆ†å‘äº†å†…æˆ˜ï¼Œæˆ˜äº‰èµ·å› æ˜¯äººä»¬äº‰è®ºï¼Œåƒé¸¡è›‹æ—¶ç©¶ç«Ÿæ˜¯ä»å¤§å¤´(Big-endian)æ•²å¼€è¿˜æ˜¯ä»å°å¤´(Little-endian)æ•²å¼€ã€‚ä¸ºäº†è¿™ä»¶äº‹æƒ…ï¼Œå‰åçˆ†å‘äº†å…­æ¬¡æˆ˜äº‰ï¼Œä¸€ä¸ªçš‡å¸é€äº†å‘½ï¼Œå¦ä¸€ä¸ªçš‡å¸ä¸¢äº†ç‹ä½ã€‚\nç¬¬ä¸€ä¸ªå­—èŠ‚åœ¨å‰ï¼Œå°±æ˜¯\u0026quot;å¤§å¤´æ–¹å¼\u0026quot;ï¼ˆBig endianï¼‰ï¼Œç¬¬äºŒä¸ªå­—èŠ‚åœ¨å‰å°±æ˜¯\u0026quot;å°å¤´æ–¹å¼\u0026quot;ï¼ˆLittle endianï¼‰ã€‚\né‚£ä¹ˆå¾ˆè‡ªç„¶çš„ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼šè®¡ç®—æœºæ€ä¹ˆçŸ¥é“æŸä¸€ä¸ªæ–‡ä»¶åˆ°åº•é‡‡ç”¨å“ªä¸€ç§æ–¹å¼ç¼–ç ï¼Ÿ\nUnicode è§„èŒƒå®šä¹‰ï¼Œæ¯ä¸€ä¸ªæ–‡ä»¶çš„æœ€å‰é¢åˆ†åˆ«åŠ å…¥ä¸€ä¸ªè¡¨ç¤ºç¼–ç é¡ºåºçš„å­—ç¬¦ï¼Œè¿™ä¸ªå­—ç¬¦çš„åå­—å«åš\u0026quot;é›¶å®½åº¦éæ¢è¡Œç©ºæ ¼\u0026quot;ï¼ˆzero width no-break spaceï¼‰ï¼Œç”¨FEFFè¡¨ç¤ºã€‚è¿™æ­£å¥½æ˜¯ä¸¤ä¸ªå­—èŠ‚ï¼Œè€Œä¸”FFæ¯”FEå¤§1ã€‚\nå¦‚æœä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„å¤´ä¸¤ä¸ªå­—èŠ‚æ˜¯FE FFï¼Œå°±è¡¨ç¤ºè¯¥æ–‡ä»¶é‡‡ç”¨å¤§å¤´æ–¹å¼ï¼›å¦‚æœå¤´ä¸¤ä¸ªå­—èŠ‚æ˜¯FF FEï¼Œå°±è¡¨ç¤ºè¯¥æ–‡ä»¶é‡‡ç”¨å°å¤´æ–¹å¼ã€‚\nå…«ã€å®ä¾‹ ä¸‹é¢ï¼Œä¸¾ä¸€ä¸ªå®ä¾‹ã€‚\næ‰“å¼€\u0026quot;è®°äº‹æœ¬\u0026quot;ç¨‹åºnotepad.exeï¼Œæ–°å»ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå†…å®¹å°±æ˜¯ä¸€ä¸ªä¸¥å­—ï¼Œä¾æ¬¡é‡‡ç”¨ANSIï¼ŒUnicodeï¼ŒUnicode big endianå’ŒUTF-8ç¼–ç æ–¹å¼ä¿å­˜ã€‚\nç„¶åï¼Œç”¨æ–‡æœ¬ç¼–è¾‘è½¯ä»¶UltraEdit ä¸­çš„\u0026quot;åå…­è¿›åˆ¶åŠŸèƒ½\u0026quot;ï¼Œè§‚å¯Ÿè¯¥æ–‡ä»¶çš„å†…éƒ¨ç¼–ç æ–¹å¼ã€‚\n1ï¼‰ANSIï¼šæ–‡ä»¶çš„ç¼–ç å°±æ˜¯ä¸¤ä¸ªå­—èŠ‚D1 CFï¼Œè¿™æ­£æ˜¯ä¸¥çš„ GB2312 ç¼–ç ï¼Œè¿™ä¹Ÿæš—ç¤º GB2312 æ˜¯é‡‡ç”¨å¤§å¤´æ–¹å¼å­˜å‚¨çš„ã€‚\n2ï¼‰Unicodeï¼šç¼–ç æ˜¯å››ä¸ªå­—èŠ‚FF FE 25 4Eï¼Œå…¶ä¸­FF FEè¡¨æ˜æ˜¯å°å¤´æ–¹å¼å­˜å‚¨ï¼ŒçœŸæ­£çš„ç¼–ç æ˜¯4E25ã€‚\n3ï¼‰Unicode big endianï¼šç¼–ç æ˜¯å››ä¸ªå­—èŠ‚FE FF 4E 25ï¼Œå…¶ä¸­FE FFè¡¨æ˜æ˜¯å¤§å¤´æ–¹å¼å­˜å‚¨ã€‚\n4ï¼‰UTF-8ï¼šç¼–ç æ˜¯å…­ä¸ªå­—èŠ‚EF BB BF E4 B8 A5ï¼Œå‰ä¸‰ä¸ªå­—èŠ‚EF BB BFè¡¨ç¤ºè¿™æ˜¯UTF-8ç¼–ç ï¼Œåä¸‰ä¸ªE4B8A5å°±æ˜¯ä¸¥çš„å…·ä½“ç¼–ç ï¼Œå®ƒçš„å­˜å‚¨é¡ºåºä¸ç¼–ç é¡ºåºæ˜¯ä¸€è‡´çš„ã€‚\nè½¬è½½æ–‡ç« åœ°å€ï¼šhttps://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html\n","permalink":"https://XianCH.github.io/posts/tech/basic/%E5%AD%97%E7%AC%A6%E9%9B%86%E7%BC%96%E7%A0%81/","summary":"\u003ch1 id=\"å­—ç¬¦ç¼–ç ç¬”è®°asciiunicode-å’Œ-utf-8\"\u003eå­—ç¬¦ç¼–ç ç¬”è®°ï¼šASCIIï¼ŒUnicode å’Œ UTF-8\u003c/h1\u003e\n\u003ch2 id=\"ä¸€ascii-ç \"\u003e\u003cstrong\u003eä¸€ã€ASCII ç \u003c/strong\u003e\u003c/h2\u003e\n\u003cp\u003eæˆ‘ä»¬çŸ¥é“ï¼Œè®¡ç®—æœºå†…éƒ¨ï¼Œæ‰€æœ‰ä¿¡æ¯æœ€ç»ˆéƒ½æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å€¼ã€‚æ¯ä¸€ä¸ªäºŒè¿›åˆ¶ä½ï¼ˆbitï¼‰æœ‰\u003ccode\u003e0\u003c/code\u003eå’Œ\u003ccode\u003e1\u003c/code\u003eä¸¤ç§çŠ¶æ€ï¼Œå› æ­¤å…«ä¸ªäºŒè¿›åˆ¶ä½å°±å¯ä»¥ç»„åˆå‡º256ç§çŠ¶æ€ï¼Œè¿™è¢«ç§°ä¸ºä¸€ä¸ªå­—èŠ‚ï¼ˆbyteï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå­—èŠ‚ä¸€å…±å¯ä»¥ç”¨æ¥è¡¨ç¤º256ç§ä¸åŒçš„çŠ¶æ€ï¼Œæ¯ä¸€ä¸ªçŠ¶æ€å¯¹åº”ä¸€ä¸ªç¬¦å·ï¼Œå°±æ˜¯256ä¸ªç¬¦å·ï¼Œä»\u003ccode\u003e00000000\u003c/code\u003eåˆ°\u003ccode\u003e11111111\u003c/code\u003eã€‚\u003c/p\u003e","title":"å­—ç¬¦é›†ç¼–ç "},{"content":"1.çº¿ç¨‹æ± ä»‹ç» çº¿ç¨‹æ± æ˜¯ä¸€ç§å¹¶å‘ç¼–ç¨‹çš„æŠ€æœ¯ï¼Œå®ƒä¸»è¦ç”¨äºç®¡ç†å’Œå¤ç”¨çº¿ç¨‹ï¼Œä»¥æé«˜ç¨‹åºçš„æ€§èƒ½å’Œæ•ˆç‡ã€‚çº¿ç¨‹æ± ç»´æŠ¤äº†ä¸€ç»„å·¥ä½œçº¿ç¨‹ï¼Œå®ƒä»¬åœ¨ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡å¹¶æ‰§è¡Œã€‚å½“ä»»åŠ¡å®Œæˆæ—¶ï¼Œçº¿ç¨‹å¹¶ä¸è¢«é”€æ¯ï¼Œè€Œæ˜¯è¿”å›çº¿ç¨‹æ± ä»¥ä¾›ä¸‹ä¸€æ¬¡ä½¿ç”¨ã€‚\nä¼˜ç‚¹ï¼š\nèµ„æºç®¡ç†ï¼šçº¿ç¨‹æ± èƒ½å¤Ÿæœ‰æ•ˆç®¡ç†ç³»ç»Ÿèµ„æºï¼Œé¿å…äº†é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹çš„å¼€é”€ï¼Œæé«˜äº†èµ„æºçš„åˆ©ç”¨ç‡ã€‚ æ€§èƒ½æå‡ï¼š é€šè¿‡å¤ç”¨çº¿ç¨‹ï¼Œå¯ä»¥å‡å°‘çº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯å¼€é”€ï¼Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚çº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯æ˜¯ç›¸å¯¹æ˜‚è´µçš„æ“ä½œï¼Œè€Œçº¿ç¨‹æ± èƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦ä¸Šé¿å…è¿™äº›å¼€é”€ã€‚ æ§åˆ¶å¹¶å‘åº¦ï¼š çº¿ç¨‹æ± å¯ä»¥é™åˆ¶å¹¶å‘æ‰§è¡Œçš„çº¿ç¨‹æ•°é‡ï¼Œé˜²æ­¢ç³»ç»Ÿå› è¿‡åº¦å¹¶å‘è€Œå´©æºƒï¼Œæé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚ ä»»åŠ¡é˜Ÿåˆ—ï¼š çº¿ç¨‹æ± é€šå¸¸ä½¿ç”¨ä»»åŠ¡é˜Ÿåˆ—æ¥å­˜å‚¨å¾…æ‰§è¡Œçš„ä»»åŠ¡ï¼Œè¿™æ ·å¯ä»¥å®ç°ä»»åŠ¡çš„æ’é˜Ÿæ‰§è¡Œï¼Œæé«˜ç³»ç»Ÿçš„æ•´ä½“æ•ˆç‡ã€‚ ç¼ºç‚¹ï¼š\nèµ„æºå ç”¨ï¼š çº¿ç¨‹æ± åœ¨ä¸€äº›åœºæ™¯ä¸‹å¯èƒ½ä¼šå ç”¨è¾ƒå¤šçš„ç³»ç»Ÿèµ„æºï¼Œå°¤å…¶æ˜¯åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­ç§¯ç´¯äº†å¤§é‡çš„ä»»åŠ¡æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´å†…å­˜å ç”¨è¿‡é«˜ã€‚ 2.Golangæ˜¯å¦éœ€è¦çº¿ç¨‹æ±  Golangä¸­å¹¶å‘æ¨¡å‹é‡‡ç”¨äº†è½»é‡çº§çš„goroutineå’Œé€šé“ï¼ˆchannelï¼‰æœºåˆ¶ï¼Œç›¸è¾ƒäºä¼ ç»Ÿçš„çº¿ç¨‹æ± æ¨¡å‹ï¼Œæ›´ç›´è§‚ã€ç®€å•ä¸”é«˜æ•ˆã€‚åœ¨Golangä¸­ï¼Œé€šå¸¸ä¸ç›´æ¥ä½¿ç”¨çº¿ç¨‹æ± ï¼Œè€Œæ˜¯åˆ©ç”¨goroutineå’Œchannelè¿›è¡Œå¹¶å‘ç¼–ç¨‹ã€‚æœ¬æ–‡å°†é€šè¿‡golangæ¥ç®€å•çš„å®ç°ä¸€ä¸ªçº¿ç¨‹æ± .\n3.è®¾è®¡ æœ¬æ–‡ä»£ç \nè¿™é‡Œä½¿ç”¨ä»»åŠ¡é˜Ÿåˆ—åŠ ä¸Šçº¿ç¨‹æ± æ¥å®Œæˆï¼Œå½“æœ‰ä»»åŠ¡å‡ºç°çš„æ—¶å€™ï¼Œä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡ï¼Œç„¶åä»çº¿ç¨‹æ± ä¸­å–å‡ºä¸€ä¸ªworkerï¼Œå°†æ¯ä¸ªworkeréƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„goroutineï¼Œå°†ä»»åŠ¡ä¼ é€’ç»™goroutineå¤„ç†ï¼Œå½“ä»»åŠ¡ç»“æŸäº†ï¼Œå†å°†goroutineæ”¾å›åˆ°çº¿ç¨‹æ± ä¸­\n3.1 jobè®¾è®¡ jobæ˜¯è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¯ä»¥é€šè¿‡å®ç°jobæ¥å£æ¥è‡ªå®šä¹‰ä»»åŠ¡\ntype Job interface { RunTask(request interface{}) } type JobChan chan Job 3.2 worker è®¾è®¡ Workerå°±æ˜¯é«˜å¹¶å‘é‡Œé¢çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå¯åŠ¨çš„æ—¶å€™æ˜¯ä¸€ä¸ªGoroutineã€‚Workerç»“æ„ä¸€éœ€è¦ä¸€ä¸ªJobChanï¼Œç”¨æ¥æ¥æ”¶ä»å…¨å±€JobQueueé‡Œé¢è·å–çš„Jobå¯¹è±¡ã€‚éœ€è¦ä¸€ä¸ªStartå‡½æ•°ï¼Œå°†è‡ªå·±æ³¨å†Œåˆ°WorkerPoolï¼Œç„¶åç›‘å¬Jobï¼Œæœ‰Jobä¼ å…¥æ—¶ï¼Œå¤„ç†Jobçš„Runï¼Œå¤„ç†å®Œæˆä¹‹åï¼Œé‡æ–°å°†è‡ªå·±æ·»åŠ å›WorkerPoolã€‚\ntype Worker struct { ID int JobQueue JobChan WorkerPool chan *Worker } func NewWorker(id int, workerpool chan *Worker) *Worker { return \u0026amp;Worker{ ID: id, JobQueue: make(JobChan), WorkerPool: workerpool, } } func (w *Worker) Start() { go func() { for { w.WorkerPool \u0026lt;- w select { case job := \u0026lt;-w.JobQueue: log.Printf(\u0026#34;Worker %d processing job\\n\u0026#34;, w.ID) job.Run(nil) } } }() } 3.3 poolè®¾è®¡ workerpool æ˜¯ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œç”¨æ¥å­˜å‚¨ç©ºé—²çš„goroutine(worker)ï¼Œsizeä¹Ÿå°±æ˜¯poolä¸­goroutineçš„æ•°é‡ï¼ŒJobQueueç”¨æ¥å­˜å‚¨å…¨å±€çš„ jobChanï¼Œå½“æœ‰ä»»åŠ¡åˆ°jobQueueæ—¶ï¼Œä»poolä¸­å–å‡ºä¸€ä¸ªworkerï¼Œæ‰§è¡Œå®Œæˆåå°†workeræ”¾å›ã€‚waitGroupç”¨äºç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼ŒMutexæ˜¯ä¸€ä¸ªäº’æ–¥é”ï¼Œç”¨äºä¿æŠ¤å…±äº«èµ„æºã€‚\ntype WorkerPool struct { Size int JobQueue JobChan WorkerPool chan *Worker WaitGroup *sync.WaitGroup Mutex sync.Mutex } //NewWorkerPool æ˜¯åˆ›å»º WorkerPool å®ä¾‹çš„æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–äº†ä¸Šè¿°å±æ€§ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡é’ˆã€‚ func NewWorkerPool(size int) *WorkerPool { return \u0026amp;WorkerPool{ Size: size, JobQueue: make(JobChan), WorkerPool: make(chan *Worker, size), WaitGroup: \u0026amp;sync.WaitGroup{}, } } func (wp *WorkerPool) StartPool() { for i := 0; i \u0026lt; wp.Size; i++ { worker := NewWorker(i, wp.WorkerPool) go worker.Start() wp.WaitGroup.Add(1) } go func() { for job := range wp.JobQueue { worker := \u0026lt;-wp.WorkerPool go func(j Job, w *Worker) { defer func() { wp.WorkerPool \u0026lt;- w }() w.JobQueue \u0026lt;- j }(job, worker) } }() } StartPool æ–¹æ³•å¯åŠ¨äº†çº¿ç¨‹æ± ï¼Œåˆ›å»ºäº†æŒ‡å®šæ•°é‡çš„ workerï¼Œå¹¶å¯åŠ¨äº†ä¸€ä¸ª goroutine æ¥ç›‘å¬ JobQueue ä¸­çš„ä»»åŠ¡ã€‚å½“æœ‰ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œå®ƒä¼šä» WorkerPool ä¸­å–å‡ºä¸€ä¸ªç©ºé—²çš„ workerï¼Œå¹¶å°†ä»»åŠ¡åˆ†é…ç»™è¯¥ worker æ‰§è¡Œã€‚æ‰§è¡Œå®Œæˆåï¼Œworker ä¼šè¢«æ”¾å› WorkerPoolã€‚\nåœ¨ StartPool æ–¹æ³•ä¸­ï¼Œä½¿ç”¨äº† sync.WaitGroup æ¥ç­‰å¾…æ‰€æœ‰ worker å®Œæˆä»»åŠ¡ã€‚æ¯åˆ›å»ºä¸€ä¸ª workerï¼Œå°±å¯¹ WaitGroup è¿›è¡ŒåŠ ä¸€æ“ä½œã€‚åœ¨ worker å®Œæˆä»»åŠ¡æ—¶ï¼Œé€šè¿‡ defer è¯­å¥æ¥ç¡®ä¿åœ¨å‡½æ•°é€€å‡ºæ—¶å‡ä¸€ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿åœ¨æ‰€æœ‰ worker å®Œæˆä»»åŠ¡åï¼Œä¸»çº¿ç¨‹ä¸ä¼šæå‰é€€å‡ºã€‚\n3.4 è°ƒç”¨ type TickerSys struct { tickerCount int Mutex *sync.Mutex } func NewTickerSys(initialCount int) *TickerSys { return \u0026amp;TickerSys{ tickerCount: initialCount, Mutex: \u0026amp;sync.Mutex{}, } } func (t *TickerSys) Run(request int) { t.Mutex.Lock() defer t.Mutex.Unlock() t.tickerCount -= request } type PurchaseJob struct { TickerSys *TickerSys TicketCount int } func (p *PurchaseJob) Run() { p.TickerSys.Run(p.TicketCount) } func main() { wp := NewWorkerPool(10) wp.StartPool() tickerSys := NewTickerSys(100) for i := 0; i \u0026lt; 1000; i++ { job := \u0026amp;PurchaseJob{ TickerSys: tickerSys, TicketCount: 1, } wp.SubmitJob(job) if tickerSys.tickerCount == 0 { fmt.Println(\u0026#34;å”®ç¥¨ç»“æŸ\u0026#34;) break } } wp.Close() } ","permalink":"https://XianCH.github.io/posts/tech/go/golang%E5%AE%9E%E7%8E%B0%E9%80%9A%E7%94%A8%E7%BA%BF%E7%A8%8B%E6%B1%A0/","summary":"\u003ch2 id=\"1çº¿ç¨‹æ± ä»‹ç»\"\u003e1.çº¿ç¨‹æ± ä»‹ç»\u003c/h2\u003e\n\u003cp\u003eçº¿ç¨‹æ± æ˜¯ä¸€ç§å¹¶å‘ç¼–ç¨‹çš„æŠ€æœ¯ï¼Œå®ƒä¸»è¦ç”¨äºç®¡ç†å’Œå¤ç”¨çº¿ç¨‹ï¼Œä»¥æé«˜ç¨‹åºçš„æ€§èƒ½å’Œæ•ˆç‡ã€‚çº¿ç¨‹æ± ç»´æŠ¤äº†ä¸€ç»„å·¥ä½œçº¿ç¨‹ï¼Œå®ƒä»¬åœ¨ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡å¹¶æ‰§è¡Œã€‚å½“ä»»åŠ¡å®Œæˆæ—¶ï¼Œçº¿ç¨‹å¹¶ä¸è¢«é”€æ¯ï¼Œè€Œæ˜¯è¿”å›çº¿ç¨‹æ± ä»¥ä¾›ä¸‹ä¸€æ¬¡ä½¿ç”¨ã€‚\u003c/p\u003e\n\u003cp\u003eä¼˜ç‚¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eèµ„æºç®¡ç†\u003c/strong\u003eï¼šçº¿ç¨‹æ± èƒ½å¤Ÿæœ‰æ•ˆç®¡ç†ç³»ç»Ÿèµ„æºï¼Œé¿å…äº†é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹çš„å¼€é”€ï¼Œæé«˜äº†èµ„æºçš„åˆ©ç”¨ç‡ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ€§èƒ½æå‡ï¼š\u003c/strong\u003e é€šè¿‡å¤ç”¨çº¿ç¨‹ï¼Œå¯ä»¥å‡å°‘çº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯å¼€é”€ï¼Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚çº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯æ˜¯ç›¸å¯¹æ˜‚è´µçš„æ“ä½œï¼Œè€Œçº¿ç¨‹æ± èƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦ä¸Šé¿å…è¿™äº›å¼€é”€ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ§åˆ¶å¹¶å‘åº¦ï¼š\u003c/strong\u003e çº¿ç¨‹æ± å¯ä»¥é™åˆ¶å¹¶å‘æ‰§è¡Œçš„çº¿ç¨‹æ•°é‡ï¼Œé˜²æ­¢ç³»ç»Ÿå› è¿‡åº¦å¹¶å‘è€Œå´©æºƒï¼Œæé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eä»»åŠ¡é˜Ÿåˆ—ï¼š\u003c/strong\u003e çº¿ç¨‹æ± é€šå¸¸ä½¿ç”¨ä»»åŠ¡é˜Ÿåˆ—æ¥å­˜å‚¨å¾…æ‰§è¡Œçš„ä»»åŠ¡ï¼Œè¿™æ ·å¯ä»¥å®ç°ä»»åŠ¡çš„æ’é˜Ÿæ‰§è¡Œï¼Œæé«˜ç³»ç»Ÿçš„æ•´ä½“æ•ˆç‡ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eç¼ºç‚¹ï¼š\u003c/p\u003e","title":"Golangå®ç°é€šç”¨çº¿ç¨‹æ± "},{"content":"ç®€ä»‹ jwt(json web token)ï¼Œä¸»è¦ç”¨åœ¨è·¨åŸŸè®¤è¯çš„é—®é¢˜\nJWTåŸç† åœ¨https://jwt.io/ è¿™ä¸ªç½‘ç«™å¯ä»¥è¿›è¡Œjwtçš„encode å’Œdecodeï¼Œencodeå’Œdecodeåˆ†åˆ«å¦‚ä¸‹\njwtç»„æˆ é€šè¿‡decodeå‡ºæ¥çš„æ•°æ®ï¼Œå¯ä»¥çœ‹åˆ°jwtç”±ä¸‰éƒ¨åˆ†ç»„æˆ\n1.HEADER\t(ALGORITHM \u0026amp; TOKEN TYPE) 2.PAYLOAD\t(DATA) 3.SIGNATURE\t(SIGNATURE) Header Header éƒ¨åˆ†æ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œæè¿° JWT çš„å…ƒæ•°æ®ï¼Œé€šå¸¸æ˜¯ä¸‹é¢çš„æ ·å­ã€‚\n{ \u0026#34;alg\u0026#34;: \u0026#34;HS256\u0026#34;, \u0026#34;typ\u0026#34;: \u0026#34;JWT\u0026#34; } ä¸Šé¢ä»£ç ä¸­ï¼Œalgå±æ€§è¡¨ç¤ºç­¾åçš„ç®—æ³•ï¼ˆalgorithmï¼‰ï¼Œé»˜è®¤æ˜¯ HMAC SHA256ï¼ˆå†™æˆ HS256ï¼‰ï¼›typå±æ€§è¡¨ç¤ºè¿™ä¸ªä»¤ç‰Œï¼ˆtokenï¼‰çš„ç±»å‹ï¼ˆtypeï¼‰ï¼ŒJWT ä»¤ç‰Œç»Ÿä¸€å†™ä¸ºJWTã€‚\næœ€åï¼Œå°†ä¸Šé¢çš„ JSON å¯¹è±¡ä½¿ç”¨ Base64URL ç®—æ³•ï¼ˆè¯¦è§åæ–‡ï¼‰è½¬æˆå­—ç¬¦ä¸²ã€‚\nPayload Payload éƒ¨åˆ†ä¹Ÿæ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œç”¨æ¥å­˜æ”¾å®é™…éœ€è¦ä¼ é€’çš„æ•°æ®ã€‚JWT è§„å®šäº†7ä¸ªå®˜æ–¹å­—æ®µï¼Œä¾›é€‰ç”¨ã€‚\niss (issuer)ï¼šç­¾å‘äºº exp (expiration time)ï¼šè¿‡æœŸæ—¶é—´ sub (subject)ï¼šä¸»é¢˜ aud (audience)ï¼šå—ä¼— nbf (Not Before)ï¼šç”Ÿæ•ˆæ—¶é—´ iat (Issued At)ï¼šç­¾å‘æ—¶é—´ jti (JWT ID)ï¼šç¼–å· Signature Signature éƒ¨åˆ†æ˜¯å¯¹å‰ä¸¤éƒ¨åˆ†çš„ç­¾åï¼Œé˜²æ­¢æ•°æ®ç¯¡æ”¹ã€‚\né¦–å…ˆï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªå¯†é’¥ï¼ˆsecretï¼‰ã€‚è¿™ä¸ªå¯†é’¥åªæœ‰æœåŠ¡å™¨æ‰çŸ¥é“ï¼Œä¸èƒ½æ³„éœ²ç»™ç”¨æˆ·ã€‚ç„¶åï¼Œä½¿ç”¨ Header é‡Œé¢æŒ‡å®šçš„ç­¾åç®—æ³•ï¼ˆé»˜è®¤æ˜¯ HMAC SHA256ï¼‰ï¼ŒæŒ‰ç…§ä¸‹é¢çš„å…¬å¼äº§ç”Ÿç­¾åã€‚\nHMACSHA256( base64UrlEncode(header) + \u0026#34;.\u0026#34; + base64UrlEncode(payload), secret) ç®—å‡ºç­¾åä»¥åï¼ŒæŠŠ Headerã€Payloadã€Signature ä¸‰ä¸ªéƒ¨åˆ†æ‹¼æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªéƒ¨åˆ†ä¹‹é—´ç”¨\u0026quot;ç‚¹\u0026quot;ï¼ˆ.ï¼‰åˆ†éš”ï¼Œå°±å¯ä»¥è¿”å›ç»™ç”¨æˆ·ã€‚\nç”Ÿæˆæµç¨‹ å°†headerå’Œpayloadä¸¤ä¸ªæ ¼å¼çš„json åˆ†åˆ«è¿›è¡Œbase64URLç¼–ç \nç”Ÿæˆçš„å­—ç¬¦ä¸²ç”¨.åˆ†å‰²ï¼Œç”Ÿæˆäº†å‰ä¸¤éƒ¨åˆ†\næœ€åä¸€éƒ¨åˆ†é€šè¿‡æ˜¯é€šè¿‡ï¼šå‰ä¸¤æ®µç”Ÿæˆçš„å­—ç¬¦ä¸²+headeré‡Œé¢çš„åŠ å¯†ç®—æ³•+ ç§˜é’¥ã€‚\næ ¡éªŒæµç¨‹ é€šè¿‡å‰é¢ä¸¤æ®µbase64ç”Ÿæˆçš„å­—ç¬¦ä¸² ï¼Œè¿˜æœ‰headeré‡Œé¢çš„åŠ å¯†ç®—æ³•ï¼ŒåŠ ä¸Šå¯†é’¥ï¼Œæœ€åç”Ÿæˆçš„å­—ç¬¦ä¸² å’Œ åŸæ¥çš„çš„å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œæ¥æ£€æŸ¥jwtæ˜¯å¦è¢«ç¯¡æ”¹ã€‚\ngolang-jwt type MyCliams struct { Username string `json:\u0026#34;username\u0026#34;` jwt.StandardClaims } const TokenExpireDuration = time.Hour * 2 var MySecurt = []byte(\u0026#34;x14nch911\u0026#34;) //ç”Ÿæˆtoken func GenToken(username string) (string, error) { c := MyCliams{ username, jwt.StandardClaims{ ExpiresAt: time.Now().Add(TokenExpireDuration).Unix(), Issuer: \u0026#34;my-project\u0026#34;, }, } token := jwt.NewWithClaims(jwt.SigningMethodHS256, c) return token.SignedString(MySecurt) } // æ ¡éªŒtoken func ParseToken(tokenString string) (*MyCliams, error) { //è§£ætoken token, err := jwt.ParseWithClaims(tokenString, \u0026amp;MyCliams{}, func(token *jwt.Token) (i interface{}, err error) { return MySecurt, nil }) if err != nil { fmt.Println(err) return nil, err } if claims, ok := token.Claims.(*MyCliams); ok \u0026amp;\u0026amp; token.Valid { return claims, nil } return nil, errors.New(\u0026#34;invalid token\u0026#34;) } ","permalink":"https://XianCH.github.io/posts/tech/basic/jwt/","summary":"\u003ch2 id=\"ç®€ä»‹\"\u003eç®€ä»‹\u003c/h2\u003e\n\u003cp\u003ejwt(json web token)ï¼Œä¸»è¦ç”¨åœ¨è·¨åŸŸè®¤è¯çš„é—®é¢˜\u003c/p\u003e\n\u003ch2 id=\"jwtåŸç†\"\u003eJWTåŸç†\u003c/h2\u003e\n\u003cp\u003eåœ¨https://jwt.io/ è¿™ä¸ªç½‘ç«™å¯ä»¥è¿›è¡Œjwtçš„encode å’Œdecodeï¼Œencodeå’Œdecodeåˆ†åˆ«å¦‚ä¸‹\u003c/p\u003e\n\u003cimg src=\"./index.assets/image-20231123163611920.png\" alt=\"image-20231123163611920\" style=\"zoom:50%;\" /\u003e\n\u003cimg src=\"./index.assets/image-20231123163747214.png\" alt=\"image-20231123163747214\" style=\"zoom:25%;\" /\u003e\n\u003ch3 id=\"jwtç»„æˆ\"\u003ejwtç»„æˆ\u003c/h3\u003e\n\u003cp\u003eé€šè¿‡decodeå‡ºæ¥çš„æ•°æ®ï¼Œå¯ä»¥çœ‹åˆ°jwtç”±ä¸‰éƒ¨åˆ†ç»„æˆ\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e1.HEADER\t\t(ALGORITHM \u0026amp; TOKEN TYPE)\n2.PAYLOAD\t\t(DATA)\n3.SIGNATURE\t\t(SIGNATURE)\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"header\"\u003eHeader\u003c/h3\u003e\n\u003cp\u003eHeader éƒ¨åˆ†æ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œæè¿° JWT çš„å…ƒæ•°æ®ï¼Œé€šå¸¸æ˜¯ä¸‹é¢çš„æ ·å­ã€‚\u003c/p\u003e","title":"Jwt"},{"content":"","permalink":"https://XianCH.github.io/posts/tech/distributed/kafka/","summary":"","title":"Kafka"},{"content":"ç®€è¿° ä»¥å‰åœ¨å­¦ä¹ mysqlçš„è¿‡ç¨‹ä¸­ ï¼Œéœ€è¦å¤ä¹ è¿˜æœ‰éœ€è¦æ‹“å±•çš„çŸ¥è¯†ç‚¹\nmysqlç›¸å…³å‘½ä»¤ #æŸ¥çœ‹æ•°æ®åº“å¼•æ“ show engine; #æŸ¥çœ‹è¡¨ç»“æ„ DESC tablename; #æŸ¥çœ‹åˆ›å»ºè¡¨çš„sqlè¯­å¥ show CREATE TABLE TABLE_NAME; #åˆ›å»ºè¡¨ Drop table if exists `school`; CREATE TABLE `school` default character set utf8; use school; #è‡ªå¢ auto_increment; #ä¸»é”® primary key(`column`); #è®¾ç½®å¼•æ“å’Œç¼–ç  engine = innoDB DEFAULT CHARSET= UT8; #è®¾ç½®å¤–é”®å°†äº§å“çš„cidç»‘å®šåˆ°categoryçš„ä¸»é”®ä¸Š constraint fk_product_category foreign key(cid) references category(id); #nè¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œä¸ç®¡ä¸­è‹±æ–‡ï¼ˆæœ‰å¾…ç¡®å®šï¼‰ varchar(n) #åˆ›å»ºè¡¨å¹¶è®¾ç½®column drop table if exists `students`; CREATE TABLE `student`( `id` int NOT NULL AUTO_INCREMENT, `NAME` VARCHAR(20) NOT NULL , `SEX` SMALLINT DEFAULT NULL COMMENT \u0026#39;æ€§åˆ«\u0026#39;, `age` int NOT NULL , `IN_TIME` DATETIME NOT NULL , PRIMARY KEY(`id`) )default charset `UTF8`; #ä¿®æ”¹è¡¨ USE school; ALTER TABLE `students` RENAME TO `student`; #æ”¹æŠ¥å ALTER TABLE `students` add column `age` int not null after `sex`; ALTER TABLE `students` DROP column `nickname`;#åˆ é™¤è¡¨ä¸­çš„æŸä¸€åˆ— ALTER TABLE `students` CHANGE column_name new_name varchar(36);#ä¿®æ”¹æŸä¸€åˆ—çš„çš„åç§° ALTER TABLE police_org Drop primary key #ä¿®æ”¹è¡¨çš„ä¸»é”® æ—¥æœŸï¼šDATEï¼ˆYYYY-MM-DDï¼‰ //æ¯”è¾ƒå¸¸ç”¨ ä½¿ç”¨ CURDATEï¼ˆï¼‰ æ—¶é—´ï¼šTIMEï¼ˆHH:MM:SSï¼‰ //æ¯”è¾ƒå¸¸ç”¨ ä½¿ç”¨CURTIMEï¼ˆï¼‰ å¹´ä»½ï¼šYEARï¼ˆYYYYï¼‰ æœ€å…¨æ—¶é—´ï¼šDATETIMEï¼ˆYYYY-MM-DD HH:MM:SSï¼‰ //ä½¿ç”¨ NOWï¼ˆï¼‰ /*varchar(36) å¯ä»¥ä¿å­˜å¤šå°‘ä¸­è‹±æ–‡å­—ç¬¦ï¼Ÿ*/ ç­”ï¼šå…·ä½“è¿˜æ˜¯è¦çœ‹ç‰ˆæœ¬çš„ï¼Œè‡ªå·±åœ¨æ•°æ®åº“ä¸­å»ºä¸ªè¡¨æµ‹è¯•ä¸‹å¯ä»¥æ”¾å¤šå°‘ä¸ªæ±‰å­—ã€‚ 4.0 ç‰ˆæœ¬ä»¥ä¸‹ï¼Œvarchar(100)ï¼ŒæŒ‡çš„æ˜¯ 100 å­—èŠ‚ï¼Œå¦‚æœå­˜æ”¾UTF8æ±‰å­—æ—¶ï¼Œåªèƒ½å­˜33ä¸ªï¼ˆæ¯ä¸ªæ±‰å­—3å­—èŠ‚ï¼‰ 5.0 ç‰ˆæœ¬ä»¥ä¸Šï¼Œvarchar(100)ï¼ŒæŒ‡çš„æ˜¯ 100 å­—ç¬¦ï¼Œæ— è®ºå­˜æ”¾çš„æ˜¯æ•°å­—ã€å­—æ¯è¿˜æ˜¯UTF8æ±‰å­—ï¼ˆæ¯ä¸ªæ±‰å­—3å­—èŠ‚ï¼‰ï¼Œéƒ½å¯ä»¥å­˜æ”¾100ä¸ªã€‚ mysql ç»ƒä¹ é¢˜ é—®ï¼šæŸ¥æ‰¾å¹´é¾„æœ€å¤§çš„å­¦ç”Ÿçš„æ‰€æœ‰ä¿¡æ¯ï¼Ÿ\nselect * from student where age = (select MAX(age) from student); é—®ï¼šæŸ¥æ‰¾å¹´é¾„åœ¨ 20-23 å²çš„å­¦ç”Ÿï¼Ÿ\nselect * from student where age=\u0026gt;20 and age\u0026lt;=23 é—®ï¼šæŸ¥æ‰¾ id åœ¨ å¦ä¸€å¼ è¡¨é‡Œçš„å­¦ç”Ÿï¼Ÿ\nSELECT * FROM household_record WHERE household_id NOT IN (SELECT id FROM household_info) é—®ï¼šç»Ÿè®¡è¡¨ä¸­ç”·å¥³å­¦ç”Ÿçš„äººæ•°ï¼Ÿ\nç»Ÿè®¡ä¸åŒå¹´é¾„æ®µçš„äººæ•°ï¼Œäººæ•°å¤§äºç­‰äº2\nselect sex,count(*) num from students group by sex; select age,count(id) from students group by age Having NUM \u0026gt; 2 é—®ï¼šå°†å­¦ç”ŸæŒ‰ç…§å¹´é¾„å€’åºæ’ï¼ŒæŒ‰ç…§ id å‡åºæ’ï¼Ÿ\nSELECT FROM students order by age desc ,id asc; é—®ï¼šæŸ¥æ‰¾å§“åä»¥ a å¼€å¤´ æˆ–è€…ä»¥ b å¼€å¤´çš„å­¦ç”Ÿï¼Ÿ\nSELECT * FROM students WHERE name REGEXP \u0026#39;^a|^b\u0026#39;; SELECT * from students where name like \u0026#39;a%\u0026#39; or name like \u0026#39;b%\u0026#39;; /* LIKEå­å¥ åœ¨ where like çš„æ¡ä»¶æŸ¥è¯¢ä¸­ï¼ŒSQL æä¾›äº†å››ç§åŒ¹é…æ–¹å¼ã€‚ %ï¼šè¡¨ç¤ºä»»æ„ 0 ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚å¯åŒ¹é…ä»»æ„ç±»å‹å’Œé•¿åº¦çš„å­—ç¬¦ï¼Œæœ‰äº›æƒ…å†µä¸‹è‹¥æ˜¯ä¸­æ–‡ï¼Œè¯·ä½¿ç”¨ä¸¤ä¸ªç™¾åˆ†å·ï¼ˆ%%ï¼‰è¡¨ç¤ºã€‚ _ï¼šè¡¨ç¤ºä»»æ„å•ä¸ªå­—ç¬¦ã€‚åŒ¹é…å•ä¸ªä»»æ„å­—ç¬¦ï¼Œå®ƒå¸¸ç”¨æ¥é™åˆ¶è¡¨è¾¾å¼çš„å­—ç¬¦é•¿åº¦è¯­å¥ã€‚ []ï¼šè¡¨ç¤ºæ‹¬å·å†…æ‰€åˆ—å­—ç¬¦ä¸­çš„ä¸€ä¸ªï¼ˆç±»ä¼¼æ­£åˆ™è¡¨è¾¾å¼ï¼‰ã€‚æŒ‡å®šä¸€ä¸ªå­—ç¬¦ã€å­—ç¬¦ä¸²æˆ–èŒƒå›´ï¼Œè¦æ±‚æ‰€åŒ¹é…å¯¹è±¡ä¸ºå®ƒä»¬ä¸­çš„ä»»ä¸€ä¸ªã€‚ [^] ï¼šè¡¨ç¤ºä¸åœ¨æ‹¬å·æ‰€åˆ—ä¹‹å†…çš„å•ä¸ªå­—ç¬¦ã€‚å…¶å–å€¼å’Œ [] ç›¸åŒï¼Œä½†å®ƒè¦æ±‚æ‰€åŒ¹é…å¯¹è±¡ä¸ºæŒ‡å®šå­—ç¬¦ä»¥å¤–çš„ä»»ä¸€ä¸ªå­—ç¬¦ã€‚ æŸ¥è¯¢å†…å®¹åŒ…å«é€šé…ç¬¦æ—¶,ç”±äºé€šé…ç¬¦çš„ç¼˜æ•…ï¼Œå¯¼è‡´æˆ‘ä»¬æŸ¥è¯¢ç‰¹æ®Šå­—ç¬¦ â€œ%â€ã€â€œ_â€ã€â€œ[â€ çš„è¯­å¥æ— æ³•æ­£å¸¸å®ç°ï¼Œè€ŒæŠŠç‰¹æ®Šå­—ç¬¦ç”¨ â€œ[ ]â€ æ‹¬èµ·ä¾¿å¯æ­£å¸¸æŸ¥è¯¢ã€‚ \u0026#39;%a\u0026#39; //ä»¥aç»“å°¾çš„æ•°æ® \u0026#39;a%\u0026#39; //ä»¥aå¼€å¤´çš„æ•°æ® \u0026#39;%a%\u0026#39; //å«æœ‰açš„æ•°æ® \u0026#39;_a_\u0026#39; //ä¸‰ä½ä¸”ä¸­é—´å­—æ¯æ˜¯açš„ \u0026#39;_a\u0026#39; //ä¸¤ä½ä¸”ç»“å°¾å­—æ¯æ˜¯açš„ \u0026#39;a_\u0026#39; //ä¸¤ä½ä¸”å¼€å¤´å­—æ¯æ˜¯açš„ */ /* REGEXP ï¼šæ­£åˆ™è¡¨è¾¾å¼ \u0026#39;a$\u0026#39; //ä»¥aç»“å°¾çš„æ•°æ® \u0026#39;^a\u0026#39; //ä»¥aå¼€å¤´çš„æ•°æ® \u0026#39;a\u0026#39; //å«æœ‰açš„æ•°æ® \u0026#39;^[a-z]|end$\u0026#39; //ä»¥å­—æ¯å¼€å¤´æˆ–è€…ä»¥endç»“å°¾ */ è¿è¡¨ è¿è¡¨æŸ¥è¯¢ç»ƒä¹  å®æˆ˜ï¼š\nå‡†å¤‡å·¥ä½œï¼š\nDROP TABLE IF EXISTS `users`; CREATE TABLE IF NOT EXISTS `users` ( `id` INT NOT NULL AUTO_INCREMENT COMMENT \u0026#39;id\u0026#39;, `uuid` VARCHAR(255) NOT NULL COMMENT \u0026#39;uuid\u0026#39;, `username` VARCHAR(150) NOT NULL COMMENT \u0026#39;username\u0026#39;, `nickname` VARCHAR(150) DEFAULT NULL COMMENT \u0026#39;nickname\u0026#39;, `email` VARCHAR(255) DEFAULT NULL COMMENT \u0026#39;EMAIL\u0026#39;, `password` VARCHAR(150) NOT NULL COMMENT \u0026#39;password\u0026#39;, `avatar` VARCHAR(250) DEFAULT NULL COMMENT \u0026#39;avatar\u0026#39;, `create_time` TIMESTAMP(3) DEFAULT CURRENT_TIMESTAMP(3) COMMENT \u0026#39;CREATE TIME\u0026#39;, `update_time` TIMESTAMP(3) DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP(3) COMMENT \u0026#39;UPDATE TIME\u0026#39;, `delete_time` DATETIME(3) DEFAULT NULL COMMENT \u0026#39;DELETE TIME\u0026#39;, PRIMARY KEY (`id`), UNIQUE KEY `username` (`username`), UNIQUE KEY `idx_uuid` (`uuid`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci COMMENT \u0026#39;ç”¨æˆ·è¡¨\u0026#39;; DROP TABLE IF EXISTS `user_friends`; CREATE TABLE IF NOT EXISTS `user_friends` ( `id` INT NOT NULL AUTO_INCREMENT COMMENT \u0026#39;id\u0026#39;, `user_id` INT DEFAULT NULL COMMENT \u0026#39;USER ID\u0026#39;, `friend_id` INT DEFAULT NULL COMMENT \u0026#39;FRIEND ID\u0026#39;, `create_time` TIMESTAMP(3) DEFAULT CURRENT_TIMESTAMP(3) COMMENT \u0026#39;CREATE TIME\u0026#39;, `update_time` TIMESTAMP(3) DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP(3) COMMENT \u0026#39;UPDATE TIME\u0026#39;, `delete_time` DATETIME(3) DEFAULT NULL COMMENT \u0026#39;DELETE TIME\u0026#39;, PRIMARY KEY (`id`), KEY `idx_user_friends_user_id` (`user_id`), KEY `idx_user_friends_friends_id` (`friend_id`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci COMMENT \u0026#39;ç”¨æˆ·å¥½å‹å…³ç³»è¡¨\u0026#39;; DROP TABLE IF EXISTS `message`; CREATE TABLE IF NOT EXISTS `message` ( `id` INT NOT NULL AUTO_INCREMENT COMMENT \u0026#39;id\u0026#39;, `from_user_id` INT DEFAULT NULL COMMENT \u0026#39;å‘é€æ–¹id\u0026#39;, `to_user_id` INT DEFAULT NULL COMMENT \u0026#39;ç›®æ ‡ç”¨æˆ·id\u0026#39;, `content` VARCHAR(2500) DEFAULT NULL COMMENT \u0026#39;æ¶ˆæ¯å†…å®¹\u0026#39;, `url` VARCHAR(350) DEFAULT NULL COMMENT \u0026#39;å†…å®¹åœ°å€\u0026#39;, `pic` TEXT COMMENT \u0026#39;ç¼©ç•¥å›¾\u0026#39;, `message_type` SMALLINT DEFAULT NULL COMMENT \u0026#39;æ¶ˆæ¯ç±»å‹ï¼š1.å•èŠï¼Œ2.ç¾¤èŠ\u0026#39;, `content_type` SMALLINT DEFAULT NULL COMMENT \u0026#39;æ¶ˆæ¯å†…å®¹ç±»å‹ï¼š1.text 2.file 3.image 4.audio 5.video\u0026#39;, `delete_time` DATETIME(3) DEFAULT NULL COMMENT \u0026#39;DELETE TIME\u0026#39;, `create_time` TIMESTAMP(3) DEFAULT CURRENT_TIMESTAMP(3) COMMENT \u0026#39;create time\u0026#39;, `update_time` TIMESTAMP(3) DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP(3) COMMENT \u0026#39;UPDATE TIME\u0026#39;, PRIMARY KEY (`id`), KEY `idx_message_to_user_id` (`to_user_id`), KEY `idx_message_from_user_id` (`from_user_id`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci COMMENT \u0026#39;æ¶ˆæ¯è¡¨\u0026#39;; DROP TABLE IF EXISTS `group`; CREATE TABLE IF NOT EXISTS `group` ( `id` INT NOT NULL AUTO_INCREMENT COMMENT \u0026#39;id\u0026#39;, `admin_id` INT DEFAULT NULL COMMENT \u0026#39;ADMIN ID\u0026#39;, `name` VARCHAR(150) DEFAULT NULL COMMENT \u0026#39;group name\u0026#39;, `notice` VARCHAR(300) DEFAULT NULL COMMENT \u0026#39;group notice\u0026#39;, `uuid` VARCHAR(150) DEFAULT NULL COMMENT \u0026#39;uuid\u0026#39;, `create_time` TIMESTAMP(3) DEFAULT CURRENT_TIMESTAMP(3) COMMENT \u0026#39;CREATE TIME\u0026#39;, `update_time` TIMESTAMP(3) DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP(3) COMMENT \u0026#39;UPDATE TIME\u0026#39;, `delete_time` DATETIME(3) DEFAULT NULL COMMENT \u0026#39;delete time\u0026#39;, PRIMARY KEY (`id`), KEY `idx_groups_admin_id` (`admin_id`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci COMMENT \u0026#39;ç¾¤ç»„è¡¨\u0026#39;; CREATE TABLE IF NOT EXISTS `group_member` ( `id` INT NOT NULL AUTO_INCREMENT COMMENT \u0026#39;ID\u0026#39;, `user_id` INT DEFAULT NULL COMMENT \u0026#39;USER ID\u0026#39;, `group_id` INT DEFAULT NULL COMMENT \u0026#39;GROUP ID\u0026#39;, `nickname` VARCHAR(150) DEFAULT NULL COMMENT \u0026#39;USER NICKNAME\u0026#39;, `create_time` TIMESTAMP(3) DEFAULT CURRENT_TIMESTAMP(3) COMMENT \u0026#39;CREATE TIME\u0026#39;, `update_time` TIMESTAMP(3) DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP(3) COMMENT \u0026#39;UPDATE TIME\u0026#39;, `delete_time` BIGINT UNSIGNED DEFAULT NULL COMMENT \u0026#39;DELETE TIME\u0026#39;, `mute` SMALLINT DEFAULT NULL COMMENT \u0026#39;æ˜¯å¦æ˜¯ç¦è¨€\u0026#39;, PRIMARY KEY (`id`), KEY `idx_group_member_user_id` (`user_id`), KEY `idx_group_member_group_id` (`group_id`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci COMMENT \u0026#39;ç”¨æˆ·ç¾¤ç»„è¡¨\u0026#39;; ç”¨æˆ·è¡¨ ç”¨æˆ·å¥½å‹å…³ç³»è¡¨ ç¾¤ç»„è¡¨ ç¾¤ç»„æˆå‘˜è¡¨\nsqlä¼˜åŒ–æ–¹æ¡ˆ 1ï¼‰åº”å°½é‡é¿å…åœ¨ where å­å¥ä¸­ä½¿ç”¨ != æˆ– \u0026lt;\u0026gt; æ“ä½œç¬¦ï¼Œå¦åˆ™å°†å¼•æ“æ”¾å¼ƒä½¿ç”¨ç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æã€‚ 2ï¼‰åº”å°½é‡é¿å…åœ¨ where å­å¥ä¸­å¯¹å­—æ®µè¿›è¡Œ null å€¼åˆ¤æ–­ï¼Œå¦åˆ™å°†å¯¼è‡´å¼•æ“æ”¾å¼ƒä½¿ç”¨ç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æï¼Œå¦‚ï¼šselect id from t where num is null å¯ä»¥åœ¨ num ä¸Šè®¾ç½®é»˜è®¤å€¼ 0ï¼Œç¡®ä¿è¡¨ä¸­ num åˆ—æ²¡æœ‰ null å€¼ï¼Œç„¶åè¿™æ ·æŸ¥è¯¢ï¼š select id from t where num=0 3ï¼‰å¾ˆå¤šæ—¶å€™ç”¨ exists ä»£æ›¿ in æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹© 4ï¼‰ç”¨Whereå­å¥æ›¿æ¢HAVING å­å¥ å› ä¸ºHAVING åªä¼šåœ¨æ£€ç´¢å‡ºæ‰€æœ‰è®°å½•ä¹‹åæ‰å¯¹ç»“æœé›†è¿›è¡Œè¿‡æ»¤\nmysqlåŸç† databaseé›†ç¾¤ ","permalink":"https://XianCH.github.io/posts/tech/database/mysql%E9%87%8D%E5%AE%A1/","summary":"\u003ch2 id=\"ç®€è¿°\"\u003eç®€è¿°\u003c/h2\u003e\n\u003cp\u003eä»¥å‰åœ¨å­¦ä¹ mysqlçš„è¿‡ç¨‹ä¸­ ï¼Œéœ€è¦å¤ä¹ è¿˜æœ‰éœ€è¦æ‹“å±•çš„çŸ¥è¯†ç‚¹\u003c/p\u003e\n\u003ch2 id=\"mysqlç›¸å…³å‘½ä»¤\"\u003emysqlç›¸å…³å‘½ä»¤\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eæŸ¥çœ‹æ•°æ®åº“å¼•æ“\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eshow\u003c/span\u003e engine;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eæŸ¥çœ‹è¡¨ç»“æ„\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eDESC\u003c/span\u003e tablename;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eæŸ¥çœ‹åˆ›å»ºè¡¨çš„\u003c/span\u003esqlè¯­å¥\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eshow\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE_NAME\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eåˆ›å»ºè¡¨\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eDrop\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etable\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eexists\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eschool\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eschool\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003edefault\u003c/span\u003e character \u003cspan style=\"color:#66d9ef\"\u003eset\u003c/span\u003e utf8;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003euse school;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eè‡ªå¢\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eauto_increment;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eä¸»é”®\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eprimary\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ekey\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ecolumn\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eè®¾ç½®å¼•æ“å’Œç¼–ç \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eengine \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e innoDB \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e CHARSET\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e UT8;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eè®¾ç½®å¤–é”®å°†äº§å“çš„\u003c/span\u003ecidç»‘å®šåˆ°categoryçš„ä¸»é”®ä¸Š\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003econstraint\u003c/span\u003e fk_product_category \u003cspan style=\"color:#66d9ef\"\u003eforeign\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ekey\u003c/span\u003e(cid) \u003cspan style=\"color:#66d9ef\"\u003ereferences\u003c/span\u003e category(id);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003enè¡¨ç¤ºä¸€ä¸ªå­—ç¬¦\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼Œä¸ç®¡ä¸­è‹±æ–‡ï¼ˆæœ‰å¾…ç¡®å®šï¼‰\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evarchar(n)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eåˆ›å»ºè¡¨å¹¶è®¾ç½®\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ecolumn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edrop\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003etable\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eexists\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003estudents\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003estudent\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eid\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e int \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e AUTO_INCREMENT,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eNAME\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e ,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eSEX\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e SMALLINT \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;æ€§åˆ«\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eage\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e int \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e ,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eIN_TIME\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e DATETIME \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e ,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ePRIMARY\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eKEY\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eid\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\u003cspan style=\"color:#66d9ef\"\u003edefault\u003c/span\u003e charset \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eUTF8\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eä¿®æ”¹è¡¨\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUSE school;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eALTER\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003estudents\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eRENAME\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTO\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003estudent\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e; \u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eæ”¹æŠ¥å\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eALTER\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003estudents\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eadd\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ecolumn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eage\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e int \u003cspan style=\"color:#66d9ef\"\u003enot\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enull\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eafter\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003esex\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eALTER\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003estudents\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eDROP\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ecolumn\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003enickname\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e;\u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eåˆ é™¤è¡¨ä¸­çš„æŸä¸€åˆ—\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eALTER\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003estudents\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e CHANGE \u003cspan style=\"color:#66d9ef\"\u003ecolumn_name\u003c/span\u003e new_name varchar(\u003cspan style=\"color:#ae81ff\"\u003e36\u003c/span\u003e);\u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eä¿®æ”¹æŸä¸€åˆ—çš„çš„åç§°\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eALTER\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e police_org \u003cspan style=\"color:#66d9ef\"\u003eDrop\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eprimary\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ekey\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e#\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eä¿®æ”¹è¡¨çš„ä¸»é”®\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eæ—¥æœŸï¼š\u003c/span\u003eDATE\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼ˆ\u003c/span\u003eYYYY\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eMM\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eDD\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼‰\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eæ¯”è¾ƒå¸¸ç”¨\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eä½¿ç”¨\u003c/span\u003e CURDATE\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼ˆï¼‰\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eæ—¶é—´ï¼š\u003c/span\u003eTIME\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼ˆ\u003c/span\u003eHH:MM:SS\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼‰\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eæ¯”è¾ƒå¸¸ç”¨\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eä½¿ç”¨\u003c/span\u003eCURTIME\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼ˆï¼‰\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eå¹´ä»½ï¼š\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eYEAR\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼ˆ\u003c/span\u003eYYYY\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼‰\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eæœ€å…¨æ—¶é—´ï¼š\u003c/span\u003eDATETIME\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼ˆ\u003c/span\u003eYYYY\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eMM\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003eDD HH:MM:SS\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼‰\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e//\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eä½¿ç”¨\u003c/span\u003e  NOW\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼ˆï¼‰\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e/*varchar(36) å¯ä»¥ä¿å­˜å¤šå°‘ä¸­è‹±æ–‡å­—ç¬¦ï¼Ÿ*/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eç­”ï¼šå…·ä½“è¿˜æ˜¯è¦çœ‹ç‰ˆæœ¬çš„ï¼Œè‡ªå·±åœ¨æ•°æ®åº“ä¸­å»ºä¸ªè¡¨æµ‹è¯•ä¸‹å¯ä»¥æ”¾å¤šå°‘ä¸ªæ±‰å­—ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e.\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eç‰ˆæœ¬ä»¥ä¸‹ï¼Œ\u003c/span\u003evarchar(\u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e)\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼ŒæŒ‡çš„æ˜¯\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eå­—èŠ‚ï¼Œå¦‚æœå­˜æ”¾\u003c/span\u003eUTF8æ±‰å­—æ—¶\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼Œåªèƒ½å­˜\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e33\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eä¸ªï¼ˆæ¯ä¸ªæ±‰å­—\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eå­—èŠ‚ï¼‰\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e.\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eç‰ˆæœ¬ä»¥ä¸Šï¼Œ\u003c/span\u003evarchar(\u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e)\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼ŒæŒ‡çš„æ˜¯\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e \u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eå­—ç¬¦ï¼Œæ— è®ºå­˜æ”¾çš„æ˜¯æ•°å­—ã€å­—æ¯è¿˜æ˜¯\u003c/span\u003eUTF8æ±‰å­—\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eï¼ˆæ¯ä¸ªæ±‰å­—\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eå­—èŠ‚ï¼‰ï¼Œéƒ½å¯ä»¥å­˜æ”¾\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003eä¸ªã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"mysql-ç»ƒä¹ é¢˜\"\u003emysql ç»ƒä¹ é¢˜\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eé—®ï¼šæŸ¥æ‰¾å¹´é¾„æœ€å¤§çš„å­¦ç”Ÿçš„æ‰€æœ‰ä¿¡æ¯ï¼Ÿ\u003c/strong\u003e\u003c/p\u003e","title":"Mysqlé‡å®¡"},{"content":"dockeréƒ¨ç½² æ‹‰å–é•œåƒ\ndocker pull nginx:latest è¿è¡Œé•œåƒ\ndocker run --name nginx -p 80:80 -d nginx åˆ›å»ºæŒ‚è½½ç›®å½•\nmkdir -p ~/Documents/dockerdata/nginx/conf / mkdir -p ~/Documents/dockerdata/nginx/conf.d / mkdir -p ~/Documents/dockerdata/nginx/html / mkdir -p ~/Documents/dockerdata/nginx/log / æ‹·è´å®¹å™¨é‡Œé¢çš„å†…å®¹\ndocker cp nginx:/etc/nginx/nginx.conf ~/Documents/dockerdata/nginx/conf/nginx.conf / docker cp nginx:/etc/nginx/conf.d ~/Documents/dockerdata/nginx / docker cp nginx:/usr/share/nginx/html ~/Documents/dockerdata/nginx / åœæ­¢å¹¶å…³é—­å®¹å™¨\ndocker rm -f nginx é‡æ–°å¯åŠ¨å®¹å™¨\ndocker run --name nginx -p 80:80 --privileged --restart=always \\ -v ~/Documents/dockerdata/nginx/conf/nginx.conf:/etc/nginx/nginx.conf:rw \\ -v ~/Documents/dockerdata/nginx/conf.d:/etc/nginx/conf.d:rw \\ -v ~/Documents/dockerdata/nginx/html:/usr/share/nginx/html:rw \\ -v ~/Documents/dockerdata/nginx/log:/var/log/nginx \\ -d nginx Nginx å…¥é—¨ å¸¸ç”¨å‘½ä»¤\nnginx -s stop å¿«é€Ÿå…³é—­Nginxï¼Œå¯èƒ½ä¸ä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œå¹¶è¿…é€Ÿç»ˆæ­¢webæœåŠ¡ã€‚ nginx -s quit å¹³ç¨³å…³é—­Nginxï¼Œä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œæœ‰å®‰æ’çš„ç»“æŸwebæœåŠ¡ã€‚ nginx -s reload å› æ”¹å˜äº†Nginxç›¸å…³é…ç½®ï¼Œéœ€è¦é‡æ–°åŠ è½½é…ç½®è€Œé‡è½½ã€‚ nginx -s reopen é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶ã€‚ nginx -c filename ä¸º Nginx æŒ‡å®šä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ¥ä»£æ›¿ç¼ºçœçš„ã€‚ nginx -t ä¸è¿è¡Œï¼Œä»…ä»…æµ‹è¯•é…ç½®æ–‡ä»¶ã€‚nginx å°†æ£€æŸ¥é…ç½®æ–‡ä»¶çš„è¯­æ³•çš„æ­£ç¡®æ€§ï¼Œå¹¶å°è¯•æ‰“å¼€é…ç½®æ–‡ä»¶ä¸­æ‰€å¼•ç”¨åˆ°çš„æ–‡ä»¶ã€‚ nginx -v æ˜¾ç¤º nginx çš„ç‰ˆæœ¬ã€‚ nginx -V æ˜¾ç¤º nginx çš„ç‰ˆæœ¬ï¼Œç¼–è¯‘å™¨ç‰ˆæœ¬å’Œé…ç½®å‚æ•°ã€‚ å®æˆ˜ httpåå‘ä»£ç† ä»‹ç»ï¼š\nåå‘ä»£ç†ï¼ˆReverse Proxyï¼‰æ–¹å¼æ˜¯æŒ‡ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥å— internet ä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†ä»æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™ internet ä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–å°±è¡¨ç°ä¸ºä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ã€‚\nä¸è€ƒè™‘å¤æ‚çš„é…ç½®ï¼Œä»…ä»…æ˜¯å®Œæˆä¸€ä¸ª http åå‘ä»£ç†ã€‚\n#è¿è¡Œç”¨æˆ· #user somebody; #å¯åŠ¨è¿›ç¨‹,é€šå¸¸è®¾ç½®æˆå’Œcpuçš„æ•°é‡ç›¸ç­‰ worker_processes 1; #å…¨å±€é”™è¯¯æ—¥å¿— error_log /var/log/nginx/error.log; error_log /var/log/nginx/notice.log notice; error_log /var/log/nginx/info.log info; #PIDæ–‡ä»¶ï¼Œè®°å½•å½“å‰å¯åŠ¨çš„nginxçš„è¿›ç¨‹ID #pid D:/Tools/nginx-1.10.1/logs/nginx.pid; #å·¥ä½œæ¨¡å¼åŠè¿æ¥æ•°ä¸Šé™ events { worker_connections 1024; #å•ä¸ªåå°worker processè¿›ç¨‹çš„æœ€å¤§å¹¶å‘é“¾æ¥æ•° } #è®¾å®šhttpæœåŠ¡å™¨ï¼Œåˆ©ç”¨å®ƒçš„åå‘ä»£ç†åŠŸèƒ½æä¾›è´Ÿè½½å‡è¡¡æ”¯æŒ http { #è®¾å®šmimeç±»å‹(é‚®ä»¶æ”¯æŒç±»å‹),ç±»å‹ç”±mime.typesæ–‡ä»¶å®šä¹‰ include include /etc/nginx/mime.types; default_type application/octet-stream; #è®¾å®šæ—¥å¿— log_format main \u0026#39;[$remote_addr] - [$remote_user] [$time_local] \u0026#34;$request\u0026#34; \u0026#39; \u0026#39;$status $body_bytes_sent \u0026#34;$http_referer\u0026#34; \u0026#39; \u0026#39;\u0026#34;$http_user_agent\u0026#34; \u0026#34;$http_x_forwarded_for\u0026#34;\u0026#39;; access_log /var/log/nginx/access.log main; rewrite_log on; #sendfile æŒ‡ä»¤æŒ‡å®š nginx æ˜¯å¦è°ƒç”¨ sendfile å‡½æ•°ï¼ˆzero copy æ–¹å¼ï¼‰æ¥è¾“å‡ºæ–‡ä»¶ï¼Œå¯¹äºæ™®é€šåº”ç”¨ï¼Œ #å¿…é¡»è®¾ä¸º on,å¦‚æœç”¨æ¥è¿›è¡Œä¸‹è½½ç­‰åº”ç”¨ç£ç›˜IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸º offï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œI/Oå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿçš„uptime. sendfile on; #tcp_nopush on; #è¿æ¥è¶…æ—¶æ—¶é—´ keepalive_timeout 120; tcp_nodelay on; #gzipå‹ç¼©å¼€å…³ #gzip on; #è®¾å®šå®é™…çš„æœåŠ¡å™¨åˆ—è¡¨ upstream zp_server1{ server 127.0.0.1:8089; } #HTTPæœåŠ¡å™¨ include /etc/nginx/config.d/default.conf } server { #ç›‘å¬80ç«¯å£ï¼Œ80ç«¯å£æ˜¯çŸ¥åç«¯å£å·ï¼Œç”¨äºHTTPåè®® listen 80; #å®šä¹‰ä½¿ç”¨www.xx.comè®¿é—® server_name www.helloworld.com; #é¦–é¡µ index index.html #æŒ‡å‘webappçš„ç›®å½• root D:\\01_Workspace\\Project\\github\\zp\\SpringNotes\\spring-security\\spring-shiro\\src\\main\\webapp; #ç¼–ç æ ¼å¼ charset utf-8; #ä»£ç†é…ç½®å‚æ•° proxy_connect_timeout 180; proxy_send_timeout 180; proxy_read_timeout 180; proxy_set_header Host $host; proxy_set_header X-Forwarder-For $remote_addr; #åå‘ä»£ç†çš„è·¯å¾„ï¼ˆå’Œupstreamç»‘å®šï¼‰ï¼Œlocation åé¢è®¾ç½®æ˜ å°„çš„è·¯å¾„ location / { proxy_pass http://zp_server1; } #é™æ€æ–‡ä»¶ï¼Œnginxè‡ªå·±å¤„ç† location ~ ^/(images|javascript|js|css|flash|media|static)/ { root D:\\01_Workspace\\Project\\github\\zp\\SpringNotes\\spring-security\\spring-shiro\\src\\main\\webapp\\views; #è¿‡æœŸ30å¤©ï¼Œé™æ€æ–‡ä»¶ä¸æ€ä¹ˆæ›´æ–°ï¼Œè¿‡æœŸå¯ä»¥è®¾å¤§ä¸€ç‚¹ï¼Œå¦‚æœé¢‘ç¹æ›´æ–°ï¼Œåˆ™å¯ä»¥è®¾ç½®å¾—å°ä¸€ç‚¹ã€‚ expires 30d; } #è®¾å®šæŸ¥çœ‹NginxçŠ¶æ€çš„åœ°å€ location /NginxStatus { stub_status on; access_log on; auth_basic \u0026#34;NginxStatus\u0026#34;; auth_basic_user_file conf/htpasswd; } #ç¦æ­¢è®¿é—® .htxxx æ–‡ä»¶ location ~ /\\.ht { deny all; } #é”™è¯¯å¤„ç†é¡µé¢ï¼ˆå¯é€‰æ‹©æ€§é…ç½®ï¼‰ #error_page 404 /404.html; #error_page 500 502 503 504 /50x.html; #location = /50x.html { # root html; #} } Https åå‘ä»£ç† ä¸€äº›å¯¹å®‰å…¨æ€§è¦æ±‚æ¯”è¾ƒé«˜çš„ç«™ç‚¹ï¼Œå¯èƒ½ä¼šä½¿ç”¨ HTTPSï¼ˆä¸€ç§ä½¿ç”¨ ssl é€šä¿¡æ ‡å‡†çš„å®‰å…¨ HTTP åè®®ï¼‰ã€‚\nè¿™é‡Œä¸ç§‘æ™® HTTP åè®®å’Œ SSL æ ‡å‡†ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨ nginx é…ç½® https éœ€è¦çŸ¥é“å‡ ç‚¹ï¼š\nHTTPS çš„å›ºå®šç«¯å£å·æ˜¯ 443ï¼Œä¸åŒäº HTTP çš„ 80 ç«¯å£ SSL æ ‡å‡†éœ€è¦å¼•å…¥å®‰å…¨è¯ä¹¦ï¼Œæ‰€ä»¥åœ¨ nginx.conf ä¸­ä½ éœ€è¦æŒ‡å®šè¯ä¹¦å’Œå®ƒå¯¹åº”çš„ key å…¶ä»–å’Œ http åå‘ä»£ç†åŸºæœ¬ä¸€æ ·ï¼Œåªæ˜¯åœ¨ Server éƒ¨åˆ†é…ç½®æœ‰äº›ä¸åŒã€‚\n#HTTPæœåŠ¡å™¨ server { #ç›‘å¬443ç«¯å£ã€‚443ä¸ºçŸ¥åç«¯å£å·ï¼Œä¸»è¦ç”¨äºHTTPSåè®® listen 443 ssl; #å®šä¹‰ä½¿ç”¨www.xx.comè®¿é—® server_name www.helloworld.com; #sslè¯ä¹¦æ–‡ä»¶ä½ç½®(å¸¸è§è¯ä¹¦æ–‡ä»¶æ ¼å¼ä¸ºï¼šcrt/pem) ssl_certificate cert.pem; #sslè¯ä¹¦keyä½ç½® ssl_certificate_key cert.key; #sslé…ç½®å‚æ•°ï¼ˆé€‰æ‹©æ€§é…ç½®ï¼‰ ssl_session_cache shared:SSL:1m; ssl_session_timeout 5m; #æ•°å­—ç­¾åï¼Œæ­¤å¤„ä½¿ç”¨MD5 ssl_ciphers HIGH:!aNULL:!MD5; ssl_prefer_server_ciphers on; location / { root /root; index index.html index.htm; } } è´Ÿè½½å‡è¡¡ ç»™é›†ç¾¤æœåŠ¡å™¨è¿›è¡Œåˆ†æµ\nhttp { #è®¾å®šmimeç±»å‹,ç±»å‹ç”±mime.typeæ–‡ä»¶å®šä¹‰ include /etc/nginx/mime.types; default_type application/octet-stream; #è®¾å®šæ—¥å¿—æ ¼å¼ access_log /var/log/nginx/access.log; #è®¾å®šè´Ÿè½½å‡è¡¡çš„æœåŠ¡å™¨åˆ—è¡¨ upstream load_balance_server { #weigthå‚æ•°è¡¨ç¤ºæƒå€¼ï¼Œæƒå€¼è¶Šé«˜è¢«åˆ†é…åˆ°çš„å‡ ç‡è¶Šå¤§ server 192.168.1.11:80 weight=5; server 192.168.1.12:80 weight=1; server 192.168.1.13:80 weight=6; } #HTTPæœåŠ¡å™¨ server { #ä¾¦å¬80ç«¯å£ listen 80; #å®šä¹‰ä½¿ç”¨www.xx.comè®¿é—® server_name www.helloworld.com; #å¯¹æ‰€æœ‰è¯·æ±‚è¿›è¡Œè´Ÿè½½å‡è¡¡è¯·æ±‚ location / { root /root; #å®šä¹‰æœåŠ¡å™¨çš„é»˜è®¤ç½‘ç«™æ ¹ç›®å½•ä½ç½® index index.html index.htm; #å®šä¹‰é¦–é¡µç´¢å¼•æ–‡ä»¶çš„åç§° proxy_pass http://load_balance_server ;#è¯·æ±‚è½¬å‘load_balance_server å®šä¹‰çš„æœåŠ¡å™¨åˆ—è¡¨ #ä»¥ä¸‹æ˜¯ä¸€äº›åå‘ä»£ç†çš„é…ç½®(å¯é€‰æ‹©æ€§é…ç½®) #proxy_redirect off; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; #åç«¯çš„WebæœåŠ¡å™¨å¯ä»¥é€šè¿‡X-Forwarded-Forè·å–ç”¨æˆ·çœŸå®IP proxy_set_header X-Forwarded-For $remote_addr; proxy_connect_timeout 90; #nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶) proxy_send_timeout 90; #åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´(ä»£ç†å‘é€è¶…æ—¶) proxy_read_timeout 90; #è¿æ¥æˆåŠŸåï¼Œåç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶) proxy_buffer_size 4k; #è®¾ç½®ä»£ç†æœåŠ¡å™¨ï¼ˆnginxï¼‰ä¿å­˜ç”¨æˆ·å¤´ä¿¡æ¯çš„ç¼“å†²åŒºå¤§å° proxy_buffers 4 32k; #proxy_buffersç¼“å†²åŒºï¼Œç½‘é¡µå¹³å‡åœ¨32kä»¥ä¸‹çš„è¯ï¼Œè¿™æ ·è®¾ç½® proxy_busy_buffers_size 64k; #é«˜è´Ÿè·ä¸‹ç¼“å†²å¤§å°ï¼ˆproxy_buffers*2ï¼‰ proxy_temp_file_write_size 64k; #è®¾å®šç¼“å­˜æ–‡ä»¶å¤¹å¤§å°ï¼Œå¤§äºè¿™ä¸ªå€¼ï¼Œå°†ä»upstreamæœåŠ¡å™¨ä¼  client_max_body_size 10m; #å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•° client_body_buffer_size 128k; #ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•° } } } è´Ÿè½½å‡è¡¡ç­–ç•¥ è½®è¯¢\nupstream bck_testing_01 { # é»˜è®¤æ‰€æœ‰æœåŠ¡å™¨æƒé‡ä¸º 1 server 192.168.250.220:8080 server 192.168.250.221:8080 server 192.168.250.222:8080 } åŠ æƒè½®è¯¢\nupstream bck_testing_01 { server 192.168.250.220:8080 weight=3 server 192.168.250.221:8080 # default weight=1 server 192.168.250.222:8080 # default weight=1 } æœ€å°‘è¿æ¥ upstream bck_testing_01 { least_conn; # with default weight for all (weight=1) server 192.168.250.220:8080 server 192.168.250.221:8080 server 192.168.250.222:8080 } åŠ æƒæœ€å°‘è¿æ¥ upstream bck_testing_01 { least_conn; server 192.168.250.220:8080 weight=3 server 192.168.250.221:8080 # default weight=1 server 192.168.250.222:8080 # default weight=1 } ip hash\nupstream bck_testing_01 { ip_hash; # with default weight for all (weight=1) server 192.168.250.220:8080 server 192.168.250.221:8080 server 192.168.250.222:8080 } æ™®é€šhash\nupstream bck_testing_01 { hash $request_uri; # with default weight for all (weight=1) server 192.168.250.220:8080 server 192.168.250.221:8080 server 192.168.250.222:8080 } ç«™ç‚¹æœ‰å¤šä¸ªwebapp æ¯”å¦‚è¯´www.x14n.comè¿™é‡Œæœ‰æœ‰ä¸‰ä¸ªæœåŠ¡:\nwww.x14n.com/admin (åå°ç®¡ç†)\nwww.x14n.com/shop (ä¸»ç«™)\nwww.x14n.com/xxxxx\nè¿™é‡Œç”¨åå‘ä»£ç†æ¥è§£å†³\nhttp { #æ­¤å¤„çœç•¥ä¸€äº›åŸºæœ¬é…ç½® upstream shop_server{ server www.x14n.com:8081; } upstream admin_server{ server www.helloworld.com:8082; } upstream xxx_server{ server www.x14n.com:8083; } server { #æ­¤å¤„çœç•¥ä¸€äº›åŸºæœ¬é…ç½® #é»˜è®¤æŒ‡å‘productçš„server location / { proxy_pass http://shop_server; } location /shop/{ proxy_pass http://shop_server; } location /admin/ { proxy_pass http://admin_server; } location /xxx/ { proxy_pass http://xxx_server; } } } é™æ€ç«™ç‚¹ æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®é™æ€ç«™ç‚¹(å³ html æ–‡ä»¶å’Œä¸€å †é™æ€èµ„æº)ã€‚\nä¸¾ä¾‹æ¥è¯´ï¼šå¦‚æœæ‰€æœ‰çš„é™æ€èµ„æºéƒ½æ”¾åœ¨äº† /app/dist ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ nginx.conf ä¸­æŒ‡å®šé¦–é¡µä»¥åŠè¿™ä¸ªç«™ç‚¹çš„ host å³å¯ã€‚\né…ç½®å¦‚ä¸‹ï¼š\nworker_processes 1; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; sendfile on; keepalive_timeout 65; gzip on; gzip_types text/plain application/x-javascript text/css application/xml text/javascript application/javascript image/jpeg image/gif image/png; gzip_vary on; server { listen 80; server_name static.zp.cn; location / { root /app/dist; index index.html; #è½¬å‘ä»»ä½•è¯·æ±‚åˆ° index.html } } } ç„¶åï¼Œæ·»åŠ  HOSTï¼š\n127.0.0.1 static.zp.cn\næ­¤æ—¶ï¼Œåœ¨æœ¬åœ°æµè§ˆå™¨è®¿é—® static.zp.cn ï¼Œå°±å¯ä»¥è®¿é—®é™æ€ç«™ç‚¹äº†ã€‚\næ­å»ºæ–‡ä»¶æœåŠ¡å™¨ æœ‰æ—¶å€™ï¼Œå›¢é˜Ÿéœ€è¦å½’æ¡£ä¸€äº›æ•°æ®æˆ–èµ„æ–™ï¼Œé‚£ä¹ˆæ–‡ä»¶æœåŠ¡å™¨å¿…ä¸å¯å°‘ã€‚ä½¿ç”¨ Nginx å¯ä»¥éå¸¸å¿«é€Ÿä¾¿æ·çš„æ­å»ºä¸€ä¸ªç®€æ˜“çš„æ–‡ä»¶æœåŠ¡ã€‚\nNginx ä¸­çš„é…ç½®è¦ç‚¹ï¼š\nå°† autoindex å¼€å¯å¯ä»¥æ˜¾ç¤ºç›®å½•ï¼Œé»˜è®¤ä¸å¼€å¯ã€‚ å°† autoindex_exact_size å¼€å¯å¯ä»¥æ˜¾ç¤ºæ–‡ä»¶çš„å¤§å°ã€‚ å°† autoindex_localtime å¼€å¯å¯ä»¥æ˜¾ç¤ºæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ã€‚ root ç”¨æ¥è®¾ç½®å¼€æ”¾ä¸ºæ–‡ä»¶æœåŠ¡çš„æ ¹è·¯å¾„ã€‚ charset è®¾ç½®ä¸º charset utf-8,gbk;ï¼Œå¯ä»¥é¿å…ä¸­æ–‡ä¹±ç é—®é¢˜ï¼ˆwindows æœåŠ¡å™¨ä¸‹è®¾ç½®åï¼Œä¾ç„¶ä¹±ç ï¼Œæœ¬äººæš‚æ—¶æ²¡æœ‰æ‰¾åˆ°è§£å†³æ–¹æ³•ï¼‰ã€‚ ä¸€ä¸ªæœ€ç®€åŒ–çš„é…ç½®å¦‚ä¸‹ï¼š\nautoindex on;# æ˜¾ç¤ºç›®å½• autoindex_exact_size on;# æ˜¾ç¤ºæ–‡ä»¶å¤§å° autoindex_localtime on;# æ˜¾ç¤ºæ–‡ä»¶æ—¶é—´ server { charset utf-8,gbk; # windows æœåŠ¡å™¨ä¸‹è®¾ç½®åï¼Œä¾ç„¶ä¹±ç ï¼Œæš‚æ—¶æ— è§£ listen 9050 default_server; listen [::]:9050 default_server; server_name _; root /share/fs; } è§£å†³è·¨åŸŸé—®é¢˜ web é¢†åŸŸå¼€å‘ä¸­ï¼Œç»å¸¸é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼ä¸‹ï¼Œå‰ç«¯å’Œåç«¯åˆ†åˆ«æ˜¯ç‹¬ç«‹çš„ web åº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚ï¼šåç«¯æ˜¯ Java ç¨‹åºï¼Œå‰ç«¯æ˜¯ React æˆ– Vue åº”ç”¨ã€‚\nå„è‡ªç‹¬ç«‹çš„ web app åœ¨äº’ç›¸è®¿é—®æ—¶ï¼ŒåŠ¿å¿…å­˜åœ¨è·¨åŸŸé—®é¢˜ã€‚è§£å†³è·¨åŸŸé—®é¢˜ä¸€èˆ¬æœ‰ä¸¤ç§æ€è·¯ï¼š\nCORS åœ¨åç«¯æœåŠ¡å™¨è®¾ç½® HTTP å“åº”å¤´ï¼ŒæŠŠä½ éœ€è¦å…è®¸è®¿é—®çš„åŸŸååŠ å…¥ Access-Control-Allow-Origin ä¸­ã€‚\njsonp æŠŠåç«¯æ ¹æ®è¯·æ±‚ï¼Œæ„é€  json æ•°æ®ï¼Œå¹¶è¿”å›ï¼Œå‰ç«¯ç”¨ jsonp è·¨åŸŸã€‚\nè¿™ä¸¤ç§æ€è·¯ï¼Œæœ¬æ–‡ä¸å±•å¼€è®¨è®ºã€‚\néœ€è¦è¯´æ˜çš„æ˜¯ï¼Œnginx æ ¹æ®ç¬¬ä¸€ç§æ€è·¯ï¼Œä¹Ÿæä¾›äº†ä¸€ç§è§£å†³è·¨åŸŸçš„è§£å†³æ–¹æ¡ˆã€‚\nä¸¾ä¾‹ï¼šwww.helloworld.com ç½‘ç«™æ˜¯ç”±ä¸€ä¸ªå‰ç«¯ app ï¼Œä¸€ä¸ªåç«¯ app ç»„æˆçš„ã€‚å‰ç«¯ç«¯å£å·ä¸º 9000ï¼Œ åç«¯ç«¯å£å·ä¸º 8080ã€‚\nå‰ç«¯å’Œåç«¯å¦‚æœä½¿ç”¨ http è¿›è¡Œäº¤äº’æ—¶ï¼Œè¯·æ±‚ä¼šè¢«æ‹’ç»ï¼Œå› ä¸ºå­˜åœ¨è·¨åŸŸé—®é¢˜ã€‚æ¥çœ‹çœ‹ï¼Œnginx æ˜¯æ€ä¹ˆè§£å†³çš„å§ï¼š\né¦–å…ˆï¼Œåœ¨ enable-cors.conf æ–‡ä»¶ä¸­è®¾ç½® cors ï¼š\n# allow origin list set $ACAO \u0026#39;*\u0026#39;; # set single origin if ($http_origin ~* (www.helloworld.com)$) { set $ACAO $http_origin; } if ($cors = \u0026#34;trueget\u0026#34;) { add_header \u0026#39;Access-Control-Allow-Origin\u0026#39; \u0026#34;$http_origin\u0026#34;; add_header \u0026#39;Access-Control-Allow-Credentials\u0026#39; \u0026#39;true\u0026#39;; add_header \u0026#39;Access-Control-Allow-Methods\u0026#39; \u0026#39;GET, POST, OPTIONS\u0026#39;; add_header \u0026#39;Access-Control-Allow-Headers\u0026#39; \u0026#39;DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type\u0026#39;; } if ($request_method = \u0026#39;OPTIONS\u0026#39;) { set $cors \u0026#34;${cors}options\u0026#34;; } if ($request_method = \u0026#39;GET\u0026#39;) { set $cors \u0026#34;${cors}get\u0026#34;; } if ($request_method = \u0026#39;POST\u0026#39;) { set $cors \u0026#34;${cors}post\u0026#34;; } â€‹\næ¥ä¸‹æ¥ï¼Œåœ¨ä½ çš„æœåŠ¡å™¨ä¸­ include enable-cors.conf æ¥å¼•å…¥è·¨åŸŸé…ç½®ï¼š\n# ---------------------------------------------------- # æ­¤æ–‡ä»¶ä¸ºé¡¹ç›® nginx é…ç½®ç‰‡æ®µ # å¯ä»¥ç›´æ¥åœ¨ nginx config ä¸­ includeï¼ˆæ¨èï¼‰ # æˆ–è€… copy åˆ°ç°æœ‰ nginx ä¸­ï¼Œè‡ªè¡Œé…ç½® # www.helloworld.com åŸŸåéœ€é…åˆ dns hosts è¿›è¡Œé…ç½® # å…¶ä¸­ï¼Œapi å¼€å¯äº† corsï¼Œéœ€é…åˆæœ¬ç›®å½•ä¸‹å¦ä¸€ä»½é…ç½®æ–‡ä»¶ # ---------------------------------------------------- upstream front_server{ server www.helloworld.com:9000; } upstream api_server{ server www.helloworld.com:8080; } server { listen 80; server_name www.helloworld.com; location ~ ^/api/ { include enable-cors.conf; proxy_pass http://api_server; rewrite \u0026#34;^/api/(.*)$\u0026#34; /$1 break; } location ~ ^/ { proxy_pass http://front_server; } } â€‹\n","permalink":"https://XianCH.github.io/posts/tech/distributed/nginx%E5%85%A5%E9%97%A8/","summary":"\u003ch2 id=\"dockeréƒ¨ç½²\"\u003edockeréƒ¨ç½²\u003c/h2\u003e\n\u003cp\u003eæ‹‰å–é•œåƒ\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker pull nginx:latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eè¿è¡Œé•œåƒ\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker run --name nginx -p 80:80 -d nginx\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eåˆ›å»ºæŒ‚è½½ç›®å½•\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir -p ~/Documents/dockerdata/nginx/conf /\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir -p ~/Documents/dockerdata/nginx/conf.d /\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir -p ~/Documents/dockerdata/nginx/html /\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir -p ~/Documents/dockerdata/nginx/log /\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæ‹·è´å®¹å™¨é‡Œé¢çš„å†…å®¹\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker cp nginx:/etc/nginx/nginx.conf ~/Documents/dockerdata/nginx/conf/nginx.conf /\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker cp nginx:/etc/nginx/conf.d ~/Documents/dockerdata/nginx /\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker cp nginx:/usr/share/nginx/html ~/Documents/dockerdata/nginx /\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eåœæ­¢å¹¶å…³é—­å®¹å™¨\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker rm -f nginx\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eé‡æ–°å¯åŠ¨å®¹å™¨\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker run --name nginx -p 80:80 --privileged --restart=always \\\n-v ~/Documents/dockerdata/nginx/conf/nginx.conf:/etc/nginx/nginx.conf:rw \\\n-v ~/Documents/dockerdata/nginx/conf.d:/etc/nginx/conf.d:rw \\\n-v ~/Documents/dockerdata/nginx/html:/usr/share/nginx/html:rw \\\n-v ~/Documents/dockerdata/nginx/log:/var/log/nginx \\\n-d nginx\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"nginx-å…¥é—¨\"\u003eNginx å…¥é—¨\u003c/h2\u003e\n\u003cp\u003eå¸¸ç”¨å‘½ä»¤\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003enginx -s stop       å¿«é€Ÿå…³é—­Nginxï¼Œå¯èƒ½ä¸ä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œå¹¶è¿…é€Ÿç»ˆæ­¢webæœåŠ¡ã€‚\nnginx -s quit       å¹³ç¨³å…³é—­Nginxï¼Œä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œæœ‰å®‰æ’çš„ç»“æŸwebæœåŠ¡ã€‚\nnginx -s reload     å› æ”¹å˜äº†Nginxç›¸å…³é…ç½®ï¼Œéœ€è¦é‡æ–°åŠ è½½é…ç½®è€Œé‡è½½ã€‚\nnginx -s reopen     é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶ã€‚\nnginx -c filename   ä¸º Nginx æŒ‡å®šä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ¥ä»£æ›¿ç¼ºçœçš„ã€‚\nnginx -t            ä¸è¿è¡Œï¼Œä»…ä»…æµ‹è¯•é…ç½®æ–‡ä»¶ã€‚nginx å°†æ£€æŸ¥é…ç½®æ–‡ä»¶çš„è¯­æ³•çš„æ­£ç¡®æ€§ï¼Œå¹¶å°è¯•æ‰“å¼€é…ç½®æ–‡ä»¶ä¸­æ‰€å¼•ç”¨åˆ°çš„æ–‡ä»¶ã€‚\nnginx -v            æ˜¾ç¤º nginx çš„ç‰ˆæœ¬ã€‚\nnginx -V            æ˜¾ç¤º nginx çš„ç‰ˆæœ¬ï¼Œç¼–è¯‘å™¨ç‰ˆæœ¬å’Œé…ç½®å‚æ•°ã€‚\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"å®æˆ˜\"\u003eå®æˆ˜\u003c/h2\u003e\n\u003ch3 id=\"httpåå‘ä»£ç†\"\u003e\u003cstrong\u003ehttpåå‘ä»£ç†\u003c/strong\u003e\u003c/h3\u003e\n\u003cp\u003eä»‹ç»ï¼š\u003c/p\u003e","title":"Nginx"},{"content":" æ‚è°ˆ â€‹\tæœ€è¿‘è¿™æ®µæ—¶é—´ï¼Œæ€»æœ‰ä¸€ç§å¥‡æ€ªçš„æƒ³æ³•ï¼Œæ„Ÿè§‰è‡ªå·±åšäº†å¾ˆå¤šäº‹æƒ…ï¼Œä½†å…¶å®åˆä»€ä¹ˆéƒ½æ²¡åšï¼Œå°±åƒæˆ‘githubä¸Šé¢çš„æ´»åŠ¨ä¸€æ ·ï¼Œæ„Ÿè§‰è‡ªå·±å¥½åƒå†™äº†å¾ˆå¤šä¸œè¥¿ï¼Œç›¸æ¯”è¿‡å»é‚£ä¸ªå†™äº†å°±ä¸ç®¡äº†å¾—æˆ‘æ¥è¯´ï¼Œè¿™ä¸æ˜¯æŒºå¥½çš„çš„å—ï¼Œåˆä»”ç»†çœ‹çœ‹ï¼Œè‡ªå·±æ¯å¤©pushçš„ä¸œè¥¿ï¼ŒçœŸçš„æ˜¯ä¸€å¨å±ï¼Œçœ‹çœ‹åˆ«äººå†™çš„ä¸œè¥¿å§ï¼Œåˆå¥½å¤šçœ‹ä¸æ‡‚ï¼Œçœ‹çœ‹è‡ªå·±çš„å†™çš„ä»€ä¹ˆåƒåœ¾åšå®¢å§ï¼ŒçœŸçš„ä¸çŸ¥é“å†™çš„æ˜¯ä»€ä¹ˆã€‚ä½†æ˜¯æˆ‘åˆå¾ˆéœ€è¦è¿™ç§æ„Ÿè§‰è‡ªå·±å¾ˆå¿™çš„æ„Ÿè§‰ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Œå¯èƒ½æ˜¯å› ä¸ºæˆ‘ç°åœ¨è¿˜æ²¡æœ‰å·¥ä½œï¼ˆå…¶å®æ˜¯æ‰¾ä¸åˆ°å·¥ä½œï¼‰ï¼Œåˆä¸æƒ³æ¯å¤©æ— æ‰€äº‹äº‹ï¼Œæ¯•ç«Ÿæˆ‘å°±æ˜¯å¾ˆå–œæ¬¢å¸¦ç€è€³æœºï¼Œå¯¹ç€ç”µè„‘ï¼Œåœ¨è‡ªå·±ä¸–ç•Œé‡Œçš„æ„Ÿè§‰ï¼Œä¹Ÿå¯ä»¥è¯´æˆ‘4æœˆä»½æ‰¾å·¥ä½œçš„ç»å†ï¼Œè®©æˆ‘çœŸçš„å®³æ€•æ‰¾å·¥ä½œäº†ï¼Œç°åœ¨æƒ³è·¨å‡ºå“ªä¸€æ­¥çœŸçš„å—ä¸äº†ï¼Œå¤–é¢é‚£äº›å¾ˆæ—©å°±å‡ºå»å·¥ä½œçš„åŒé¾„äººï¼Œå·¥ä½œç»éªŒå’Œèƒ½åŠ›ä¸æ¯”æˆ‘ä¸°å¯Œå—ï¼Ÿè¿˜æ²¡æ¯•ä¸šåœ¨æ ¡çš„ï¼Œä¸å¿…æˆ‘æ›´æœ‰æ¿€æƒ…å—ï¼Ÿåœ¨å¤–é¢å·¥ä½œäº†å¾ˆå¤šå¹´çš„ç¨‹åºå‘˜ï¼Œå°±æ›´ä¸ç”¨è¯´äº†å—ï¼Ÿè¿˜æœ‰githubä¸Šé¢çš„ä¸€ä¼—å¤§ç¥\u0026hellip;\u0026hellip;..\nâ€‹\tçœŸçš„è¿›äº†æ­»å¾ªç¯å—ï¼Œçœ‹ç€æ‹›è˜ä¸Šé¢çš„ä¿¡æ¯ï¼Œä¸Šé¢éœ€è¦æŒæ¡çš„æŠ€èƒ½ï¼Œæˆ‘å°±å»å­¦ä¹ ï¼Œåˆåœ¨æƒ³ï¼Œæˆ‘ä¸æ˜¯ä»€ä¹ˆèªæ˜äººï¼Œå¾ˆå¤šæ—¶å€™æˆ‘çœŸçš„ä¸èƒ½å®Œå…¨æŒæ¡è¿™çŸ¥è¯†ã€‚ä½†æ˜¯æˆ‘åˆä¸æƒ³ç›´æ¥å»é¢è¯•ï¼Œä¸æƒ³é¢è¯•çš„æ—¶å€™æ„Ÿè§‰è‡ªå·±ä¼¼æ‡‚éæ‡‚è¿˜è¦ç¡¬ç€å¤´çš®è¯´è‡ªå·±äº†è§£ï¼Œæ€ä¹ˆè¯´å‘¢ , æƒ³åˆ°è¿™æ–¹é¢çš„ï¼Œæˆ‘åˆtmçš„ç„¦è™‘äº†ï¼ŒçœŸçš„å—ä¸äº†ã€‚\nè¿˜æ˜¯è¦æ”¹å˜ç‚¹ä»€ä¹ˆ:\nå°‘æŠ½çƒŸï¼Œåªæ˜¯ä¸èƒ½æŠŠä»–å½“æˆä¾èµ–å§ å†ä¸“æ³¨ä¸€ç‚¹ å°‘ç‚¹åœ¨ç½‘ç»œä¸Šçœ‹é‚£äº›æ²¡è¥å…»çš„äº†ï¼ˆè‡³å°‘ä¸æ˜¯åœ¨æˆ‘å­¦ä¹ çš„æ—¶å€™ï¼‰ï¼Œåœ¨æƒ³ä¸å‡ºå†™ä»€ä¹ˆä»£ç çš„æ—¶å€™ï¼Œæ‹¿æ‰‹æœºå‡ºæ¥ï¼Œçœ‹çœ‹æ— èŠæ–‡ç« ï¼Œçœ‹çœ‹æ²¡æœ‰è¥å…»çš„è§†å±ï¼Œç¡®å®è®©æˆ‘æ„Ÿè§‰æœ‰æ— æ„ä¹‰çš„å¿«ä¹ï¼Œæœ‰ä¸€ç§é€ƒé¿çš„å¿«ä¹ï¼Œæ‰‹æœºç‚¹ä¸€ä¸‹å°±èƒ½è·å¾—æœ€ç›´æ¥çš„å¤šå·´èƒºã€‚ä½†æ˜¯è¿™æ ¹åªæ²¡æœ‰æ€è€ƒèƒ½åŠ›çš„å°ç™½é¼ åˆæœ‰ä½•åŒºåˆ«å‘¢ã€‚æˆ‘ä¸æƒ³è¿™æ ·\u0026hellip;\u0026hellip;. ","permalink":"https://XianCH.github.io/posts/life/%E4%B8%80%E4%BA%9B%E6%83%B3%E6%B3%95/","summary":"\u003cimg src=\"./index.assets/image-20231014184130058.png\" alt=\"image-20231014184130058\" style=\"zoom:60%;\" /\u003e\n\u003ch2 id=\"æ‚è°ˆ\"\u003eæ‚è°ˆ\u003c/h2\u003e\n\u003cp\u003eâ€‹\t\tæœ€è¿‘è¿™æ®µæ—¶é—´ï¼Œæ€»æœ‰ä¸€ç§å¥‡æ€ªçš„æƒ³æ³•ï¼Œæ„Ÿè§‰è‡ªå·±åšäº†å¾ˆå¤šäº‹æƒ…ï¼Œä½†å…¶å®åˆä»€ä¹ˆéƒ½æ²¡åšï¼Œå°±åƒæˆ‘githubä¸Šé¢çš„æ´»åŠ¨ä¸€æ ·ï¼Œ\u003cimg src=\"./index.assets/image-20231014181817119.png\" alt=\"image-20231014181817119\" style=\"zoom:25%;\" /\u003eæ„Ÿè§‰è‡ªå·±å¥½åƒå†™äº†å¾ˆå¤šä¸œè¥¿ï¼Œç›¸æ¯”è¿‡å»é‚£ä¸ªå†™äº†å°±ä¸ç®¡äº†å¾—æˆ‘æ¥è¯´ï¼Œè¿™ä¸æ˜¯æŒºå¥½çš„çš„å—ï¼Œåˆä»”ç»†çœ‹çœ‹ï¼Œè‡ªå·±æ¯å¤©pushçš„ä¸œè¥¿ï¼ŒçœŸçš„æ˜¯ä¸€å¨å±ï¼Œçœ‹çœ‹åˆ«äººå†™çš„ä¸œè¥¿å§ï¼Œåˆå¥½å¤šçœ‹ä¸æ‡‚ï¼Œçœ‹çœ‹è‡ªå·±çš„å†™çš„ä»€ä¹ˆåƒåœ¾åšå®¢å§ï¼ŒçœŸçš„ä¸çŸ¥é“å†™çš„æ˜¯ä»€ä¹ˆã€‚ä½†æ˜¯æˆ‘åˆå¾ˆéœ€è¦è¿™ç§æ„Ÿè§‰è‡ªå·±å¾ˆå¿™çš„æ„Ÿè§‰ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Œå¯èƒ½æ˜¯å› ä¸ºæˆ‘ç°åœ¨è¿˜æ²¡æœ‰å·¥ä½œï¼ˆå…¶å®æ˜¯æ‰¾ä¸åˆ°å·¥ä½œï¼‰ï¼Œåˆä¸æƒ³æ¯å¤©æ— æ‰€äº‹äº‹ï¼Œæ¯•ç«Ÿæˆ‘å°±æ˜¯å¾ˆå–œæ¬¢å¸¦ç€è€³æœºï¼Œå¯¹ç€ç”µè„‘ï¼Œåœ¨è‡ªå·±ä¸–ç•Œé‡Œçš„æ„Ÿè§‰ï¼Œä¹Ÿå¯ä»¥è¯´æˆ‘4æœˆä»½æ‰¾å·¥ä½œçš„ç»å†ï¼Œè®©æˆ‘çœŸçš„å®³æ€•æ‰¾å·¥ä½œäº†ï¼Œç°åœ¨æƒ³è·¨å‡ºå“ªä¸€æ­¥çœŸçš„å—ä¸äº†ï¼Œå¤–é¢é‚£äº›å¾ˆæ—©å°±å‡ºå»å·¥ä½œçš„åŒé¾„äººï¼Œå·¥ä½œç»éªŒå’Œèƒ½åŠ›ä¸æ¯”æˆ‘ä¸°å¯Œå—ï¼Ÿè¿˜æ²¡æ¯•ä¸šåœ¨æ ¡çš„ï¼Œä¸å¿…æˆ‘æ›´æœ‰æ¿€æƒ…å—ï¼Ÿåœ¨å¤–é¢å·¥ä½œäº†å¾ˆå¤šå¹´çš„ç¨‹åºå‘˜ï¼Œå°±æ›´ä¸ç”¨è¯´äº†å—ï¼Ÿè¿˜æœ‰githubä¸Šé¢çš„ä¸€ä¼—å¤§ç¥\u0026hellip;\u0026hellip;..\u003c/p\u003e","title":"ä¸€äº›æƒ³æ³•"},{"content":"gin ä»‹ç» Gin is a web framework written in Go. It features a martini-like API with performance that is up to 40 times faster thanks to httprouter. If you need performance and good productivity, you will love Gin.\nThe key features of Gin are:\nZero allocation router Fast Middleware support Crash-free JSON validation Routes grouping Error management Rendering built-in Extendable Gin ä¸ net/http çš„å…³ç³» ginæ˜¯åœ¨ Golang HTTP æ ‡å‡†åº“ net/http åŸºç¡€ä¹‹ä¸Šçš„å†å°è£…\nGin æ¡†æ¶ä½¿ç”¨ç¤ºä¾‹ func main(){ mux := gin.Default() mux.Use(middleware) mux.Post(\u0026#34;/ping\u0026#34;,xxxhandler) if err :=mux.Run(\u0026#34;:8000\u0026#34;); err != nil { panic(err) } } func xxxhandler(c *gin.context){ c.Json(http.StatusOK,\u0026#34;pong\u0026#34;) } ç®€æ˜“è§£é‡Šï¼ˆåé¢ä¼šè¯¦ç»†è§£é‡Šï¼‰ï¼š\ngin.Default()è¿”å›é»˜è®¤çš„gin Engine\nUse()å‡½æ•°ï¼Œæ·»åŠ ä¸­é—´ä»¶\nmux.Post()åˆ›å»ºä¸€ä¸ªpost\u0026quot;/ping\u0026quot;çš„è·¯ç”±ï¼Œè·¯ç”±åˆ°xxxhandleræ–¹æ³•\n.Run()è¿è¡ŒhttpæœåŠ¡\nç”¨net/http\nfunc main() { http.HandleFunc(\u0026#34;/ping\u0026#34;, func(w http.ResponseWriter, r *http.Request) { if r.Method == http.MethodPost { w.Header().Set(\u0026#34;Content-Type\u0026#34;, \u0026#34;application/json\u0026#34;) w.WriteHeader(http.StatusOK) w.Write([]byte(`{\u0026#34;message\u0026#34;: \u0026#34;pong\u0026#34;}`)) } else { http.Error(w, \u0026#34;Method Not Allowed\u0026#34;, http.StatusMethodNotAllowed) } }) if err := http.ListenAndServe(\u0026#34;:8000\u0026#34;, nil); err != nil { panic(err) } } gin åŸºç¡€æ¦‚å¿µ è·¯ç”± ä¸­é—´ä»¶ è¯·æ±‚å’Œå“åº”å¯¹è±¡ å‚æ•°è§£æ é™æ€æ–‡ä»¶å¤„ç† åˆ›å»ºç¬¬ä¸€ä¸ªGinåº”ç”¨ åˆ›å»ºä¸€ä¸ªç®€å•çš„Hello Worldåº”ç”¨ å®šä¹‰è·¯ç”± å¤„ç†HTTPè¯·æ±‚ è¿”å›JSONå“åº” è·¯ç”±ä¸æ§åˆ¶å™¨\nè·¯ç”±çš„å®šä¹‰ä¸ä½¿ç”¨ å‚æ•°ä¼ é€’å’Œè·¯ç”±å‚æ•° æ§åˆ¶å™¨çš„åˆ›å»ºä¸ä½¿ç”¨ ä¸­é—´ä»¶\nä»€ä¹ˆæ˜¯ä¸­é—´ä»¶ å†…ç½®ä¸­é—´ä»¶ï¼ˆLoggerã€Recoveryï¼‰ è‡ªå®šä¹‰ä¸­é—´ä»¶ è¯·æ±‚ä¸å“åº”å¤„ç†\nè·å–è¯·æ±‚æ•°æ®ï¼ˆGETã€POSTã€Queryå‚æ•°ï¼‰ å‘é€å“åº”æ•°æ®ï¼ˆJSONã€HTMLã€æ–‡ä»¶ï¼‰ é”™è¯¯å¤„ç†ä¸çŠ¶æ€ç  æ•°æ®åº“é›†æˆ\nè¿æ¥æ•°æ®åº“ ORMï¼ˆå¦‚æœä½¿ç”¨ï¼‰ CRUDæ“ä½œ èº«ä»½éªŒè¯ä¸æˆæƒ\nç”¨æˆ·è®¤è¯ åŸºäºè§’è‰²çš„æˆæƒ JSON Web Tokens (JWT)çš„ä½¿ç”¨ æ€§èƒ½ä¼˜åŒ–\nGolangå’ŒGinçš„æ€§èƒ½ç‰¹ç‚¹ å¸¸è§æ€§èƒ½é—®é¢˜ä¸ä¼˜åŒ–ç­–ç•¥ éƒ¨ç½²ä¸ç»´æŠ¤\néƒ¨ç½²Ginåº”ç”¨ æ—¥å¿—ç®¡ç† å®‰å…¨æ€§è€ƒè™‘ æœ€ä½³å®è·µ\nä»£ç ç»“æ„ç»„ç»‡ æµ‹è¯•æ–¹æ³• æ–‡æ¡£ç¼–å†™ è¿›é˜¶ä¸»é¢˜\nWebSocketæ”¯æŒ æœåŠ¡å™¨æ¨é€ï¼ˆServer-Sent Eventsï¼‰ ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ ","permalink":"https://XianCH.github.io/posts/tech/go/gin%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/","summary":"\u003ch2 id=\"gin-ä»‹ç»\"\u003egin ä»‹ç»\u003c/h2\u003e\n\u003cp\u003eGin is a web framework written in \u003ca href=\"https://go.dev/\"\u003eGo\u003c/a\u003e. It features a martini-like API with performance that is up to 40 times faster thanks to \u003ca href=\"https://github.com/julienschmidt/httprouter\"\u003ehttprouter\u003c/a\u003e. If you need performance and good productivity, you will love Gin.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eThe key features of Gin are:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eZero allocation router\u003c/li\u003e\n\u003cli\u003eFast\u003c/li\u003e\n\u003cli\u003eMiddleware support\u003c/li\u003e\n\u003cli\u003eCrash-free\u003c/li\u003e\n\u003cli\u003eJSON validation\u003c/li\u003e\n\u003cli\u003eRoutes grouping\u003c/li\u003e\n\u003cli\u003eError management\u003c/li\u003e\n\u003cli\u003eRendering built-in\u003c/li\u003e\n\u003cli\u003eExtendable\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"gin-ä¸-nethttp-çš„å…³ç³»\"\u003eGin ä¸ net/http çš„å…³ç³»\u003c/h2\u003e\n\u003cp\u003eginæ˜¯åœ¨ Golang HTTP æ ‡å‡†åº“ net/http åŸºç¡€ä¹‹ä¸Šçš„å†å°è£…\u003c/p\u003e\n\u003cimg src=\"./index.assets/image-20231022202236741.png\" alt=\"image-20231022202236741\" style=\"zoom:50%;\" /\u003e\n\u003ch2 id=\"gin-æ¡†æ¶ä½¿ç”¨ç¤ºä¾‹\"\u003eGin æ¡†æ¶ä½¿ç”¨ç¤ºä¾‹\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e(){\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003emux\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eDefault\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003emux\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eUse\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003emiddleware\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003emux\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ePost\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/ping\u0026#34;\u003c/span\u003e,\u003cspan style=\"color:#a6e22e\"\u003exxxhandler\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e:=\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003emux\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eRun\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;:8000\u0026#34;\u003c/span\u003e); \u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enil\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        panic(\u003cspan style=\"color:#a6e22e\"\u003eerr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    } \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efunc\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003exxxhandler\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003egin\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003econtext\u003c/span\u003e){\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eJson\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003ehttp\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eStatusOK\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;pong\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eç®€æ˜“è§£é‡Šï¼ˆåé¢ä¼šè¯¦ç»†è§£é‡Šï¼‰ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003egin.Default()è¿”å›é»˜è®¤çš„gin Engine\u003c/p\u003e","title":"Ginæ¡†æ¶å­¦ä¹ "},{"content":"WebSocketç®€ä»‹ æœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼Œæ˜¯çœŸæ­£çš„åŒå‘å¹³ç­‰å¯¹è¯ï¼Œå±äºæœåŠ¡å™¨æ¨é€æŠ€æœ¯çš„ä¸€ç§ã€‚\nï¼ˆ1ï¼‰å»ºç«‹åœ¨ TCP åè®®ä¹‹ä¸Šï¼ŒæœåŠ¡å™¨ç«¯çš„å®ç°æ¯”è¾ƒå®¹æ˜“ã€‚\nï¼ˆ2ï¼‰ä¸ HTTP åè®®æœ‰ç€è‰¯å¥½çš„å…¼å®¹æ€§ã€‚é»˜è®¤ç«¯å£ä¹Ÿæ˜¯80å’Œ443ï¼Œå¹¶ä¸”æ¡æ‰‹é˜¶æ®µé‡‡ç”¨ HTTP åè®®ï¼Œå› æ­¤æ¡æ‰‹æ—¶ä¸å®¹æ˜“å±è”½ï¼Œèƒ½é€šè¿‡å„ç§ HTTP ä»£ç†æœåŠ¡å™¨ã€‚\nï¼ˆ3ï¼‰æ•°æ®æ ¼å¼æ¯”è¾ƒè½»é‡ï¼Œæ€§èƒ½å¼€é”€å°ï¼Œé€šä¿¡é«˜æ•ˆã€‚\nï¼ˆ4ï¼‰å¯ä»¥å‘é€æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥å‘é€äºŒè¿›åˆ¶æ•°æ®ã€‚\nï¼ˆ5ï¼‰æ²¡æœ‰åŒæºé™åˆ¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸ä»»æ„æœåŠ¡å™¨é€šä¿¡ã€‚\nï¼ˆ6ï¼‰åè®®æ ‡è¯†ç¬¦æ˜¯wsï¼ˆå¦‚æœåŠ å¯†ï¼Œåˆ™ä¸ºwssï¼‰ï¼ŒæœåŠ¡å™¨ç½‘å€å°±æ˜¯ URLã€‚\nè¯·æ±‚ç¤ºä¾‹ å®¢æˆ·ç«¯:\nGET /chat HTTP/1.1 Host: server.example.com Upgrade: websocket Connection: Upgrade Sec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw== Sec-WebSocket-Protocol: chat, superchat Sec-WebSocket-Version: 13 Origin: http://example.com æœåŠ¡ç«¯ï¼š\nHTTP/1.1 101 Switching Protocols Upgrade: websocket Connection: Upgrade Sec-WebSocket-Accept: HSmrc0sMlYUkAGmm5OPpG2HaGWk= Sec-WebSocket-Protocol: chat è§‚å¯ŸæŠ¥æ–‡ä¸­çš„å‚æ•°websocketåƒæ˜¯httpçš„å‡çº§ï¼Œä½†æ˜¯å‡†ç¡®æ¥è¯´ä»–ä¸æ˜¯å»ºç«‹åœ¨httpä¹‹ä¸Šçš„ï¼Œåªæ˜¯é€šè¿‡httpæ¡æ‰‹ä¹‹åè¿›è¡ŒæœåŠ¡çš„å‡çº§\nå»ºç«‹è¿æ¥çš„æ­¥éª¤å»ºç«‹\nå®¢æˆ·ç«¯å‘èµ·WebSocketè¿æ¥ï¼šå®¢æˆ·ç«¯é€šè¿‡HTTPåè®®å‘æœåŠ¡å™¨å‘èµ·WebSocketè¿æ¥è¯·æ±‚ã€‚è¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„HTTP GETè¯·æ±‚ï¼Œä½†åŒ…å«ç‰¹å®šçš„WebSocketå¤´ä¿¡æ¯ï¼Œä¾‹å¦‚å‡çº§åè®®ï¼ˆUpgradeï¼‰ä¸º\u0026quot;websocket\u0026quot;ã€è¿æ¥æ–¹å¼ï¼ˆConnectionï¼‰ä¸º\u0026quot;Upgrade\u0026quot;ï¼Œä»¥åŠä¸€ä¸ªéšæœºç”Ÿæˆçš„Sec-WebSocket-Keyå¤´éƒ¨ã€‚å®¢æˆ·ç«¯è¿˜å¯ä»¥é™„åŠ å…¶ä»–WebSocketç‰¹å®šçš„å¤´éƒ¨ä¿¡æ¯ã€‚ æœåŠ¡å™¨æ¥å—WebSocketè¿æ¥è¯·æ±‚ï¼šæœåŠ¡å™¨æ¥æ”¶å®¢æˆ·ç«¯çš„HTTPè¿æ¥è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å¤´éƒ¨ä¿¡æ¯ä»¥ç¡®ä¿å…¶åŒ…å«äº†WebSocketç›¸å…³çš„ä¿¡æ¯ã€‚å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼ŒæœåŠ¡å™¨å°†å‘å®¢æˆ·ç«¯å‘é€HTTP 101åˆ‡æ¢åè®®ï¼ˆHTTP 101 Switching Protocolsï¼‰å“åº”ï¼Œè¡¨ç¤ºæ¥å—äº†WebSocketè¿æ¥ã€‚ WebSocketæ¡æ‰‹ï¼šåœ¨æ¥å—WebSocketè¿æ¥åï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯è¿›è¡Œæ¡æ‰‹ã€‚æœåŠ¡å™¨ä¼šè®¡ç®—å®¢æˆ·ç«¯å‘é€çš„Sec-WebSocket-Keyçš„å“ˆå¸Œå€¼ï¼Œå¹¶ä¸ä¸€ä¸ªå›ºå®šçš„GUIDï¼ˆ\u0026ldquo;258EAFA5-E914-47DA-95CA-C5AB0DC85B11\u0026rdquo;ï¼‰ä¸€èµ·è®¡ç®—SHA-1å“ˆå¸Œå€¼ï¼Œç„¶åå°†ç»“æœè½¬æ¢ä¸ºBase64ç¼–ç ã€‚è¿™ä¸ªBase64ç¼–ç çš„å€¼å°†ä½œä¸ºå“åº”å¤´éƒ¨Sec-WebSocket-Acceptè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œä»¥è¯æ˜WebSocketè¿æ¥å·²æˆåŠŸå»ºç«‹ã€‚ WebSocketè¿æ¥å»ºç«‹ï¼šä¸€æ—¦å®¢æˆ·ç«¯æ”¶åˆ°HTTP 101åˆ‡æ¢åè®®å“åº”ï¼Œå¹¶éªŒè¯Sec-WebSocket-Acceptå¤´éƒ¨ï¼Œè¿æ¥è¢«è§†ä¸ºæˆåŠŸå»ºç«‹ã€‚æ­¤æ—¶ï¼ŒWebSocketè¿æ¥å¯ä»¥ç”¨äºåŒå‘é€šä¿¡ã€‚ ä¼ è¾“æ•°æ®å¸§ æ¡æ‰‹æˆåŠŸå®Œæˆåï¼Œæ‚¨çš„åº”ç”¨ç¨‹åºå¯ä»¥ä»å®¢æˆ·ç«¯è¯»å–æ•°æ®æˆ–å‘å®¢æˆ·ç«¯å†™å…¥æ•°æ®ã€‚WebSocket è§„èŒƒå®šä¹‰äº†çš„ä¸€ä¸ªå®¢æˆ·æœºå’ŒæœåŠ¡å™¨ä¹‹é—´ä½¿ç”¨çš„ç‰¹å®šå¸§æ ¼å¼ã€‚è¿™æ˜¯æ¡†æ¶çš„ä½æ¨¡å¼ï¼š\nhttpå’Œwebsocket å…±åŒç‚¹\néƒ½æ˜¯åŸºäºtcpåè®®çš„ï¼Œæ‰€ä»¥éƒ½æ˜¯å¯é ä¼  éƒ½åœ¨åº”ç”¨å±‚ ä¸åŒ\nwebsocketæ˜¯åŒå‘é€šè®¯çš„åè®®ï¼Œæ¨¡æ‹Ÿsocketåè®®ï¼Œå¯ä»¥åŒå‘å‘é€å’Œæ¥å—ä¿¡æ¯ï¼Œè€Œhttpæ˜¯å•å‘çš„ éƒ½éœ€è¦æ¡æ‰‹å»ºç«‹è¿æ¥ï¼Œä½†æ˜¯httpæ¯æ¬¡éƒ½éœ€è¦è¿›è¡Œæ¡æ‰‹ï¼Œè€Œwebsocketåœ¨æ¡æ‰‹ä¹‹åå†å‘é€æ•°æ®æ— éœ€è¿›è¡Œæ¡æ‰‹ï¼Œ websocketæ²¡æœ‰header websocket æ¡æ‰‹è¿‡ç¨‹ æµè§ˆå™¨å’ŒæœåŠ¡ç«¯å»ºç«‹tcpä¸‰æ¬¡æ¡æ‰‹ï¼Œè¿™æ˜¯é€šè®¯çš„åŸºç¡€ï¼Œä¼ è¾“æ§åˆ¶å±‚ï¼Œè‹¥å¤±è´¥äº†å°±ä¸ç»§ç»­äº† tcpæ¡æ‰‹å®Œæˆåï¼Œæµè§ˆå™¨é€šè¿‡httpåè®®å‘æœåŠ¡ç«¯å‘é€websocketæ”¯æŒçš„ç‰ˆæœ¬å·ç­‰ä¿¡æ¯ï¼ˆå¼€å§‹å‰çš„httpæ¡æ‰‹ï¼‰ æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„æ¡æ‰‹è¯·æ±‚åï¼ŒåŒæ ·é‡‡ç”¨httpåè®®å›é¦ˆæ•°æ®ã€‚ å½“æ”¶åˆ°äº†è¿æ¥æˆåŠŸçš„ä¿¡æ¯åï¼Œé€šè¿‡tcpé€šé“è¿›è¡Œä¼ è¾“é€šè®¯ åœ¨GOè¯­è¨€ä½¿ç”¨websocket è¦åŸºäº Go è¯­è¨€å†…ç½®çš„ net/http åº“ç¼–å†™ WebSocket æœåŠ¡å™¨ï¼Œä½ éœ€è¦ï¼š\nå‘èµ·æ¡æ‰‹ ä»å®¢æˆ·ç«¯æ¥æ”¶æ•°æ®å¸§ å‘é€æ•°æ®å¸§ç»™å®¢æˆ·ç«¯ å…³é—­æ¡æ‰‹ å»ºç«‹å‘èµ·æ¡æ‰‹ é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ WebSocket ç«¯ç‚¹çš„ HTTP å¤„ç†ç¨‹åºï¼š\n// HTTP server with WebSocket endpoint func Server() { http.HandleFunc(\u0026#34;/\u0026#34;, func(w http.ResponseWriter, r *http.Request) { ws, err := NewHandler(w, r) if err != nil { // handle error } if err = ws.Handshake(); err != nil { // handle error } â€¦ ç„¶ååˆå§‹åŒ– WebSocket ç»“æ„ã€‚\nåˆå§‹æ¡æ‰‹è¯·æ±‚å§‹ç»ˆæ¥è‡ªå®¢æˆ·ç«¯ã€‚æœåŠ¡å™¨ç¡®å®šäº† WebSocket è¯·æ±‚åï¼Œéœ€è¦ä½¿ç”¨æ¡æ‰‹å“åº”è¿›è¡Œå›å¤ã€‚\nè¯·è®°ä½ï¼Œä½ æ— æ³•ä½¿ç”¨ http.ResponseWriter ç¼–å†™å“åº”ï¼Œå› ä¸ºä¸€æ—¦å¼€å§‹å‘é€å“åº”ï¼Œå®ƒå°†å…³é—­å…¶åŸºç¡€çš„ TCP è¿æ¥ï¼ˆè¿™æ˜¯ HTTP åè®®çš„è¿è¡Œæœºåˆ¶å†³å®šçš„ï¼Œå‘é€å“åº”åå³å…³é—­è¿æ¥ï¼‰ã€‚\nå› æ­¤ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ HTTP åŠ«æŒ (hijack)ã€‚é€šè¿‡åŠ«æŒï¼Œå¯ä»¥æ¥ç®¡åŸºç¡€çš„ TCP è¿æ¥å¤„ç†ç¨‹åºå’Œ bufio.Writerã€‚è¿™ä½¿å¯ä»¥åœ¨ä¸å…³é—­ TCP è¿æ¥çš„æƒ…å†µä¸‹è¯»å–å’Œå†™å…¥æ•°æ®ã€‚\n// NewHandler initializes a new handler func NewHandler(w http.ResponseWriter, req *http.Request) (*WS, error) { hj, ok := w.(http.Hijacker) if !ok { // handle error } ..... } è¦å®Œæˆæ¡æ‰‹ï¼ŒæœåŠ¡å™¨å¿…é¡»ä½¿ç”¨é€‚å½“çš„å¤´è¿›è¡Œå“åº”ã€‚\n// Handshake creates a handshake header func (ws *WS) Handshake() error { hash := func(key string) string { h := sha1.New() h.Write([]byte(key)) h.Write([]byte(\u0026#34;258EAFA5-E914-47DA-95CA-C5AB0DC85B11\u0026#34;)) return base64.StdEncoding.EncodeToString(h.Sum(nil)) }(ws.header.Get(\u0026#34;Sec-WebSocket-Key\u0026#34;)) ..... } å®¢æˆ·ç«¯å‘èµ· WebSocket è¿æ¥è¯·æ±‚æ—¶ç”¨çš„ Sec-WebSocket-key æ˜¯éšæœºç”Ÿæˆçš„ï¼Œå¹¶ä¸”æ˜¯ Base64 ç¼–ç çš„ã€‚æ¥å—è¯·æ±‚åï¼ŒæœåŠ¡å™¨éœ€è¦å°†æ­¤å¯†é’¥é™„åŠ åˆ°å›ºå®šå­—ç¬¦ä¸²ã€‚å‡è®¾ç§˜é’¥æ˜¯ x3JJHMbDL1EzLkh9GBhXDw==ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ SHA-1 è®¡ç®—äºŒè¿›åˆ¶å€¼ï¼Œå¹¶ä½¿ç”¨ Base64 å¯¹å…¶è¿›è¡Œç¼–ç ã€‚å¾—åˆ° HSmrc0sMlYUkAGmm5OPpG2HaGWk=ã€‚ç„¶åä½¿ç”¨å®ƒä½œä¸º Sec-WebSocket-Accept å“åº”å¤´çš„å€¼ã€‚\nä½¿ç”¨ç¬¬ä¸‰æ–¹åº“å¿«é€Ÿæ„å»º WebSocket æœåŠ¡ ","permalink":"https://XianCH.github.io/posts/tech/go/websocket%E5%AD%A6%E4%B9%A0/","summary":"\u003ch2 id=\"websocketç®€ä»‹\"\u003eWebSocketç®€ä»‹\u003c/h2\u003e\n\u003cp\u003eæœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼Œæ˜¯çœŸæ­£çš„åŒå‘å¹³ç­‰å¯¹è¯ï¼Œå±äºæœåŠ¡å™¨æ¨é€æŠ€æœ¯çš„ä¸€ç§ã€‚\u003c/p\u003e\n\u003cp\u003eï¼ˆ1ï¼‰\u003cstrong\u003eå»ºç«‹åœ¨ TCP åè®®ä¹‹ä¸Š\u003c/strong\u003eï¼ŒæœåŠ¡å™¨ç«¯çš„å®ç°æ¯”è¾ƒå®¹æ˜“ã€‚\u003c/p\u003e\n\u003cp\u003eï¼ˆ2ï¼‰ä¸ HTTP åè®®æœ‰ç€è‰¯å¥½çš„å…¼å®¹æ€§ã€‚é»˜è®¤ç«¯å£ä¹Ÿæ˜¯80å’Œ443ï¼Œå¹¶ä¸”æ¡æ‰‹é˜¶æ®µé‡‡ç”¨ HTTP åè®®ï¼Œå› æ­¤æ¡æ‰‹æ—¶ä¸å®¹æ˜“å±è”½ï¼Œèƒ½é€šè¿‡å„ç§ HTTP ä»£ç†æœåŠ¡å™¨ã€‚\u003c/p\u003e","title":"Websocketå­¦ä¹ "},{"content":"os os åŒ…æ˜¯ Go è¯­è¨€æ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦ç”¨äºä¸æ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œæä¾›äº†è®¿é—®æ“ä½œç³»ç»Ÿåº•å±‚åŠŸèƒ½çš„åŠŸèƒ½ã€‚ä¸‹é¢æ˜¯å…³äº os åŒ…çš„ä¸€äº›é‡è¦åŠŸèƒ½å’Œç”¨æ³•ï¼š\næ–‡ä»¶å’Œç›®å½•æ“ä½œï¼š os.Createï¼šåˆ›å»ºæ–‡ä»¶ã€‚ os.Openï¼šæ‰“å¼€æ–‡ä»¶ã€‚ os.OpenFileï¼šä»¥æŒ‡å®šæ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚ os.Removeï¼šåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚ os.Renameï¼šé‡å‘½åæ–‡ä»¶æˆ–ç›®å½•ã€‚ os.Mkdirï¼šåˆ›å»ºç›®å½•ã€‚ os.MkdirAllï¼šé€’å½’åˆ›å»ºç›®å½•ã€‚ os.Chdirï¼šæ”¹å˜å·¥ä½œç›®å½•ã€‚ os.Getwdï¼šè·å–å½“å‰å·¥ä½œç›®å½•ã€‚ os.Statï¼šè·å–æ–‡ä»¶æˆ–ç›®å½•çš„ä¿¡æ¯ã€‚ æ–‡ä»¶æè¿°ç¬¦ï¼š os.Stdinã€os.Stdoutã€os.Stderrï¼šæ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯çš„æ–‡ä»¶æè¿°ç¬¦ã€‚ os.Fileï¼šè¡¨ç¤ºæ–‡ä»¶çš„ç»“æ„ï¼ŒåŒ…æ‹¬æ–‡ä»¶æè¿°ç¬¦ã€æ–‡ä»¶åç­‰ä¿¡æ¯ã€‚ ç¯å¢ƒå˜é‡ï¼š os.Getenvï¼šè·å–ç¯å¢ƒå˜é‡çš„å€¼ã€‚ os.Setenvï¼šè®¾ç½®ç¯å¢ƒå˜é‡çš„å€¼ã€‚ os.Unsetenvï¼šåˆ é™¤ç¯å¢ƒå˜é‡ã€‚ è¿›ç¨‹æ§åˆ¶ï¼š os.Argsï¼šå‘½ä»¤è¡Œå‚æ•°ã€‚ os.Getpidï¼šè·å–å½“å‰è¿›ç¨‹çš„ PIDã€‚ os.Getppidï¼šè·å–çˆ¶è¿›ç¨‹çš„ PIDã€‚ os.Exitï¼šé€€å‡ºå½“å‰è¿›ç¨‹ã€‚ ä¿¡å·å¤„ç†ï¼š os.Signalï¼šè¡¨ç¤ºæ“ä½œç³»ç»Ÿä¿¡å·çš„ç±»å‹ã€‚ os.Notifyï¼šç”¨äºæ¥æ”¶æŒ‡å®šçš„æ“ä½œç³»ç»Ÿä¿¡å·ã€‚ ç”¨æˆ·å’Œç»„ä¿¡æ¯ï¼š os.Userï¼šè¡¨ç¤ºç”¨æˆ·çš„ç»“æ„ã€‚ os.LookupEnvï¼šæ ¹æ®ç¯å¢ƒå˜é‡åæŸ¥æ‰¾ç¯å¢ƒå˜é‡å€¼ã€‚ os.Hostnameï¼šè·å–ä¸»æœºåã€‚ æƒé™å’Œæ–‡ä»¶ä¿¡æ¯ï¼š os.Chmodï¼šæ”¹å˜æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚ os.Chtimesï¼šæ”¹å˜æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´ã€‚ os.Symlinkï¼šåˆ›å»ºç¬¦å·é“¾æ¥ã€‚ os.Readlinkï¼šè¯»å–ç¬¦å·é“¾æ¥ç›®æ ‡è·¯å¾„ã€‚ os.Lstatï¼šè·å–ç¬¦å·é“¾æ¥ä¿¡æ¯ï¼Œè€Œä¸æ˜¯ç›®æ ‡æ–‡ä»¶ä¿¡æ¯ã€‚ æ–‡ä»¶è·¯å¾„æ“ä½œï¼š os.PathSeparatorï¼šè¡¨ç¤ºæ–‡ä»¶è·¯å¾„ä¸­çš„è·¯å¾„åˆ†éš”ç¬¦ã€‚ os.Joinï¼šè¿æ¥è·¯å¾„å…ƒç´ ä»¥åˆ›å»ºæœ‰æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚ os.Splitï¼šåˆ†å‰²æ–‡ä»¶è·¯å¾„ä¸ºç›®å½•å’Œæ–‡ä»¶åã€‚ os.IsExistï¼šåˆ¤æ–­é”™è¯¯æ˜¯å¦è¡¨ç¤ºæ–‡ä»¶å·²å­˜åœ¨ã€‚ os.IsNotExistï¼šåˆ¤æ–­é”™è¯¯æ˜¯å¦è¡¨ç¤ºæ–‡ä»¶ä¸å­˜åœ¨ã€‚ æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼š os.Execï¼šæ‰§è¡Œå¤–éƒ¨å‘½ä»¤å¹¶è·å–å…¶è¾“å‡ºã€‚ os.StartProcessï¼šä»¥æŒ‡å®šçš„å±æ€§å¯åŠ¨æ–°è¿›ç¨‹ã€‚ æ–‡ä»¶é”ï¼š os.FileLockï¼šæ–‡ä»¶é”ç»“æ„ï¼Œç”¨äºæ–‡ä»¶çš„è¯»å†™é”å®šã€‚ å¹³å°ç›¸å…³åŠŸèƒ½ï¼š os.Environï¼šè·å–å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ç¯å¢ƒå˜é‡ã€‚ os.Hostnameï¼šè·å–ä¸»æœºåã€‚ io io åŒ…æ˜¯ Go è¯­è¨€æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒåŒ…ï¼Œæä¾›äº†å¯¹è¾“å…¥å’Œè¾“å‡ºæ“ä½œçš„æŠ½è±¡å’Œé€šç”¨æ¥å£ã€‚è¿™ä¸ªåŒ…åŒ…å«äº†è®¸å¤šæ¥å£å’Œç±»å‹ï¼Œç”¨äºå¤„ç†æ–‡ä»¶ã€ç½‘ç»œè¿æ¥ã€å†…å­˜ç¼“å†²ã€å‹ç¼©ã€è§£å‹ç¼©ç­‰ I/O ç›¸å…³çš„æ“ä½œã€‚ä»¥ä¸‹æ˜¯ä¸€äº› io åŒ…çš„é‡è¦æ¥å£å’Œç±»å‹ï¼š\nReader æ¥å£ï¼š\nReader æ¥å£å®šä¹‰äº†è¯»å–æ•°æ®çš„æ–¹æ³•ï¼Œå…è®¸å®ç°è¯¥æ¥å£çš„ç±»å‹ä»ä¸åŒçš„æ•°æ®æºè¯»å–æ•°æ®ã€‚\nRead(p []byte) (n int, err error)ï¼šä»æ•°æ®æºè¯»å–æ•°æ®å¹¶å°†å…¶å­˜å‚¨åˆ° p ä¸­ï¼Œè¿”å›è¯»å–çš„å­—èŠ‚æ•°å’Œå¯èƒ½çš„é”™è¯¯ã€‚ æ ‡å‡†åº“ä¸­çš„ä¸€äº›ç±»å‹å®ç°äº† Reader æ¥å£ï¼Œä¾‹å¦‚ os.Fileã€strings.Reader ç­‰ã€‚\nWriter æ¥å£ï¼š\nWriter æ¥å£å®šä¹‰äº†å†™å…¥æ•°æ®çš„æ–¹æ³•ï¼Œå…è®¸å®ç°è¯¥æ¥å£çš„ç±»å‹å°†æ•°æ®å†™å…¥ä¸åŒçš„ç›®æ ‡ã€‚\nWrite(p []byte) (n int, err error)ï¼šå°† p ä¸­çš„æ•°æ®å†™å…¥ç›®æ ‡ï¼Œè¿”å›å†™å…¥çš„å­—èŠ‚æ•°å’Œå¯èƒ½çš„é”™è¯¯ã€‚ æ ‡å‡†åº“ä¸­çš„ä¸€äº›ç±»å‹å®ç°äº† Writer æ¥å£ï¼Œä¾‹å¦‚ os.Fileã€bytes.Buffer ç­‰ã€‚\nCloser æ¥å£ï¼š\nCloser æ¥å£å®šä¹‰äº†å…³é—­èµ„æºçš„æ–¹æ³•ï¼Œé€šå¸¸ç”¨äºé‡Šæ”¾èµ„æºï¼Œå¦‚æ–‡ä»¶å¥æŸ„ã€ç½‘ç»œè¿æ¥ç­‰ã€‚\nClose() errorï¼šå…³é—­èµ„æºå¹¶è¿”å›å¯èƒ½çš„é”™è¯¯ã€‚ ä¾‹å¦‚ï¼Œos.File å®ç°äº† Closer æ¥å£ï¼Œå¯ä»¥ç”¨æ¥å…³é—­æ–‡ä»¶ã€‚\nSeeker æ¥å£ï¼š\nSeeker æ¥å£å®šä¹‰äº†åœ¨æ•°æ®æºä¸­å®šä½çš„æ–¹æ³•ï¼Œé€šå¸¸ç”¨äºéšæœºè®¿é—®æ–‡ä»¶æˆ–å…¶ä»–æ•°æ®æºã€‚\nSeek(offset int64, whence int) (int64, error)ï¼šæ ¹æ® whence æŒ‡å®šçš„æ–¹å¼å®šä½åˆ° offset å¤„ï¼Œè¿”å›æ–°çš„åç§»é‡å’Œå¯èƒ½çš„é”™è¯¯ã€‚ ä¾‹å¦‚ï¼Œos.File å®ç°äº† Seeker æ¥å£ï¼Œå¯ä»¥ç”¨æ¥åœ¨æ–‡ä»¶ä¸­å®šä½ã€‚\nReadWriter æ¥å£ï¼š\nReadWriter æ¥å£ç»„åˆäº† Reader å’Œ Writer æ¥å£ï¼Œè¡¨ç¤ºåŒæ—¶æ”¯æŒè¯»å’Œå†™æ“ä½œçš„å¯¹è±¡ã€‚\nReadCloser å’Œ WriteCloser æ¥å£ï¼š\nè¿™äº›æ¥å£ç»„åˆäº† Reader æˆ– Writer æ¥å£å’Œ Closer æ¥å£ï¼Œè¡¨ç¤ºåŒæ—¶æ”¯æŒè¯»æˆ–å†™å’Œå…³é—­çš„å¯¹è±¡ã€‚\nMultiReader å’Œ MultiWriterï¼š\nè¿™äº›ç±»å‹å®ç°äº†å¤šä¸ª Reader æˆ– Writer çš„å¤åˆæ“ä½œï¼Œå…è®¸å¤šä¸ªæ•°æ®æºè¿›è¡Œä¸²è”ã€‚\nio.Copy å‡½æ•°ï¼š\nio.Copy å‡½æ•°ç”¨äºå°†æ•°æ®ä»ä¸€ä¸ª Reader å¤åˆ¶åˆ°ä¸€ä¸ª Writer ä¸­ï¼Œé€šå¸¸ç”¨äºæ–‡ä»¶å¤åˆ¶ã€ç½‘ç»œä¼ è¾“ç­‰æ“ä½œã€‚\nio/ioutil åŒ…ï¼š\nio/ioutil åŒ…æä¾›äº†ä¸€äº›ä¾¿æ·çš„å‡½æ•°ï¼Œç”¨äºç®€åŒ–æ–‡ä»¶è¯»å†™ã€ä¸´æ—¶æ–‡ä»¶åˆ›å»ºç­‰æ“ä½œã€‚ä¾‹å¦‚ï¼Œioutil.ReadFile ç”¨äºè¯»å–æ•´ä¸ªæ–‡ä»¶åˆ°å†…å­˜ä¸­ï¼Œioutil.WriteFile ç”¨äºå°†æ•°æ®å†™å…¥æ–‡ä»¶ã€‚\nio.Pipe ç±»å‹ï¼š\nio.Pipe ç±»å‹ç”¨äºåœ¨ä¸åŒçš„ goroutine ä¹‹é—´åˆ›å»ºä¸€ä¸ªç®¡é“ï¼Œå…è®¸ä¸€ä¸ª goroutine å†™å…¥æ•°æ®ï¼Œå¦ä¸€ä¸ª goroutine è¯»å–æ•°æ®ã€‚\nio.Reader å’Œ io.Writer çš„é€‚é…å™¨ï¼š\nio åŒ…è¿˜æä¾›äº†è®¸å¤šé€‚é…å™¨ç±»å‹ï¼Œç”¨äºå°†å…¶ä»–ç±»å‹ï¼ˆä¾‹å¦‚å­—ç¬¦ä¸²ã€å­—èŠ‚æ•°ç»„ï¼‰è½¬æ¢ä¸º Reader æˆ– Writer æ¥å£ï¼Œä»¥ä¾¿è¿›è¡Œ I/O æ“ä½œ\n","permalink":"https://XianCH.github.io/posts/tech/go/go%E5%9F%BA%E7%A1%80%E6%A0%87%E5%87%86%E5%BA%93/","summary":"\u003ch1 id=\"os\"\u003eos\u003c/h1\u003e\n\u003cp\u003e\u003ccode\u003eos\u003c/code\u003e åŒ…æ˜¯ Go è¯­è¨€æ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦ç”¨äºä¸æ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œæä¾›äº†è®¿é—®æ“ä½œç³»ç»Ÿåº•å±‚åŠŸèƒ½çš„åŠŸèƒ½ã€‚ä¸‹é¢æ˜¯å…³äº \u003ccode\u003eos\u003c/code\u003e åŒ…çš„ä¸€äº›é‡è¦åŠŸèƒ½å’Œç”¨æ³•ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eæ–‡ä»¶å’Œç›®å½•æ“ä½œ\u003c/strong\u003eï¼š\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eos.Create\u003c/code\u003eï¼šåˆ›å»ºæ–‡ä»¶ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Open\u003c/code\u003eï¼šæ‰“å¼€æ–‡ä»¶ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.OpenFile\u003c/code\u003eï¼šä»¥æŒ‡å®šæ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Remove\u003c/code\u003eï¼šåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Rename\u003c/code\u003eï¼šé‡å‘½åæ–‡ä»¶æˆ–ç›®å½•ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Mkdir\u003c/code\u003eï¼šåˆ›å»ºç›®å½•ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.MkdirAll\u003c/code\u003eï¼šé€’å½’åˆ›å»ºç›®å½•ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Chdir\u003c/code\u003eï¼šæ”¹å˜å·¥ä½œç›®å½•ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Getwd\u003c/code\u003eï¼šè·å–å½“å‰å·¥ä½œç›®å½•ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Stat\u003c/code\u003eï¼šè·å–æ–‡ä»¶æˆ–ç›®å½•çš„ä¿¡æ¯ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ–‡ä»¶æè¿°ç¬¦\u003c/strong\u003eï¼š\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eos.Stdin\u003c/code\u003eã€\u003ccode\u003eos.Stdout\u003c/code\u003eã€\u003ccode\u003eos.Stderr\u003c/code\u003eï¼šæ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯çš„æ–‡ä»¶æè¿°ç¬¦ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.File\u003c/code\u003eï¼šè¡¨ç¤ºæ–‡ä»¶çš„ç»“æ„ï¼ŒåŒ…æ‹¬æ–‡ä»¶æè¿°ç¬¦ã€æ–‡ä»¶åç­‰ä¿¡æ¯ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eç¯å¢ƒå˜é‡\u003c/strong\u003eï¼š\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eos.Getenv\u003c/code\u003eï¼šè·å–ç¯å¢ƒå˜é‡çš„å€¼ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Setenv\u003c/code\u003eï¼šè®¾ç½®ç¯å¢ƒå˜é‡çš„å€¼ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Unsetenv\u003c/code\u003eï¼šåˆ é™¤ç¯å¢ƒå˜é‡ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eè¿›ç¨‹æ§åˆ¶\u003c/strong\u003eï¼š\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eos.Args\u003c/code\u003eï¼šå‘½ä»¤è¡Œå‚æ•°ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Getpid\u003c/code\u003eï¼šè·å–å½“å‰è¿›ç¨‹çš„ PIDã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Getppid\u003c/code\u003eï¼šè·å–çˆ¶è¿›ç¨‹çš„ PIDã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Exit\u003c/code\u003eï¼šé€€å‡ºå½“å‰è¿›ç¨‹ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eä¿¡å·å¤„ç†\u003c/strong\u003eï¼š\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eos.Signal\u003c/code\u003eï¼šè¡¨ç¤ºæ“ä½œç³»ç»Ÿä¿¡å·çš„ç±»å‹ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Notify\u003c/code\u003eï¼šç”¨äºæ¥æ”¶æŒ‡å®šçš„æ“ä½œç³»ç»Ÿä¿¡å·ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eç”¨æˆ·å’Œç»„ä¿¡æ¯\u003c/strong\u003eï¼š\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eos.User\u003c/code\u003eï¼šè¡¨ç¤ºç”¨æˆ·çš„ç»“æ„ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.LookupEnv\u003c/code\u003eï¼šæ ¹æ®ç¯å¢ƒå˜é‡åæŸ¥æ‰¾ç¯å¢ƒå˜é‡å€¼ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Hostname\u003c/code\u003eï¼šè·å–ä¸»æœºåã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæƒé™å’Œæ–‡ä»¶ä¿¡æ¯\u003c/strong\u003eï¼š\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eos.Chmod\u003c/code\u003eï¼šæ”¹å˜æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Chtimes\u003c/code\u003eï¼šæ”¹å˜æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Symlink\u003c/code\u003eï¼šåˆ›å»ºç¬¦å·é“¾æ¥ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Readlink\u003c/code\u003eï¼šè¯»å–ç¬¦å·é“¾æ¥ç›®æ ‡è·¯å¾„ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Lstat\u003c/code\u003eï¼šè·å–ç¬¦å·é“¾æ¥ä¿¡æ¯ï¼Œè€Œä¸æ˜¯ç›®æ ‡æ–‡ä»¶ä¿¡æ¯ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ–‡ä»¶è·¯å¾„æ“ä½œ\u003c/strong\u003eï¼š\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eos.PathSeparator\u003c/code\u003eï¼šè¡¨ç¤ºæ–‡ä»¶è·¯å¾„ä¸­çš„è·¯å¾„åˆ†éš”ç¬¦ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Join\u003c/code\u003eï¼šè¿æ¥è·¯å¾„å…ƒç´ ä»¥åˆ›å»ºæœ‰æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Split\u003c/code\u003eï¼šåˆ†å‰²æ–‡ä»¶è·¯å¾„ä¸ºç›®å½•å’Œæ–‡ä»¶åã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.IsExist\u003c/code\u003eï¼šåˆ¤æ–­é”™è¯¯æ˜¯å¦è¡¨ç¤ºæ–‡ä»¶å·²å­˜åœ¨ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.IsNotExist\u003c/code\u003eï¼šåˆ¤æ–­é”™è¯¯æ˜¯å¦è¡¨ç¤ºæ–‡ä»¶ä¸å­˜åœ¨ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ‰§è¡Œå¤–éƒ¨å‘½ä»¤\u003c/strong\u003eï¼š\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eos.Exec\u003c/code\u003eï¼šæ‰§è¡Œå¤–éƒ¨å‘½ä»¤å¹¶è·å–å…¶è¾“å‡ºã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.StartProcess\u003c/code\u003eï¼šä»¥æŒ‡å®šçš„å±æ€§å¯åŠ¨æ–°è¿›ç¨‹ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ–‡ä»¶é”\u003c/strong\u003eï¼š\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eos.FileLock\u003c/code\u003eï¼šæ–‡ä»¶é”ç»“æ„ï¼Œç”¨äºæ–‡ä»¶çš„è¯»å†™é”å®šã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå¹³å°ç›¸å…³åŠŸèƒ½\u003c/strong\u003eï¼š\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eos.Environ\u003c/code\u003eï¼šè·å–å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ç¯å¢ƒå˜é‡ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eos.Hostname\u003c/code\u003eï¼šè·å–ä¸»æœºåã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch1 id=\"io\"\u003eio\u003c/h1\u003e\n\u003cp\u003e\u003ccode\u003eio\u003c/code\u003e åŒ…æ˜¯ Go è¯­è¨€æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒåŒ…ï¼Œæä¾›äº†å¯¹è¾“å…¥å’Œè¾“å‡ºæ“ä½œçš„æŠ½è±¡å’Œé€šç”¨æ¥å£ã€‚è¿™ä¸ªåŒ…åŒ…å«äº†è®¸å¤šæ¥å£å’Œç±»å‹ï¼Œç”¨äºå¤„ç†æ–‡ä»¶ã€ç½‘ç»œè¿æ¥ã€å†…å­˜ç¼“å†²ã€å‹ç¼©ã€è§£å‹ç¼©ç­‰ I/O ç›¸å…³çš„æ“ä½œã€‚ä»¥ä¸‹æ˜¯ä¸€äº› \u003ccode\u003eio\u003c/code\u003e åŒ…çš„é‡è¦æ¥å£å’Œç±»å‹ï¼š\u003c/p\u003e","title":"GoåŸºç¡€æ ‡å‡†åº“"},{"content":"","permalink":"https://XianCH.github.io/posts/tech/go/go%E6%93%8D%E4%BD%9Credis/","summary":"","title":"Goæ“ä½œredis"},{"content":"åŸºç¡€æ•°æ®ç±»å‹åŠè¿ç”¨åœºæ™¯ String å¸¸ç”¨å‘½ä»¤ æ™®é€šå­—ç¬¦ä¸²çš„åŸºæœ¬æ“ä½œï¼š\n# è®¾ç½® key-value ç±»å‹çš„å€¼ \u0026gt; SET name lin OK # æ ¹æ® key è·å¾—å¯¹åº”çš„ value \u0026gt; GET name \u0026#34;lin\u0026#34; # åˆ¤æ–­æŸä¸ª key æ˜¯å¦å­˜åœ¨ \u0026gt; EXISTS name (integer) 1 # è¿”å› key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼çš„é•¿åº¦ \u0026gt; STRLEN name (integer) 3 # åˆ é™¤æŸä¸ª key å¯¹åº”çš„å€¼ \u0026gt; DEL name (integer) 1 æ‰¹é‡è®¾ç½® :\n# æ‰¹é‡è®¾ç½® key-value ç±»å‹çš„å€¼ \u0026gt; MSET key1 value1 key2 value2 OK # æ‰¹é‡è·å–å¤šä¸ª key å¯¹åº”çš„ value \u0026gt; MGET key1 key2 1) \u0026#34;value1\u0026#34; 2) \u0026#34;value2\u0026#34; è®¡æ•°å™¨ï¼ˆå­—ç¬¦ä¸²çš„å†…å®¹ä¸ºæ•´æ•°çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ï¼‰ï¼š\n# è®¾ç½® key-value ç±»å‹çš„å€¼ \u0026gt; SET number 0 OK # å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å¢ä¸€ \u0026gt; INCR number (integer) 1 # å°†keyä¸­å­˜å‚¨çš„æ•°å­—å€¼åŠ  10 \u0026gt; INCRBY number 10 (integer) 11 # å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å‡ä¸€ \u0026gt; DECR number (integer) 10 # å°†keyä¸­å­˜å‚¨çš„æ•°å­—å€¼é”® 10 \u0026gt; DECRBY number 10 (integer) 0 è¿‡æœŸï¼ˆé»˜è®¤ä¸ºæ°¸ä¸è¿‡æœŸï¼‰ï¼š\n# è®¾ç½® key åœ¨ 60 ç§’åè¿‡æœŸï¼ˆè¯¥æ–¹æ³•æ˜¯é’ˆå¯¹å·²ç»å­˜åœ¨çš„keyè®¾ç½®è¿‡æœŸæ—¶é—´ï¼‰ \u0026gt; EXPIRE name 60 (integer) 1 # æŸ¥çœ‹æ•°æ®è¿˜æœ‰å¤šä¹…è¿‡æœŸ \u0026gt; TTL name (integer) 51 #è®¾ç½® key-value ç±»å‹çš„å€¼ï¼Œå¹¶è®¾ç½®è¯¥keyçš„è¿‡æœŸæ—¶é—´ä¸º 60 ç§’ \u0026gt; SET key value EX 60 OK \u0026gt; SETEX key 60 value OK ä¸å­˜åœ¨å°±æ’å…¥ï¼š\n# ä¸å­˜åœ¨å°±æ’å…¥ï¼ˆnot existsï¼‰ \u0026gt;SETNX key value (integer) 1 åº”ç”¨åœºæ™¯ ç¼“å­˜å¯¹è±¡ ä½¿ç”¨ String æ¥ç¼“å­˜å¯¹è±¡æœ‰ä¸¤ç§æ–¹å¼ï¼š\nç›´æ¥ç¼“å­˜æ•´ä¸ªå¯¹è±¡çš„ JSONï¼Œå‘½ä»¤ä¾‹å­ï¼š SET user:1 '{\u0026quot;name\u0026quot;:\u0026quot;xiaolin\u0026quot;, \u0026quot;age\u0026quot;:18}'ã€‚ é‡‡ç”¨å°† key è¿›è¡Œåˆ†ç¦»ä¸º user:ID:å±æ€§ï¼Œé‡‡ç”¨ MSET å­˜å‚¨ï¼Œç”¨ MGET è·å–å„å±æ€§å€¼ï¼Œå‘½ä»¤ä¾‹å­ï¼š MSET user:1:name xiaolin user:1:age 18 user:2:name xiaomei user:2:age 20ã€‚ å¸¸è§„è®¡æ•° é˜…è¯»é‡è®¡æ•°ï¼š\n# åˆå§‹åŒ–æ–‡ç« çš„é˜…è¯»é‡ \u0026gt; SET aritcle:readcount:1001 0 OK #é˜…è¯»é‡+1 \u0026gt; INCR aritcle:readcount:1001 (integer) 1 #é˜…è¯»é‡+1 \u0026gt; INCR aritcle:readcount:1001 (integer) 2 #é˜…è¯»é‡+1 \u0026gt; INCR aritcle:readcount:1001 (integer) 3 # è·å–å¯¹åº”æ–‡ç« çš„é˜…è¯»é‡ \u0026gt; GET aritcle:readcount:1001 \u0026#34;3\u0026#34; åˆ†å¸ƒå¼é”ï¼š\nSET å‘½ä»¤ä¸­æœ‰ä¸ªNXå‚æ•° ï¼Œå½“keyä¸å­˜åœ¨çš„æ—¶å€™æ‰æ’å…¥æ ¹æ®è¿™ä¸ªåŠŸèƒ½\nnx å¦‚keyä¸å­˜åœ¨çš„è¯ï¼Œåˆ™æ’å…¥ï¼Œå¯ä»¥è¡¨ç¤ºæˆåŠ é”æˆåŠŸ nxå¦‚æœkeyå­˜åœ¨çš„è¯ï¼Œåˆ™æ’å…¥å¤±è´¥ï¼Œå¯ä»¥è¡¨ç¤ºåŠ é”å¤±è´¥ SET lock_key unique_value NX PX 10000 #px è¡¨ç¤ºè¿‡æœŸæ—¶é—´ï¼Œä¸ºäº†é˜²æ­¢æ­»é” å­˜å‚¨ç”¨æˆ·ç™»å½•ä¿¡æ¯ï¼š\nå¦‚æœæ˜¯å•ä¸€ç³»ç»Ÿï¼Œç”¨æˆ·ä¿¡æ¯æˆ–è€…è¯´sessionåˆ™keyå­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­ï¼Œä½†æ˜¯å¦‚æœæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç”¨æˆ·çš„ç™»å½•ä¿¡æ¯æˆ–è€…å…¶ä»–ç™»å½•æˆ–è€…æ›´æ–°çš„å…¶ä»–ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æœåªå­˜åœ¨AæœåŠ¡å™¨ä¸­ï¼ŒBæœåŠ¡å™¨æ²¡æœ‰å…±äº«è¿™äº›ä¿¡æ¯ï¼Œåˆ™ä¼šå‡ºç°è¦æ±‚ç”¨æˆ·å†æ¬¡ç™»å½•ã€‚è¿™æ—¶å€™å¦‚ä½•å°†è¿™äº›ç›¸ä¿¡æ¯å­˜å‚¨åœ¨redisä¸­ï¼ŒæœåŠ¡å™¨A å’ŒæœåŠ¡å™¨B éƒ½åˆ°redisä¸­è·å–ä¿¡æ¯å°±è§£å†³äº†ç›¸å…³é—®é¢˜ã€‚\nList ä»‹ç» â€‹\tlistæ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œæ ¹æ®æ’å…¥é¡ºåºæ’åºï¼Œå¯ä»¥ä»å¤´éƒ¨å’Œå°¾éƒ¨æ’å…¥æ•°æ®ï¼Œåˆ—è¡¨æœ€å¤§é•¿åº¦æ˜¯2^32 - 1\nå†…éƒ¨å®ç° åœ¨ä½†æ˜¯åœ¨ Redis 3.2 ç‰ˆæœ¬ä¹‹åï¼ŒList æ•°æ®ç±»å‹åº•å±‚æ•°æ®ç»“æ„å°±åªç”± quicklist å®ç°äº†ï¼Œæ›¿ä»£äº†åŒå‘é“¾è¡¨å’Œå‹ç¼©åˆ—è¡¨\nquicklist(å¾…è¡¥å……\u0026hellip;.)\nquicklistNode\ntypedef struct quicklistNode { struct quicklistNode *prev; //å‰ä¸€ä¸ªquicklistNode struct quicklistNode *next; //åä¸€ä¸ªquicklistNode unsigned char *zl; //quicklistNodeæŒ‡å‘çš„ziplist unsigned int sz; //ziplistçš„å­—èŠ‚å¤§å° unsigned int count : 16; //ziplistä¸­çš„å…ƒç´ ä¸ªæ•° unsigned int encoding : 2; //ç¼–ç æ ¼å¼ï¼ŒåŸç”Ÿå­—èŠ‚æ•°ç»„æˆ–å‹ç¼©å­˜å‚¨ unsigned int container : 2; //å­˜å‚¨æ–¹å¼ unsigned int recompress : 1; //æ•°æ®æ˜¯å¦è¢«å‹ç¼© unsigned int attempted_compress : 1; //æ•°æ®èƒ½å¦è¢«å‹ç¼© unsigned int extra : 10; //é¢„ç•™çš„bitä½ } quicklistNode; typedef struct quicklist { quicklistNode *head; // quicklistçš„é“¾è¡¨å¤´ quicklistNode *tail; // quicklistçš„é“¾è¡¨å°¾ unsigned long count; // æ‰€æœ‰ziplistä¸­çš„æ€»å…ƒç´ ä¸ªæ•° unsigned long len; // quicklistNodesçš„ä¸ªæ•° int fill : QL_FILL_BITS; // å•ç‹¬è§£é‡Š unsigned int compress : QL_COMP_BITS; // å…·ä½“å«ä¹‰æ˜¯ä¸¤ç«¯å„æœ‰compressä¸ªèŠ‚ç‚¹ä¸å‹ç¼© ... } quicklist; å¸¸ç”¨å‘½ä»¤ # å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼valueæ’å…¥åˆ°keyåˆ—è¡¨çš„è¡¨å¤´(æœ€å·¦è¾¹)ï¼Œæœ€åçš„å€¼åœ¨æœ€å‰é¢ LPUSH key value [value ...] # å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼valueæ’å…¥åˆ°keyåˆ—è¡¨çš„è¡¨å°¾(æœ€å³è¾¹) RPUSH key value [value ...] # ç§»é™¤å¹¶è¿”å›keyåˆ—è¡¨çš„å¤´å…ƒç´  LPOP key # ç§»é™¤å¹¶è¿”å›keyåˆ—è¡¨çš„å°¾å…ƒç´  RPOP key # è¿”å›åˆ—è¡¨keyä¸­æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ ï¼ŒåŒºé—´ä»¥åç§»é‡startå’ŒstopæŒ‡å®šï¼Œä»0å¼€å§‹ LRANGE key start stop # ä»keyåˆ—è¡¨è¡¨å¤´å¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰å°±é˜»å¡timeoutç§’ï¼Œå¦‚æœtimeout=0åˆ™ä¸€ç›´é˜»å¡ BLPOP key [key ...] timeout # ä»keyåˆ—è¡¨è¡¨å°¾å¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰å°±é˜»å¡timeoutç§’ï¼Œå¦‚æœtimeout=0åˆ™ä¸€ç›´é˜»å¡ BRPOP key [key ...] timeout åº”ç”¨åœºæ™¯ æ¶ˆæ¯é˜Ÿåˆ—\nredisä¸­çš„Listæ˜¯å…ˆè¿›å…ˆå‡ºçš„ï¼Œæ»¡è¶³ä½¿ç”¨åœºæ™¯ã€‚\nproduceré€šè¿‡LPUSH key value [value\u0026hellip;]å‘Listé›†åˆä¸­å­˜æ”¾æ¶ˆæ¯ consumeré€šè¿‡ RPOP key ä»é›†åˆä¸­è·å–æ¶ˆæ¯ å¦‚ä½•produceræ²¡æœ‰ç”Ÿæˆæ¶ˆæ¯ï¼Œæ¶ˆæ¯é›†åˆä¸­ä¹Ÿæ²¡æœ‰æ•°æ®ï¼Œè€Œconsumerè¿˜æ˜¯ä¸€ç›´è¯»å–æ¶ˆæ¯ï¼Œä¼šé€ æˆcpuä¸å¿…è¦çš„cpuå ç”¨ï¼Œè¿™æ—¶å€™consumerå¯ä»¥ç”¨BRPOP(blocking right pop )ï¼ŒBRPOPå‘½ä»¤ä¹Ÿç§°ä¸ºé˜»å¡å¼è¯»å–ï¼Œå®¢æˆ·ç«¯åœ¨æ²¡æœ‰è¯»åˆ°é˜Ÿåˆ—æ•°æ®æ—¶ï¼Œè‡ªåŠ¨é˜»å¡ï¼Œç›´åˆ°æœ‰æ–°çš„æ•°æ®å†™å…¥é˜Ÿåˆ—ï¼Œå†å¼€å§‹è¯»å–æ–°æ•°æ®\nå¦‚ä½•å¤„ç†é‡å¤çš„æ¶ˆæ¯ï¼Ÿ\næ¶ˆè´¹è€…è¦å®ç°é‡å¤æ¶ˆæ¯çš„åˆ¤æ–­ï¼Œéœ€è¦ 2 ä¸ªæ–¹é¢çš„è¦æ±‚ï¼š\næ¯ä¸ªæ¶ˆæ¯éƒ½æœ‰ä¸€ä¸ªå…¨å±€çš„ IDã€‚ æ¶ˆè´¹è€…è¦è®°å½•å·²ç»å¤„ç†è¿‡çš„æ¶ˆæ¯çš„ ID å› ä¸ºlistä¸ä¼šç”Ÿæˆidï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è‡ªè¡Œç”Ÿæˆid\næˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°±æŠŠä¸€æ¡å…¨å±€ ID ä¸º 111000102ã€åº“å­˜é‡ä¸º 99 çš„æ¶ˆæ¯æ’å…¥äº†æ¶ˆæ¯é˜Ÿåˆ—ï¼š\n\u0026gt; LPUSH mq \u0026#34;111000102:stock:99\u0026#34; (integer) 1 List ä½œä¸ºæ¶ˆæ¯é˜Ÿåˆ—æœ‰ä»€ä¹ˆç¼ºé™·ï¼Ÿ\nList ä¸æ”¯æŒå¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹åŒä¸€æ¡æ¶ˆæ¯ï¼Œå› ä¸ºä¸€æ—¦æ¶ˆè´¹è€…æ‹‰å–ä¸€æ¡æ¶ˆæ¯åï¼Œè¿™æ¡æ¶ˆæ¯å°±ä» List ä¸­åˆ é™¤äº†ï¼Œæ— æ³•è¢«å…¶å®ƒæ¶ˆè´¹è€…å†æ¬¡æ¶ˆè´¹ã€‚\nè¦å®ç°ä¸€æ¡æ¶ˆæ¯å¯ä»¥è¢«å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œé‚£ä¹ˆå°±è¦å°†å¤šä¸ªæ¶ˆè´¹è€…ç»„æˆä¸€ä¸ªæ¶ˆè´¹ç»„ï¼Œä½¿å¾—å¤šä¸ªæ¶ˆè´¹è€…å¯ä»¥æ¶ˆè´¹åŒä¸€æ¡æ¶ˆæ¯ï¼Œä½†æ˜¯ List ç±»å‹å¹¶ä¸æ”¯æŒæ¶ˆè´¹ç»„çš„å®ç°ã€‚\nhash ä»‹ç» hashæ˜¯é”®å€¼å¯¹é›†åˆ(key-value) eg: value[{fields:,value},\u0026hellip;.]\nstringå’Œhashå¯¹æ¯”ï¼Œhashæ›´é€‚åˆç”¨æ¥å­˜å‚¨å¯¹è±¡\nå†…éƒ¨å®ç° Hashç±»å‹æ˜¯é€šè¿‡å‹ç¼©åˆ—è¡¨å’Œå“ˆå¸Œè¡¨å®ç°çš„åœ¨ Redis 7.0 ä¸­ï¼Œå‹ç¼©åˆ—è¡¨æ•°æ®ç»“æ„å·²ç»åºŸå¼ƒäº†ï¼Œäº¤ç”± listpack æ•°æ®ç»“æ„æ¥å®ç°äº†ã€‚\nå¦‚æœå“ˆå¸Œç±»å‹å…ƒç´ ä¸ªæ•°å°äº 512 ä¸ªï¼ˆé»˜è®¤å€¼ï¼Œå¯ç”± hash-max-ziplist-entries é…ç½®ï¼‰ï¼Œæ‰€æœ‰å€¼å°äº 64 å­—èŠ‚ï¼ˆé»˜è®¤å€¼ï¼Œå¯ç”± hash-max-ziplist-value é…ç½®ï¼‰çš„è¯ï¼ŒRedis ä¼šä½¿ç”¨å‹ç¼©åˆ—è¡¨ä½œä¸º Hash ç±»å‹çš„åº•å±‚æ•°æ®ç»“æ„ï¼› å¦‚æœå“ˆå¸Œç±»å‹å…ƒç´ ä¸æ»¡è¶³ä¸Šé¢æ¡ä»¶ï¼ŒRedis ä¼šä½¿ç”¨å“ˆå¸Œè¡¨ä½œä¸º Hash ç±»å‹çš„ åº•å±‚æ•°æ®ç»“æ„ã€‚ å¸¸ç”¨å‘½ä»¤ # å­˜å‚¨ä¸€ä¸ªå“ˆå¸Œè¡¨keyçš„é”®å€¼ HSET key field value # è·å–å“ˆå¸Œè¡¨keyå¯¹åº”çš„fieldé”®å€¼ HGET key field # åœ¨ä¸€ä¸ªå“ˆå¸Œè¡¨keyä¸­å­˜å‚¨å¤šä¸ªé”®å€¼å¯¹ HMSET key field value [field value...] # æ‰¹é‡è·å–å“ˆå¸Œè¡¨keyä¸­å¤šä¸ªfieldé”®å€¼ HMGET key field [field ...] # åˆ é™¤å“ˆå¸Œè¡¨keyä¸­çš„fieldé”®å€¼ HDEL key field [field ...] # è¿”å›å“ˆå¸Œè¡¨keyä¸­fieldçš„æ•°é‡ HLEN key # è¿”å›å“ˆå¸Œè¡¨keyä¸­æ‰€æœ‰çš„é”®å€¼ HGETALL key # ä¸ºå“ˆå¸Œè¡¨keyä¸­fieldé”®çš„å€¼åŠ ä¸Šå¢é‡n HINCRBY key field n åº”ç”¨åœºæ™¯ è´­ç‰©è½¦\nfield(å•†å“id) æ•°é‡(value) å¢åŠ æ•°é‡ï¼ˆHINCRBYï¼‰ key(ç”¨æˆ·id) è´­ç‰©è½¦æ•°é‡(hlen) å…¨é€‰(hgetall) ç”¨æˆ·id [{å•†å“idï¼Œæ•°é‡}\u0026hellip;.,{å•†å“id,æ•°é‡} ]\nset zset ","permalink":"https://XianCH.github.io/posts/tech/database/redis%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","summary":"\u003ch1 id=\"åŸºç¡€æ•°æ®ç±»å‹åŠè¿ç”¨åœºæ™¯\"\u003eåŸºç¡€æ•°æ®ç±»å‹åŠè¿ç”¨åœºæ™¯\u003c/h1\u003e\n\u003ch2 id=\"string\"\u003eString\u003c/h2\u003e\n\u003ch3 id=\"å¸¸ç”¨å‘½ä»¤\"\u003eå¸¸ç”¨å‘½ä»¤\u003c/h3\u003e\n\u003cp\u003eæ™®é€šå­—ç¬¦ä¸²çš„åŸºæœ¬æ“ä½œï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# è®¾ç½® key-value ç±»å‹çš„å€¼\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; SET name lin\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eOK\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# æ ¹æ® key è·å¾—å¯¹åº”çš„ value\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; GET name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lin\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# åˆ¤æ–­æŸä¸ª key æ˜¯å¦å­˜åœ¨\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; EXISTS name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003einteger\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# è¿”å› key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼çš„é•¿åº¦\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; STRLEN name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003einteger\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# åˆ é™¤æŸä¸ª key å¯¹åº”çš„å€¼\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; DEL name\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003einteger\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæ‰¹é‡è®¾ç½® :\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# æ‰¹é‡è®¾ç½® key-value ç±»å‹çš„å€¼\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; MSET key1 value1 key2 value2 \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eOK\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# æ‰¹é‡è·å–å¤šä¸ª key å¯¹åº”çš„ value\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u0026gt; MGET key1 key2 \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e1\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;value1\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e2\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;value2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eè®¡æ•°å™¨ï¼ˆå­—ç¬¦ä¸²çš„å†…å®¹ä¸ºæ•´æ•°çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ï¼‰ï¼š\u003c/p\u003e","title":"RedisåŸºç¡€çŸ¥è¯†å›é¡¾(æ›´æ–°ä¸­)"},{"content":"dockerå¸¸ç”¨å‘½ä»¤ å®¹å™¨ è¿›å…¥å®¹å™¨ docker exec -it contaionName /bin/bash æŸ¥çœ‹å®¹å™¨æ—¥å¿— docker logs -f contaionName # åœæ­¢è¿è¡Œçš„å®¹å™¨ docker stop [å®¹å™¨ID] # æ€æ­»å®¹å™¨è¿›ç¨‹ docker kill [å®¹å™¨ID] é•œåƒ å¯¼å‡ºé•œåƒ\ndocker save å¯¼å…¥é•œåƒ\ndocker load dockerå®‰è£…ç›¸å…³è½¯ä»¶ redis è¿è¡Œå®¹å™¨\ndocker run -itd --name redis-test -p 6379:6379 redis docker run --restart=always --log-opt max-size=100m --log-opt max-file=2 -p 6379:6379 --name myredis -v /home/redis/myredis/myredis.conf:/etc/redis/redis.conf -v /home/redis/myredis/data:/data -d redis redis-server /etc/redis/redis.conf --appendonly yes --requirepass 000415 å‚æ•°è¯´æ˜\n--restart=always æ€»æ˜¯å¼€æœºå¯åŠ¨ --logæ˜¯æ—¥å¿—æ–¹é¢çš„ -p 6379:6379 å°†6379ç«¯å£æŒ‚è½½å‡ºå» --name ç»™è¿™ä¸ªå®¹å™¨å–ä¸€ä¸ªåå­— -v æ•°æ®å·æŒ‚è½½ â€“appendonly yes å¼€å¯redis æŒä¹…åŒ– â€“requirepass 000415 è®¾ç½®å¯†ç  ï¼ˆ nacos ä¸‹è½½é•œåƒ\ndocker pull nacos/nacos-server:2.0.3 æŒ‚è½½ç›®å½•\nmkdir -p /usr/local/docker/nacos/conf mkdir -p /usr/local/docker/nacos/data mkdir -p /usr/local/docker/nacos/logs chmod a+w /usr/local/docker/nacos åœ¨/usr/local/docker/nacos/confç›®å½•ä¸‹æ–°å»ºapplication.propertiesæ–‡ä»¶\nåœ¨`/usr/local/docker/nacos/conf`ç›®å½•ä¸‹æ–°å»º`application.properties`æ–‡ä»¶ server.servlet.contextPath=/nacos server.port=8848 spring.datasource.platform=mysql ### Count of DB: db.num=1 ### Connect URL of DB: db.url.0=jdbc:mysql://192.168.164.101:3306/nacos?characterEncoding=utf8\u0026amp;connectTimeout=1000\u0026amp;socketTimeout=3000\u0026amp;autoReconnect=true\u0026amp;useUnicode=true\u0026amp;useSSL=false\u0026amp;serverTimezone=UTC db.user.0=root db.password.0=root ### Connection pool configuration: hikariCP db.pool.config.connectionTimeout=30000 db.pool.config.validationTimeout=10000 db.pool.config.maximumPoolSize=20 db.pool.config.minimumIdle=2 nacos.naming.empty-service.auto-clean=true nacos.naming.empty-service.clean.initial-delay-ms=50000 nacos.naming.empty-service.clean.period-time-ms=30000 server.tomcat.accesslog.enabled=true ### The access log pattern: server.tomcat.accesslog.pattern=%h %l %u %t \u0026#34;%r\u0026#34; %s %b %D %{User-Agent}i %{Request-Source}i nacos.security.ignore.urls=/,/error,/**/*.css,/**/*.js,/**/*.html,/**/*.map,/**/*.svg,/**/*.png,/**/*.ico,/console-ui/public/**,/v1/auth/**,/v1/console/health/**,/actuator/**,/v1/console/server/** ### The auth system to use, currently only \u0026#39;nacos\u0026#39; and \u0026#39;ldap\u0026#39; is supported: nacos.core.auth.system.type=nacos ### If turn on auth system: nacos.core.auth.enabled=false ### The token expiration in seconds: nacos.core.auth.default.token.expire.seconds=18000 ### The default token: nacos.core.auth.default.token.secret.key=SecretKey012345678901234567890123456789012345678901234567890123456789 nacos.core.auth.caching.enabled=true nacos.core.auth.enable.userAgentAuthWhite=false nacos.core.auth.server.identity.key=serverIdentity nacos.core.auth.server.identity.value=security nacos.istio.mcp.server.enabled=false åˆå§‹åŒ–nacosæ•°æ®åº“nacos.sql\næ”¾åˆ°confç›®å½•ä¸‹\n/* * Copyright 1999-2018 Alibaba Group Holding Ltd. * * Licensed under the Apache License, Version 2.0 (the \u0026#34;License\u0026#34;); * you may not use this file except in compliance with the License. * You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an \u0026#34;AS IS\u0026#34; BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */ /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = config_info */ /******************************************/ CREATE TABLE `config_info` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT \u0026#39;id\u0026#39;, `data_id` varchar(255) NOT NULL COMMENT \u0026#39;data_id\u0026#39;, `group_id` varchar(255) DEFAULT NULL, `content` longtext NOT NULL COMMENT \u0026#39;content\u0026#39;, `md5` varchar(32) DEFAULT NULL COMMENT \u0026#39;md5\u0026#39;, `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT \u0026#39;åˆ›å»ºæ—¶é—´\u0026#39;, `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT \u0026#39;ä¿®æ”¹æ—¶é—´\u0026#39;, `src_user` text COMMENT \u0026#39;source user\u0026#39;, `src_ip` varchar(50) DEFAULT NULL COMMENT \u0026#39;source ip\u0026#39;, `app_name` varchar(128) DEFAULT NULL, `tenant_id` varchar(128) DEFAULT \u0026#39;\u0026#39; COMMENT \u0026#39;ç§Ÿæˆ·å­—æ®µ\u0026#39;, `c_desc` varchar(256) DEFAULT NULL, `c_use` varchar(64) DEFAULT NULL, `effect` varchar(64) DEFAULT NULL, `type` varchar(64) DEFAULT NULL, `c_schema` text, PRIMARY KEY (`id`), UNIQUE KEY `uk_configinfo_datagrouptenant` (`data_id`,`group_id`,`tenant_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=\u0026#39;config_info\u0026#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = config_info_aggr */ /******************************************/ CREATE TABLE `config_info_aggr` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT \u0026#39;id\u0026#39;, `data_id` varchar(255) NOT NULL COMMENT \u0026#39;data_id\u0026#39;, `group_id` varchar(255) NOT NULL COMMENT \u0026#39;group_id\u0026#39;, `datum_id` varchar(255) NOT NULL COMMENT \u0026#39;datum_id\u0026#39;, `content` longtext NOT NULL COMMENT \u0026#39;å†…å®¹\u0026#39;, `gmt_modified` datetime NOT NULL COMMENT \u0026#39;ä¿®æ”¹æ—¶é—´\u0026#39;, `app_name` varchar(128) DEFAULT NULL, `tenant_id` varchar(128) DEFAULT \u0026#39;\u0026#39; COMMENT \u0026#39;ç§Ÿæˆ·å­—æ®µ\u0026#39;, PRIMARY KEY (`id`), UNIQUE KEY `uk_configinfoaggr_datagrouptenantdatum` (`data_id`,`group_id`,`tenant_id`,`datum_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=\u0026#39;å¢åŠ ç§Ÿæˆ·å­—æ®µ\u0026#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = config_info_beta */ /******************************************/ CREATE TABLE `config_info_beta` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT \u0026#39;id\u0026#39;, `data_id` varchar(255) NOT NULL COMMENT \u0026#39;data_id\u0026#39;, `group_id` varchar(128) NOT NULL COMMENT \u0026#39;group_id\u0026#39;, `app_name` varchar(128) DEFAULT NULL COMMENT \u0026#39;app_name\u0026#39;, `content` longtext NOT NULL COMMENT \u0026#39;content\u0026#39;, `beta_ips` varchar(1024) DEFAULT NULL COMMENT \u0026#39;betaIps\u0026#39;, `md5` varchar(32) DEFAULT NULL COMMENT \u0026#39;md5\u0026#39;, `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT \u0026#39;åˆ›å»ºæ—¶é—´\u0026#39;, `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT \u0026#39;ä¿®æ”¹æ—¶é—´\u0026#39;, `src_user` text COMMENT \u0026#39;source user\u0026#39;, `src_ip` varchar(50) DEFAULT NULL COMMENT \u0026#39;source ip\u0026#39;, `tenant_id` varchar(128) DEFAULT \u0026#39;\u0026#39; COMMENT \u0026#39;ç§Ÿæˆ·å­—æ®µ\u0026#39;, PRIMARY KEY (`id`), UNIQUE KEY `uk_configinfobeta_datagrouptenant` (`data_id`,`group_id`,`tenant_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=\u0026#39;config_info_beta\u0026#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = config_info_tag */ /******************************************/ CREATE TABLE `config_info_tag` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT \u0026#39;id\u0026#39;, `data_id` varchar(255) NOT NULL COMMENT \u0026#39;data_id\u0026#39;, `group_id` varchar(128) NOT NULL COMMENT \u0026#39;group_id\u0026#39;, `tenant_id` varchar(128) DEFAULT \u0026#39;\u0026#39; COMMENT \u0026#39;tenant_id\u0026#39;, `tag_id` varchar(128) NOT NULL COMMENT \u0026#39;tag_id\u0026#39;, `app_name` varchar(128) DEFAULT NULL COMMENT \u0026#39;app_name\u0026#39;, `content` longtext NOT NULL COMMENT \u0026#39;content\u0026#39;, `md5` varchar(32) DEFAULT NULL COMMENT \u0026#39;md5\u0026#39;, `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT \u0026#39;åˆ›å»ºæ—¶é—´\u0026#39;, `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT \u0026#39;ä¿®æ”¹æ—¶é—´\u0026#39;, `src_user` text COMMENT \u0026#39;source user\u0026#39;, `src_ip` varchar(50) DEFAULT NULL COMMENT \u0026#39;source ip\u0026#39;, PRIMARY KEY (`id`), UNIQUE KEY `uk_configinfotag_datagrouptenanttag` (`data_id`,`group_id`,`tenant_id`,`tag_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=\u0026#39;config_info_tag\u0026#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = config_tags_relation */ /******************************************/ CREATE TABLE `config_tags_relation` ( `id` bigint(20) NOT NULL COMMENT \u0026#39;id\u0026#39;, `tag_name` varchar(128) NOT NULL COMMENT \u0026#39;tag_name\u0026#39;, `tag_type` varchar(64) DEFAULT NULL COMMENT \u0026#39;tag_type\u0026#39;, `data_id` varchar(255) NOT NULL COMMENT \u0026#39;data_id\u0026#39;, `group_id` varchar(128) NOT NULL COMMENT \u0026#39;group_id\u0026#39;, `tenant_id` varchar(128) DEFAULT \u0026#39;\u0026#39; COMMENT \u0026#39;tenant_id\u0026#39;, `nid` bigint(20) NOT NULL AUTO_INCREMENT, PRIMARY KEY (`nid`), UNIQUE KEY `uk_configtagrelation_configidtag` (`id`,`tag_name`,`tag_type`), KEY `idx_tenant_id` (`tenant_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=\u0026#39;config_tag_relation\u0026#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = group_capacity */ /******************************************/ CREATE TABLE `group_capacity` ( `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT \u0026#39;ä¸»é”®ID\u0026#39;, `group_id` varchar(128) NOT NULL DEFAULT \u0026#39;\u0026#39; COMMENT \u0026#39;Group IDï¼Œç©ºå­—ç¬¦è¡¨ç¤ºæ•´ä¸ªé›†ç¾¤\u0026#39;, `quota` int(10) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;é…é¢ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼\u0026#39;, `usage` int(10) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;ä½¿ç”¨é‡\u0026#39;, `max_size` int(10) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;å•ä¸ªé…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼\u0026#39;, `max_aggr_count` int(10) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;èšåˆå­é…ç½®æœ€å¤§ä¸ªæ•°ï¼Œï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼\u0026#39;, `max_aggr_size` int(10) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;å•ä¸ªèšåˆæ•°æ®çš„å­é…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼\u0026#39;, `max_history_count` int(10) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;æœ€å¤§å˜æ›´å†å²æ•°é‡\u0026#39;, `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT \u0026#39;åˆ›å»ºæ—¶é—´\u0026#39;, `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT \u0026#39;ä¿®æ”¹æ—¶é—´\u0026#39;, PRIMARY KEY (`id`), UNIQUE KEY `uk_group_id` (`group_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=\u0026#39;é›†ç¾¤ã€å„Groupå®¹é‡ä¿¡æ¯è¡¨\u0026#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = his_config_info */ /******************************************/ CREATE TABLE `his_config_info` ( `id` bigint(64) unsigned NOT NULL, `nid` bigint(20) unsigned NOT NULL AUTO_INCREMENT, `data_id` varchar(255) NOT NULL, `group_id` varchar(128) NOT NULL, `app_name` varchar(128) DEFAULT NULL COMMENT \u0026#39;app_name\u0026#39;, `content` longtext NOT NULL, `md5` varchar(32) DEFAULT NULL, `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP, `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP, `src_user` text, `src_ip` varchar(50) DEFAULT NULL, `op_type` char(10) DEFAULT NULL, `tenant_id` varchar(128) DEFAULT \u0026#39;\u0026#39; COMMENT \u0026#39;ç§Ÿæˆ·å­—æ®µ\u0026#39;, PRIMARY KEY (`nid`), KEY `idx_gmt_create` (`gmt_create`), KEY `idx_gmt_modified` (`gmt_modified`), KEY `idx_did` (`data_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=\u0026#39;å¤šç§Ÿæˆ·æ”¹é€ \u0026#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = tenant_capacity */ /******************************************/ CREATE TABLE `tenant_capacity` ( `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT \u0026#39;ä¸»é”®ID\u0026#39;, `tenant_id` varchar(128) NOT NULL DEFAULT \u0026#39;\u0026#39; COMMENT \u0026#39;Tenant ID\u0026#39;, `quota` int(10) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;é…é¢ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼\u0026#39;, `usage` int(10) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;ä½¿ç”¨é‡\u0026#39;, `max_size` int(10) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;å•ä¸ªé…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼\u0026#39;, `max_aggr_count` int(10) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;èšåˆå­é…ç½®æœ€å¤§ä¸ªæ•°\u0026#39;, `max_aggr_size` int(10) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;å•ä¸ªèšåˆæ•°æ®çš„å­é…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼\u0026#39;, `max_history_count` int(10) unsigned NOT NULL DEFAULT \u0026#39;0\u0026#39; COMMENT \u0026#39;æœ€å¤§å˜æ›´å†å²æ•°é‡\u0026#39;, `gmt_create` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT \u0026#39;åˆ›å»ºæ—¶é—´\u0026#39;, `gmt_modified` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT \u0026#39;ä¿®æ”¹æ—¶é—´\u0026#39;, PRIMARY KEY (`id`), UNIQUE KEY `uk_tenant_id` (`tenant_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=\u0026#39;ç§Ÿæˆ·å®¹é‡ä¿¡æ¯è¡¨\u0026#39;; CREATE TABLE `tenant_info` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT \u0026#39;id\u0026#39;, `kp` varchar(128) NOT NULL COMMENT \u0026#39;kp\u0026#39;, `tenant_id` varchar(128) default \u0026#39;\u0026#39; COMMENT \u0026#39;tenant_id\u0026#39;, `tenant_name` varchar(128) default \u0026#39;\u0026#39; COMMENT \u0026#39;tenant_name\u0026#39;, `tenant_desc` varchar(256) DEFAULT NULL COMMENT \u0026#39;tenant_desc\u0026#39;, `create_source` varchar(32) DEFAULT NULL COMMENT \u0026#39;create_source\u0026#39;, `gmt_create` bigint(20) NOT NULL COMMENT \u0026#39;åˆ›å»ºæ—¶é—´\u0026#39;, `gmt_modified` bigint(20) NOT NULL COMMENT \u0026#39;ä¿®æ”¹æ—¶é—´\u0026#39;, PRIMARY KEY (`id`), UNIQUE KEY `uk_tenant_info_kptenantid` (`kp`,`tenant_id`), KEY `idx_tenant_id` (`tenant_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=\u0026#39;tenant_info\u0026#39;; CREATE TABLE `users` ( `username` varchar(50) NOT NULL PRIMARY KEY, `password` varchar(500) NOT NULL, `enabled` boolean NOT NULL ); CREATE TABLE `roles` ( `username` varchar(50) NOT NULL, `role` varchar(50) NOT NULL, UNIQUE INDEX `idx_user_role` (`username` ASC, `role` ASC) USING BTREE ); CREATE TABLE `permissions` ( `role` varchar(50) NOT NULL, `resource` varchar(255) NOT NULL, `action` varchar(8) NOT NULL, UNIQUE INDEX `uk_role_permission` (`role`,`resource`,`action`) USING BTREE ); INSERT INTO users (username, password, enabled) VALUES (\u0026#39;nacos\u0026#39;, \u0026#39;$2a$10$EuWPZHzz32dJN7jexM34MOeYirDdFAZm2kuWj7VEOJhhZkDrxfvUu\u0026#39;, TRUE); INSERT INTO roles (username, role) VALUES (\u0026#39;nacos\u0026#39;, \u0026#39;ROLE_ADMIN\u0026#39;); è¿è¡Œ\ndocker run -it --name nacos \\ -p 8848:8848 \\ -e MODE=standalone \\ -v /usr/local/docker/nacos/conf/application.properties:/home/nacos/conf/application.properties \\ -v /usr/local/docker/nacos/conf/data:/home/nacos/conf/data \\ -v /usr/local/docker/nacos/conf/logs:/home/nacos/conf/logs \\ -d nacos/nacos-server:2.0.3 mysql docker run -d --name=mysql-server -p 3306:3306 -v mysql-data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=your_password mysql docker run -d --name=mysql-server -p 3306:3306 -e MYSQL_ROOT_PASSWORD=your_password mysql nginx Nginx é…ç½®æ–‡ä»¶ï¼šä½ é€šå¸¸ä¼šæƒ³è¦è‡ªå®šä¹‰ Nginx çš„é…ç½®ã€‚ä½ å¯ä»¥å°†è‡ªå®šä¹‰çš„ Nginx é…ç½®æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨å†…ï¼Œä»¥è¦†ç›–é»˜è®¤é…ç½®ã€‚ä½ å¯ä»¥ä½¿ç”¨ -v æ ‡å¿—æ¥æŒ‚è½½ä¸»æœºä¸Šçš„é…ç½®æ–‡ä»¶åˆ°å®¹å™¨å†…ï¼Œå°±åƒä¸Šé¢çš„ç¤ºä¾‹æ‰€ç¤ºã€‚è¿™æ ·ï¼Œä½ å¯ä»¥åœ¨ä¸»æœºä¸Šç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œç„¶åå®¹å™¨å°†ä½¿ç”¨ä½ çš„è‡ªå®šä¹‰é…ç½®ã€‚\ndocker run -d -p 80:80 -v /host/path/nginx.conf:/etc/nginx/nginx.conf:ro nginx ç½‘ç«™å†…å®¹ï¼šå¦‚æœä½ è¦æä¾›é™æ€ç½‘é¡µæˆ–å…¶ä»–æ–‡ä»¶ï¼Œä½ å¯ä»¥å°†è¿™äº›æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨å†…çš„ Nginx æ ¹ç›®å½•ä¸­ã€‚è¿™é€šå¸¸å‘ç”Ÿåœ¨æŒ‚è½½ä¸€ä¸ªç›®å½•ï¼Œå…¶ä¸­åŒ…å«ä½ çš„ç½‘ç«™æ–‡ä»¶ã€‚\ndocker run -d -p 80:80 -v /host/path/html:/usr/share/nginx/html nginx SSL è¯ä¹¦ï¼šå¦‚æœä½ ä½¿ç”¨ HTTPSï¼Œä½ éœ€è¦æä¾› SSL è¯ä¹¦å’Œå¯†é’¥ã€‚ä½ å¯ä»¥å°† SSL è¯ä¹¦æŒ‚è½½åˆ°å®¹å™¨å†…çš„é€‚å½“ä½ç½®ï¼Œä»¥ä¾¿ Nginx å¯ä»¥ä½¿ç”¨å®ƒä»¬ã€‚\ndocker run -d -p 443:443 -v /host/path/certs:/etc/nginx/certs nginx æ—¥å¿—æ–‡ä»¶ï¼šå¦‚æœä½ æƒ³åœ¨ä¸»æœºä¸Šä¿å­˜ Nginx çš„è®¿é—®æ—¥å¿—å’Œé”™è¯¯æ—¥å¿—ï¼Œä½ å¯ä»¥æŒ‚è½½ä¸€ä¸ªç›®å½•ä»¥ä¾¿å®¹å™¨å¯ä»¥å°†æ—¥å¿—æ–‡ä»¶å†™å…¥è¯¥ç›®å½•ã€‚\ndocker run -d -p 80:80 -v /host/path/logs:/var/log/nginx nginx æ‹‰å–é•œåƒ\ndocker pull nginx:latest è¿è¡Œé•œåƒ\ndocker run --name nginx -p 80:80 -d nginx åˆ›å»ºæŒ‚è½½ç›®å½•\nmkdir -p ~/Documents/dockerdata/nginx/conf / mkdir -p ~/Documents/dockerdata/nginx/conf.d / mkdir -p ~/Documents/dockerdata/nginx/html / mkdir -p ~/Documents/dockerdata/nginx/log / æ‹·è´å®¹å™¨é‡Œé¢çš„å†…å®¹\ndocker cp nginx:/etc/nginx/nginx.conf ~/Documents/dockerdata/nginx/conf/nginx.conf / docker cp nginx:/etc/nginx/conf.d ~/Documents/dockerdata/nginx / docker cp nginx:/usr/share/nginx/html ~/Documents/dockerdata/nginx / åœæ­¢å¹¶å…³é—­å®¹å™¨\ndocker rm -f nginx é‡æ–°å¯åŠ¨å®¹å™¨\ndocker run --name nginx -p 80:80 --privileged --restart=always \\ -v ~/Documents/dockerdata/nginx/conf/nginx.conf:/etc/nginx/nginx.conf:rw \\ -v ~/Documents/dockerdata/nginx/conf.d:/etc/nginx/conf.d:rw \\ -v ~/Documents/dockerdata/nginx/html:/usr/share/nginx/html:rw \\ -v ~/Documents/dockerdata/nginx/log:/var/log/nginx \\ -d nginx portainer docker network disconnect bridge mysql-server docker network connect portainer-net mysql-server docker network inspect bridge docker network create portainer-net docker run -d -p 9000:9000 --name=portainer --restart=always \\ -v /var/run/docker.sock:/var/run/docker.sock \\ -v portainer_data:/data --network portainer-net portainer/portainer-ce ","permalink":"https://XianCH.github.io/posts/tech/tool/docker%E5%A4%87%E5%BF%98%E5%BD%95/","summary":"\u003ch1 id=\"dockerå¸¸ç”¨å‘½ä»¤\"\u003edockerå¸¸ç”¨å‘½ä»¤\u003c/h1\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://ask.qcloudimg.com/http-save/yehe-7565276/6lldlbgfhn.png\" alt=\"Docker\"  /\u003e\n\u003c/p\u003e\n\u003ch2 id=\"å®¹å™¨\"\u003eå®¹å™¨\u003c/h2\u003e\n\u003ch3 id=\"è¿›å…¥å®¹å™¨\"\u003eè¿›å…¥å®¹å™¨\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker exec -it contaionName /bin/bash\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"æŸ¥çœ‹å®¹å™¨æ—¥å¿—\"\u003eæŸ¥çœ‹å®¹å™¨æ—¥å¿—\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker logs -f contaionName\n\u003c/code\u003e\u003c/pre\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e#\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eåœæ­¢è¿è¡Œçš„å®¹å™¨\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edocker\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003estop\u003c/span\u003e [\u003cspan style=\"color:#a6e22e\"\u003eå®¹å™¨ID\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e#\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eæ€æ­»å®¹å™¨è¿›ç¨‹\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edocker\u003c/span\u003e  \u003cspan style=\"color:#a6e22e\"\u003ekill\u003c/span\u003e [\u003cspan style=\"color:#a6e22e\"\u003eå®¹å™¨ID\u003c/span\u003e] \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"é•œåƒ\"\u003eé•œåƒ\u003c/h2\u003e\n\u003cp\u003eå¯¼å‡ºé•œåƒ\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker save\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eå¯¼å…¥é•œåƒ\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker load\n\u003c/code\u003e\u003c/pre\u003e\u003ch1 id=\"dockerå®‰è£…ç›¸å…³è½¯ä»¶\"\u003edockerå®‰è£…ç›¸å…³è½¯ä»¶\u003c/h1\u003e\n\u003ch2 id=\"redis\"\u003eredis\u003c/h2\u003e\n\u003cp\u003eè¿è¡Œå®¹å™¨\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker run -itd --name redis-test -p 6379:6379 redis\n\u003c/code\u003e\u003c/pre\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker run --restart=always --log-opt max-size=100m --log-opt max-file=2 -p 6379:6379 --name myredis -v /home/redis/myredis/myredis.conf:/etc/redis/redis.conf -v /home/redis/myredis/data:/data -d redis redis-server /etc/redis/redis.conf  --appendonly yes  --requirepass 000415\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eå‚æ•°è¯´æ˜\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e--restart=always æ€»æ˜¯å¼€æœºå¯åŠ¨\n--logæ˜¯æ—¥å¿—æ–¹é¢çš„\n-p 6379:6379 å°†6379ç«¯å£æŒ‚è½½å‡ºå»\n--name ç»™è¿™ä¸ªå®¹å™¨å–ä¸€ä¸ªåå­—\n-v æ•°æ®å·æŒ‚è½½\nâ€“appendonly yes å¼€å¯redis æŒä¹…åŒ–\nâ€“requirepass 000415 è®¾ç½®å¯†ç  ï¼ˆ\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"nacos\"\u003enacos\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eä¸‹è½½é•œåƒ\u003c/p\u003e","title":"Dockerå¤‡å¿˜å½•"},{"content":"goåŸºç¡€å­¦ä¹ ç¬”è®° 1. å‘½ä»¤ $ go Go is a tool for managing Go source code. Usage: go command [arguments] The commands are: build compile packages and dependencies clean remove object files doc show documentation for package or symbol env print Go environment information bug start a bug report fix run go tool fix on packages fmt run gofmt on package sources generate generate Go files by processing source get download and install packages and dependencies install compile and install packages and dependencies list list packages run compile and run Go program test test packages tool run specified go tool version print Go version vet run go tool vet on packages Use \u0026#34;go help [command]\u0026#34; for more information about a command. Additional help topics: c calling between Go and C buildmode description of build modes filetype file types gopath GOPATH environment variable environment environment variables importpath import path syntax packages description of package lists testflag description of testing flags testfunc description of testing functions Use \u0026#34;go help [topic]\u0026#34; for more information about that topic. go envç”¨äºæ‰“å°Goè¯­è¨€çš„ç¯å¢ƒä¿¡æ¯ã€‚\ngo runå‘½ä»¤å¯ä»¥ç¼–è¯‘å¹¶è¿è¡Œå‘½ä»¤æºç æ–‡ä»¶ã€‚\ngo getå¯ä»¥æ ¹æ®è¦æ±‚å’Œå®é™…æƒ…å†µä»äº’è”ç½‘ä¸Šä¸‹è½½æˆ–æ›´æ–°æŒ‡å®šçš„ä»£ç åŒ…åŠå…¶ä¾èµ–åŒ…ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œç¼–è¯‘å’Œå®‰è£…ã€‚\ngo buildå‘½ä»¤ç”¨äºç¼–è¯‘æˆ‘ä»¬æŒ‡å®šçš„æºç æ–‡ä»¶æˆ–ä»£ç åŒ…ä»¥åŠå®ƒä»¬çš„ä¾èµ–åŒ…ã€‚\ngo installç”¨äºç¼–è¯‘å¹¶å®‰è£…æŒ‡å®šçš„ä»£ç åŒ…åŠå®ƒä»¬çš„ä¾èµ–åŒ…ã€‚\ngo cleanå‘½ä»¤ä¼šåˆ é™¤æ‰æ‰§è¡Œå…¶å®ƒå‘½ä»¤æ—¶äº§ç”Ÿçš„ä¸€äº›æ–‡ä»¶å’Œç›®å½•ã€‚\ngo docå‘½ä»¤å¯ä»¥æ‰“å°é™„äºGoè¯­è¨€ç¨‹åºå®ä½“ä¸Šçš„æ–‡æ¡£ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æŠŠç¨‹åºå®ä½“çš„æ ‡è¯†ç¬¦ä½œä¸ºè¯¥å‘½ä»¤çš„å‚æ•°æ¥è¾¾åˆ°æŸ¥çœ‹å…¶æ–‡æ¡£çš„ç›®çš„ã€‚\ngo testå‘½ä»¤ç”¨äºå¯¹Goè¯­è¨€ç¼–å†™çš„ç¨‹åºè¿›è¡Œæµ‹è¯•ã€‚\ngo listå‘½ä»¤çš„ä½œç”¨æ˜¯åˆ—å‡ºæŒ‡å®šçš„ä»£ç åŒ…çš„ä¿¡æ¯ã€‚\ngo fixä¼šæŠŠæŒ‡å®šä»£ç åŒ…çš„æ‰€æœ‰Goè¯­è¨€æºç æ–‡ä»¶ä¸­çš„æ—§ç‰ˆæœ¬ä»£ç ä¿®æ­£ä¸ºæ–°ç‰ˆæœ¬çš„ä»£ç ã€‚\ngo vetæ˜¯ä¸€ä¸ªç”¨äºæ£€æŸ¥Goè¯­è¨€æºç ä¸­é™æ€é”™è¯¯çš„ç®€å•å·¥å…·ã€‚\ngo tool pprofå‘½ä»¤æ¥äº¤äº’å¼çš„è®¿é—®æ¦‚è¦æ–‡ä»¶çš„å†…å®¹ã€‚\n2. è¿ç®—ç¬¦ 1.ç®—æ•°è¿ç®—ç¬¦\nè¿ç®—ç¬¦ ä½œç”¨ + ç›¸åŠ  - å‡ * ä¹˜ / é™¤ % æ±‚ä½™ 2.é€»è¾‘è¿ç®—ç¬¦\nè¿ç®—ç¬¦ æè¿° \u0026amp;\u0026amp; é€»è¾‘ AND è¿ç®—ç¬¦ã€‚ å¦‚æœä¸¤è¾¹çš„æ“ä½œæ•°éƒ½æ˜¯ Trueï¼Œåˆ™ä¸º Trueï¼Œå¦åˆ™ä¸º Falseã€‚ ll é€»è¾‘ OR è¿ç®—ç¬¦ã€‚ å¦‚æœä¸¤è¾¹çš„æ“ä½œæ•°æœ‰ä¸€ä¸ª Trueï¼Œåˆ™ä¸º Trueï¼Œå¦åˆ™ä¸º Falseã€‚ ! é€»è¾‘ NOT è¿ç®—ç¬¦ã€‚ å¦‚æœæ¡ä»¶ä¸º Trueï¼Œåˆ™ä¸º Falseï¼Œå¦åˆ™ä¸º True 3.ä½è¿ç®—ç¬¦\nè¿ç®—ç¬¦ æè¿° \u0026amp; å‚ä¸è¿ç®—çš„ä¸¤æ•°å„å¯¹åº”çš„äºŒè¿›ä½ç›¸ä¸ã€‚ï¼ˆä¸¤ä½å‡ä¸º1æ‰ä¸º1ï¼‰ l å‚ä¸è¿ç®—çš„ä¸¤æ•°å„å¯¹åº”çš„äºŒè¿›ä½ç›¸æˆ–ã€‚ï¼ˆä¸¤ä½æœ‰ä¸€ä¸ªä¸º1å°±ä¸º1ï¼‰ ^ å‚ä¸è¿ç®—çš„ä¸¤æ•°å„å¯¹åº”çš„äºŒè¿›ä½ç›¸å¼‚æˆ–ï¼Œå½“ä¸¤å¯¹åº”çš„äºŒè¿›ä½ç›¸å¼‚æ—¶ï¼Œç»“æœä¸º1ã€‚ï¼ˆä¸¤ä½ä¸ä¸€æ ·åˆ™ä¸º1ï¼‰ \u0026laquo; å·¦ç§»nä½å°±æ˜¯ä¹˜ä»¥2çš„næ¬¡æ–¹ã€‚â€œa\u0026laquo;bâ€æ˜¯æŠŠaçš„å„äºŒè¿›ä½å…¨éƒ¨å·¦ç§»bä½ï¼Œé«˜ä½ä¸¢å¼ƒï¼Œä½ä½è¡¥0ã€‚ \u0026gt;\u0026gt; å³ç§»nä½å°±æ˜¯é™¤ä»¥2çš„næ¬¡æ–¹ã€‚â€œa\u0026raquo;bâ€æ˜¯æŠŠaçš„å„äºŒè¿›ä½å…¨éƒ¨å³ç§»bä½ã€‚ 4.èµ‹å€¼è¿ç®—ç¬¦\nè¿ç®—ç¬¦ æè¿° = ç®€å•çš„èµ‹å€¼è¿ç®—ç¬¦ï¼Œå°†ä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼èµ‹ç»™ä¸€ä¸ªå·¦å€¼ += ç›¸åŠ åå†èµ‹å€¼ -= ç›¸å‡åå†èµ‹å€¼ *= ç›¸ä¹˜åå†èµ‹å€¼ /= ç›¸é™¤åå†èµ‹å€¼ %= æ±‚ä½™åå†èµ‹å€¼ \u0026laquo;= å·¦ç§»åèµ‹å€¼ \u0026gt;\u0026gt;= å³ç§»åèµ‹å€¼ \u0026amp;= æŒ‰ä½ä¸åèµ‹å€¼ l= æŒ‰ä½æˆ–åèµ‹å€¼ ^= æŒ‰ä½å¼‚æˆ–åèµ‹å€¼ 3. init å’Œ mainå‡½æ•° initå‡½æ•°\ngoè¯­è¨€ä¸­initå‡½æ•°ç”¨äºåŒ…(package)çš„åˆå§‹åŒ–ï¼Œè¯¥å‡½æ•°æ˜¯goè¯­è¨€çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ã€‚\næœ‰ä¸‹é¢çš„ç‰¹å¾ï¼š\n1 initå‡½æ•°æ˜¯ç”¨äºç¨‹åºæ‰§è¡Œå‰åšåŒ…çš„åˆå§‹åŒ–çš„å‡½æ•°ï¼Œæ¯”å¦‚åˆå§‹åŒ–åŒ…é‡Œçš„å˜é‡ç­‰ 2 æ¯ä¸ªåŒ…å¯ä»¥æ‹¥æœ‰å¤šä¸ªinitå‡½æ•° 3 åŒ…çš„æ¯ä¸ªæºæ–‡ä»¶ä¹Ÿå¯ä»¥æ‹¥æœ‰å¤šä¸ªinitå‡½æ•° 4 åŒä¸€ä¸ªåŒ…ä¸­å¤šä¸ªinitå‡½æ•°çš„æ‰§è¡Œé¡ºåºgoè¯­è¨€æ²¡æœ‰æ˜ç¡®çš„å®šä¹‰(è¯´æ˜) 5 ä¸åŒåŒ…çš„initå‡½æ•°æŒ‰ç…§åŒ…å¯¼å…¥çš„ä¾èµ–å…³ç³»å†³å®šè¯¥åˆå§‹åŒ–å‡½æ•°çš„æ‰§è¡Œé¡ºåº 6 initå‡½æ•°ä¸èƒ½è¢«å…¶ä»–å‡½æ•°è°ƒç”¨ï¼Œè€Œæ˜¯åœ¨mainå‡½æ•°æ‰§è¡Œä¹‹å‰ï¼Œè‡ªåŠ¨è¢«è°ƒç”¨ 1.2. mainå‡½æ•°\nGoè¯­è¨€ç¨‹åºçš„é»˜è®¤å…¥å£å‡½æ•°(ä¸»å‡½æ•°)ï¼šfunc main() å‡½æ•°ä½“ç”¨ï½›ï½ä¸€å¯¹æ‹¬å·åŒ…è£¹ã€‚ func main(){ //å‡½æ•°ä½“ } 1.3. initå‡½æ•°å’Œmainå‡½æ•°çš„å¼‚åŒ\nç›¸åŒç‚¹ï¼š ä¸¤ä¸ªå‡½æ•°åœ¨å®šä¹‰æ—¶ä¸èƒ½æœ‰ä»»ä½•çš„å‚æ•°å’Œè¿”å›å€¼ï¼Œä¸”Goç¨‹åºè‡ªåŠ¨è°ƒç”¨ã€‚ ä¸åŒç‚¹ï¼š initå¯ä»¥åº”ç”¨äºä»»æ„åŒ…ä¸­ï¼Œä¸”å¯ä»¥é‡å¤å®šä¹‰å¤šä¸ªã€‚ mainå‡½æ•°åªèƒ½ç”¨äºmainåŒ…ä¸­ï¼Œä¸”åªèƒ½å®šä¹‰ä¸€ä¸ªã€‚ ä¸¤ä¸ªå‡½æ•°çš„æ‰§è¡Œé¡ºåºï¼š\nå¯¹åŒä¸€ä¸ªgoæ–‡ä»¶çš„init()è°ƒç”¨é¡ºåºæ˜¯ä»ä¸Šåˆ°ä¸‹çš„ã€‚\nå¯¹åŒä¸€ä¸ªpackageä¸­ä¸åŒæ–‡ä»¶æ˜¯æŒ‰æ–‡ä»¶åå­—ç¬¦ä¸²æ¯”è¾ƒä»å°åˆ°å¤§é¡ºåºè°ƒç”¨å„æ–‡ä»¶ä¸­çš„init()å‡½æ•°ã€‚\nå¯¹äºä¸åŒçš„packageï¼Œå¦‚æœä¸ç›¸äº’ä¾èµ–çš„è¯ï¼ŒæŒ‰ç…§mainåŒ…ä¸­\u0026quot;å…ˆimportçš„åè°ƒç”¨\u0026quot;çš„é¡ºåºè°ƒç”¨å…¶åŒ…ä¸­çš„init()ï¼Œå¦‚æœpackageå­˜åœ¨ä¾èµ–ï¼Œåˆ™å…ˆè°ƒç”¨æœ€æ—©è¢«ä¾èµ–çš„packageä¸­çš„init()ï¼Œæœ€åè°ƒç”¨mainå‡½æ•°ã€‚\nå¦‚æœinitå‡½æ•°ä¸­ä½¿ç”¨äº†println()æˆ–è€…print()ä½ ä¼šå‘ç°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­è¿™ä¸¤ä¸ªä¸ä¼šæŒ‰ç…§ä½ æƒ³è±¡ä¸­çš„é¡ºåºæ‰§è¡Œã€‚è¿™ä¸¤ä¸ªå‡½æ•°å®˜æ–¹åªæ¨èåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¯¹äºæ­£å¼ç¯å¢ƒä¸è¦ä½¿ç”¨ã€‚\n4. å˜é‡å’Œå¸¸é‡ å˜é‡ æ ‡å‡†å£°æ˜\nvar å˜é‡å å˜é‡ç±»å‹\nvar name string var age int var isOk bool æ‰¹é‡å£°æ˜\nvar ( a string b int c bool d float32 ) å˜é‡åˆå§‹åŒ–\nvar å˜é‡å ç±»å‹ = è¡¨è¾¾å¼\nvar name string = \u0026#34;pprof.cn\u0026#34; var sex int = 1 3.1 å˜é‡æ¨å€’å£°æ˜\nvar name = \u0026#34;pprof.cn\u0026#34; var sex = 1 3.2 çŸ­å˜é‡å£°æ˜\npackage main import ( \u0026#34;fmt\u0026#34; ) // å…¨å±€å˜é‡m var m = 100 func main() { n := 10 m := 200 // æ­¤å¤„å£°æ˜å±€éƒ¨å˜é‡m fmt.Println(m, n) } 3.3 åŒ¿åå˜é‡\nåœ¨ä½¿ç”¨å¤šé‡èµ‹å€¼æ—¶ï¼Œå¦‚æœæƒ³è¦å¿½ç•¥æŸä¸ªå€¼ï¼Œå¯ä»¥ä½¿ç”¨\nåŒ¿åå˜é‡ï¼ˆanonymous variableï¼‰ ã€‚ åŒ¿åå˜é‡ç”¨ä¸€ä¸ªä¸‹åˆ’çº¿_è¡¨ç¤ºï¼Œä¾‹å¦‚ï¼š\nfunc foo() (int, string) { return 10, \u0026#34;Q1mi\u0026#34; } func main() { x, _ := foo() _, y := foo() fmt.Println(\u0026#34;x=\u0026#34;, x) fmt.Println(\u0026#34;y=\u0026#34;, y) } åŒ¿åå˜é‡ä¸å ç”¨å‘½åç©ºé—´ï¼Œä¸ä¼šåˆ†é…å†…å­˜ï¼Œæ‰€ä»¥åŒ¿åå˜é‡ä¹‹é—´ä¸å­˜åœ¨é‡å¤å£°æ˜ã€‚ (åœ¨Luaç­‰ç¼–ç¨‹è¯­è¨€é‡Œï¼ŒåŒ¿åå˜é‡ä¹Ÿè¢«å«åšå“‘å…ƒå˜é‡ã€‚)\næ³¨æ„äº‹é¡¹ï¼š\nå‡½æ•°å¤–çš„æ¯ä¸ªè¯­å¥éƒ½å¿…é¡»ä»¥å…³é”®å­—å¼€å§‹ï¼ˆvarã€constã€funcç­‰ï¼‰ :=ä¸èƒ½ä½¿ç”¨åœ¨å‡½æ•°å¤–ã€‚ _å¤šç”¨äºå ä½ï¼Œè¡¨ç¤ºå¿½ç•¥å€¼ã€‚ å¸¸é‡ æ ‡å‡†å¸¸é‡å£°æ˜\nconst pi = 1415 const e = 7182 æ‰¹é‡\nconst ( pi = 1415 e = 7182 ) const ( n1 = 100 n2 n3 ) iota iotaæ˜¯goè¯­è¨€çš„å¸¸é‡è®¡æ•°å™¨ï¼Œåªèƒ½åœ¨å¸¸é‡çš„è¡¨è¾¾å¼ä¸­ä½¿ç”¨ã€‚ iotaåœ¨constå…³é”®å­—å‡ºç°æ—¶å°†è¢«é‡ç½®ä¸º0ã€‚constä¸­æ¯æ–°å¢ä¸€è¡Œå¸¸é‡å£°æ˜å°†ä½¿iotaè®¡æ•°ä¸€æ¬¡(iotaå¯ç†è§£ä¸ºconstè¯­å¥å—ä¸­çš„è¡Œç´¢å¼•)ã€‚ ä½¿ç”¨iotaèƒ½ç®€åŒ–å®šä¹‰ï¼Œåœ¨å®šä¹‰æšä¸¾æ—¶å¾ˆæœ‰ç”¨ã€‚\nconst ( n1 = iota //0 n2 //1 n3 //2 n4 //3 ) å‡ ä¸ªå¸¸è§çš„iotaç¤ºä¾‹:\nä½¿ç”¨_è·³è¿‡æŸäº›å€¼\nconst ( n1 = iota //0 n2 //1 _ n4 //3 ) iotaå£°æ˜ä¸­é—´æ’é˜Ÿ\nconst ( n1 = iota //0 n2 = 100 //100 n3 = iota //2 n4 //3 ) const n5 = iota //0 å®šä¹‰æ•°é‡çº§ ï¼ˆè¿™é‡Œçš„\u0026lt;\u0026lt;è¡¨ç¤ºå·¦ç§»æ“ä½œï¼Œ1\u0026lt;\u0026lt;10è¡¨ç¤ºå°†1çš„äºŒè¿›åˆ¶è¡¨ç¤ºå‘å·¦ç§»10ä½ï¼Œä¹Ÿå°±æ˜¯ç”±1å˜æˆäº†10000000000ï¼Œä¹Ÿå°±æ˜¯åè¿›åˆ¶çš„1024ã€‚åŒç†2\u0026lt;\u0026lt;2è¡¨ç¤ºå°†2çš„äºŒè¿›åˆ¶è¡¨ç¤ºå‘å·¦ç§»2ä½ï¼Œä¹Ÿå°±æ˜¯ç”±10å˜æˆäº†1000ï¼Œä¹Ÿå°±æ˜¯åè¿›åˆ¶çš„8ã€‚ï¼‰\nconst ( _ = iota KB = 1 \u0026lt;\u0026lt; (10 * iota) MB = 1 \u0026lt;\u0026lt; (10 * iota) GB = 1 \u0026lt;\u0026lt; (10 * iota) TB = 1 \u0026lt;\u0026lt; (10 * iota) PB = 1 \u0026lt;\u0026lt; (10 * iota) ) å¤šä¸ªiotaå®šä¹‰åœ¨ä¸€è¡Œ\nconst ( a, b = iota + 1, iota + 2 //1,2 c, d //2,3 e, f //3,4 ) 5. åŸºæœ¬ç±»å‹ åŸºç¡€ç±»å‹ä»‹ç» ç±»å‹ é•¿åº¦(å­—èŠ‚) é»˜è®¤å€¼ è¯´æ˜ bool 1 false byte 1 0 uint8 rune 4 0 Unicode Code Point, int32 int, uint 4æˆ–8 0 32 æˆ– 64 ä½ int8, uint8 1 0 -128 ~ 127, 0 ~ 255ï¼Œbyteæ˜¯uint8 çš„åˆ«å int16, uint16 2 0 -32768 ~ 32767, 0 ~ 65535 int32, uint32 4 0 -21äº¿~ 21äº¿, 0 ~ 42äº¿ï¼Œruneæ˜¯int32 çš„åˆ«å int64, uint64 8 0 float32 4 0.0 float64 8 0.0 complex64 8 complex128 16 uintptr 4æˆ–8 ä»¥å­˜å‚¨æŒ‡é’ˆçš„ uint32 æˆ– uint64 æ•´æ•° array å€¼ç±»å‹ struct å€¼ç±»å‹ string \u0026quot;\u0026quot; UTF-8 å­—ç¬¦ä¸² slice nil å¼•ç”¨ç±»å‹ map nil å¼•ç”¨ç±»å‹ channel nil å¼•ç”¨ç±»å‹ interface nil æ¥å£ function nil å‡½æ•° 6. æ•°ç»„Array æ•°ç»„ï¼šæ˜¯åŒä¸€ç§æ•°æ®ç±»å‹çš„å›ºå®šé•¿åº¦çš„åºåˆ—ã€‚ æ•°ç»„å®šä¹‰ï¼švar a [len]intï¼Œæ¯”å¦‚ï¼švar a [5]intï¼Œæ•°ç»„é•¿åº¦å¿…é¡»æ˜¯å¸¸é‡ï¼Œä¸”æ˜¯ç±»å‹çš„ç»„æˆéƒ¨åˆ†ã€‚ä¸€æ—¦å®šä¹‰ï¼Œé•¿åº¦ä¸èƒ½å˜ã€‚ é•¿åº¦æ˜¯æ•°ç»„ç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤ï¼Œvar a[5] intå’Œvar a[10]intæ˜¯ä¸åŒçš„ç±»å‹ã€‚ æ•°ç»„å¯ä»¥é€šè¿‡ä¸‹æ ‡è¿›è¡Œè®¿é—®ï¼Œä¸‹æ ‡æ˜¯ä»0å¼€å§‹ï¼Œæœ€åä¸€ä¸ªå…ƒç´ ä¸‹æ ‡æ˜¯ï¼šlen-1 for i := 0; i \u0026lt; len(a); i++ { } for index, v := range a { } è®¿é—®è¶Šç•Œï¼Œå¦‚æœä¸‹æ ‡åœ¨æ•°ç»„åˆæ³•èŒƒå›´ä¹‹å¤–ï¼Œåˆ™è§¦å‘è®¿é—®è¶Šç•Œï¼Œä¼španic æ•°ç»„æ˜¯å€¼ç±»å‹ï¼Œèµ‹å€¼å’Œä¼ å‚ä¼šå¤åˆ¶æ•´ä¸ªæ•°ç»„ï¼Œè€Œä¸æ˜¯æŒ‡é’ˆã€‚å› æ­¤æ”¹å˜å‰¯æœ¬çš„å€¼ï¼Œä¸ä¼šæ”¹å˜æœ¬èº«çš„å€¼ã€‚ æ”¯æŒ \u0026#34;==\u0026#34;ã€\u0026#34;!=\u0026#34; æ“ä½œç¬¦ï¼Œå› ä¸ºå†…å­˜æ€»æ˜¯è¢«åˆå§‹åŒ–è¿‡çš„ã€‚ æŒ‡é’ˆæ•°ç»„ [n]*Tï¼Œæ•°ç»„æŒ‡é’ˆ *[n]Tã€‚ æ•°ç»„åˆå§‹åŒ– ä¸€ç»´æ•°ç»„\nå…¨å±€ï¼š var arr0 [5]int = [5]int{1, 2, 3} var arr1 = [5]int{1, 2, 3, 4, 5} var arr2 = [...]int{1, 2, 3, 4, 5, 6} var str = [5]string{3: \u0026#34;hello world\u0026#34;, 4: \u0026#34;tom\u0026#34;} å±€éƒ¨ï¼š a := [3]int{1, 2} // æœªåˆå§‹åŒ–å…ƒç´ å€¼ä¸º 0ã€‚ b := [...]int{1, 2, 3, 4} // é€šè¿‡åˆå§‹åŒ–å€¼ç¡®å®šæ•°ç»„é•¿åº¦ã€‚ c := [5]int{2: 100, 4: 200} // ä½¿ç”¨ç´¢å¼•å·åˆå§‹åŒ–å…ƒç´ ã€‚ d := [...]struct { name string age uint8 }{ {\u0026#34;user1\u0026#34;, 10}, // å¯çœç•¥å…ƒç´ ç±»å‹ã€‚ {\u0026#34;user2\u0026#34;, 20}, // åˆ«å¿˜äº†æœ€åä¸€è¡Œçš„é€—å·ã€‚ }package main import ( \u0026#34;fmt\u0026#34; ) var arr0 [5]int = [5]int{1, 2, 3} var arr1 = [5]int{1, 2, 3, 4, 5} var arr2 = [...]int{1, 2, 3, 4, 5, 6} var str = [5]string{3: \u0026#34;hello world\u0026#34;, 4: \u0026#34;tom\u0026#34;} func main() { a := [3]int{1, 2} // æœªåˆå§‹åŒ–å…ƒç´ å€¼ä¸º 0ã€‚ b := [...]int{1, 2, 3, 4} // é€šè¿‡åˆå§‹åŒ–å€¼ç¡®å®šæ•°ç»„é•¿åº¦ã€‚ c := [5]int{2: 100, 4: 200} // ä½¿ç”¨å¼•å·åˆå§‹åŒ–å…ƒç´ ã€‚ d := [...]struct { name string age uint8 }{ {\u0026#34;user1\u0026#34;, 10}, // å¯çœç•¥å…ƒç´ ç±»å‹ã€‚ {\u0026#34;user2\u0026#34;, 20}, // åˆ«å¿˜äº†æœ€åä¸€è¡Œçš„é€—å·ã€‚ } fmt.Println(arr0, arr1, arr2, str) fmt.Println(a, b, c, d) } ä»£ç ï¼š\npackage main import ( \u0026#34;fmt\u0026#34; ) var arr0 [5]int = [5]int{1, 2, 3} var arr1 = [5]int{1, 2, 3, 4, 5} var arr2 = [...]int{1, 2, 3, 4, 5, 6} var str = [5]string{3: \u0026#34;hello world\u0026#34;, 4: \u0026#34;tom\u0026#34;} func main() { a := [3]int{1, 2} // æœªåˆå§‹åŒ–å…ƒç´ å€¼ä¸º 0ã€‚ b := [...]int{1, 2, 3, 4} // é€šè¿‡åˆå§‹åŒ–å€¼ç¡®å®šæ•°ç»„é•¿åº¦ã€‚ c := [5]int{2: 100, 4: 200} // ä½¿ç”¨å¼•å·åˆå§‹åŒ–å…ƒç´ ã€‚ d := [...]struct { name string age uint8 }{ {\u0026#34;user1\u0026#34;, 10}, // å¯çœç•¥å…ƒç´ ç±»å‹ã€‚ {\u0026#34;user2\u0026#34;, 20}, // åˆ«å¿˜äº†æœ€åä¸€è¡Œçš„é€—å·ã€‚ } fmt.Println(arr0, arr1, arr2, str) fmt.Println(a, b, c, d) } ç»“æœï¼š\n[1 2 3 0 0] [1 2 3 4 5] [1 2 3 4 5 6] [ hello world tom] [1 2 0] [1 2 3 4] [0 0 100 0 200] [{user1 10} {user2 20}] å¤šç»´æ•°ç»„\npackage main import ( \u0026#34;fmt\u0026#34; ) var arr0 [5][3]int var arr1 [2][3]int = [...][3]int{{1, 2, 3}, {7, 8, 9}} func main() { a := [2][3]int{{1, 2, 3}, {4, 5, 6}} b := [...][2]int{{1, 1}, {2, 2}, {3, 3}} // ç¬¬ 2 çº¬åº¦ä¸èƒ½ç”¨ \u0026#34;...\u0026#34;ã€‚ fmt.Println(arr0, arr1) fmt.Println(a, b) } ç»“æœ\n[[0 0 0] [0 0 0] [0 0 0] [0 0 0] [0 0 0]] [[1 2 3] [7 8 9]] [[1 2 3] [4 5 6]] [[1 1] [2 2] [3 3]] å†…ç½®å‡½æ•° len å’Œ cap éƒ½è¿”å›æ•°ç»„é•¿åº¦ (å…ƒç´ æ•°é‡)ã€‚\npackage main func main() { a := [2]int{} println(len(a), cap(a)) } è¾“å‡ºç»“æœï¼š\n2 2\nå€¼æ‹·è´è¡Œä¸ºä¼šé€ æˆæ€§èƒ½é—®é¢˜ï¼Œé€šå¸¸ä¼šå»ºè®®ä½¿ç”¨ sliceï¼Œæˆ–æ•°ç»„æŒ‡é’ˆã€‚\npackage main import ( \u0026#34;fmt\u0026#34; ) func test(x [2]int) { fmt.Printf(\u0026#34;x: %p\\\\n\u0026#34;, \u0026amp;x) x[1] = 1000 } func main() { a := [2]int{} fmt.Printf(\u0026#34;a: %p\\\\n\u0026#34;, \u0026amp;a) test(a) fmt.Println(a) } è¾“å‡ºç»“æœ:\na: 0xc42007c010 x: 0xc42007c030 [0 0] # å¤šç»´æ•°ç»„éå†ï¼š package main import ( \u0026#34;fmt\u0026#34; ) func main() { var f [2][3]int = [...][3]int{{1, 2, 3}, {7, 8, 9}} for k1, v1 := range f { for k2, v2 := range v1 { fmt.Printf(\u0026#34;(%d,%d)=%d \u0026#34;, k1, k2, v2) } fmt.Println() } } (0,0)=1 (0,1)=2 (0,2)=3 (1,0)=7 (1,1)=8 (1,2)=9 æ•°ç»„æ‹·è´å’Œä¼ å‚\npackage main import \u0026#34;fmt\u0026#34; func printArr(arr *[5]int) { arr[0] = 10 for i, v := range arr { fmt.Println(i, v) } } func main() { var arr1 [5]int printArr(\u0026amp;arr1) fmt.Println(arr1) arr2 := [...]int{2, 4, 6, 8, 10} printArr(\u0026amp;arr2) fmt.Println(arr2) } 7.åˆ‡ç‰‡Slice ä»‹ç»ï¼š\nslice å¹¶ä¸æ˜¯æ•°ç»„æˆ–è€…æŒ‡é’ˆã€‚å®ƒæ˜¯é€šè¿‡å†…éƒ¨æŒ‡é’ˆå’Œç›¸å…³å±æ€§å¼•ç”¨æ•°ç»„ç‰‡æ®µï¼Œä»¥å®ç°å˜é•¿æ–¹æ¡ˆ\n7.1 åˆ›å»ºåˆ‡ç‰‡çš„å„ç§æ–¹å¼ // å£°æ˜åˆ‡ç‰‡\nvar s1 []int\n// :=\ns2 := []int{}\n// make\nvar slice []type = make([]type, len) slice := make([]type, len) slice := make([]type, len, cap) // åˆå§‹åŒ–èµ‹å€¼\ns := []int{1,2,3}\n7.2åˆ‡ç‰‡åˆå§‹åŒ– //å…¨å±€ var arr = [...]int{0, 1, 2, 3, 4, 5, 6, 7, 8, 9} var slice0 []int = arr[start:end] var slice1 []int = arr[:end] var slice2 []int = arr[start:] var slice3 []int = arr[:] var slice4 = arr[:len(arr)-1] //å»æ‰åˆ‡ç‰‡çš„æœ€åä¸€ä¸ªå…ƒç´  //å±€éƒ¨ arr2 := [...]int{9, 8, 7, 6, 5, 4, 3, 2, 1, 0} slice5 := arr[start:end] slice6 := arr[:end] slice7 := arr[start:] slice8 := arr[:] slice9 := arr[:len(arr)-1] //å»æ‰åˆ‡ç‰‡çš„æœ€åä¸€ä¸ªå…ƒç´  æ“ä½œ å«ä¹‰ s[n] åˆ‡ç‰‡sä¸­ç´¢å¼•ä½ç½®ä¸ºnçš„é¡¹ç›® s[:] 0åˆ°len(s)-1 s[low:] low åˆ°len(s)-1 s[:high] 0 åˆ°hight,len=high s[low:high] len = hight-low len(s) åˆ‡ç‰‡é•¿åº¦ ï¼Œæ€»æ˜¯\u0026lt;=cap(s) cap(s) åˆ‡ç‰‡å®¹é‡ï¼Œæ€»æ˜¯\u0026gt;=len(s) 7.3 åˆ‡ç‰‡åŸºç¡€æ“ä½œ append\nvar a = []int{1, 2, 3} var b = []int{4, 5, 6} c := append(a, b...) fmt.Printf(\u0026#34;slice c : %v\\\\n\u0026#34;, c) slice c : [1 2 3 4 5 6] è¶…å‡ºåŸ slice.cap é™åˆ¶ï¼Œå°±ä¼šé‡æ–°åˆ†é…åº•å±‚æ•°ç»„ï¼Œå³ä¾¿åŸæ•°ç»„å¹¶æœªå¡«æ»¡\ndata := [...]int{0, 1, 2, 3, 4, 10: 0} s := data[:2:3] s = append(s, 100, 200) // ä¸€æ¬¡ append ä¸¤ä¸ªå€¼ï¼Œè¶…å‡º s.cap é™åˆ¶ã€‚ fmt.Println(s, data) // é‡æ–°åˆ†é…åº•å±‚æ•°ç»„ï¼Œä¸åŸæ•°ç»„æ— å…³ã€‚ fmt.Println(\u0026amp;s[0], \u0026amp;data[0]) // æ¯”å¯¹åº•å±‚æ•°ç»„èµ·å§‹æŒ‡é’ˆã€‚ [0 1 100 200] [0 1 2 3 4 0 0 0 0 0 0] 0xc4200160f0 0xc420070060 åˆ‡ç‰‡æ‹·è´\ns1 := []int{1, 2, 3, 4, 5} fmt.Printf(\u0026#34;slice s1 : %v\\\\n\u0026#34;, s1) s2 := make([]int, 10) fmt.Printf(\u0026#34;slice s2 : %v\\\\n\u0026#34;, s2) copy(s2, s1) fmt.Printf(\u0026#34;copied slice s1 : %v\\\\n\u0026#34;, s1) fmt.Printf(\u0026#34;copied slice s2 : %v\\\\n\u0026#34;, s2) s3 := []int{1, 2, 3} fmt.Printf(\u0026#34;slice s3 : %v\\\\n\u0026#34;, s3) s3 = append(s3, s..) fmt.Printf(\u0026#34;appended slice s3 : %v\\\\n\u0026#34;, s3) s3 = append(s3, 4, 5, 6) fmt.Printf(\u0026#34;last slice s3 : %v\\\\n\u0026#34;, s3) slice s1 : [1 2 3 4 5] slice s2 : [0 0 0 0 0 0 0 0 0 0] copied slice s1 : [1 2 3 4 5] copied slice s2 : [1 2 3 4 5 0 0 0 0 0] slice s3 : [1 2 3] appended slice s3 : [1 2 3 1 2 3 4 5 0 0 0 0 0] last slice s3 : [1 2 3 1 2 3 4 5 0 0 0 0 0 4 5 6] copy ï¼šå‡½æ•° copy åœ¨ä¸¤ä¸ª slice é—´å¤åˆ¶æ•°æ®ï¼Œå¤åˆ¶é•¿åº¦ä»¥ len å°çš„ä¸ºå‡†ã€‚ä¸¤ä¸ª slice å¯æŒ‡å‘åŒä¸€åº•å±‚æ•°ç»„ï¼Œå…è®¸å…ƒç´ åŒºé—´é‡å ã€‚\ndata := [...]int{0, 1, 2, 3, 4, 5, 6, 7, 8, 9} fmt.Println(\u0026#34;array data : \u0026#34;, data) s1 := data[8:] s2 := data[:5] fmt.Printf(\u0026#34;slice s1 : %v\\\\n\u0026#34;, s1) fmt.Printf(\u0026#34;slice s2 : %v\\\\n\u0026#34;, s2) copy(s2, s1) fmt.Printf(\u0026#34;copied slice s1 : %v\\\\n\u0026#34;, s1) fmt.Printf(\u0026#34;copied slice s2 : %v\\\\n\u0026#34;, s2) fmt.Println(\u0026#34;last array data : \u0026#34;, data) array data : [0 1 2 3 4 5 6 7 8 9] slice s1 : [8 9] slice s2 : [0 1 2 3 4] copied slice s1 : [8 9] copied slice s2 : [8 9 2 3 4] last array data : [8 9 2 3 4 5 6 7 8 9] sliceéå†\ndata := [...]int{0, 1, 2, 3, 4, 5, 6, 7, 8, 9} slice := data[:] for index, value := range slice { fmt.Printf(\u0026#34;inde : %v , value : %v\\\\n\u0026#34;, index, value) } åˆ‡ç‰‡è°ƒæ•´å¤§å°\nfmt.Printf(\u0026#34;slice a : %v , len(a) : %v\\\\n\u0026#34;, a, len(a)) b := a[1:2] fmt.Printf(\u0026#34;slice b : %v , len(b) : %v\\\\n\u0026#34;, b, len(b)) c := b[0:3] fmt.Printf(\u0026#34;slice c : %v , len(c) : %v\\\\n\u0026#34;, c, len(c)) slice a : [1 3 4 5] , len(a) : 4 slice b : [3] , len(b) : 1 slice c : [3 4 5] , len(c) : 3 å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡\nstringåº•å±‚å°±æ˜¯ä¸€ä¸ªbyteçš„æ•°ç»„ï¼Œå› æ­¤ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œåˆ‡ç‰‡æ“ä½œã€‚\nstr := \u0026#34;hello world\u0026#34; s1 := str[0:5] fmt.Println(s1) s2 := str[6:] fmt.Println(s2) hello world\n8. map è¯­æ³•\nmap[KeyType]ValueType scoreMap := make(map[string]int, 8) åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨\nvalue, ok := map[key] mapçš„éå†\nfor k, v := range scoreMap { fmt.Println(k, v) } åˆ é™¤é”®å€¼å¯¹\ndelete(map, key) å…ƒç´ ä¸ºmapç±»å‹çš„åˆ‡ç‰‡\nvar mapSlice = make([]map[string]string, 3) for index, value := range mapSlice { fmt.Printf(\u0026#34;index:%d value:%v\\\\n\u0026#34;, index, value) } fmt.Println(\u0026#34;after init\u0026#34;) // å¯¹åˆ‡ç‰‡ä¸­çš„mapå…ƒç´ è¿›è¡Œåˆå§‹åŒ– mapSlice[0] = make(map[string]string, 10) mapSlice[0][\u0026#34;name\u0026#34;] = \u0026#34;ç‹äº”\u0026#34; mapSlice[0][\u0026#34;password\u0026#34;] = \u0026#34;123456\u0026#34; mapSlice[0][\u0026#34;address\u0026#34;] = \u0026#34;çº¢æ——å¤§è¡—\u0026#34; for index, value := range mapSlice { fmt.Printf(\u0026#34;index:%d value:%v\\\\n\u0026#34;, index, value) } å€¼ä¸ºåˆ‡ç‰‡ç±»å‹çš„map\nvar sliceMap = make(map[string][]string, 3) fmt.Println(sliceMap) fmt.Println(\u0026#34;after init\u0026#34;) key := \u0026#34;ä¸­å›½\u0026#34; value, ok := sliceMap[key] if !ok { value = make([]string, 0, 2) } value = append(value, \u0026#34;åŒ—äº¬\u0026#34;, \u0026#34;ä¸Šæµ·\u0026#34;) sliceMap[key] = value fmt.Println(sliceMap) 9.æµç¨‹æ§åˆ¶ if if å¸ƒå°”è¡¨è¾¾å¼ { /* åœ¨å¸ƒå°”è¡¨è¾¾å¼ä¸º true æ—¶æ‰§è¡Œ */ } else { /* åœ¨å¸ƒå°”è¡¨è¾¾å¼ä¸º false æ—¶æ‰§è¡Œ */ } switch switch var1 { case val1: ... case val2: ... default: ... } type switch\nswitch x.(type){ case type: statement(s) case type: statement(s) /* ä½ å¯ä»¥å®šä¹‰ä»»æ„ä¸ªæ•°çš„case */ default: /* å¯é€‰ */ statement(s) } select select è¯­å¥ç±»ä¼¼äº switch è¯­å¥ï¼Œä½†æ˜¯selectä¼šéšæœºæ‰§è¡Œä¸€ä¸ªå¯è¿è¡Œçš„caseã€‚å¦‚æœæ²¡æœ‰caseå¯è¿è¡Œï¼Œå®ƒå°†é˜»å¡ï¼Œç›´åˆ°æœ‰caseå¯è¿è¡Œã€‚\nselect { case communication clause : statement(s); case communication clause : statement(s); /* ä½ å¯ä»¥å®šä¹‰ä»»æ„æ•°é‡çš„ case */ default : /* å¯é€‰ */ statement(s); } tips:\næ¯ä¸ªcaseéƒ½å¿…é¡»æ˜¯ä¸€ä¸ªé€šä¿¡\nâ€‹ æ‰€æœ‰channelè¡¨è¾¾å¼éƒ½ä¼šè¢«æ±‚å€¼\nâ€‹ æ‰€æœ‰è¢«å‘é€çš„è¡¨è¾¾å¼éƒ½ä¼šè¢«æ±‚å€¼\nâ€‹ å¦‚æœä»»æ„æŸä¸ªé€šä¿¡å¯ä»¥è¿›è¡Œï¼Œå®ƒå°±æ‰§è¡Œï¼›å…¶ä»–è¢«å¿½ç•¥ã€‚\nâ€‹ å¦‚æœæœ‰å¤šä¸ªcaseéƒ½å¯ä»¥è¿è¡Œï¼ŒSelectä¼šéšæœºå…¬å¹³åœ°é€‰å‡ºä¸€ä¸ªæ‰§è¡Œã€‚å…¶ä»–ä¸ä¼šæ‰§è¡Œã€‚\nâ€‹ å¦åˆ™ï¼š\nâ€‹ å¦‚æœæœ‰defaultå­å¥ï¼Œåˆ™æ‰§è¡Œè¯¥è¯­å¥ã€‚\nâ€‹ å¦‚æœæ²¡æœ‰defaultå­—å¥ï¼Œselectå°†é˜»å¡ï¼Œç›´åˆ°æŸä¸ªé€šä¿¡å¯ä»¥è¿è¡Œï¼›Goä¸ä¼šé‡æ–°å¯¹channelæˆ–å€¼è¿›è¡Œæ±‚å€¼ã€‚\nvar c1, c2, c3 chan int var i1, i2 int select { case i1 = \u0026lt;-c1: fmt.Printf(\u0026#34;received \u0026#34;, i1, \u0026#34; from c1\\\\n\u0026#34;) case c2 \u0026lt;- i2: fmt.Printf(\u0026#34;sent \u0026#34;, i2, \u0026#34; to c2\\\\n\u0026#34;) case i3, ok := (\u0026lt;-c3): // same as: i3, ok := \u0026lt;-c3 if ok { fmt.Printf(\u0026#34;received \u0026#34;, i3, \u0026#34; from c3\\\\n\u0026#34;) } else { fmt.Printf(\u0026#34;c3 is closed\\\\n\u0026#34;) } default: fmt.Printf(\u0026#34;no communication\\\\n\u0026#34;) åŸºæœ¬ä½¿ç”¨\nselectæ˜¯Goä¸­çš„ä¸€ä¸ªæ§åˆ¶ç»“æ„ï¼Œç±»ä¼¼äºswitchè¯­å¥ï¼Œç”¨äºå¤„ç†å¼‚æ­¥IOæ“ä½œã€‚selectä¼šç›‘å¬caseè¯­å¥ä¸­channelçš„è¯»å†™æ“ä½œï¼Œå½“caseä¸­channelè¯»å†™æ“ä½œä¸ºéé˜»å¡çŠ¶æ€ï¼ˆå³èƒ½è¯»å†™ï¼‰æ—¶ï¼Œå°†ä¼šè§¦å‘ç›¸åº”çš„åŠ¨ä½œã€‚ selectä¸­çš„caseè¯­å¥å¿…é¡»æ˜¯ä¸€ä¸ªchannelæ“ä½œ\nselectä¸­çš„defaultå­å¥æ€»æ˜¯å¯è¿è¡Œçš„ã€‚\n1, å¦‚æœæœ‰å¤šä¸ªcaseéƒ½å¯ä»¥è¿è¡Œï¼Œselectä¼šéšæœºå…¬å¹³åœ°é€‰å‡ºä¸€ä¸ªæ‰§è¡Œï¼Œå…¶ä»–ä¸ä¼šæ‰§è¡Œã€‚\n2, å¦‚æœæ²¡æœ‰å¯è¿è¡Œçš„caseè¯­å¥ï¼Œä¸”æœ‰defaultè¯­å¥ï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œdefaultçš„åŠ¨ä½œã€‚\n3, å¦‚æœæ²¡æœ‰å¯è¿è¡Œçš„caseè¯­å¥ï¼Œä¸”æ²¡æœ‰defaultè¯­å¥ï¼Œselectå°†é˜»å¡ï¼Œç›´åˆ°æŸä¸ªcaseé€šä¿¡å¯ä»¥è¿è¡Œ\nå…¸å‹ç”¨æ³• 1.è¶…æ—¶åˆ¤æ–­\n//æ¯”å¦‚åœ¨ä¸‹é¢çš„åœºæ™¯ä¸­ï¼Œä½¿ç”¨å…¨å±€resChanæ¥æ¥å—responseï¼Œå¦‚æœæ—¶é—´è¶…è¿‡3S,resChanä¸­è¿˜æ²¡æœ‰æ•°æ®è¿”å›ï¼Œåˆ™ç¬¬äºŒæ¡caseå°†æ‰§è¡Œ var resChan = make(chan int) // do request func test() { select { case data := \u0026lt;-resChan: doData(data) case \u0026lt;-time.After(time.Second * 3): fmt.Println(\u0026#34;request time out\u0026#34;) } } func doData(data int) { //... } 2.é€€å‡º\n//ä¸»çº¿ç¨‹ï¼ˆåç¨‹ï¼‰ä¸­å¦‚ä¸‹ï¼š var shouldQuit=make(chan struct{}) fun main(){ { //loop } //...out of the loop select { case \u0026lt;-c.shouldQuit: cleanUp() return default: } //... } //å†å¦å¤–ä¸€ä¸ªåç¨‹ä¸­ï¼Œå¦‚æœè¿è¡Œé‡åˆ°éæ³•æ“ä½œæˆ–ä¸å¯å¤„ç†çš„é”™è¯¯ï¼Œå°±å‘shouldQuitå‘é€æ•°æ®é€šçŸ¥ç¨‹åºåœæ­¢è¿è¡Œ close(shouldQuit) 3.åˆ¤æ–­æ˜¯å¦å µå¡\n//åœ¨æŸäº›æƒ…å†µä¸‹æ˜¯å­˜åœ¨ä¸å¸Œæœ›channelç¼“å­˜æ»¡äº†çš„éœ€æ±‚çš„ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹æ–¹æ³•åˆ¤æ–­ ch := make (chan int, 5) //... dataï¼š=0 select { case ch \u0026lt;- data: default: //åšç›¸åº”æ“ä½œï¼Œæ¯”å¦‚ä¸¢å¼ƒdataã€‚è§†éœ€æ±‚è€Œå®š } for 1, for init; condition; post { } 2, for condition { } 3, for { } range for key, value := range oldMap { newMap[key] = value } goto,break,continue ","permalink":"https://XianCH.github.io/posts/tech/go/golang%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/","summary":"\u003ch1 id=\"goåŸºç¡€å­¦ä¹ ç¬”è®°\"\u003egoåŸºç¡€å­¦ä¹ ç¬”è®°\u003c/h1\u003e\n\u003ch2 id=\"1-å‘½ä»¤\"\u003e1. å‘½ä»¤\u003c/h2\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e$ go\nGo is a tool for managing Go source code.\n\nUsage:\n\n    go command [arguments]\n\nThe commands are:\n\n    build       compile packages and dependencies\n    clean       remove object files\n    doc         show documentation for package or symbol\n    env         print Go environment information\n    bug         start a bug report\n    fix         run go tool fix on packages\n    fmt         run gofmt on package sources\n    generate    generate Go files by processing source\n    get         download and install packages and dependencies\n    install     compile and install packages and dependencies\n    list        list packages\n    run         compile and run Go program\n    test        test packages\n    tool        run specified go tool\n    version     print Go version\n    vet         run go tool vet on packages\n\nUse \u0026#34;go help [command]\u0026#34; for more information about a command.\n\nAdditional help topics:\n\n    c           calling between Go and C\n    buildmode   description of build modes\n    filetype    file types\n    gopath      GOPATH environment variable\n    environment environment variables\n    importpath  import path syntax\n    packages    description of package lists\n    testflag    description of testing flags\n    testfunc    description of testing functions\n\nUse \u0026#34;go help [topic]\u0026#34; for more information about that topic.\n\u003c/code\u003e\u003c/pre\u003e\u003cblockquote\u003e\n\u003cp\u003ego envç”¨äºæ‰“å°Goè¯­è¨€çš„ç¯å¢ƒä¿¡æ¯ã€‚\u003c/p\u003e","title":"GolangåŸºç¡€å­¦ä¹ (æ›´æ–°ä¸­ï¼‰"},{"content":"(F)æ•°æ®ç»“æ„ 1,æ•°ç»„å’Œé˜Ÿåˆ— ç¨€ç–æ•°ç»„ ä»‹ç»\nå½“ä¸€ä¸ªç´ ç»„ä¸­å¤§éƒ¨åˆ†ä¸º0æˆ–è€…éƒ½æ˜¯åŒä¸€ä¸ªæ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç¨€ç–æ•°ç»„æ¥ä¿å­˜è¯¥æ•°ç»„ï¼Œå°±åƒæ˜¯äº”å­æ£‹æ¸¸æˆä¸€æ ·ï¼ŒæŠŠæ•´ä¸ªäº”å­æ£‹æ£‹ç›˜å®šä¹‰æˆä¸€ä¸ªäºŒä½æ•°ç»„ï¼Œå¤§éƒ¨åˆ†ä¸º0.\nå¤„ç†æ–¹å¼\n1.è®°å½•ä¸€ä¸ªæ•°ç»„ä¸€å…±æœ‰å‡ è¡Œå‡ åˆ—ï¼Œæœ‰å¤šå°‘ä¸ªä¸åŒçš„å€¼\n2.æŠŠå…·æœ‰ ä¸åŒå€¼çš„å…ƒç´  çš„ è¡Œåˆ—åŠå€¼ è®°å½•åœ¨ä¸€ä¸ª å°è§„æ¨¡çš„æ•°ç»„ ä¸­ï¼Œä»è€Œç¼©å°ç¨‹åºçš„è§„æ¨¡\nå®é™…åº”ç”¨\nä»¥å›´æ£‹ä¸ºä¾‹ï¼Œå‡è®¾ä¸€ä¸ª10x10çš„æ£‹ç›˜å¯ä»¥ç”¨ä¸ªäºŒç»´æ•°ç»„è¡¨ç¤ºint[10] [10],æ•°ç»„å…¨æ˜¯é›¶ï¼Œçº¢æ–¹å’Œé»‘æ–¹åˆ†åˆ«ç”¨1å’Œ2è¡¨ç¤ºï¼Œå¦‚ä¸‹å›¾ï¼š\nä»£ç å®ç°\npackage main import \u0026#34;fmt\u0026#34; type SparseElement struct { row, col, value int } type SparseArray struct { row, col int data []SparseElement } func NewSparseArray(row, col int) *SparseArray { return \u0026amp;SparseArray{ row: row, col: col, data: []SparseElement{}, } } func (sa *SparseArray) Set(row, col, value int) { element := \u0026amp;SparseElement{ row: row, col: col, value: value, } sa.data = append(sa.data, *element) } func (sa *SparseArray) Get(row, col int) int { for _, data := range sa.data { if row == data.row \u0026amp;\u0026amp; col == data.col { return data.value } } return 0 } func main() { sparseArray := NewSparseArray(10, 10) sparseArray.Set(1, 3, 1) sparseArray.Set(4, 2, 2) for i := 0; i \u0026lt; 10; i++ { for j := 0; j \u0026lt; 10; j++ { fmt.Printf(\u0026#34;%d \u0026#34;, sparseArray.Get(i, j)) } fmt.Println() } } é˜Ÿåˆ— é˜Ÿåˆ—æš‚æ—¶æ²¡æœ‰ä»€ä¹ˆæƒ³æ³•ï¼Œå…ˆè¿›å…ˆå‡ºï¼Ÿä¸‹é¢æ˜¯è‡ªå·±å†™çš„ä»£ç \npackage main import ( \u0026#34;sync\u0026#34; ) type Queen struct { Size int items []interface{} mutex sync.Mutex } func (queen *Queen) SetMaxSize(size int) { queen.Size = size } func (queen *Queen) IsFull() bool { return len(queen.items) == queen.Size } func (queen *Queen) EnQueen(item interface{}) { queen.mutex.Lock() defer queen.mutex.Unlock() if !queen.IsFull() { queen.items = append(queen.items, item) } } func (queen *Queen) Fornt() interface{} { return queen.items[0] } func (queen *Queen) IsEmpty() bool { return len(queen.items) == 0 } func main() { queen := \u0026amp;Queen{ Size: 20, } go func() { for i := 0; i \u0026lt; 20; i++ { } }() } 2,é“¾è¡¨ ä»‹ç» é“¾è¡¨æ˜¯ä»¥ èŠ‚ç‚¹ çš„æ–¹å¼æ¥å­˜å‚¨ï¼Œæ˜¯ é“¾å¼å­˜å‚¨ æ¯ä¸ªèŠ‚ç‚¹åŒ…å« data åŸŸã€next åŸŸï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ é“¾è¡¨çš„å„ä¸ªèŠ‚ç‚¹ ä¸ä¸€å®šæ˜¯è¿ç»­å­˜å‚¨ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤º é“¾è¡¨è¿˜åˆ†ï¼šå¸¦å¤´èŠ‚ç‚¹ã€ä¸å¸¦å¤´èŠ‚ç‚¹ï¼Œæ ¹æ®å®é™…éœ€æ±‚æ¥ç¡®å®š é“¾è¡¨çš„ä¼˜åŠ¿\nåˆ é™¤å’Œæ’å…¥æ•°æ®æ¯”è¾ƒæ–¹ä¾¿ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO1,ä½†æ˜¯æŸ¥æ‰¾ä¸æ–¹ä¾¿ï¼Œéƒ½æ˜¯è¦ä»ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸€ç›´æ‰¾nextæŒ‡é’ˆï¼Œç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢ï¼Œå¦‚æœæ•°å­—çš„è¯ï¼Œç›´æ¥æ‰¾åˆ°æ•°ç»„çš„indexå°±å¯ä»¥äº†\nå•é“¾è¡¨ ä¸‹å›¾æ˜¯å•é“¾è¡¨çš„é€»è¾‘ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œå½“æŸä¸ªèŠ‚ç‚¹çš„nextä¸ºnilçš„æ—¶å€™ï¼Œå°±åˆ°äº†å°¾èŠ‚ç‚¹\nå•é“¾è¡¨åº”ç”¨å®æˆ˜ ç”¨å•é“¾è¡¨å®ç°å¯¹è¶³çƒæ˜æ˜Ÿæ’åçš„å­˜å‚¨ï¼ˆä¸ªäººå–œå¥½ï¼Œä¸ä¾›å‚è€ƒï¼‰\nå®Œæˆå¯¹çƒæ˜Ÿäººç‰©çš„ å¢åˆ æ”¹æŸ¥ æ“ä½œ æ ¹æ®æ’åå¯¹çƒæ˜Ÿæ’åè¿›è¡Œæ’åº åŒå‘é“¾è¡¨ å•é“¾è¡¨çš„ç¼ºé™·ï¼š\næŸ¥æ‰¾æ–¹å‘åªèƒ½æ˜¯å•å‘çš„ ä¸èƒ½è‡ªæˆ‘åˆ é™¤ï¼Œéœ€è¦ä¾é è¾…åŠ©èŠ‚ç‚¹ åŒå‘è¿è¡¨ç®€å›¾ï¼š\næ’å…¥ï¼š\ntmp.next.pre = newNode tmp.next = newNode newNode.pre = tmp newNode.next = tmp.next åˆ é™¤ï¼š\ntmp.next.pre = tmp.pre tmp.pre.next = tmp. Josephu é—®é¢˜ k è¡¨ç¤ºç¯å½¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹æ•° m è¡¨ç¤º å–Šå·çš„æ¬¡æ•° 3,æ ˆ æ ˆçš„åº”ç”¨åœºæ™¯ å­ç¨‹åºçš„è°ƒç”¨\nåœ¨è·³å¾€å­ç¨‹åºå‰ï¼Œä¼šå…ˆå°† ä¸‹ä¸ªæŒ‡ä»¤çš„åœ°å€ å­˜åˆ°å †æ ˆä¸­ï¼Œç›´åˆ°å­ç¨‹åºæ‰§è¡Œå®Œåå† å°†åœ°å€å–å‡ºï¼Œä»¥ å›åˆ°åŸæ¥çš„ç¨‹åºä¸­ã€‚\nå¦‚æ–¹æ³•ä¸­è°ƒç”¨æ–¹æ³•ã€‚\nå¤„ç†é€’å½’è°ƒç”¨\nå’Œå­ç¨‹åºè°ƒç”¨ç±»ä¼¼ï¼Œåªæ˜¯é™¤äº†å­˜å‚¨ä¸‹ä¸€ä¸ªæŒ‡ä»¤çš„åœ°å€å¤–ï¼Œä¹Ÿå°†å‚æ•°ã€åŒºåŸŸå˜é‡ç­‰æ•°æ®å­˜å…¥å †æ ˆä¸­ã€‚\nè¡¨è¾¾å¼çš„è½¬æ¢ï¼ˆä¸­ç¼€è¡¨è¾¾å¼è½¬åç¼€è¡¨è¾¾å¼ï¼‰ä¸æ±‚å€¼ï¼ˆå®é™…è§£å†³ï¼‰\näºŒå‰æ ‘çš„éå†\nå›¾å½¢çš„æ·±åº¦ä¼˜å…ˆï¼ˆdepth-firstï¼‰æœç´¢æ³•\n4,å“ˆå¸Œè¡¨ ä»‹ç» æ•£åˆ—è¡¨ï¼ˆHash tableï¼‰ï¼Œä¹Ÿå«å“ˆå¸Œè¡¨ã€‚æ˜¯æ ¹æ® å…³é”®ç å€¼ï¼ˆkey valueï¼‰ è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ã€‚\nå“ˆå¸Œè¡¨åœ¨å†…å­˜ä¸­çš„ç»“æ„å°±å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nå¦‚ä¸Šæ‰€è¿°ï¼š\nå·¦ä¾§æœ‰ 15 ä¸ªå…ƒç´ çš„æ•°ç»„ï¼ˆå¯ä»¥ç”¨æ•°ç»„å®ç°ï¼‰ï¼Œå°±æ˜¯ä¸€ä¸ªè¡¨\nè¯¥è¡¨ä¸­å­˜æ”¾çš„æ˜¯ä¸€ä¸ªé“¾è¡¨\né€šè¿‡ æ•£åˆ—å‡½æ•°ï¼Œè®¡ç®—å‡ºä¸€ä¸ªä½ç½®ï¼Œç„¶ååœ¨æŠŠæ•°æ®å­˜å‚¨åˆ°è¿™ä¸ªé“¾è¡¨ä¸Š\næ¯”å¦‚ä¸Šé¢æœ‰ 15 ä¸ªï¼Œå¯ä»¥è®¡ç®—å‡ºæ•£åˆ—å€¼åï¼Œå†å–æ¨¡ã€‚ 111 % 15 ï¼Œå°±å®šä½åœ¨äº†æŸä¸€ä¸ªå…ƒç´ ä½ç½®ä¸Šã€‚\nä»£ç å®ç° package main import \u0026#34;fmt\u0026#34; type Employee struct { ID int Name string Sal int Next *Employee } type EmpHashTable struct { Table []*Employee Size int } func NewTable(size int) *EmpHashTable { return \u0026amp;EmpHashTable{ Table: make([]*Employee, size), Size: size, } } // æ’å…¥ func (ht *EmpHashTable) Insert(emp *Employee) { Index := int(emp.ID) % ht.Size if ht.Table[Index] == nil { ht.Table[Index] = emp } else { current := ht.Table[Index] for current.Next != nil { current = current.Next } current.Next = emp } } // æŸ¥æ‰¾ func (ht *EmpHashTable) search(id int) (emp *Employee) { Index := id % ht.Size if ht.Table[Index].ID == id { return ht.Table[Index] } else { current := ht.Table[Index] for current != nil { if current.ID == id { return current } current = current.Next } } return nil } // åˆ é™¤ func (ht *EmpHashTable) del(id int) bool { Index := id % ht.Size current := ht.Table[Index] var prev *Employee for current != nil { if current.ID == id { if prev == nil { //åˆ é™¤çš„æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´  ht.Table[Index] = current.Next } else { //ä¸­é—´æˆ–è€…æœ«å°¾ prev.Next = current.Next } return true } prev = current current = current.Next } return false } // ä¿®æ”¹ func (ht *EmpHashTable) change(id int, newEmp *Employee) bool { Index := id % ht.Size current := ht.Table[Index] for current != nil { if current.ID == id { current.Name = newEmp.Name current.Sal = newEmp.Sal return true } current = current.Next } return false } // éå† func (ht *EmpHashTable) DisPlayAll() { for _, emp := range ht.Table { current := emp for current != nil { fmt.Printf(\u0026#34;ID:%d,Name:%s,sal:%d\\n\u0026#34;, current.ID, current.Name, current.Sal) current = current.Next } } } func main() { empTable := NewTable(5) empTable.Insert(\u0026amp;Employee{ID: 101, Name: \u0026#34;x14n\u0026#34;, Sal: 3000}) empTable.Insert(\u0026amp;Employee{ID: 102, Name: \u0026#34;x14n\u0026#34;, Sal: 3000}) empTable.Insert(\u0026amp;Employee{ID: 103, Name: \u0026#34;x14n\u0026#34;, Sal: 3000}) empTable.Insert(\u0026amp;Employee{ID: 104, Name: \u0026#34;x14n\u0026#34;, Sal: 3000}) empTable.Insert(\u0026amp;Employee{ID: 105, Name: \u0026#34;x14n\u0026#34;, Sal: 3000}) empTable.Insert(\u0026amp;Employee{ID: 106, Name: \u0026#34;x14n\u0026#34;, Sal: 3000}) empTable.Insert(\u0026amp;Employee{ID: 107, Name: \u0026#34;x14n\u0026#34;, Sal: 3000}) empTable.Insert(\u0026amp;Employee{ID: 108, Name: \u0026#34;x14n\u0026#34;, Sal: 3000}) empTable.Insert(\u0026amp;Employee{ID: 109, Name: \u0026#34;x14n\u0026#34;, Sal: 3000}) emp := empTable.search(101) if emp == nil { fmt.Println(\u0026#34;no found\u0026#34;) } else { fmt.Println(\u0026#34;find\u0026#34;) fmt.Printf(\u0026#34;ID:%d,Name:%s,sal:%d\\n\u0026#34;, emp.ID, emp.Name, emp.Sal) } empTable.DisPlayAll() fmt.Println(\u0026#34;//åˆ é™¤\u0026#34;) empTable.del(102) fmt.Println(\u0026#34;//ä¿®æ”¹\u0026#34;) empTable.change(101, \u0026amp;Employee{Name: \u0026#34;ahahah\u0026#34;, Sal: 10000000}) fmt.Println(\u0026#34;////////\u0026#34;) empTable.search(101) fmt.Println(\u0026#34;////////\u0026#34;) empTable.DisPlayAll() } 5,æ ‘åŸºç¡€ äºŒå‰æ ‘ ä»‹ç» ç®€å•æ¥è¯´å°±æ˜¯å·¦å­èŠ‚ç‚¹å°äºrootï¼Œå³èŠ‚ç‚¹å¤§äºroot\néå† å‰åºéå†ï¼šå…ˆè¾“å‡ºçˆ¶èŠ‚ç‚¹ï¼Œåœ¨éå†å·¦èŠ‚ç‚¹ï¼ˆé€’å½’ï¼‰ï¼Œå†éå†å³èŠ‚ç‚¹ï¼ˆé€’å½’ï¼‰\nä¸­åºéå†ï¼šå…ˆéå†å·¦å­æ ‘ï¼ˆé€’å½’ï¼‰ï¼Œå†è¾“å‡ºçˆ¶èŠ‚ç‚¹ï¼Œå†éå†å³å­æ ‘ï¼ˆé€’å½’ï¼‰\nååºéå†ï¼šå…ˆéå†å·¦å­æ ‘ï¼ˆé€’å½’ï¼‰ï¼Œå†å³å­æ ‘ï¼ˆé€’å½’ï¼‰ï¼Œå†çˆ¶èŠ‚ç‚¹\nå‰ï¼š a -\u0026gt; b -\u0026gt; d -\u0026gt;e -\u0026gt;c\nä¸­: d -\u0026gt; b -\u0026gt; e -\u0026gt; a -\u0026gt;c\nåï¼š d-\u0026gt;e -\u0026gt; b-\u0026gt; c -\u0026gt;a\nåˆ é™¤ // æ’å…¥åŸå§‹ func (bt *binaryTree) insert(key int) { if bt.root == nil { bt.root = \u0026amp;node{key: key} } bt.insertRecursively(bt.root, key) } func (bt *binaryTree) insertRecursively(root *node, key int) { if key \u0026lt; root.key { if root.LeftChild == nil { root.LeftChild = \u0026amp;node{key: key} } else { bt.insertRecursively(root.LeftChild, key) } } else { if root.RightChild == nil { root.RightChild = \u0026amp;node{key: key} } else { bt.insertRecursively(root.RightChild, key) } } } // æœç´¢å…ƒç´  func (bt *binaryTree) search(key int) bool { return bt.searchRecurisively(bt.root, key) } func (bt *binaryTree) searchRecurisively(root *node, key int) bool { if root == nil { fmt.Println(\u0026#34;root is nil\u0026#34;) return false } if root.key == key { return true } if root.key \u0026gt; key { return bt.searchRecurisively(root.LeftChild, key) } else { return bt.searchRecurisively(root.RightChild, key) } } // å‰åºéå† func (bt *binaryTree) PerOrderTraversal(node *node) { if node != nil { fmt.Printf(\u0026#34;%d\u0026#34;, node.key) bt.PerOrderTraversal(node.LeftChild) bt.PerOrderTraversal(node.RightChild) } } // ä¸­åºéå† func (bt *binaryTree) InOrderTraversal(root *node) { if root != nil { bt.InOrderTraversal(root.LeftChild) fmt.Printf(\u0026#34;%d\u0026#34;, root.key) bt.InOrderTraversal(root.RightChild) } } // ååºéå† func (bt *binaryTree) PostOrderTraversal(root *node) { if root != nil { bt.PostOrderTraversal(root.RightChild) bt.PostOrderTraversal(root.LeftChild) fmt.Printf(\u0026#34;%d\u0026#34;, root.key) } } é¡ºåºæŸ¥æ‰¾äºŒå‰æ ‘ é¡ºåºäºŒå‰æ ‘ é€šå¸¸åªè€ƒè™‘ å®Œå…¨äºŒå‰æ ‘ ç¬¬ n ä¸ªå…ƒç´ çš„ å·¦å­èŠ‚ç‚¹ ä¸º 2*n+1 ç¬¬ n ä¸ªå…ƒç´ çš„ å³å­èŠ‚ç‚¹ ä¸º 2*n+2 ç¬¬ n ä¸ªå…ƒç´ çš„ çˆ¶èŠ‚ç‚¹ ä¸º (n-1)/2 çº¿ç´¢åŒ–äºŒå‰æ ‘ 6,æ ‘å®é™… å †æ’åº ä»‹ç» å †æ˜¯å…·æœ‰ä»¥ä¸‹æ€§è´¨çš„å®Œå…¨äºŒå‰æ ‘ï¼š\nå¤§é¡¶å †ï¼šæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½ å¤§äºæˆ–ç­‰äº å…¶å·¦å³å­©å­èŠ‚ç‚¹çš„å€¼\næ³¨ï¼šæ²¡æœ‰è¦æ±‚å·¦å³å€¼çš„å¤§å°å…³ç³»\nå°é¡¶å †ï¼šæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½ å°äºæˆ–ç­‰äº å…¶å·¦å³å­©å­èŠ‚ç‚¹çš„å€¼\nå¤§é¡¶å †\nå¯¹å †ä¸­çš„èŠ‚ç‚¹æŒ‰å±‚è¿›è¡Œç¼–å·ï¼Œæ˜ å°„åˆ°æ•°ç»„ä¸­å¦‚ä¸‹å›¾\nå°é¡¶å †ï¼ˆåä¹‹ï¼‰\nå †æ’åºæ€è·¯\u0026mdash;- package main import ( \u0026#34;fmt\u0026#34; ) func heapSort(arr []int) { n := len(arr) // æ„å»ºæœ€å¤§å † for i := n/2 - 1; i \u0026gt;= 0; i-- { heapify(arr, n, i) } // ä¾æ¬¡å–å‡ºå †é¡¶å…ƒç´ ï¼Œäº¤æ¢ä½ç½®ï¼Œé‡æ–°å †åŒ– for i := n - 1; i \u0026gt; 0; i-- { // äº¤æ¢å †é¡¶å’Œå½“å‰å †çš„æœ€åä¸€ä¸ªå…ƒç´  arr[i], arr[0] = arr[0], arr[i] // å¯¹äº¤æ¢åçš„å †é¡¶æ‰§è¡Œå †åŒ– heapify(arr, i, 0) } } func heapify(arr []int, n, i int) { largest := i left := 2*i + 1 right := 2*i + 2 // æ‰¾å‡ºå·¦å­èŠ‚ç‚¹å’Œå³å­èŠ‚ç‚¹ä¸­çš„æœ€å¤§å€¼ if left \u0026lt; n \u0026amp;\u0026amp; arr[left] \u0026gt; arr[largest] { largest = left } if right \u0026lt; n \u0026amp;\u0026amp; arr[right] \u0026gt; arr[largest] { largest = right } // å¦‚æœæœ€å¤§å€¼ä¸æ˜¯çˆ¶èŠ‚ç‚¹ï¼Œäº¤æ¢çˆ¶èŠ‚ç‚¹å’Œæœ€å¤§å€¼ï¼Œç„¶åé€’å½’å †åŒ– if largest != i { arr[i], arr[largest] = arr[largest], arr[i] heapify(arr, n, largest) } } func main() { arr := []int{4, 10, 3, 5, 1} fmt.Println(\u0026#34;Unsorted array:\u0026#34;, arr) heapSort(arr) fmt.Println(\u0026#34;Sorted array:\u0026#34;, arr) } å…³äºå †æ’åºçš„æ€è€ƒ æœ€å¼€å§‹æˆ‘è®¤ä¸ºå †æ’åºä¸ºä»€ä¹ˆä¸ç›´æ¥ å°†äºŒå‰æ ‘ä¸­çš„å¶å­èŠ‚ç‚¹çš„å€¼å­˜åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç„¶åå¯¹æ•°ç»„çš„å€¼è¿›è¡Œä»å°åˆ°å¤§è¿›è¡Œ\tæ’åºï¼Œç„¶åæ ¹æ®æ•°ç»„çš„ç´¢å¼•å’Œç´¢å¼•çš„å€¼åˆ›å»ºä¸€ä¸ªæ–°çš„äºŒå‰æ ‘ï¼Œè¿™æ ·ä¸æ˜¯æ›´ç®€å•å—ï¼Œä»”ç»†æƒ³æƒ³è¿™ä¸æ˜¯æ›´ç®€å•å—ã€‚\nå †æ’åºä¹‹æ‰€ä»¥é«˜æ•ˆçš„åŸå› ï¼š\nä¸éœ€è¦é¢å¤–çš„æ•°æ®ç»“æ„ï¼š å †æ’åºç›´æ¥åœ¨åŸå§‹æ•°ç»„ä¸Šè¿›è¡Œæ“ä½œï¼Œä¸éœ€è¦é¢å¤–çš„æ•°æ®ç»“æ„æ¥å­˜å‚¨èŠ‚ç‚¹çš„å€¼ã€‚è¿™èŠ‚çœäº†ç©ºé—´ï¼Œå¹¶å‡å°‘äº†å¤æ‚æ€§ã€‚ åŸåœ°æ’åºï¼š å †æ’åºæ˜¯ä¸€ç§åŸåœ°æ’åºç®—æ³•ï¼Œå®ƒä¸éœ€è¦é¢å¤–çš„å†…å­˜æ¥å­˜å‚¨ä¸­é—´ç»“æœï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦ä¸º O(1)ã€‚ æ—¶é—´å¤æ‚åº¦ï¼š å †æ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n log n)ï¼Œå…¶ä¸­ n æ˜¯è¦æ’åºçš„å…ƒç´ æ•°é‡ã€‚è¿™æ˜¯ä¸€ç§éå¸¸é«˜æ•ˆçš„æ’åºç®—æ³•ï¼Œç‰¹åˆ«é€‚ç”¨äºå¤§å‹æ•°æ®é›†ã€‚ å¦‚æœæŒ‰ç…§åŸæ¥çš„æ€è·¯ä¼šå¸¦æ¥çš„é—®é¢˜ï¼š\nåˆ›å»ºäº†é¢å¤–çš„æ•°æ®ç»“æ„ï¼Œå¢åŠ äº†ç©ºé—´å¤æ‚åº¦ å¢åŠ äº†æ—¶é—´å¤æ‚åº¦ â€‹\nèµ«å¤«æ›¼æ ‘ ä»‹ç» æƒè·¯å¾„é•¿åº¦æœ€å°ï¼ˆwplï¼‰çš„äºŒå‰æ ‘ç§°ä¸ºæœ€ä¼˜äºŒå‰æ ‘ä¹Ÿè¢«æˆä¸ºèµ«å¤«æ›¼æ ‘ã€‚\nèµ«å¤«æ›¼æ ‘æ˜¯å¸¦å…¨è·¯å¾„é•¿åº¦æœ€çŸ­çš„æ ‘ï¼Œæƒå€¼è¾ƒå¤§çš„èŠ‚ç‚¹ç¦»æ ¹èŠ‚ç‚¹è¾ƒè¿‘\nç›¸å…³æ¦‚å¿µ è·¯å¾„ å’Œ è·¯å¾„é•¿åº¦ï¼š\nåœ¨ä¸€é¢—æ ‘ä¸­ï¼Œä»ä¸€ä¸ªèŠ‚ç‚¹å¾€ä¸‹å¯ä»¥åˆ°è¾¾çš„å­©å­æˆ–å­™å­èŠ‚ç‚¹ä¹‹é—´çš„é€šè·¯ï¼Œç§°ä¸º è·¯å¾„ã€‚\né€šè·¯ä¸­åˆ†æ”¯çš„æ•°ç›®ç§°ä¸ºè·¯å¾„é•¿åº¦ã€‚è‹¥è§„å®šæ ¹èŠ‚ç‚¹çš„å±‚æ•°ä¸º 1ï¼Œåˆ™ä»æ ¹èŠ‚ç‚¹åˆ°ç¬¬ L å±‚èŠ‚ç‚¹çš„è·¯å¾„é•¿åº¦ä¸º L-1\nèŠ‚ç‚¹çš„æƒ åŠ å¸¦æƒè·¯å¾„é•¿åº¦\nè‹¥å°†æ ‘ä¸­èŠ‚ç‚¹èµ‹ç»™ä¸€ä¸ªæœ‰ç€æŸç§å‡½æ•°çš„æ•°å€¼ï¼Œåˆ™è¿™ä¸ªæ•°å€¼ç§°ä¸ºè¯¥èŠ‚ç‚¹çš„ æƒã€‚\nèŠ‚ç‚¹çš„å¸¦æƒè·¯å¾„é•¿åº¦ä¸ºï¼šä»æ ¹èŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹ä¹‹é—´çš„è·¯å¾„é•¿åº¦ä¸è¯¥èŠ‚ç‚¹çš„æƒçš„ä¹˜ç§¯ã€‚\næ ‘çš„å¸¦æƒè·¯å¾„é•¿åº¦\næ‰€æœ‰å¶å­èŠ‚ç‚¹çš„å¸¦æƒè·¯å¾„é•¿åº¦ä¹‹å’Œï¼Œè®°ä¸º WPLï¼ˆweighted path lengthï¼‰ï¼Œæƒå€¼è¶Šå¤§çš„èŠ‚ç‚¹ç¦»æ ¹èŠ‚ç‚¹è¶Šè¿‘çš„äºŒå‰æ ‘æ‰æ˜¯æœ€ä¼˜äºŒå‰æ ‘\nèµ«å¤«æ›¼æ ‘å®ç°\u0026mdash;\u0026mdash; äºŒå‰æ’åºæ ‘ ä»‹ç» å¯¹äºäºŒå‰æ’åºæ ‘çš„ä»»ä½•ä¸€ä¸ª éå¶å­èŠ‚ç‚¹ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š\nå·¦èŠ‚ç‚¹ï¼Œæ¯”çˆ¶èŠ‚ç‚¹å° å³èŠ‚ç‚¹ï¼Œæ¯”çˆ¶èŠ‚ç‚¹å¤§ å®Œæ•´å¹³è¡¡äºŒå‰æ ‘ï¼ˆAVLæ ‘ï¼‰ ä»‹ç» å¹³è¡¡äºŒå‰æ ‘ä¹Ÿå« å¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼ˆSelf-balancing binary search treeï¼‰ï¼Œåˆè¢«ç§°ä¸º AVL æ ‘ï¼Œå¯ä»¥ä¿è¯ æŸ¥è¯¢æ•ˆç‡è¾ƒé«˜ã€‚å®ƒæ˜¯è§£å†³ äºŒå‰æ’åº å¯èƒ½å‡ºç°çš„æŸ¥è¯¢é—®é¢˜ã€‚\nå®ƒçš„ç‰¹ç‚¹ï¼šæ˜¯ä¸€é¢—ç©ºæ ‘æˆ–å®ƒçš„ å·¦å³ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡ 1ï¼Œå¹¶ä¸”å·¦å³ä¸¤ä¸ªå­æ ‘éƒ½æ˜¯ä¸€é¢—å¹³è¡¡äºŒå‰æ ‘ã€‚\nå¦‚ä¸‹æ‰€è¿°ï¼Œå“ªäº›æ˜¯å¹³è¡¡äºŒå‰æ ‘ï¼Ÿ\næ˜¯å¹³è¡¡äºŒå‰æ ‘ï¼š\nå·¦å­æ ‘é«˜åº¦ä¸º 2 å³å­æ ‘é«˜åº¦ä¸º 1 ä»–ä»¬å·®å€¼ä¸º 1\nä¹Ÿæ˜¯å¹³è¡¡äºŒå‰æ ‘\nä¸æ˜¯å¹³è¡¡äºŒå‰æ ‘\nå·¦å­æ ‘é«˜åº¦ä¸º 3 å³å­æ ‘é«˜åº¦ä¸º 1 ä»–ä»¬å·®å€¼ä¸º 2ï¼Œæ‰€ä»¥ä¸æ˜¯\nå¹³è¡¡äºŒå‰æ ‘çš„å¸¸ç”¨å®ç°æ–¹æ³•æœ‰ï¼š çº¢é»‘æ ‘\nAVLï¼ˆç®—æ³•ï¼‰\næ›¿ç½ªç¾Šæ ‘\nTreap\nä¼¸å±•æ ‘\n7,å¤šè·¯æŸ¥æ‰¾æ ‘ äºŒå‰æ ‘ä¸Bæ ‘ Bæ ‘,B+æ ‘,B*æ ‘ 8,å›¾ (S)ç®—æ³• 1,é€’å½’ 2,æ’åºç®—æ³• å†’æ³¡æ’åº func bubbleSort(arrs []int) { len := len(arrs) for i := 0; i \u0026lt; len-1; i++ { for j := 0; j \u0026lt; len-i-1; j++ { if arrs[j] \u0026gt; arrs[j+1] { arrs[j], arrs[j+1] = arrs[j+1], arrs[j] } } } } é€‰æ‹©æ’åº func selectSort(arr []int) { n := len(arr) for i := 0; i \u0026lt; n-1; i++ { minIndex := i for j := i + 1; j \u0026lt; n; j++ { if arr[j] \u0026lt; arr[minIndex] { minIndex = j } } if minIndex != i { arr[i], arr[minIndex] = arr[minIndex], arr[i] // äº¤æ¢å…ƒç´  } } } æ’å…¥æ’åº package main import \u0026#34;fmt\u0026#34; func InsertSort(array []int) { n := len(array) for i := 1; i \u0026lt; n; i++ { for js := i; js \u0026gt; 0; js-- { if array[js] \u0026lt; array[js-1] { array[js], array[js-1] = array[js-1], array[js] } } } } func main() { array := []int{7, 6, 4, 5, 3, 2} InsertSort(array) fmt.Println(array) } å¸Œå°”æ’åº å¿«é€Ÿæ’åº å½’å¹¶æ’åº åŸºæ•°æ’åº å¸¸ç”¨æ’åºç®—æ³•æ€»ç»“å¯¹æ¯” 3,æŸ¥æ‰¾ç®—æ³• 4,åç§å¸¸ç”¨ç®—æ³• äºŒåˆ†æŸ¥æ‰¾(éé€’å½’) åˆ†æ²»ç®—æ³• åŠ¨æ€è§„åˆ’ç®—æ³• KMPç®—æ³• è´ªå¿ƒç®—æ³• æ™®åˆ©å§†ç®—æ³• è¿ªæ°æ–¯ç‰¹æ‹‰ç®—æ³• é©¬è¸æ£‹ç®—æ³• æ™®æ´›ä¼Šå¾·ç®—æ³• ","permalink":"https://XianCH.github.io/posts/tech/basic/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/","summary":"\u003ch1 id=\"fæ•°æ®ç»“æ„\"\u003e(F)æ•°æ®ç»“æ„\u003c/h1\u003e\n\u003ch2 id=\"1æ•°ç»„å’Œé˜Ÿåˆ—\"\u003e1,æ•°ç»„å’Œé˜Ÿåˆ—\u003c/h2\u003e\n\u003ch3 id=\"ç¨€ç–æ•°ç»„\"\u003eç¨€ç–æ•°ç»„\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eä»‹ç»\u003c/p\u003e\n\u003cp\u003eå½“ä¸€ä¸ªç´ ç»„ä¸­å¤§éƒ¨åˆ†ä¸º0æˆ–è€…éƒ½æ˜¯åŒä¸€ä¸ªæ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç¨€ç–æ•°ç»„æ¥ä¿å­˜è¯¥æ•°ç»„ï¼Œå°±åƒæ˜¯äº”å­æ£‹æ¸¸æˆä¸€æ ·ï¼ŒæŠŠæ•´ä¸ªäº”å­æ£‹æ£‹ç›˜å®šä¹‰æˆä¸€ä¸ªäºŒä½æ•°ç»„ï¼Œå¤§éƒ¨åˆ†ä¸º0.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eå¤„ç†æ–¹å¼\u003c/p\u003e\n\u003cp\u003e1.è®°å½•ä¸€ä¸ªæ•°ç»„ä¸€å…±æœ‰å‡ è¡Œå‡ åˆ—ï¼Œæœ‰å¤šå°‘ä¸ªä¸åŒçš„å€¼\u003c/p\u003e\n\u003cp\u003e2.æŠŠå…·æœ‰ \u003cstrong\u003eä¸åŒå€¼çš„å…ƒç´ \u003c/strong\u003e çš„ \u003cstrong\u003eè¡Œåˆ—åŠå€¼\u003c/strong\u003e è®°å½•åœ¨ä¸€ä¸ª \u003cstrong\u003eå°è§„æ¨¡çš„æ•°ç»„\u003c/strong\u003e ä¸­ï¼Œä»è€Œç¼©å°ç¨‹åºçš„è§„æ¨¡\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eå®é™…åº”ç”¨\u003c/strong\u003e\u003c/p\u003e","title":"goæ•°æ®ç»“æ„ä¸ç®—æ³•ï¼ˆæ›´æ–°ä¸­ï¼‰"},{"content":" åŸºç¡€ç›¸å…³ varå’Œ:=æ¥å®šä¹‰å˜é‡æœ‰ä»€ä¹ˆä¸åŒï¼Ÿnewå’Œmakeåˆå§‹åŒ–å˜é‡æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ\n#var ç”¨æ¥å®šä¹‰å•ä¸ªæˆ–è€…å¤šä¸ªå˜é‡å˜é‡,:=ä¸€èˆ¬ç”¨æ¥åˆ›å»ºå˜é‡å¹¶ä¸”ç”¨æ¥ç»™å˜é‡å¤èµ‹å€¼ var a int a =5 a :=5 #new ç”¨æ¥åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–°åˆ†é…é›¶å€¼å¯¹è±¡çš„æŒ‡é’ˆï¼Œå¹¶è¿”å›æŒ‡å‘è¯¥å®ä¾‹çš„æŒ‡é’ˆï¼Œnewè¿”å›çš„æ˜¯æŒ‡é’ˆå¯¹è±¡ #make ç”¨æ¥åˆ›å»ºåˆ‡ç‰‡ï¼Œé€šé“å’Œæ˜ å°„ç­‰å†…ç½®æ•°æ®ç»“æ„ï¼Œå¹¶åˆå§‹åŒ– p := new(int) slience := make([]int,0,10) deferæ˜¯åšä»€ä¹ˆç”¨çš„ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºé‡Œé¢æœ‰å¤šä¸ªdeferä¼šæ€ä¹ˆæ ·ï¼Ÿ\nå»¶è¿Ÿçš„å‡½æ•°æ¨é€æ‰§è¡Œï¼Œå…ˆè¿›å…ˆå‡ºï¼Œä¸€èˆ¬ç”¨æ¥å…³é—­æ–‡ä»¶èµ„æºã€‚ç¬¬ä¸€ä¸ªdeferä¸€èˆ¬æ˜¯åœ¨æ•´ä¸ªç¨‹åºè¿è¡Œç»“æŸåç¬¬ä¸€ä¸ªæ‰§è¡Œï¼Œç„¶åæ‰åˆ°æ‰§è¡Œä¸‹ä¸€ä¸ª åˆ‡ç‰‡çš„åº•å±‚æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿinterfaceçš„ä¸¤ç§ç”¨æ³•äº†è§£å—ï¼Ÿäº†è§£interfaceçš„åº•å±‚å®ç°å—ï¼Ÿ\nå¦‚ä¸Šå›¾åˆ‡ç‰‡å…¶å®æ˜¯åº”ç”¨ç±»å‹ï¼Œæœ‰ä¸‰ä¸ªå­—æ®µï¼š1.æŒ‡å‘åº”ç”¨æ•°ç»„çš„æŒ‡é’ˆï¼Œé•¿åº¦ï¼Œå’Œå®¹é‡ã€‚å½“å¯¹æŸä¸ªåˆ‡ç‰‡è¿›è¡Œslien[1:3]å…¶å®æ˜¯åˆ›å»ºäº†æ–°çš„åˆ‡ç‰‡ã€‚ 1.ç±»å‹æ–­è¨€\tvalue, ok := someInterface.(SomeType) 2.ç±»å‹æŸ¥è¯¢\tswitch v := someInterface.(type) { case SomeType1: // å¤„ç† SomeType1 ç±»å‹ case SomeType2: // å¤„ç† SomeType2 ç±»å‹ default: // é»˜è®¤å¤„ç† } æ€ä¹ˆç”¨çš„mapï¼Œä¼šæœ‰å¹¶å‘é—®é¢˜å—ï¼Ÿæ€ä¹ˆæ±‚ä¸€ä¸ªmapçš„é•¿åº¦ï¼ˆlenå°±å¯ä»¥ï¼Œå®³ï¼‰ã€‚sync.Mapå¯ä»¥ç”¨lenæ¥æ±‚é•¿åº¦å—ï¼Ÿï¼ˆåº”è¯¥æ˜¯æƒ³è¦é—®sync.Mapçš„åº•å±‚å§ï¼‰\n//makeç¤ºä¾‹ myMap = make(map[string]int) len(map) å…³äºå¹¶å‘é—®é¢˜ï¼Œæ ‡å‡†çš„ Go map ä¸æ˜¯å¹¶å‘å®‰å…¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå¤šä¸ª goroutine åŒæ—¶è¯»å†™ä¸€ä¸ª mapï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®ç«äº‰å’Œä¸ç¡®å®šçš„ç»“æœã€‚ä¸ºäº†åœ¨å¹¶å‘ç¯å¢ƒä¸‹å®‰å…¨ä½¿ç”¨ mapï¼Œä½ å¯ä»¥ä½¿ç”¨äº’æ–¥é”ï¼ˆsync.Mutexï¼‰æ¥ä¿æŠ¤ mapï¼Œæˆ–è€…ä½¿ç”¨ sync.Mapï¼Œåè€…æ˜¯ Go 1.9 å¼•å…¥çš„å¹¶å‘å®‰å…¨çš„æ˜ å°„ç±»å‹ã€‚ //ç”¨äº’æ–¥é”æ¥ä¿æŠ¤æ ‡å‡†çš„\u0026#39;map\u0026#39;ï¼š package main import ( \u0026#34;fmt\u0026#34; \u0026#34;sync\u0026#34; ) func main() { myMap := make(map[string]int) var mu sync.Mutex var wg sync.WaitGroup for i := 0; i \u0026lt; 100; i++ { wg.Add(1) go func(n int) { defer wg.Done() mu.Lock() myMap[\u0026#34;key\u0026#34;] = n mu.Unlock() }(i) } fmt.Println(\u0026#34;Waiting for goroutines to finish...\u0026#34;) wg.Wait() mu.Lock() fmt.Println(\u0026#34;Map:\u0026#34;, myMap) mu.Unlock() } ç„¶è€Œï¼Œåœ¨ sync.Map ä¸­ï¼Œä½ ä¸èƒ½ç›´æ¥ä½¿ç”¨ len() å‡½æ•°æ¥è·å–é•¿åº¦ã€‚sync.Map ä¸æä¾›è·å–é•¿åº¦çš„æ–¹æ³•ã€‚è¿™æ˜¯å› ä¸º sync.Map çš„è®¾è®¡ç›®æ ‡æ˜¯åœ¨å¹¶å‘ç¯å¢ƒä¸‹è¿›è¡Œè¯»å†™æ“ä½œï¼Œè€Œä¸æ˜¯é¢‘ç¹è·å–é•¿åº¦ç­‰æ“ä½œã€‚å¦‚æœä½ éœ€è¦è·Ÿè¸ª sync.Map çš„é•¿åº¦ï¼Œå¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªè®¡æ•°å™¨ï¼Œåœ¨æ¯æ¬¡æ’å…¥æˆ–åˆ é™¤é”®å€¼å¯¹æ—¶è¿›è¡Œé€’å¢æˆ–é€’å‡æ“ä½œæ¥ç»´æŠ¤é•¿åº¦ä¿¡æ¯ã€‚ä½†è¦æ³¨æ„ï¼Œåœ¨å¤šä¸ªå¹¶å‘æ“ä½œä¸­ï¼Œä½ éœ€è¦æ­£ç¡®åœ°å¤„ç†è®¡æ•°å™¨çš„å¢å‡ï¼Œä»¥é¿å…ç«æ€æ¡ä»¶ã€‚ package main import ( \u0026#34;fmt\u0026#34; \u0026#34;sync\u0026#34; ) func main() { var myMap sync.Map for i := 0; i \u0026lt; 100; i++ { key := fmt.Sprintf(\u0026#34;key%d\u0026#34;, i) myMap.Store(key, i) } fmt.Println(\u0026#34;wating all gonrint down....\u0026#34;) myMap.Range(func(key, value interface{}) bool { fmt.Printf(\u0026#34;Key: %v, Value: %v\\n\u0026#34;, key, value) return true }) } æœ‰ç¼“å†²å’Œæ— ç¼“å†²channelçš„åŒºåˆ«\næ— ç¼“å†²(\u0026lt;-)ï¼šè¡¨ç¤ºå¦‚æœå‘é€šé“ä¸­è¾“å…¥æ•°æ®ï¼Œä½†æ˜¯è¯¥é€šé“æ²¡æœ‰è¾“å‡ºæ–¹ï¼Œåˆ™ä¼šå µå¡,ç›´åˆ°åŒæ–¹éƒ½å‡†å¤‡å¥½ æœ‰ç¼“å†²ï¼šåœ¨ç¼“å†²å€¼æ²¡æœ‰æ»¡ä¹‹å‰å¯ä»¥ä¸€ç›´å‘é€šé“è¾“å…¥æ•°æ® selectä¸­å¦‚æœæ²¡æœ‰defaultä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿï¼ˆselectä¼šé˜»å¡ï¼Œç›´åˆ°æœ‰caseå¯ä»¥æ‰§è¡Œï¼‰caseä¸­çš„é€šé“è¢«å…³é—­äº†ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿï¼ˆåªæœ‰è¿™ä¸€ä¸ªçš„è¯ä¼šæ­»å¾ªç¯ï¼Œå¯ä»¥ç”¨,okåˆ¤æ–­ä¸€ä¸‹ï¼‰\nmapæ˜¯æœ‰åºçš„å—ï¼Ÿmapåº•å±‚å®ç°æ€ä¹ˆå¤„ç†hashç¢°æ’çš„é—®é¢˜ï¼Ÿ\nrecoverå’Œpanicçš„å®ç°åŸç†\næ˜¯å¦äº†è§£åå°„\næ™®é€šçš„mapåŠ é”ä½¿ç”¨ä¸ç›´æ¥ç”¨sync.mapæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿï¼ˆåˆ†åˆ«è¯´äº†ä½¿ç”¨ä¸Šå’Œæ€§èƒ½ä¸Šï¼‰\nå¹¶å‘ç›¸å…³ golangåç¨‹çš„è°ƒåº¦ï¼ŒèŠèŠå¯¹GMPæ¨¡å‹çš„ç†è§£ æ€ä¹ˆå®ç°å¹¶å‘ï¼Ÿ æ€ä¹ˆè®©åç¨‹ç­‰å¾…ï¼Ÿ èŠèŠgoroutineæ³„æ¼ï¼Ÿæ€ä¹ˆé¿å…å’Œæ’æŸ¥goroutineæ³„æ¼çš„é—®é¢˜ï¼Ÿ goroutineçš„çŠ¶æ€æœº èŠèŠchannelçš„ç‰¹æ€§ï¼Œä»nilçš„channelä¸­å–æ•°æ®ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å…¶ä»– å“ªäº›æƒ…å†µä¸‹ä¼španicï¼Ÿæ‰€æœ‰çš„panicéƒ½å¯ä»¥recoverå—ï¼Ÿrecoverå‡½æ•°çš„ä½¿ç”¨è¿‡ç¨‹ï¼Œæ˜¯æ€ä¹ˆæ•è·çš„ï¼Ÿ contextæ˜¯åšä»€ä¹ˆç”¨çš„ï¼Ÿ æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥è·å¾—å‡½æ•°è°ƒç”¨çš„é“¾è·¯ï¼Ÿ æ€ä¹ˆå¤„ç†åç¨‹è¿è¡Œçš„è¶…æ—¶é—®é¢˜ï¼Ÿ æ€ä¹ˆä¼˜é›…åœ°å…³é—­é€šé“ï¼Ÿ ä»é¢å‘å¯¹è±¡çš„è§’åº¦èŠèŠjavaå’Œgolangçš„åŒºåˆ« golangçš„GC golangçš„httpè·¯ç”±å®ç°æ‡‚å—ï¼Œå¯ä»¥æè¿°ä¸€ä¸‹å—ï¼Ÿ golangç¨‹åºhangä½äº†å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼ˆè¯´äº†å¯èƒ½æ­»å¾ªç¯å¯¼è‡´æ— æ³•GCï¼Œgolang1.13ï¼‰ï¼Œæ€ä¹ˆæ’æŸ¥ï¼ˆå¯ä»¥ç”¨pprofï¼‰ æ•°æ®ç»“æ„ æ•°ç»„æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Œä¸ºä»€ä¹ˆï¼Ÿ äº†è§£è·³è¡¨å—ï¼Ÿ ä½ çŸ¥é“å“ªäº›æ ‘ç»“æ„ï¼Œå„è‡ªçš„ä¼˜ç¼ºç‚¹åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆå›ç­”çš„æ—¶å€™å†å›ç­”ä¸€ä¸‹åº”ç”¨åœºæ™¯å°±æ›´å¥½äº†ï¼‰ æ“ä½œç³»ç»Ÿ ç”¨è¿‡é”å—ï¼Ÿè¯»å†™é”åŠ è¯»é”çš„æ—¶å€™ä¼šé˜»å¡å†™æ“ä½œå—ï¼Ÿä¼šé˜»å¡è¯»æ“ä½œå—ï¼Ÿï¼ˆç”¨è¿‡ï¼Œä¼šï¼Œä¸ä¼šï¼‰ Linux ç”¨è¿‡pså‘½ä»¤è§£å†³è¿‡ä»€ä¹ˆé—®é¢˜å—ï¼ŸæŸ¥è¯¢å‡ºæ¥çš„ç»“æœå„ä¸ªå­—æ®µæœ‰ä»€ä¹ˆå«ä¹‰ï¼Ÿ äº†è§£åƒµå°¸è¿›ç¨‹å—ï¼Ÿæ€ä¹ˆé¿å…ï¼Ÿ æ€ä¹ˆæ ¹æ®pidè·å–çˆ¶è¿›ç¨‹çš„pidï¼ˆå›ç­”è¯´å»/procä¸‹é¢ï¼‰ï¼Œæ€ä¹ˆæ ¹æ®pidæ‰¾æ‰§è¡Œè·¯å¾„å‘¢ï¼Ÿæ€ä¹ˆæ ¹æ®ç«¯å£å·æ‰¾pidï¼ˆå›ç­”è¯´lsof -iï¼Œç”¨netstatä¹Ÿå¯ä»¥ä½†æ˜¯æˆ‘ä¸çŸ¥é“ï¼Œé¢è¯•å®˜è¡¥å……çš„ï¼‰ æ•°æ®åº“ Rediså’ŒMySQLçš„åŒºåˆ«ï¼Œä»€ä¹ˆæ—¶å€™ç”¨Redisï¼Œä»€ä¹ˆæ—¶å€™ç”¨MySQLï¼ˆè¿™é‡Œæˆ‘è¯´äº†ä¸‹æˆ‘ä»¬æœåŠ¡ç”¨åˆ°çš„åœºæ™¯ï¼‰ï¼Ÿå¦‚æœè®©ä½ è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿï¼Œè¦æ€ä¹ˆè®¾è®¡ï¼Ÿï¼ˆé¢è¯•å®˜åæ¥æç¤ºäº†ä¸€ä¸‹è¯´redisåˆä¸€ä¸ªè‡ªå¢keyï¼‰ MySQL æœ‰å‡ ç§éš”ç¦»çº§åˆ«ï¼Ÿé»˜è®¤çº§åˆ«æ˜¯ä»€ä¹ˆï¼Ÿå¯é‡å¤è¯»æ˜¯æ€ä¹ˆè§£å†³å¹»è¯»çš„ï¼Ÿäº†è§£mvccå˜›ï¼Ÿä¸‹é¢å‡ ç§mysqlå“ªä¸ªä¼šç”¨åˆ°è”åˆç´¢å¼• linkedï¼šhttps://juejin.cn/post/6967618371844046856\n","permalink":"https://XianCH.github.io/posts/tech/go/golang%E7%9B%B8%E5%85%B3%E7%BB%83%E4%B9%A0%E9%A2%98/","summary":"\u003ch2\u003e\u003c/h2\u003e\n\u003ch3 id=\"åŸºç¡€ç›¸å…³\"\u003eåŸºç¡€ç›¸å…³\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003evarå’Œ:=æ¥å®šä¹‰å˜é‡æœ‰ä»€ä¹ˆä¸åŒï¼Ÿnewå’Œmakeåˆå§‹åŒ–å˜é‡æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e#var ç”¨æ¥å®šä¹‰å•ä¸ªæˆ–è€…å¤šä¸ªå˜é‡å˜é‡,:=ä¸€èˆ¬ç”¨æ¥åˆ›å»ºå˜é‡å¹¶ä¸”ç”¨æ¥ç»™å˜é‡å¤èµ‹å€¼\nvar a int\na =5\na :=5\n\n#new ç”¨æ¥åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–°åˆ†é…é›¶å€¼å¯¹è±¡çš„æŒ‡é’ˆï¼Œå¹¶è¿”å›æŒ‡å‘è¯¥å®ä¾‹çš„æŒ‡é’ˆï¼Œnewè¿”å›çš„æ˜¯æŒ‡é’ˆå¯¹è±¡\n#make ç”¨æ¥åˆ›å»ºåˆ‡ç‰‡ï¼Œé€šé“å’Œæ˜ å°„ç­‰å†…ç½®æ•°æ®ç»“æ„ï¼Œå¹¶åˆå§‹åŒ–\np := new(int)\nslience := make([]int,0,10)\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003edeferæ˜¯åšä»€ä¹ˆç”¨çš„ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºé‡Œé¢æœ‰å¤šä¸ªdeferä¼šæ€ä¹ˆæ ·ï¼Ÿ\u003c/p\u003e","title":"Golangç›¸å…³ç»ƒä¹ é¢˜"},{"content":"archå®‰è£…ä»¥åŠi3wmé…ç½® é…ç½®ï¼š\nintel\nç¡¬ç›˜å¤„ç† lsblk æŸ¥çœ‹ç¡¬ç›˜æƒ…å†µï¼ˆsda ä¸ºæœºæ¢°ç¡¬ç›˜ï¼Œnvme0n1æ˜¯å›ºæ€ï¼Œè¿™é‡Œçš„sda æ˜¯uç›˜)\ncgdisk /dev/nvme0n1\nç”¨äºåˆ†åŒºè¡¨ç¼–è¾‘å’Œç®¡ç†çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä¸»è¦ç”¨äºå¤„ç†ç£ç›˜çš„åˆ†åŒºè¡¨ï¼Œå¯ä»¥ä½¿ç”¨cgdiskæ¥åˆ›å»ºæ–°çš„GPTåˆ†åŒºè¡¨ï¼Œè¿™å°†æŠ¹å»æ—§çš„åˆ†åŒºè¡¨å’Œæ•°æ®ï¼Œæ‰€ä»¥åŠ¡å¿…è°¨æ…æ“ä½œ\nef00 boot\n8200 swap\næ ¼å¼åŒ–ç¡¬ç›˜\nå¯åŠ¨åˆ†åŒºï¼š\nmkfs.fat -F32 /dev/nvme0n1p1 äº¤æ¢åˆ†åŒºï¼š\nmkswap /dev/nvme0n1p2 å¯åŠ¨äº¤æ¢åˆ†åŒº\nswapon /dev/nvme0n1p2 ç³»ç»Ÿåˆ†åŒºï¼š\nmkfs.ext4 /dev/nvme0n1p3\rmkfs.ext4 /dev/nvme0n1p4 æŒ‚è½½åˆ†åŒº\nmount /dev/nvme0n1p3 /mnt mkdir /mnt/boot\rmount /dev/nvme0n1p1 /mnt/boot mkdir /mnt/home\rmount /dev/nvme0n1p4 /mnt/home ç„¶åè¿è¡ŒlsblkæŸ¥çœ‹åˆ†åŒºæƒ…å†µ\nè®¾ç½®pacmanæœåŠ¡ é€šè¿‡https://archlinux.org/mirrorlist/ æŸ¥çœ‹é•œåƒæº\nä¿®æ”¹é•œåƒæº\nvim /etc/pacman.d/mirrorlist å¤‡ä»½é•œåƒæº\ncp /etc/pacman.d/mirrorlist /etc/pacman.d/mirrorlist.backup æ›´æ–°é•œåƒæº\nreflector --verbose --latest 15 --sort rate --save /etc/pacman.d/mirrorlist pacman -Sy å®‰è£…åŸºæœ¬ç³»ç»Ÿä»¥åŠå›ºä»¶ pacstrap -i /mnt linux-headers linux-firmware base base-devel vim intel-ucode pacstrap /mnt base base-devel linux linux-firmware dhcpcd vim reflector è¿›å…¥æ–°ç³»ç»Ÿ\ngenfstab -U -p /mnt \u0026gt;\u0026gt; /mnt/etc/fstab cat /mnt/etc/fstab arch-chroot /mnt pacman -Syy è®¾ç½®æ—¶åŒº è¯­è¨€ æ—¶åŒº\nls -s /usr/share/zoneinfo/ #ç‚¹tab ls -s /usr/share/zoneinfo/Asia/ #ä»¥æ­¤ç±»æ¨ ln -s /usr/share/zoneinfo/Asia/Shanghai \u0026gt; /etc/localtime hwclock --systohc è¯­è¨€è®¾ç½®\nvim /etc/locale.gen zh_CN.UTF-8 UTF-8 en_US.UTF-8 UTF-8 #é€‰è¿™ä¸¤ä¸ª locale-gen è®¾ç½®é»˜è®¤è¯­è¨€å¹¶æ›´æ–°\n[root@archiso /]# echo LANG=en_US.UTF-8 \u0026gt; /etc/locale.conf [root@archiso /]# vim /etc/locale.conf [root@archiso /]# export LANG=en_US.UTF-8 ç½‘ç»œè®¾ç½® [root@archiso /]# vim /etc/hostname\r[root@archiso /]# vim /etc/hosts æ·»åŠ ç”¨æˆ· useradd -m -g users -G wheel,storage,power -s /bin/bash x14n EDITOR=vim visudo åœ¨æ–‡ä»¶ä¸­å–æ¶ˆ%wheel ALL=(ALL:ALL) çš„ #\næ·»åŠ Defaults rootpw\nå®‰è£…ç³»ç»Ÿå¼•å¯¼å·¥å…·grub, å¹¶ç”Ÿæˆå¼•å¯¼æ–‡ä»¶ pacman -S os-prober ntfs-3g grub efibootmgr # è¿™é‡Œçš„/dev/sda1æ˜¯å‰é¢bootæ‰€åœ¨çš„åˆ†åŒº #grub-install --efi-directory=/mnt/boot/efi --bootloader-id=Arch --recheck grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=grub # ç”Ÿæˆé»˜è®¤é…ç½®æ–‡ä»¶ grub-mkconfig -o /boot/grub/grub.cfg å®‰è£…åŸºç¡€åŒ… pacman -S networkManager systemctl disable netctl systemctl enable NetworkManager pacman -S mtools dosfstools bluez bluez-utils cups xdg-utils xdg-user-dirs alsa-utils pulseaudio pulseaudio-bluetooth reflector openssh pacman -S xf86-video-intel mesa lib32-mesa åŸºç¡€é…ç½® ä¿®æ”¹**/etc/pacman.conf**ï¼Œåœ¨æ–‡ä»¶æœ€åæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š\n[archlinuxcn]\rServer = https://mirrors.ustc.edu.cn/archlinuxcn/$arch ç„¶åæ˜¯æ›´æ–°æºåŠå®‰è£…yayï¼š\npacman -Syyu //æ›´æ–°æºï¼ŒæœŸé—´ä¼šè‡ªåŠ¨ä¸‹è½½archlinuxcnçš„æºæ•°æ®åº“\rpacman -S yay //å®‰è£…yay\rpacman -S archlinuxcn-keyring //archlinuxcnç›¸å…³GPG keyï¼Œå¦‚æœä¸å®‰è£…è¿™ä¸ªåŒ…ä¼šå¯¼è‡´åç»­éƒ¨åˆ†åŒ…æ— æ³•æˆåŠŸå®‰è£… ié…ç½® pacman -S xorg-server\r//sddmå®‰è£…ï¼Œå¦‚æœé€šè¿‡startxå‘½ä»¤ç™»å½•i3wmä¹Ÿå¯ä¸å®‰è£…æ­¤é¡¹\rpacman -S sddm\r//i3wmå®‰è£…\rpacman -S i3wm //æˆ–è€…å®‰è£…i3gapsï¼ŒäºŒé€‰ä¸€\ryay -S i3-gaps\r//picomã€rofiåŠfeh\rpacman -S rofi picom feh ç»ˆç«¯åº”ç”¨\npacman -S alacritty å®‰è£…å­—ä½“æ–‡ä»¶\npacman -S noto-fonts-cjk powerline-fonts wqy-microhei adobe-source-code-pro-fonts\ryay -S ttf-apple-emoji å®‰è£…å­—ä½“ä¹‹åï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿä¸­å®‰è£…çš„å­—ä½“ä¿¡æ¯ï¼š\nfc-cat | less å®‰è£…å®Œæˆä¹‹åå¯åŠ¨SDDMï¼Œåº”è¯¥å°±èƒ½é€šè¿‡å›¾å½¢åŒ–ç•Œé¢è¿›è¡Œç™»å½•äº†ï¼š\nsystemctl enable sddm\rsystemctl start sddm i3wmé…ç½® i3wmé»˜è®¤çš„å¿«æ·é”®æˆ‘ä¸æ‰“ç®—ä¸€ä¸€åˆ—å‡ºäº†ï¼ŒæŸ¥çœ‹i3wmçš„é»˜è®¤é…ç½®æ–‡ä»¶å°±èƒ½çœ‹åˆ°ï¼Œi3wmé»˜è®¤é…ç½®æ–‡ä»¶åœ°å€ï¼š\n~/.config/i3/config å¦‚æœæ­¤é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ–è€…è¢«ä¿®æ”¹å‡ºé”™ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤å¤åˆ¶ä¸€ä»½æ–°çš„ï¼š\nmkdir ~/.config/i3\rcp /etc/i3/config ~/.config/i3/config i3wmçš„é…ç½®æ–‡ä»¶åˆ†ä¸ºä¸¤æ­¥ï¼Œåˆ†åˆ«æ˜¯ä¿®æ”¹åŸæœ‰é…ç½®åŠæ–°å¢é…ç½®ã€‚\nå…ˆæ˜¯ä¿®æ”¹åŸæœ‰é…ç½®ï¼Œä¸‹åˆ—éƒ¨åˆ†æ˜¯åˆ é™¤æˆ–è€…æ³¨é‡Šï¼š\n#font pango:monospace 8\r#bindsym $mod+d exec --no-startup-id dmenu\r#bar {\r# status_command i3status\r#} ç„¶åæ˜¯æ–°å¢éƒ¨åˆ†é…ç½®ï¼š\n//è®¾ç½®å­—ä½“åŠå­—ä½“å¤§å°\rfont pango:Source Code Pro 12,DejaVu Sans Mono 12\r//è®¾ç½®$MOD+dä¸ºå¯åŠ¨rofi\rbindsym $mod+d exec --no-startup-id \u0026#34;rofi -modi drun,run -show drun\u0026#34;\r//å¯åŠ¨picom\rexec --no-startup-id picom -b\r//ä½¿ç”¨fehè®¾ç½®å£çº¸ï¼Œæ³¨æ„å£çº¸æ–‡ä»¶å¿…é¡»å­˜åœ¨ä¸”è·¯å¾„æ­£ç¡®\rexec --no-startup-id feh --bg-scale ~/zocoxx/wallpaper.jpeg\r//é”å±ï¼Œå› Win+Lå¿«æ·é”®åœ¨i3wmé»˜è®¤è¢«å ç”¨ï¼Œæˆ‘è®¾ç½®çš„æ˜¯$MOD+Ctrl+lä¸ºé”å±å¿«æ·é”®\rbindsym $mod+Ctrl+l exec --no-startup-id i3lock\r//å»é™¤çª—å£çš„æ ‡é¢˜æ ï¼Œæœ‰åˆ©æœ‰å¼Šï¼Œå¥½å¤„æ˜¯çª—å£å°‘äº†é¢å¤´ï¼Œåå¤„æ˜¯å»é™¤æ ‡é¢˜æ ä¹‹åéƒ¨åˆ†çª—å£æ— æ³•è¿›è¡Œé¼ æ ‡æ‹–åŠ¨\rfor_window [class=\u0026#34;^.*\u0026#34;] border pixel 0\r//è®¾ç½®è¾¹æ¡†ä¸º1åƒç´ \rnew_window pixel 1\r//å¦‚æœå®‰è£…äº†è¾“å…¥æ³•ï¼Œå¯ä»¥ä½¿ç”¨æ­¤å‘½ä»¤è¿›è¡Œå¯åŠ¨è¾“å…¥æ³•\rexec --no-startup-id fcitx \u0026amp; é…ç½®å®Œæˆä¹‹åï¼ŒæŒ‰$MOD+Shift+rå¯ä»¥å¿«é€Ÿé‡å¯i3wmï¼Œå¦‚æœé…ç½®æ²¡é—®é¢˜çš„è¯ï¼Œå¯ä»¥çœ‹åˆ°æ–°çš„æ•ˆæœäº†ã€‚\nalacrittyé…ç½® é€‰æ‹©alacrittyå°±æ˜¯çœ‹é‡å…¶å¯å®šåˆ¶ï¼Œè‡ªç„¶ä¸ä¼šé€‰æ‹©é»˜è®¤é…ç½®äº†ã€‚\nalacrittyå¯é€‰é…ç½®æ–‡ä»¶è·¯å¾„æœ‰å¾ˆå¤šï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘é€‰æ‹©å°†é…ç½®æ–‡ä»¶æ”¾åˆ°~/.configç›®å½•é‡Œé¢ã€‚å®Œæ•´é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š\n# ~/.config/alacritty.yml\rfont:\rnormal:\rfamily: Source Code Pro\rbold:\rfamily: Source Code Pro\ritalic:\rfamily: Source Code Pro\rsize: 12\rwindow:\ropacity: 0.7\renv:\rTERM: xterm-256color æˆ‘é€‰æ‹©é…ç½®alacrittyä½¿ç”¨Source Code Proå­—ä½“ï¼Œä¸”å­—å·å¤§å°ä¸º12ã€‚\nç‰¹åˆ«æé†’ä¸€ä¸‹ï¼ŒalacrittyèƒŒæ™¯é€æ˜åº¦è®¾ç½®ä¸æ˜¯ç½‘ç»œæµä¼ çš„window.opacityæˆ–è€…background_opacityï¼Œè¦è®¾ç½®é€æ˜åº¦çš„è¯å»ºè®®å‚è€ƒæˆ‘ä¸Šè¿°çš„æ ¼å¼ã€‚\nä¿å­˜å³å¯çœ‹åˆ°æ•ˆæœã€‚\npolybarè®¾ç½®åŠå¯åŠ¨ polybaréœ€è¦æœ‰é»˜è®¤çš„é…ç½®æ–‡ä»¶æ‰èƒ½å¯åŠ¨ï¼Œæ‰€ä»¥ï¼Œåˆ›å»ºç›®å½•å¹¶è®¾ç½®é…ç½®æ–‡ä»¶ï¼š\nmkdir ~/.config/polybar\rcp /etc/polybar/config.ini ~/.config/polybar ä¸çŸ¥é“æ˜¯polybaræ›´æ–°ç‰ˆæœ¬ä¹‹åé…ç½®æ–‡ä»¶åç§°æ”¹å˜è¿˜æ˜¯ç½‘ä¸Šçš„æ•™ç¨‹ä»¥è®¹ä¼ è®¹ï¼Œå¾ˆå¤šéƒ½ä¸å¸¦**.ini**åç¼€ï¼Œè¿™é‡Œå»ºè®®å¸¦ä¸Šã€‚\nä¸Šè¿°config.inié»˜è®¤åŒ…å«äº†ä¸€ä¸ªexampleçš„é…ç½®ï¼Œå‘½ä»¤è¡Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯çœ‹åˆ°æ•ˆæœï¼š\npolybar example è¦åœ¨å¯åŠ¨i3wmä¹‹åé»˜è®¤å¯åŠ¨polybarï¼Œéœ€è¦æœ‰ä¸ªå¯åŠ¨è„šæœ¬ï¼Œæ–‡ä»¶åç§°ã€è·¯å¾„åŠå†…å®¹å¦‚ä¸‹ï¼š\n# ~/.config/polybar/launch.sh\r#!/bin/bash\r# ç»ˆç«¯å¯èƒ½å·²ç»æœ‰åœ¨è¿è¡Œçš„å®ä¾‹\rkillall -q polybar\r# ç­‰å¾…è¿›ç¨‹è¢«ç»ˆæ­¢\rwhile pgrep -u $UID -x polybar \u0026gt;/dev/null; do sleep 1; done\r# è¿è¡ŒPolybarï¼Œä½¿ç”¨é»˜è®¤çš„é…ç½®æ–‡ä»¶è·¯å¾„ ~/.config/polybar/config.ini\rpolybar example \u0026amp;\recho \u0026#34;Polybar launched...\u0026#34; ç„¶åç»™ä¸å¯åŠ¨è„šæœ¬å¯æ‰§è¡Œæƒé™ï¼š\nchmod +x ~/.config/polybar/launch.sh ç„¶åi3wmé…ç½®æ–‡ä»¶æ–°åŠ ä¸€è¡Œï¼š\n# ~/.config/i3/config\rexec --no-startup-id ~/.config/polybar/launch.sh sudo systemctl restart display-manager\ni3-msg restart\nå®‰è£…å®Œæˆåé…ç½® xorg-xrandr åˆ†è¾¨ç‡è°ƒæ•´\nxrandr --output your_display_name --mode 1600x900 xrandr --output eDP1 --scale 1.25x1.25 å®‰è£…ä¸­æ–‡è¾“å…¥æ³• é…ç½®ä¸­æ–‡è¾“å…¥æ³•é¦–å…ˆéœ€è¦å®‰è£… fcitx åŒ…ä¸ fcitx-im é›†åˆåŒ…ï¼Œè¿˜æœ‰é…ç½®å·¥å…· fcitx-configtoolï¼š\n1 $ sudo pacman -S fcitx fcitx-im fcitx-configtool ç„¶åç¼–è¾‘ /etc/profile æ–‡ä»¶ï¼Œæœ«å°¾åŠ å…¥ï¼š\n1234 # Fcitxexport GTK_IM_MODULE=fcitxexport QT_IM_MODULE=fcitxexport XMODIFIERS=\u0026quot;@im=fcitx\u0026quot; å†åˆ°Fcitx#ä¸­æ–‡é€‰æ‹©ä¸€ä¸ªä¸­æ–‡è¾“å…¥æ³•åŒ…å®‰è£…ï¼š\n1 $ sudo pacman -S fcitx-googlepinyin zsh 1ã€å®‰è£…zsh\nsudo pacman -S zsh 2ã€æ›´æ”¹é»˜è®¤ç»ˆç«¯\nchsh -s /bin/zsh 3ã€å®‰è£…oh-my-zsh-git\nsudo pacman -S oh-my-zsh-git 4ã€é»˜è®¤é…ç½®\ncp /usr/share/oh-my-zsh/zshrc ~/.zshrc 5ã€å®‰è£…æ’ä»¶ è·³è½¬ç›®å½•ã€å‘½ä»¤é«˜äº®ã€è‡ªåŠ¨å»ºè®®è¡¥å…¨\nsudo pacman -S autojump zsh-syntax-highlighting zsh-autosuggestions oh-my-zsh æ‰¾ä¸åˆ°æ’ä»¶è·¯å¾„ï¼Œåšä¸‹é“¾æ¥ æ²¡æœ‰ç›®å½•è‡ªå·±å»º mkdir -p /usr/share/oh-my-zsh/custom/plugins/\nsudo ln -s /usr/share/zsh/plugins/zsh-syntax-highlighting /usr/share/oh-my-zsh/custom/plugins/ sudo ln -s /usr/share/zsh/plugins/zsh-autosuggestions /usr/share/oh-my-zsh/custom/plugins/ 6ã€é…ç½® ~/.zshrc\nplugins=( git autojump zsh-syntax-highlighting zsh-autosuggestions ) Xresources sddm https://github.com/MarianArlt/sddm-chili\nneovim https://taoshu.in/vim/go-vim.html\nHIDPIå±å¹• polybar ä½¿ç”¨githubä¸»é¢˜hack\nmpd brightness volume speed battery temperature\nhtopèµ„æºç›‘æ§ ç®¡ç†é…ç½®\nrander æ–‡ä»¶çª—å£ https://wiki.archlinux.org/title/ranger\nç”Ÿæˆé…ç½®æ–‡ä»¶\nranger --copy-config=all äº†è§£ä¸€äº›åŸºæœ¬çš„ python çŸ¥è¯†å¯èƒ½å¯¹å®šåˆ¶ ranger ä¼šæœ‰å¸®åŠ©ã€‚\nrc.conf - é€‰é¡¹è®¾ç½®å’Œå¿«æ·é”® commands.py - èƒ½é€šè¿‡ : æ‰§è¡Œçš„å‘½ä»¤ rifle.conf - æŒ‡å®šä¸åŒç±»å‹çš„æ–‡ä»¶çš„é»˜è®¤æ‰“å¼€ç¨‹åºã€‚ scope.sh - æ–‡ä»¶é¢„è§ˆç›¸å…³é…ç½® å›¾ç‰‡é¢„è§ˆåŠŸèƒ½\npacman -S w3m #å›¾ç‰‡é¢„è§ˆå·¥å…· ç§»åŠ¨åˆ°å›æ”¶ç«™ å¦‚æœæƒ³æ·»åŠ ä¸€ä¸ªæŠŠæ–‡ä»¶ç§»åŠ¨åˆ°ç›®å½• ~/.local/share/Trash/files/ çš„å¿«æ·é”® DDï¼ŒæŠŠä»¥ä¸‹è¿™ä¸€è¡Œæ·»åŠ åˆ° ~/.config/ranger/rc.confï¼š\nmap DD shell mv %s /home/${USER}/.local/share/Trash/files/ å…³è”æ–‡ä»¶æ‰“å¼€åº”ç”¨\næ–‡ä»¶è§£å‹\né”å±ç”µæº rofi è®¾ç½®é»˜è®¤åº”ç”¨ ç²˜è´´æ¿copyq éŸ³é‡è°ƒèŠ‚ALSA sudo pacman -S alsa-utils\nsudo pacman -S alsa-plug\nsudo pacman -S pulseaudio-alsa\nsudo pacman -S pavucontrol-qt\nsudo pacman -S pavucontrol\nå¯ç”¨ï¼šamixer sset Master unmute\nsudo lspci -v\nlspci | grep Audio\nmpdéŸ³ä¹æ’­æ”¾å™¨ å¸¸ç”¨å¿«æ·é”®\nq ï¼š é€€å‡º ranger\rR : é‡æ–°åˆ·æ–°ç›®å½•\rS : æ‰§è¡Œ shell å‘½ä»¤\r: æˆ–è€… ; : æ§åˆ¶å°\rW : æ˜¾ç¤ºæ—¥å¿—\rk : å‘ä¸Š\rj : å‘ä¸‹\rh : å‘å·¦\rl : å‘å³\rg : åˆ°é¡¶éƒ¨\rG : åˆ°åº•éƒ¨\rJ : åŠé¡µå‘ä¸‹\rK : åŠé¡µå‘ä¸Š\rgh : ç›¸å½“äº cd ~\rge : ç›¸å½“äº cd /etc\rgu : cd /usr\rdd : å‰ªåˆ‡\ryy : å¤åˆ¶\rpp : ç²˜è´´\ræˆªå›¾å·¥å…· å¤šå±å¹•æ˜¾ç¤º xrandr --output HDMI-1 --auto --left-of DP-1 åœ¨ i3wm ä¸­é…ç½®å¤šå±æ˜¾ç¤ºé€šå¸¸éœ€è¦ä¸€äº›ç‰¹å®šçš„è®¾ç½®ã€‚ä»¥ä¸‹æ˜¯åœ¨ Arch Linux ä¸Šé…ç½® i3wm çš„å¤šå±æ˜¾ç¤ºçš„ä¸€èˆ¬æ­¥éª¤ï¼š\næ£€æµ‹å’Œè¯†åˆ«æ˜¾ç¤ºå™¨ï¼š æ‰“å¼€ç»ˆç«¯å¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä»¥æ£€æµ‹å’Œè¯†åˆ«è¿æ¥çš„æ˜¾ç¤ºå™¨ï¼š\nxrandr è¿™å°†åˆ—å‡ºæ‰€æœ‰å·²è¿æ¥çš„æ˜¾ç¤ºå™¨ä»¥åŠå®ƒä»¬çš„åç§°ï¼ˆä¾‹å¦‚ï¼šHDMI-1ã€DP-1 ç­‰ï¼‰ã€‚\né…ç½®æ˜¾ç¤ºå™¨å¸ƒå±€ï¼š ä½¿ç”¨ xrandr å‘½ä»¤æ¥é…ç½®æ˜¾ç¤ºå™¨å¸ƒå±€ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³å°†ä¸¤ä¸ªæ˜¾ç¤ºå™¨è®¾ç½®ä¸ºå·¦å³æ‰©å±•æ¨¡å¼ï¼Œå¯ä»¥è¿è¡Œï¼š\nxrandr --output HDMI-1 --auto --left-of DP-1 æ‰“å¼€ `~/.config/i3/config` æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹è¡Œæ¥é…ç½®å¤šå±æ˜¾ç¤ºï¼š exec --no-startup-id xrandr --output HDMI-1 --auto --left-of DP-1 exec --no-startup-id xrandr --output HDMI-1 --auto --right-of DP-1 è®¾ç½®å±å¹•\nxrandr --output HDMI-1 --mode 1920x1080 --scale 0.95x0.95 ","permalink":"https://XianCH.github.io/posts/tech/archlinux/archlinux%E5%AE%89%E8%A3%85%E4%BB%A5%E5%8F%8Ai3wm%E9%85%8D%E7%BD%AE/","summary":"\u003ch1 id=\"archå®‰è£…ä»¥åŠi3wmé…ç½®\"\u003earchå®‰è£…ä»¥åŠi3wmé…ç½®\u003c/h1\u003e\n\u003cp\u003eé…ç½®ï¼š\u003c/p\u003e\n\u003cp\u003eintel\u003c/p\u003e\n\u003ch2 id=\"ç¡¬ç›˜å¤„ç†\"\u003eç¡¬ç›˜å¤„ç†\u003c/h2\u003e\n\u003cp\u003elsblk æŸ¥çœ‹ç¡¬ç›˜æƒ…å†µï¼ˆsda ä¸ºæœºæ¢°ç¡¬ç›˜ï¼Œnvme0n1æ˜¯å›ºæ€ï¼Œè¿™é‡Œçš„sda æ˜¯uç›˜)\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"i3wm%20archlinux.assets/image-20230914112459376.png\" alt=\"image-20230914112459376\"  /\u003e\n\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003ecgdisk /dev/nvme0n1\u003c/p\u003e\n\u003cp\u003eç”¨äºåˆ†åŒºè¡¨ç¼–è¾‘å’Œç®¡ç†çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä¸»è¦ç”¨äºå¤„ç†ç£ç›˜çš„åˆ†åŒºè¡¨ï¼Œå¯ä»¥ä½¿ç”¨\u003ccode\u003ecgdisk\u003c/code\u003eæ¥åˆ›å»ºæ–°çš„GPTåˆ†åŒºè¡¨ï¼Œè¿™å°†æŠ¹å»æ—§çš„åˆ†åŒºè¡¨å’Œæ•°æ®ï¼Œæ‰€ä»¥åŠ¡å¿…è°¨æ…æ“ä½œ\u003c/p\u003e\n\u003cp\u003eef00  boot\u003c/p\u003e\n\u003cp\u003e8200 swap\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eæ ¼å¼åŒ–ç¡¬ç›˜\u003c/p\u003e\n\u003cp\u003eå¯åŠ¨åˆ†åŒºï¼š\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emkfs.fat -F32 /dev/nvme0n1p1 \n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eäº¤æ¢åˆ†åŒºï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-text\" data-lang=\"text\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkswap /dev/nvme0n1p2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eå¯åŠ¨äº¤æ¢åˆ†åŒº\u003c/p\u003e","title":"archå®‰è£…ä»¥åŠi3wmé…ç½®"},{"content":"tmuxå¸¸ç”¨å‘½ä»¤ ç»ˆç«¯ä¸­ä½¿ç”¨ Tmux å‘½ä»¤ å¯åŠ¨ tmux ä½¿ç”¨ -s å‘½ä»¤æŒ‡å®šä¼šè¯åç§°ï¼Œä½¿ç”¨ -n å‘½ä»¤æŒ‡å®šçª—å£åç§° $ tmux new -s sessionName -n window é€€å‡ºä¼šè¯(tmuxä¼šè¯å†…å‘½ä»¤) $ tmux detach é€€å‡ºå¹¶å…³é—­ä¼šè¯ï¼ˆçª—å£,çª—æ ¼ï¼‰ $ exit ç»“æŸåå°çš„ä¼šè¯ #é€šè¿‡ä¼šè¯ç¼–å· $ tmux kill-session -t 0 #é€šè¿‡ä¼šè¯åç§° $ tmux kill-session -t sessionName æŸ¥çœ‹æ‰€æœ‰ä¼šè¯ $ tmux ls æ¿€æ´»ä¼šè¯ $ tmux attach -t sessionName Tmux å†…ä½¿ç”¨å‰ç¼€ Ctrl+b ç„¶åå¯¹åº”å¿«æ·é”®æ‰§è¡Œå‘½ä»¤ ä¼šè¯å¸¸ç”¨å¿«æ·æ“ä½œ å¿«æ·é”® è¯´æ˜ ? æ‰€æœ‰å¿«æ·é”®ï¼Œqé€€å‡º :new sessionName åˆ›å»ºæ–°ä¼šè¯ s åˆ‡æ¢ä¼šè¯ $ é‡å‘½åå½“å‰ä¼šè¯ d ç¦»å¼€ä¼šè¯è¿”å›shellï¼ˆä¸tmux detachåŠŸèƒ½ç›¸åŒï¼‰ Ctrl+z æŒ‚èµ·ä¼šè¯ï¼Œè¿”å›shell çª—å£å¸¸ç”¨å¿«æ·æ“ä½œ å¿«æ·é”® è¯´æ˜ c åˆ›å»ºæ–°çª—å£ w æ˜¾ç¤ºçª—å£ æ•°å­—é”® é€‰æ‹©å¯¹åº”çª—å£ p å‰ä¸€ä¸ªçª—å£ n åä¸€ä¸ªçª—å£ f æŸ¥æ‰¾çª—å£ , é‡å‘½åçª—å£ \u0026amp; å…³é—­çª—å£ï¼ˆå¸¦æç¤ºï¼‰ çª—æ ¼å¸¸ç”¨å¿«æ·é”® å¿«æ·é”® è¯´æ˜ % å‚ç›´åˆ†å‰² â€ æ°´å¹³åˆ†å‰² o åˆ‡æ¢çª—æ ¼ x å…³é—­çª—æ ¼ space åˆ‡æ¢çª—æ ¼å¸ƒå±€ q æ˜¾ç¤ºçª—æ ¼ç¼–å·ï¼ŒæŒ‰å¯¹åº”æ•°å­—é€‰æ‹©çª—æ ¼ { ä¸ä¸Šä¸€ä¸ªçª—æ ¼è°ƒæ¢ä½ç½® } ä¸ä¸‹ä¸€ä¸ªçª—æ ¼è°ƒæ¢ä½ç½® z å½“å‰çª—æ ¼æœ€å¤§åŒ– ! å–æ¶ˆæ‰€æœ‰çª—å£ä¿ç•™å½“å‰çª—å£ Ctrl+æ–¹å‘é”® ä»¥1ä¸ªå•å…ƒæ ¼ä¸ºå•ä½ç§»åŠ¨è¾¹ç¼˜ä»¥è°ƒæ•´å½“å‰çª—æ ¼å¤§å° Alt+æ–¹å‘é”® ä»¥5ä¸ªå•å…ƒæ ¼ä¸ºå•ä½ç§»åŠ¨è¾¹ç¼˜ä»¥è°ƒæ•´å½“å‰çª—æ ¼å¤§å° vim ä½¿ç”¨æŠ€å·§ [#](https://pengfeixc.com/blogs/developer-handbook/vim-shortcuts#vim ä½¿ç”¨æŠ€å·§) ä¸‹é¢çš„å‘½ä»¤æ˜¯æˆ‘å¸¸ç”¨çš„ä¸€äº›å¿«æ·é”®æ“ä½œï¼Œæˆ‘ä½¿ç”¨çš„ç¼–è¾‘å™¨æ˜¯ vscodeï¼Œå®‰è£…äº† vim æ’ä»¶ã€‚\nå¦‚ä½•åœ¨ vscode ä¸­ä½¿ç”¨ vimï¼Ÿå¯ä»¥çœ‹çœ‹æˆ‘çš„ vscode é…ç½®\nå…‰æ ‡ç§»åŠ¨ # hjklï¼šå·¦ä¸‹ä¸Šå³ gj å’Œ gkï¼šç§»åŠ¨è‡³ä¸‹ä¸€ä¸ªæˆ–è€…ä¸Šä¸€ä¸ªç‰©ç†è¡Œï¼Œå½“ä¸€è¡Œå‡ºç° linewrap æ—¶ï¼Œä½¿ç”¨ j å’Œ k å¹¶ä¸èƒ½æŒ‰ç…§è§†è§‰çœ‹åˆ°çš„ä¸€è¡Œè¿›è¡Œç§»åŠ¨ {ï¼šè·³è½¬è‡³å‘ä¸Šå¯»æ‰¾çš„ç¬¬ä¸€ä¸ªæ®µè½é¦–éƒ¨çš„å‰ä¸€è¡Œ }ï¼šè·³è½¬è‡³å‘ä¸‹å¯»æ‰¾çš„ç¬¬ä¸€ä¸ªæ®µè½å°¾éƒ¨çš„åä¸€è¡Œ (ï¼šè·³è½¬è‡³å‘ä¸Šå¯»æ‰¾çš„ç¬¬ä¸€ä¸ªæ®µè½é¦–éƒ¨çš„æ‰€åœ¨è¡Œ )ï¼šè·³è½¬è‡³å‘ä¸‹å¯»æ‰¾çš„ç¬¬ä¸€ä¸ªæ®µè½å°¾éƒ¨çš„æ‰€åœ¨è¡Œ wï¼šä¸‹ä¸€ä¸ªå•è¯å¼€å¤´ bï¼šä¸Šä¸€ä¸ªå•è¯å¼€å¤´ eï¼šä¸‹ä¸€ä¸ªå•è¯ç»“å°¾ geï¼šä¸Šä¸€ä¸ªå•è¯ç»“å°¾ ggï¼šè·³è½¬åˆ°ç¬¬ä¸€è¡Œ Gï¼šè·³è½¬åˆ°æœ€åä¸€è¡Œ \u0026lt;number\u0026gt; + ggï¼šè·³è½¬åˆ°ç¬¬ number è¡Œ :\u0026lt;number\u0026gt;ï¼šè·³è½¬åˆ°ç¬¬ number è¡Œ %ï¼šåŒ¹é…å¯¹åº”æ‹¬å·ï¼Œå¹¶è¿›è¡Œè·³è½¬ * å’Œ #ï¼šåŒ¹é…å½“å‰å…‰æ ‡æ‰€åœ¨çš„å•è¯ï¼Œç§»åŠ¨å…‰æ ‡åˆ°ä¸‹ä¸€ä¸ªæˆ–ä¸Šä¸€ä¸ª fã€Fã€ t å’Œ Tï¼Œè¡Œå†…å…‰æ ‡è·³è½¬ [#](https://pengfeixc.com/blogs/developer-handbook/vim-shortcuts#fã€Fã€ t å’Œ Tï¼Œè¡Œå†…å…‰æ ‡è·³è½¬) fï¼šå½“å‰è¡Œè·³è½¬åˆ°å…‰æ ‡åçš„æŒ‡å®šå­—ç¬¦ï¼ŒæŒ‰ ; è·³è½¬åˆ°ä¸‹ä¸€ä¸ªæŒ‡å®šå­—ç¬¦ Fï¼šå½“å‰è¡Œè·³è½¬åˆ°å…‰æ ‡å‰çš„æŒ‡å®šå­—ç¬¦ï¼ŒæŒ‰ ; è·³è½¬åˆ°ä¸‹ä¸€ä¸ªæŒ‡å®šå­—ç¬¦ tï¼šå½“å‰è¡Œè·³è½¬åˆ°å…‰æ ‡åçš„æŒ‡å®šå­—ç¬¦å‰çš„ä¸€ä¸ªå­—ç¬¦ï¼ŒæŒ‰ ; è·³è½¬åˆ°ä¸‹ä¸€ä¸ªæŒ‡å®šå­—ç¬¦å‰ä¸€ä¸ªå­—ç¬¦ Tï¼šå½“å‰è¡Œè·³è½¬åˆ°å…‰æ ‡å‰çš„æŒ‡å®šå­—ç¬¦åçš„ä¸€ä¸ªå­—ç¬¦ï¼ŒæŒ‰ ; è·³è½¬åˆ°ä¸‹ä¸€ä¸ªæŒ‡å®šå­—ç¬¦åä¸€ä¸ªå­—ç¬¦ ä¸€èˆ¬ï¼Œæˆ‘åªç”¨ f å’Œ Fã€‚\næ¨¡å¼åˆ‡æ¢ # vï¼šnormal æ¨¡å¼è¿›å…¥ visual æ¨¡å¼ V: normal æ¨¡å¼è¿›å…¥ visual æ¨¡å¼ï¼Œå¹¶é€‰ä¸­å½“å‰è¡Œ i: normal æ¨¡å¼è¿›å…¥ insert æ¨¡å¼ï¼Œå…‰æ ‡å‡ºç°åœ¨å½“å‰é€‰ä¸­å­—ç¬¦å‰ I: normal æ¨¡å¼è¿›å…¥ insert æ¨¡å¼ï¼Œå…‰æ ‡å‡ºç°åœ¨è¡Œé¦– a: normal æ¨¡å¼è¿›å…¥ insert æ¨¡å¼ï¼Œå…‰æ ‡å‡ºç°åœ¨å½“å‰é€‰ä¸­å­—ç¬¦å A: normal æ¨¡å¼è¿›å…¥ insert æ¨¡å¼ï¼Œå…‰æ ‡å‡ºç°åœ¨è¡Œå°¾ esc: ä» visual å’Œ insert æ¨¡å¼é€€å›åˆ° normal æ¨¡å¼ oï¼šåœ¨å½“å‰è¡Œä¸‹æ–¹æ’å…¥ä¸€è¡Œï¼Œå¹¶è¿›å…¥ insert æ¨¡å¼ Oï¼šåœ¨å½“å‰è¡Œä¸Šæ–¹æ’å…¥ä¸€è¡Œï¼Œå¹¶è¿›å…¥ insert æ¨¡å¼\næ’å…¥ã€åˆ é™¤ã€å¤åˆ¶ã€ç²˜è´´ # åœ¨æ¨¡å¼åˆ‡æ¢ä¸­å·²ç»åŒ…å«äº†æ’å…¥çš„ç›¸å…³å¿«æ·é”®ã€‚\ngiï¼šåœ¨ä¸Šä¸€ä¸ªåšå‡ºå˜åŒ–çš„åœ°æ–¹è¿›å…¥æ’å…¥æ¨¡å¼ xï¼šåˆ é™¤å½“å‰å…‰æ ‡æ‰€åœ¨çš„å­—ç¬¦ ddï¼šåˆ é™¤å½“å‰è¡Œ ccï¼šåˆ é™¤å½“å‰è¡Œï¼Œå¹¶è¿›å…¥ insert æ¨¡å¼ Dï¼šåˆ é™¤ä»å½“å‰å…‰æ ‡è‡³è¡Œå°¾çš„å†…å®¹ Cï¼šåˆ é™¤ä»å½“å‰è´¯æ ‡è‡³è¡Œå°¾çš„å†…å®¹ï¼Œå¹¶è¿›å…¥ insert æ¨¡å¼ yyï¼šå¤åˆ¶å½“å‰è¡Œ Yï¼šä¸ yy ç›¸åŒ ylï¼šå¤åˆ¶å½“å‰å…‰æ ‡ä¸‹çš„å­—ç¬¦ yasï¼šå¤åˆ¶ä¸€ä¸ªå¥å­ yapï¼šå¤åˆ¶ä¸€ä¸ªæ®µè½ p: ç²˜è´´å‰ªåˆ‡æ¿è‡³å…‰æ ‡å Pï¼šç²˜è´´å‰ªåˆ‡æ¿è‡³å…‰æ ‡å‰ gP: ä¸ P ç›¸åŒï¼Œåªä¸è¿‡å°†å…‰æ ‡ç½®äºç²˜è´´å†…å®¹çš„åé¢ gp: ä¸ p ç›¸åŒï¼Œåªä¸è¿‡å°†å…‰æ ‡ç½®äºç²˜è´´å†…å®¹çš„åé¢ cwï¼šåˆ é™¤ä»å…‰æ ‡æ‰€åœ¨ä½ç½®ååˆ°ä¸€ä¸ªå•è¯çš„ç»“å°¾ï¼Œå¹¶è¿›å…¥ insert æ¨¡å¼ï¼ˆåŒç†å¯ä»¥ç”¨ dw åˆ é™¤ï¼Œä½†æ˜¯ä¸è¿›å…¥ insert æ¨¡å¼ï¼‰ c$ï¼šåˆ é™¤ä»å…‰æ ‡æ‰€åœ¨ä½ç½®ååˆ°æœ¬è¡Œç»“å°¾ï¼Œå¹¶è¿›å…¥ insert æ¨¡å¼ï¼ˆåŒç†å¯ä»¥ç”¨ d$ åˆ é™¤ï¼Œä½†æ˜¯ä¸è¿›å…¥ insert æ¨¡å¼ï¼‰ rï¼šæ›¿æ¢å½“å‰å…‰æ ‡ä¸‹çš„å­—ç¬¦ï¼ŒæŒ‰ä¸‹ rï¼Œç„¶åè¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œç”¨æ¥æ›¿æ¢å½“å‰å­—ç¬¦ v + \u0026lt;select area\u0026gt; + \u0026lt;action\u0026gt;ï¼šå¯ä»¥ä½¿ç”¨ v è¿›å…¥ visual æ¨¡å¼ï¼Œç„¶åé€‰ä¸­åŒºåŸŸï¼Œæœ€åä½¿ç”¨ yã€cã€d å’Œ r å¯¹é€‰ä¸­åŒºåŸŸè¿›è¡Œæ“ä½œã€‚ \u0026lt;command\u0026gt;\u0026lt;pos\u0026gt; æ¨¡å¼ï¼š\u0026lt;command\u0026gt; å¯ä»¥æ˜¯ yã€dã€cç­‰ï¼Œï¼ˆå¯ä»¥ç”¨äºå…‰æ ‡è·³è½¬çš„ä¸€ç³»åˆ—å­—ç¬¦ï¼‰ å¯ä»¥æ˜¯ wï¼ˆä¸€ä¸ªå•è¯çš„ç»“å°¾ï¼‰ã€$ï¼ˆè¡Œå°¾ï¼‰ã€^ï¼ˆè¡Œé¦–ç¬¬ä¸€ä¸ªéç©ºå­—ç¬¦ï¼‰ã€bï¼ˆå•è¯çš„å¼€å¤´ï¼‰ã€0(è¡Œé¦–) ç­‰ç­‰ã€‚\n\u0026lt;verbs\u0026gt;\u0026lt;adjectives\u0026gt;\u0026lt;objects\u0026gt; æ¨¡å¼ï¼šä½ å¯ä»¥å°† operatorï¼ˆyï¼Œdï¼Œcï¼‰ä½œä¸º verbsï¼Œcountã€a å’Œ i ä½œä¸º adjectivesï¼Œç§»åŠ¨ï¼ˆhjklã€wã€$ã€^ã€bã€0ç­‰ï¼‰ä½œä¸º objectsï¼Œä¾‹å¦‚:\nd3l: åˆ é™¤å…‰æ ‡å³ä¾§ä¸‰ä¸ªå­—ç¬¦ dlï¼šadjectives å¯ä»¥çœç•¥ï¼Œæ‰€ä»¥ dl ç­‰ä»·äº d1l diwï¼šåˆ é™¤å…‰æ ‡ä¸‹çš„å•è¯ä¸åŒ…æ‹¬å‘¨å›´çš„ç©ºæ ¼ ä»£ç æŠ˜å  # zcï¼šæŠ˜å ä»£ç  zo: å±•å¼€ä»£ç  zM: å…¨éƒ¨æŠ˜å  zR: å…¨éƒ¨å±•å¼€ çª—å£ç§»åŠ¨ # ï¼ˆ1ï¼‰ç§»åŠ¨å½“å‰æ‰€åœ¨è¡Œçš„ä½ç½®\nzzï¼šå°†å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œç§»åŠ¨åˆ°çª—å£ä¸­é—´ zt: å°†å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œç§»åŠ¨åˆ°çª—å£é¡¶éƒ¨ zb: å°†å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œç§»åŠ¨åˆ°çª—å£åº•éƒ¨ ï¼ˆ2ï¼‰è¡Œç§»åŠ¨\nctrl + eï¼šä¸€è¡Œä¸€è¡Œå‘ä¸‹ç§»åŠ¨ ctrl + dï¼šå‘ä¸‹ç§»åŠ¨çª—å£æ˜¾ç¤ºè¡Œæ•°çš„ä¸€åŠ ctrl + y: ä¸€è¡Œä¸€è¡Œå‘ä¸Šç§»åŠ¨ ctrl + u: å‘ä¸Šç§»åŠ¨çª—å£æ˜¾ç¤ºè¡Œæ•°çš„ä¸€åŠ åˆ†å±æ“ä½œ # ï¼ˆ1ï¼‰åˆ›å»ºåˆ†å±\nä½¿ç”¨å‘½ä»¤ï¼š\n:split [file] æˆ–è€… :sp [file]ï¼šæ·»åŠ ä¸€ä¸ªæ¨ªå± :vsplit [file] æˆ–è€… :vsp [file]ï¼šæ·»åŠ ä¸€ä¸ªç«–å±\nä½¿ç”¨å¿«æ·é”®ï¼š\nctrl + w sï¼šä»¥å½“å‰æ–‡ä»¶æ·»åŠ ä¸€ä¸ªæ¨ªå± ctrl + w vï¼šä»¥å½“å‰æ–‡ä»¶æ·»åŠ ä¸€ä¸ªç«–å±\nï¼ˆ2ï¼‰åˆ†å±åˆ‡æ¢\nctrl + w \u0026lt;arrow\u0026gt; æˆ–è€… ctrl + w \u0026lt;hjkl\u0026gt; ï¼šå°†å…‰æ ‡ç§»åŠ¨åˆ°æŒ‡å®šæ–¹å‘çš„åˆ†å±\nï¼ˆ3ï¼‰å…³é—­å±å¹•å’Œåˆ†å±\n:onlyï¼šåªä¿ç•™å½“å‰åˆ†å±ï¼Œå…³é—­å…¶ä»–åˆ†å± ctrl + w cï¼šå…³é—­å½“å‰çª—å£ ctrl + w q: å…³é—­å½“å‰çª—å£ï¼Œè‹¥åªæœ‰ä¸€ä¸ªåˆ†å±ï¼Œåˆ™é€€å‡º vim ctrl + w o: å…³é—­å…¶ä»–çª—å£\nï¼ˆ4ï¼‰å¢åŠ å±å¹•é«˜åº¦\ncrtrl + w +ï¼šå¢åŠ é«˜åº¦ ctrl + w -ï¼šå‡å°é«˜åº¦\nå¤šå…‰æ ‡æ“ä½œï¼ˆå—æ“ä½œï¼‰ # ä½¿ç”¨ ctrl + v è¿›å…¥å—æ“ä½œ å¯ä»¥ä½¿ç”¨ hkjlã€$ ç­‰æ¥æ’å…¥å¤šå…‰æ ‡å’Œç§»åŠ¨å…‰æ ‡ ä½¿ç”¨ I å’Œ A è¿›å…¥ç¼–è¾‘ åŒæ ·å¯ä»¥ä½¿ç”¨ v è¿›å…¥ visual æ¨¡å¼ï¼Œé€‰ä¸­ä¸€äº›è¡Œï¼Œç„¶åæŒ‰ A åœ¨æ¯è¡Œç»“å°¾æ’å…¥å…‰æ ‡è¿›è¡Œç¼–è¾‘ã€‚\nvisual æ¨¡å¼ä¸‹çš„æ ¼å¼åŒ–æ“ä½œ [#](https://pengfeixc.com/blogs/developer-handbook/vim-shortcuts#visual æ¨¡å¼ä¸‹çš„æ ¼å¼åŒ–æ“ä½œ) v è¿›å…¥ visual æ¨¡å¼ï¼Œè¿›å…¥ visual æ¨¡å¼åï¼Œå¯ä»¥é€šè¿‡ hjkl é€‰ä¸­ä¸€äº›è¡Œã€‚å¯ä»¥å¯¹é€‰ä¸­çš„è¡Œåšå¦‚ä¸‹æ“ä½œã€‚\nJï¼šæŠŠæ‰€æœ‰è¡Œè¿æ¥èµ·æ¥å˜æˆä¸€è¡Œ \u0026lt; æˆ– \u0026gt;ï¼šå·¦å³ç¼©è¿› =ï¼šè‡ªåŠ¨ç¼©è¿›ï¼Œæ ¼å¼åŒ–ä»£ç ï¼ˆéå¸¸ niceï¼‰ æŸ¥æ‰¾å’Œæ›¿æ¢ # æ›¿æ¢æ ¼å¼å¦‚ä¸‹ï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€‚\n:[range]s/\u0026lt;pattern\u0026gt;/[string]/[flags] [count] è¯¥å‘½ä»¤è¡¨ç¤ºåœ¨ range çš„æ¯ä¸€è¡Œä¸­æœç´¢patternï¼Œå¹¶å°†å…¶æ›¿æ¢ä¸º stringã€‚ countæ˜¯ä¸€ä¸ªä¹˜ä»¥å‘½ä»¤çš„æ­£æ•´æ•°ã€‚\nï¼ˆ1ï¼‰æŸ¥æ‰¾\n/\u0026lt;pattern\u0026gt;ï¼šé«˜äº®æŸ¥æ‰¾åˆ°çš„å†…å®¹ /\\C\u0026lt;pattern\u0026gt;ï¼šå¤§å°å†™æ•æ„Ÿ /\\c\u0026lt;pattern\u0026gt;: å¿½ç•¥å¤§å°å†™ /\\\u0026lt;\u0026lt;pattern\u0026gt;\\\u0026gt;: æ•´è¯åŒ¹é…ï¼Œæ³¨æ„è¿™é‡Œå‰é¢æ˜¯ä¿®é¥°ç¬¦ \\\u0026lt;ï¼Œåé¢æ˜¯ä¿®é¥°ç¬¦ \\\u0026gt;ï¼Œä¸¤ä¸ªç»„åˆè¡¨ç¤ºæ•´è¯åŒ¹é…ï¼ˆwhole word matchï¼‰ *ï¼šå‘ä¸‹æŸ¥æ‰¾å½“å‰å…‰æ ‡ä¸‹çš„ word #ï¼šå‘ä¸ŠæŸ¥æ‰¾å½“å‰å…‰æ ‡ä¸‹çš„ word nï¼šè·³è½¬åˆ°ä¸‹ä¸€ä¸ªæŸ¥æ‰¾åˆ°çš„å†…å®¹ :nohlï¼šå–æ¶ˆé«˜äº® ï¼ˆ2ï¼‰å½“å‰è¡Œæ›¿æ¢\n:s/foo/bar/`ï¼šæ›¿æ¢å½“å‰è¡ŒæŸ¥åˆ°çš„**ç¬¬ä¸€ä¸ª** `foo`ï¼Œå¹¶å°†å…¶æ›¿æ¢ä¸º `bar` `:s/foo/bar/g`ï¼šæ›¿æ¢å½“å‰è¡ŒæŸ¥åˆ°çš„æ‰€æœ‰ `foo`ï¼Œå¹¶å°†å…¶æ›¿æ¢ä¸º `bar ï¼ˆ3ï¼‰å…¨æ–‡ä»¶æ›¿æ¢\n:%s/foo/bar/`ï¼šæ›¿æ¢å½“å‰æ–‡ä»¶ä¸­æ‰€æœ‰è¡Œçš„**ç¬¬ä¸€ä¸ª** `foo`ï¼Œå°†å®ƒä»¬æ›¿æ¢ä¸º `bar` `:%s/foo/bar/g`ï¼šæ›¿æ¢å½“å‰æ–‡ä»¶ä¸­æ‰€æœ‰è¡Œçš„ `foo`ï¼Œå°†å®ƒä»¬æ›¿æ¢ä¸º `bar ï¼ˆ4ï¼‰c flag\n:%s/foo/bar/gcä½¿ç”¨ c æ ‡è®°å¯ä»¥ä¾æ¬¡ç¡®è®¤æ¯ä¸ªæ›¿æ¢ã€‚ä¼šå¼¹å‡º replace with foo(y/n/a/q/l)? ç¡®è®¤å¯¹è¯æ¡†ï¼ŒæŒ‰ y æ›¿æ¢åŒ¹é…é¡¹ï¼Œæˆ–æŒ‰ l æ›¿æ¢åŒ¹é…é¡¹å¹¶é€€å‡ºã€‚ æŒ‰ n è·³è¿‡å½“å‰åŒ¹é…ï¼ŒæŒ‰ q æˆ– Esc é€€å‡ºæ›¿æ¢ã€‚ a é€‰é¡¹æ›¿æ¢åŒ¹é…é¡¹å’Œæ‰€æœ‰å‰©ä½™åŒ¹é…é¡¹ã€‚\nï¼ˆ5ï¼‰i flag å¼€å¯å¤§å°å†™æ•æ„Ÿ\n:s/foo/bar/gc`: `foo` ä¸ä¼šåŒ¹é… `Foo ï¼ˆ6ï¼‰æŒ‡å®šæŸ¥è¯¢èŒƒå›´\n:3,10s/foo/bar/gï¼šæŸ¥è¯¢èŒƒå›´ä¸ºç¬¬ä¸‰è¡Œåˆ°ç¬¬åè¡Œï¼Œå°†è¯¥èŒƒå›´å†…çš„ foo æ›¿æ¢ä¸º bar :.,$s/foo/bar/ï¼šæŸ¥è¯¢èŒƒå›´ä¸ºå½“å‰è¡Œåˆ°æœ€åä¸€è¡Œï¼Œå°†è¯¥èŒƒå›´å†…çš„ foo æ›¿æ¢ä¸º barï¼Œ. è¡¨ç¤ºå½“å‰è¡Œï¼Œ$ è¡¨ç¤ºæœ€åä¸€è¡Œ :.,+4s/foo/bar/gï¼šæŸ¥è¯¢èŒƒå›´ä¸ºä»å½“å‰è¡Œå¼€å§‹å¾€ä¸‹æ•°å››è¡Œï¼ˆæ€»å…±å››è¡Œï¼‰ï¼Œå°†è¯¥èŒƒå›´å†…çš„ foo æ›¿æ¢ä¸º barï¼Œ. è¡¨ç¤ºå½“å‰è¡Œï¼Œ+4 è¡¨ç¤ºæ¥ä¸‹æ¥çš„å››è¡Œ\n\u0026lt;start position\u0026gt;\u0026lt;command\u0026gt;\u0026lt;end position\u0026gt; # ä¾‹å¦‚ 0y$ï¼Œè¡¨ç¤ºæ‹·è´å½“å‰è¡Œã€‚\n0ï¼šå…ˆåˆ°è¡Œé¦– y: ä» \u0026lt;start position\u0026gt; å¼€å§‹æ‹·è´ï¼Œè¿™é‡Œæ˜¯è¡Œé¦– $ï¼šè¡¨ç¤ºä¸€ç›´æ‹·è´åˆ°è¡Œå°¾ \u0026quot; hello \u0026quot;\n\u0026lt;command\u0026gt;\u0026lt;a | i | s\u0026gt;\u0026lt;obj\u0026gt; # s éœ€è¦æ’ä»¶æ”¯æŒï¼Œvscode-vim è‡ªå¸¦è¿™ä¸ªåŠŸèƒ½\na è¡¨ç¤º aroundï¼Œi è¡¨ç¤º innerï¼Œs è¡¨ç¤º surroundï¼Œcommand å¯ä»¥æ˜¯ d c yï¼Œobj å¯ä»¥æ˜¯å¼•å·ã€åŒå¼•å·ã€w å’Œ tï¼Œt è¡¨ç¤º tagï¼Œå¯¹ html è¿™ç§æ ‡è®°è¯­è¨€æ¯”è¾ƒæœ‰ç”¨\ndiwï¼šåˆ é™¤å•è¯ï¼Œä¸åŒ…æ‹¬å•è¯å‘¨å›´çš„ç¬¦å·ï¼Œä¾‹å¦‚ \u0026quot; word \u0026quot;ï¼Œå…‰æ ‡åœ¨ w,åˆ é™¤åå˜æˆäº† \u0026quot; \u0026quot; dawï¼šåˆ é™¤å½“å‰å•è¯ï¼ŒåŒ…æ‹¬å‘¨å›´çš„ç©ºç™½å­—ç¬¦ï¼Œä¾‹å¦‚ \u0026quot; word \u0026quot;ï¼Œå…‰æ ‡åœ¨ w,åˆ é™¤åå˜æˆäº† \u0026quot;\u0026quot; da\u0026quot;: åˆ é™¤åŒå¼•å·ä¸­é—´çš„å†…å®¹ï¼ŒåŒ…æ‹¬åŒå¼•å·æœ¬èº«ï¼Œä¾‹å¦‚ \u0026quot; word \u0026quot;ï¼Œå…‰æ ‡åœ¨ w,åˆ é™¤åå˜æˆäº† `` di\u0026quot;: åˆ é™¤åŒå¼•å·ä¸­é—´çš„å†…å®¹ï¼Œä¸åŒ…æ‹¬åŒå¼•å·æœ¬èº«ï¼Œä¾‹å¦‚ \u0026quot; word \u0026quot;ï¼Œå…‰æ ‡åœ¨ w,åˆ é™¤åå˜æˆäº† \u0026quot;\u0026quot; ds\u0026quot;ï¼šåˆ é™¤å½“å‰å•è¯å‘¨å›´çš„åŒå¼•å·ï¼Œä¾‹å¦‚ \u0026quot; word \u0026quot;ï¼Œå…‰æ ‡åœ¨ w,åˆ é™¤åå˜æˆäº† w å¦‚æœæŠŠä¸Šé¢çš„ command d æ¢æˆ cï¼Œé‚£ä¹ˆåˆ é™¤åä¼šè¿›å…¥åˆ°æ’å…¥æ¨¡å¼ã€‚\ns` å¯¹å†™ html è¿™ç§æ ‡è®°è¯­è¨€éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚å°†ä¸‹é¢çš„ `div` æ”¹æˆ `p`ï¼Œå¯ä»¥ä½¿ç”¨ `cstt`ï¼Œç„¶åè¾“å…¥ `p`ï¼Œ`c` è¡¨ç¤º `change \u0026lt;div\u0026gt; è¿™æ˜¯ä¸€ä¸ªæ®µè½ \u0026lt;/div\u0026gt; i3 wm ","permalink":"https://XianCH.github.io/posts/tech/tool/%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/","summary":"\u003ch1 id=\"tmuxå¸¸ç”¨å‘½ä»¤\"\u003etmuxå¸¸ç”¨å‘½ä»¤\u003c/h1\u003e\n\u003ch2 id=\"ç»ˆç«¯ä¸­ä½¿ç”¨-tmux-å‘½ä»¤\"\u003eç»ˆç«¯ä¸­ä½¿ç”¨ Tmux å‘½ä»¤\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eå¯åŠ¨ tmux ä½¿ç”¨ \u003ccode\u003e-s\u003c/code\u003e å‘½ä»¤æŒ‡å®šä¼šè¯åç§°ï¼Œä½¿ç”¨ \u003ccode\u003e-n\u003c/code\u003e å‘½ä»¤æŒ‡å®šçª—å£åç§°\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e$ tmux new -s sessionName -n window\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\n\u003cli\u003eé€€å‡ºä¼šè¯(tmuxä¼šè¯å†…å‘½ä»¤)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e$ tmux detach\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\n\u003cli\u003eé€€å‡ºå¹¶å…³é—­ä¼šè¯ï¼ˆçª—å£,çª—æ ¼ï¼‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e$ exit\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\n\u003cli\u003eç»“æŸåå°çš„ä¼šè¯\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e#é€šè¿‡ä¼šè¯ç¼–å·\n\n$ tmux kill-session -t 0\n\n#é€šè¿‡ä¼šè¯åç§°\n\n$ tmux kill-session -t sessionName \n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\n\u003cli\u003eæŸ¥çœ‹æ‰€æœ‰ä¼šè¯\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e$ tmux ls\n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\n\u003cli\u003eæ¿€æ´»ä¼šè¯\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e$ tmux attach -t sessionName\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"tmux-å†…ä½¿ç”¨å‰ç¼€-ctrlb-ç„¶åå¯¹åº”å¿«æ·é”®æ‰§è¡Œå‘½ä»¤\"\u003eTmux å†…ä½¿ç”¨å‰ç¼€ Ctrl+b ç„¶åå¯¹åº”å¿«æ·é”®æ‰§è¡Œå‘½ä»¤\u003c/h2\u003e\n\u003ch3 id=\"ä¼šè¯å¸¸ç”¨å¿«æ·æ“ä½œ\"\u003eä¼šè¯å¸¸ç”¨å¿«æ·æ“ä½œ\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eå¿«æ·é”®\u003c/th\u003e\n          \u003cth\u003eè¯´æ˜\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e?\u003c/td\u003e\n          \u003ctd\u003eæ‰€æœ‰å¿«æ·é”®ï¼Œqé€€å‡º\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e:new sessionName\u003c/td\u003e\n          \u003ctd\u003eåˆ›å»ºæ–°ä¼šè¯\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003es\u003c/td\u003e\n          \u003ctd\u003eåˆ‡æ¢ä¼šè¯\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e$\u003c/td\u003e\n          \u003ctd\u003eé‡å‘½åå½“å‰ä¼šè¯\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ed\u003c/td\u003e\n          \u003ctd\u003eç¦»å¼€ä¼šè¯è¿”å›shellï¼ˆä¸tmux detachåŠŸèƒ½ç›¸åŒï¼‰\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCtrl+z\u003c/td\u003e\n          \u003ctd\u003eæŒ‚èµ·ä¼šè¯ï¼Œè¿”å›shell\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"çª—å£å¸¸ç”¨å¿«æ·æ“ä½œ\"\u003eçª—å£å¸¸ç”¨å¿«æ·æ“ä½œ\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eå¿«æ·é”®\u003c/th\u003e\n          \u003cth\u003eè¯´æ˜\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ec\u003c/td\u003e\n          \u003ctd\u003eåˆ›å»ºæ–°çª—å£\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ew\u003c/td\u003e\n          \u003ctd\u003eæ˜¾ç¤ºçª—å£\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eæ•°å­—é”®\u003c/td\u003e\n          \u003ctd\u003eé€‰æ‹©å¯¹åº”çª—å£\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ep\u003c/td\u003e\n          \u003ctd\u003eå‰ä¸€ä¸ªçª—å£\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003en\u003c/td\u003e\n          \u003ctd\u003eåä¸€ä¸ªçª—å£\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ef\u003c/td\u003e\n          \u003ctd\u003eæŸ¥æ‰¾çª—å£\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e,\u003c/td\u003e\n          \u003ctd\u003eé‡å‘½åçª—å£\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u0026amp;\u003c/td\u003e\n          \u003ctd\u003eå…³é—­çª—å£ï¼ˆå¸¦æç¤ºï¼‰\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"çª—æ ¼å¸¸ç”¨å¿«æ·é”®\"\u003eçª—æ ¼å¸¸ç”¨å¿«æ·é”®\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eå¿«æ·é”®\u003c/th\u003e\n          \u003cth\u003eè¯´æ˜\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e%\u003c/td\u003e\n          \u003ctd\u003eå‚ç›´åˆ†å‰²\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eâ€\u003c/td\u003e\n          \u003ctd\u003eæ°´å¹³åˆ†å‰²\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eo\u003c/td\u003e\n          \u003ctd\u003eåˆ‡æ¢çª—æ ¼\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ex\u003c/td\u003e\n          \u003ctd\u003eå…³é—­çª—æ ¼\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003espace\u003c/td\u003e\n          \u003ctd\u003eåˆ‡æ¢çª—æ ¼å¸ƒå±€\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eq\u003c/td\u003e\n          \u003ctd\u003eæ˜¾ç¤ºçª—æ ¼ç¼–å·ï¼ŒæŒ‰å¯¹åº”æ•°å­—é€‰æ‹©çª—æ ¼\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e{\u003c/td\u003e\n          \u003ctd\u003eä¸ä¸Šä¸€ä¸ªçª—æ ¼è°ƒæ¢ä½ç½®\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e}\u003c/td\u003e\n          \u003ctd\u003eä¸ä¸‹ä¸€ä¸ªçª—æ ¼è°ƒæ¢ä½ç½®\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ez\u003c/td\u003e\n          \u003ctd\u003eå½“å‰çª—æ ¼æœ€å¤§åŒ–\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e!\u003c/td\u003e\n          \u003ctd\u003eå–æ¶ˆæ‰€æœ‰çª—å£ä¿ç•™å½“å‰çª—å£\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCtrl+æ–¹å‘é”®\u003c/td\u003e\n          \u003ctd\u003eä»¥1ä¸ªå•å…ƒæ ¼ä¸ºå•ä½ç§»åŠ¨è¾¹ç¼˜ä»¥è°ƒæ•´å½“å‰çª—æ ¼å¤§å°\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAlt+æ–¹å‘é”®\u003c/td\u003e\n          \u003ctd\u003eä»¥5ä¸ªå•å…ƒæ ¼ä¸ºå•ä½ç§»åŠ¨è¾¹ç¼˜ä»¥è°ƒæ•´å½“å‰çª—æ ¼å¤§å°\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch1 id=\"vim-ä½¿ç”¨æŠ€å·§--ä½¿ç”¨æŠ€å·§\"\u003evim ä½¿ç”¨æŠ€å·§ [#](\u003ca href=\"https://pengfeixc.com/blogs/developer-handbook/vim-shortcuts#vim\"\u003ehttps://pengfeixc.com/blogs/developer-handbook/vim-shortcuts#vim\u003c/a\u003e ä½¿ç”¨æŠ€å·§)\u003c/h1\u003e\n\u003cp\u003eä¸‹é¢çš„å‘½ä»¤æ˜¯æˆ‘å¸¸ç”¨çš„ä¸€äº›å¿«æ·é”®æ“ä½œï¼Œæˆ‘ä½¿ç”¨çš„ç¼–è¾‘å™¨æ˜¯ vscodeï¼Œå®‰è£…äº† vim æ’ä»¶ã€‚\u003c/p\u003e","title":"å¸¸ç”¨å¿«æ·é”®"},{"content":"è¿™ä¸ªæ˜¯elonå‘å¸ƒçš„æ¶æ„å›¾\nå› ä¸ºå¾ˆå¤šå­—çœ‹ä¸æ¸…æˆ‘åœ¨twitterä¸Šæ‰¾äº†ä½æ¶æ„å¸ˆalex xuæ•´ç†çš„å›¾ https://twitter.com/alexxubyte/status/1594008281340530688\n1ï¼Œé¦–å…ˆå¯¹å®‰å“å’Œiphoneç”¨æˆ·åšäº†ä¸åŒçš„å¤„ç†ï¼Œå¯ä»¥è¯´è¿™ä¸¤ä¸ªç³»ç»Ÿæ˜¯ä¸¤ä¸ªåº”ç”¨æŠŠï¼Œå®‰å“ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸç”Ÿåº”ç”¨ç¨‹åºï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯ä¸“é—¨ä¸ºå®‰å“æ“ä½œç³»ç»Ÿç¼–å†™çš„åº”ç”¨ç¨‹åºï¼Œèƒ½å¤Ÿç›´æ¥è®¿é—®è®¾å¤‡ç¡¬ä»¶å’Œç³»ç»Ÿèµ„æºï¼Œå®‰å“ç”¨æˆ·æ‹¥æœ‰æ›´é«˜çš„æ€§èƒ½å’Œä½“éªŒã€‚è€Œ iphoneç‰ˆ twitteræ„Ÿè§‰å°±æ˜¯åƒæ˜¯ç½‘ç«™webç«¯å§ï¼Œï¼Œå®ƒéœ€è¦ä¾èµ–æµè§ˆå™¨æ¥åŠ è½½å’Œæ¸²æŸ“å†…å®¹ï¼Œç›¸å¯¹äºåŸç”Ÿåº”ç”¨ç¨‹åºï¼Œå®ƒå¯èƒ½ä¼šå…·æœ‰ä¸€äº›é™åˆ¶å’Œæ€§èƒ½ä¸Šçš„åŠ£åŠ¿ã€‚å¦‚æœtwitterçš„uiä»£ç å‡ºé—®é¢˜äº†ï¼Œå®‰å“ç”¨æˆ·åº”è¯¥ä¼šç›´æ¥æ”¶åˆ°æŠ¥é”™å§ï¼Œè¿™é‡Œéƒ½é’ˆå¯¹ä¸åŒç³»ç»Ÿçš„ç”¨æˆ·æœ‰ä¸åŒçš„æ‹¦æˆªå™¨å§ã€‚\nä»–ä»¬ä¸¤ä¸ªç”¨åˆ°è®¿é—®æ•°æ®çš„æ–¹å¼ä¸ä¸€æ ·å®‰å“ç”¨TLS APIï¼ŒTLS æ˜¯ä¸€ç§å®‰å…¨åè®®ï¼Œå¯ä»¥å¾ˆå¥½çš„ä¿æŠ¤äº’è”ç½‘ä¸­çš„å®‰å…¨ä¿¡æ¯ï¼Œå®‰å…¨æ€§ç›¸å¯¹é«˜ï¼Œç¼ºç‚¹åº”è¯¥å°±æ˜¯æ€§èƒ½å¼€é”€å¤§å§ï¼Œiphoneç”¨æˆ·ç”¨çš„æ˜¯GraphQLæ˜¯ä¸€ç§æ•°æ®æŸ¥è¯¢è¯­è¨€ï¼Œå¯ä»¥ç²¾ç¡®çš„è·å–æŒ‡å®šçš„èµ„æºï¼Œå‡å°‘æœåŠ¡ç«¯å“åº”çš„æ•°é‡ï¼Œæé«˜æ€§èƒ½å’Œæ•°é‡ã€‚\n2ï¼ŒTimeline Mixerè¿™ä¸ªæ¨¡å—æ ¹æ®ç”¨æˆ·å‘å¤–è¾“å‡ºçš„æ•°æ®åšè·å–ï¼Œå¤„ç†ç”¨æˆ·çš„æ—¶é—´çº¿æ•°æ®ï¼Œç”¨æˆ·æ—¶é—´çº¿æ•°æ®åº”è¯¥æ˜¯æŒ‡ç”¨æˆ·åœ¨Twitterä¸Šå‘å¸ƒçš„æ¨æ–‡(Tweetè½¬å‘å›å¤ç­‰å†…å®¹ç»„æˆçš„æ—¶é—´åºåˆ—ã€‚åœ¨twitterä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„æ—¶é—´çº¿ï¼Œæ ¹æ®ç”¨æˆ·å…³æ³¨äº†è°ï¼Œç‚¹è¿›äº†ä»€ä¹ˆå¹¿å‘Šï¼Œè¯„è®ºè¿‡çš„æ¨æ–‡ï¼Œå‘å¸ƒè¿‡çš„æ¨æ–‡åšåˆ†æã€‚è¿™é‡Œçš„onboardingæˆ‘ä¸æ˜¯å¾ˆæ¸…æ¥šä»€ä¹ˆæ„æ€ã€‚cursoring | pagination é€šè¿‡cusoring åˆ†é¡µæŠ€æœ¯æé«˜æŸ¥è¯¢ç”¨æˆ·çš„æ—¶é—´çº¿æ•°æ®ã€‚tweet deduplicationå¤„ç†æ—¶é—´çº¿æ•°æ®çš„å»é‡ï¼Œé¿å…åŒä¸€æ¡æ¨æ–‡åœ¨ç”¨æˆ·æ—¶é—´çº¿ä¸­å‡ºç°å¤šæ¬¡ã€‚served data loggingè®°å½•æ•°æ®æŸ¥è¯¢å’Œå¤„ç†çš„æ—¥å¿—ä¿¡æ¯ï¼Œä»¥ä¾¿åç»­çš„æ•°æ®åˆ†æå’Œæ€§èƒ½ä¼˜åŒ–ã€‚æœ€ååœ¨æŠŠæ”¶é›†çš„ä¿¡æ¯æä¾›ç»™â€ç”¨æˆ·å‘ç°ç”¨æˆ·â€œï¼Œâ€å¹¿å‘Šæ¨é€â€œï¼Œâ€ç”¨æˆ·å¼•å¯¼â€œç­‰æœåŠ¡\n3ï¼ŒHome Mixerä¸»è¦è´Ÿè´£ä¸ºç”¨æˆ·æ¨èç›¸å…³çš„å†…å®¹ï¼ŒåŒ…æ‹¬ä¸»é¡µä¸Šæ˜¾ç¤ºçš„æ¨æ–‡ã€çƒ­é—¨è¯é¢˜ã€æ¨èç”¨æˆ·ç­‰ã€‚é€šè¿‡åˆ†æç”¨æˆ·çš„ç¤¾äº¤å…³ç³»ã€å…´è¶£çˆ±å¥½ã€å†å²è¡Œä¸ºç­‰ä¿¡æ¯ï¼Œä¸ºç”¨æˆ·æ¨èé€‚åˆçš„å†…å®¹ã€‚æ··åˆåœ¨ä¸€èµ·ï¼Œç”Ÿæˆç”¨æˆ·çš„ä¸ªæ€§åŒ–ä¸»é¡µ\n4,timeline mixerå’Œhome mixerçš„æ•°æ®ä¼ åˆ°homerankerä¸­ï¼Œç„¶åå®ƒä¸ºç”¨æˆ·ä¸ªæ€§åŒ–åœ°æ’åºå’Œæ¨èä¸»é¡µä¸Šæ˜¾ç¤ºçš„å†…å®¹ï¼ŒåŒ…æ‹¬æ¨æ–‡ã€çƒ­é—¨è¯é¢˜ã€æ¨èç”¨æˆ·ç­‰ã€‚æ„Ÿè§‰homerankeræ˜¯ä¸ªå¾ˆå¤æ‚çš„ç®—æ³•æ¨¡å‹\n5,æ„Ÿè§‰è¿™æ˜¯æœºæ¢°å­¦ç³»çš„é¢†åŸŸäº†ï¼Œhomerankeré€šè¿‡æŸç§ç®—æ³•å¾—åˆ°homescorer ï¼Œè€Œ feature hydration åˆ™æ˜¯æŒ‡å°†è¿™äº›æå–å‡ºæ¥çš„ç‰¹å¾ä¸ç›¸åº”çš„æ¨æ–‡ä¿¡æ¯è¿›è¡Œå…³è”ï¼Œæ•°æ®ä¼šä»å­˜å‚¨åœ¨ memcache ä¸­çš„ç¼“å­˜ä¸­ï¼ŒåæœŸè®¡ç®—çš„æ—¶å¯ä»¥ä½¿ç”¨ï¼Ÿã€‚Home Scorer ä¼šå°†è®¡ç®—å¾—åˆ†åçš„æ•°æ®å‘é€åˆ° Manhattan \u0026hellip;.\n","permalink":"https://XianCH.github.io/posts/tech/other/%E5%85%B3%E4%BA%8Etwitter%E6%9E%B6%E6%9E%84%E5%9B%BE%E7%9A%84%E6%80%9D%E8%80%83/","summary":"\u003cp\u003eè¿™ä¸ªæ˜¯elonå‘å¸ƒçš„æ¶æ„å›¾\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"twitter%e6%9e%b6%e6%9e%84%e5%9b%be%e7%9a%84%e6%80%9d%e8%80%83.assets/Fh6qtzdUAAARaTI.jpg\" alt=\"\"  /\u003e\nå› ä¸ºå¾ˆå¤šå­—çœ‹ä¸æ¸…æˆ‘åœ¨twitterä¸Šæ‰¾äº†ä½æ¶æ„å¸ˆalex xuæ•´ç†çš„å›¾ \u003ca href=\"https://twitter.com/alexxubyte/status/1594008281340530688\"\u003ehttps://twitter.com/alexxubyte/status/1594008281340530688\u003c/a\u003e\u003cimg src=\"twitteræ¶æ„å›¾çš„æ€è€ƒ.assets/Fh8OE2jUAAEIVRR.jpg\" style=\"zoom:20%;\" /\u003e\u003cimg src=\"twitteræ¶æ„å›¾çš„æ€è€ƒ.assets/image-20230328044142610.png\" alt=\"image-20230328044142610\" style=\"zoom:50%;\" /\u003e\u003c/p\u003e\n\u003cp\u003e1ï¼Œé¦–å…ˆå¯¹å®‰å“å’Œiphoneç”¨æˆ·åšäº†ä¸åŒçš„å¤„ç†ï¼Œå¯ä»¥è¯´è¿™ä¸¤ä¸ªç³»ç»Ÿæ˜¯ä¸¤ä¸ªåº”ç”¨æŠŠï¼Œå®‰å“ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸç”Ÿåº”ç”¨ç¨‹åºï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯ä¸“é—¨ä¸ºå®‰å“æ“ä½œç³»ç»Ÿç¼–å†™çš„åº”ç”¨ç¨‹åºï¼Œèƒ½å¤Ÿç›´æ¥è®¿é—®è®¾å¤‡ç¡¬ä»¶å’Œç³»ç»Ÿèµ„æºï¼Œå®‰å“ç”¨æˆ·æ‹¥æœ‰æ›´é«˜çš„æ€§èƒ½å’Œä½“éªŒã€‚è€Œ iphoneç‰ˆ twitteræ„Ÿè§‰å°±æ˜¯åƒæ˜¯ç½‘ç«™webç«¯å§ï¼Œï¼Œå®ƒéœ€è¦ä¾èµ–æµè§ˆå™¨æ¥åŠ è½½å’Œæ¸²æŸ“å†…å®¹ï¼Œç›¸å¯¹äºåŸç”Ÿåº”ç”¨ç¨‹åºï¼Œå®ƒå¯èƒ½ä¼šå…·æœ‰ä¸€äº›é™åˆ¶å’Œæ€§èƒ½ä¸Šçš„åŠ£åŠ¿ã€‚å¦‚æœtwitterçš„uiä»£ç å‡ºé—®é¢˜äº†ï¼Œå®‰å“ç”¨æˆ·åº”è¯¥ä¼šç›´æ¥æ”¶åˆ°æŠ¥é”™å§ï¼Œè¿™é‡Œéƒ½é’ˆå¯¹ä¸åŒç³»ç»Ÿçš„ç”¨æˆ·æœ‰ä¸åŒçš„æ‹¦æˆªå™¨å§ã€‚\u003c/p\u003e","title":"å…³äºtwitteræ¶æ„å›¾çš„æ€è€ƒ"},{"content":"å¼‚å¸¸ å¸¸è§å¼‚å¸¸ï¼š\nIOException,NullPointerException,IndexOutOfBoundsException,SQLException,ArithmeticException\n","permalink":"https://XianCH.github.io/posts/tech/java/java%E5%A4%8D%E4%B9%A0/","summary":"\u003ch2 id=\"å¼‚å¸¸\"\u003eå¼‚å¸¸\u003c/h2\u003e\n\u003cp\u003eå¸¸è§å¼‚å¸¸ï¼š\u003c/p\u003e\n\u003cp\u003eIOException,NullPointerException,IndexOutOfBoundsException,SQLException,ArithmeticException\u003c/p\u003e","title":"javaåŸºç¡€å¤ä¹ "},{"content":"åŒ…å«çš„æ¨¡å— åä¹ä¸ªæ¨¡å—ï¼Œåˆ†åˆ«æ˜¯ï¼š Java åŸºç¡€ã€å®¹å™¨ã€å¤šçº¿ç¨‹ã€åå°„ã€å¯¹è±¡æ‹·è´ã€Java Web ã€å¼‚å¸¸ã€ç½‘ç»œã€è®¾è®¡æ¨¡å¼ã€ Spring/Spring MVCã€Spring Boot/Spring Cloudã€Hibernateã€MyBatisã€RabbitMQã€Kafkaã€Zookeeperã€ MySQLã€Redisã€JVM ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nJava åŸºç¡€ 1. JDK å’Œ JRE æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ JDKï¼šJava Development Kit çš„ç®€ç§°ï¼ŒJava å¼€å‘å·¥å…·åŒ…ï¼Œæä¾›äº† Java çš„å¼€å‘ç¯å¢ƒå’Œè¿è¡Œç¯å¢ƒã€‚ JREï¼šJava Runtime Environment çš„ç®€ç§°ï¼ŒJava è¿è¡Œç¯å¢ƒï¼Œä¸º Java çš„è¿è¡Œæä¾›äº†æ‰€éœ€ç¯å¢ƒã€‚ å…·ä½“æ¥è¯´ JDK å…¶å®åŒ…å«äº† JREï¼ŒåŒæ—¶è¿˜åŒ…å«äº†ç¼–è¯‘ Java æºç çš„ç¼–è¯‘å™¨ Javacï¼Œè¿˜åŒ…å«äº†å¾ˆå¤š Java ç¨‹åºè°ƒè¯•å’Œåˆ†æçš„ å·¥å…·ã€‚ç®€å•æ¥è¯´ï¼šå¦‚æœä½ éœ€è¦è¿è¡Œ Java ç¨‹åºï¼Œåªéœ€å®‰è£… JRE å°±å¯ä»¥äº†ï¼Œå¦‚æœä½ éœ€è¦ç¼–å†™ Java ç¨‹åºï¼Œéœ€è¦å®‰è£… JDKã€‚\n2. == å’Œ equals çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ == è§£è¯» å¯¹äºåŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹ == çš„ä½œç”¨æ•ˆæœæ˜¯ä¸åŒçš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š åŸºæœ¬ç±»å‹ï¼šæ¯”è¾ƒçš„æ˜¯å€¼æ˜¯å¦ç›¸åŒï¼› å¼•ç”¨ç±»å‹ï¼šæ¯”è¾ƒçš„æ˜¯å¼•ç”¨æ˜¯å¦ç›¸åŒï¼› ä»£ç ç¤ºä¾‹ï¼š String x = \u0026#34;string\u0026#34;; String y = \u0026#34;string\u0026#34;; String z = new String(\u0026#34;string\u0026#34;); System.out.println(x==y); // true System.out.println(x==z); // false System.out.println(x.equals(y)); // true System.out.println(x.equals(z)); // true ä»£ç è§£è¯»ï¼šå› ä¸º x å’Œ y æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥ == ä¹Ÿæ˜¯ trueï¼Œè€Œ new String()æ–¹æ³•åˆ™é‡å†™å¼€è¾Ÿäº†å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥ == ç»“æœä¸º falseï¼Œè€Œ equals æ¯”è¾ƒçš„ä¸€ç›´æ˜¯å€¼ï¼Œæ‰€ä»¥ç»“æœéƒ½ä¸º trueã€‚\nequals è§£è¯»\nequals æœ¬è´¨ä¸Šå°±æ˜¯ ==ï¼Œåªä¸è¿‡ String å’Œ Integer ç­‰é‡å†™äº† equals æ–¹æ³•ï¼ŒæŠŠå®ƒå˜æˆäº†å€¼æ¯”è¾ƒã€‚çœ‹ä¸‹é¢çš„ä»£ç å°±æ˜ç™½ äº†ã€‚\né¦–å…ˆæ¥çœ‹é»˜è®¤æƒ…å†µä¸‹ equals æ¯”è¾ƒä¸€ä¸ªæœ‰ç›¸åŒå€¼çš„å¯¹è±¡ï¼Œä»£ç å¦‚ä¸‹ï¼š\nString x = \u0026#34;string\u0026#34;; String y = \u0026#34;string\u0026#34;; String z = new String(\u0026#34;string\u0026#34;); System.out.println(x==y); // true System.out.println(x==z); // false System.out.println(x.equals(y)); // true System.out.println(x.equals(z)); // true class Cat {\rpublic Cat(String name) {\rthis.name = name;\r} private String name; public String getName() {\rreturn name;\r} public void setName(String name) {\rthis.name = name;\r}\r} Cat c1 = new Cat(\u0026#34;ç‹ç£Š\u0026#34;); Cat c2 = new Cat(\u0026#34;ç‹ç£Š\u0026#34;); System.out.println(c1.equals(c2)); // false è¾“å‡ºç»“æœå‡ºä¹æˆ‘ä»¬çš„æ„æ–™ï¼Œç«Ÿç„¶æ˜¯ falseï¼Ÿè¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Œçœ‹äº† equals æºç å°±çŸ¥é“äº†ï¼Œæºç å¦‚ä¸‹ï¼š\nåŸæ¥ equals æœ¬è´¨ä¸Šå°±æ˜¯ ==ã€‚\né‚£é—®é¢˜æ¥äº†ï¼Œä¸¤ä¸ªç›¸åŒå€¼çš„ String å¯¹è±¡ï¼Œä¸ºä»€ä¹ˆè¿”å›çš„æ˜¯ trueï¼Ÿä»£ç å¦‚ä¸‹ï¼š\nåŒæ ·çš„ï¼Œå½“æˆ‘ä»¬è¿›å…¥ String çš„ equals æ–¹æ³•ï¼Œæ‰¾åˆ°äº†ç­”æ¡ˆï¼Œä»£ç å¦‚ä¸‹ï¼š\nåŸæ¥æ˜¯ String é‡å†™äº† Object çš„ equals æ–¹æ³•ï¼ŒæŠŠå¼•ç”¨æ¯”è¾ƒæ”¹æˆäº†å€¼æ¯”è¾ƒã€‚\næ€»ç»“ ï¼š== å¯¹äºåŸºæœ¬ç±»å‹æ¥è¯´æ˜¯å€¼æ¯”è¾ƒï¼Œå¯¹äºå¼•ç”¨ç±»å‹æ¥è¯´æ˜¯æ¯”è¾ƒçš„æ˜¯å¼•ç”¨ï¼›è€Œ equals é»˜è®¤æƒ…å†µä¸‹æ˜¯å¼•ç”¨æ¯”è¾ƒï¼Œåª æ˜¯å¾ˆå¤šç±»é‡æ–°äº† equals æ–¹æ³•ï¼Œæ¯”å¦‚ Stringã€Integer ç­‰æŠŠå®ƒå˜æˆäº†å€¼æ¯”è¾ƒï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ equals æ¯”è¾ƒçš„æ˜¯å€¼æ˜¯å¦ ç›¸ç­‰ã€‚\n3. ä¸¤ä¸ªå¯¹è±¡çš„ hashCode() ç›¸åŒï¼Œåˆ™ equals() ä¹Ÿä¸€å®šä¸º trueï¼Œå¯¹å—ï¼Ÿ ä¸å¯¹ï¼Œä¸¤ä¸ªå¯¹è±¡çš„ hashCode() ç›¸åŒï¼Œequals() ä¸ä¸€å®š trueã€‚\nä»£ç ç¤ºä¾‹ï¼š\npublic boolean equals(Object obj) {\rreturn (this == obj);\r} String s1 = new String(\u0026#34;è€ç‹\u0026#34;);\rString s2 = new String(\u0026#34;è€ç‹\u0026#34;);\rSystem.out.println(s1.equals(s2)); // true public boolean equals(Object anObject) { if (this == anObject) { return true; } if (anObject instanceof String) { String anotherString = (String)anObject; int n = value.length; if (n == anotherString.value.length) { char v1[] = value; char v2[] = anotherString.value; int i = 0 ; while (n-- != 0 ) { if (v1[i] != v2[i]) return false; i++; } return true; } } return false; } æ‰§è¡Œçš„ç»“æœï¼š ä»£ç è§£è¯»ï¼šå¾ˆæ˜¾ç„¶â€œé€šè¯â€å’Œâ€œé‡åœ°â€çš„ hashCode() ç›¸åŒï¼Œç„¶è€Œ equals() åˆ™ä¸º falseï¼Œå› ä¸ºåœ¨æ•£åˆ—è¡¨ä¸­ï¼ŒhashCode() ç›¸ ç­‰å³ä¸¤ä¸ªé”®å€¼å¯¹çš„å“ˆå¸Œå€¼ç›¸ç­‰ï¼Œç„¶è€Œå“ˆå¸Œå€¼ç›¸ç­‰ï¼Œå¹¶ä¸ä¸€å®šèƒ½å¾—å‡ºé”®å€¼å¯¹ç›¸ç­‰ã€‚\n4. final åœ¨ Java ä¸­æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ final ä¿®é¥°çš„ç±»å«æœ€ç»ˆç±»ï¼Œè¯¥ç±»ä¸èƒ½è¢«ç»§æ‰¿ã€‚\rfinal ä¿®é¥°çš„æ–¹æ³•ä¸èƒ½è¢«é‡å†™ã€‚\rfinal ä¿®é¥°çš„å˜é‡å«å¸¸é‡ï¼Œå¸¸é‡å¿…é¡»åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–ä¹‹åå€¼å°±ä¸èƒ½è¢«ä¿®æ”¹ã€‚ 5. Java ä¸­çš„ Math. round(-1. 5) ç­‰äºå¤šå°‘ï¼Ÿ ç­‰äº -1ï¼Œå› ä¸ºåœ¨æ•°è½´ä¸Šå–å€¼æ—¶ï¼Œä¸­é—´å€¼ï¼ˆ0.5ï¼‰å‘å³å–æ•´ï¼Œæ‰€ä»¥æ­£ 0.5 æ˜¯å¾€ä¸Šå–æ•´ï¼Œè´Ÿ 0.5 æ˜¯ç›´æ¥èˆå¼ƒã€‚ 6. String å±äºåŸºç¡€çš„æ•°æ®ç±»å‹å—ï¼Ÿ String ä¸å±äºåŸºç¡€ç±»å‹ï¼ŒåŸºç¡€ç±»å‹æœ‰ 8 ç§ï¼šbyteã€booleanã€charã€shortã€intã€floatã€longã€doubleï¼Œè€Œ String å±äºå¯¹è±¡ã€‚\n7. Java ä¸­æ“ä½œå­—ç¬¦ä¸²éƒ½æœ‰å“ªäº›ç±»ï¼Ÿå®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ æ“ä½œå­—ç¬¦ä¸²çš„ç±»æœ‰ï¼šStringã€StringBufferã€StringBuilderã€‚\nString å’Œ StringBufferã€StringBuilder çš„åŒºåˆ«åœ¨äº String å£°æ˜çš„æ˜¯ä¸å¯å˜çš„å¯¹è±¡ï¼Œæ¯æ¬¡æ“ä½œéƒ½ä¼šç”Ÿæˆæ–°çš„ String å¯¹ è±¡ï¼Œç„¶åå°†æŒ‡é’ˆæŒ‡å‘æ–°çš„ String å¯¹è±¡ï¼Œè€Œ StringBufferã€StringBuilder å¯ä»¥åœ¨åŸæœ‰å¯¹è±¡çš„åŸºç¡€ä¸Šè¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥åœ¨ ç»å¸¸æ”¹å˜å­—ç¬¦ä¸²å†…å®¹çš„æƒ…å†µä¸‹æœ€å¥½ä¸è¦ä½¿ç”¨ Stringã€‚\nStringBuffer å’Œ StringBuilder æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼ŒStringBuffer æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œ StringBuilder æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œä½† StringBuilder çš„æ€§èƒ½å´é«˜äº StringBufferï¼Œæ‰€ä»¥åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹æ¨èä½¿ç”¨ StringBuilderï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ¨èä½¿ç”¨ StringBufferã€‚\n8. String str=\u0026ldquo;i\u0026quot;ä¸ String str=new String(\u0026ldquo;i\u0026rdquo;)ä¸€æ ·å—ï¼Ÿ ä¸ä¸€æ ·ï¼Œå› ä¸ºå†…å­˜çš„åˆ†é…æ–¹å¼ä¸ä¸€æ ·ã€‚String str=\u0026ldquo;i\u0026quot;çš„æ–¹å¼ï¼ŒJava è™šæ‹Ÿæœºä¼šå°†å…¶åˆ†é…åˆ°å¸¸é‡æ± ä¸­ï¼›è€Œ String str=new String(\u0026ldquo;i\u0026rdquo;) åˆ™ä¼šè¢«åˆ†åˆ°å †å†…å­˜ä¸­ã€‚\n9. å¦‚ä½•å°†å­—ç¬¦ä¸²åè½¬ï¼Ÿ ä½¿ç”¨ StringBuilder æˆ–è€… stringBuffer çš„ reverse() æ–¹æ³•ã€‚\nç¤ºä¾‹ä»£ç ï¼š\nString str1 = \u0026#34;é€šè¯\u0026#34;;\rString str2 = \u0026#34;é‡åœ°\u0026#34;;\rSystem. out. println(String. format(\u0026#34;str1ï¼š%d | str2ï¼š%d\u0026#34;, str1. hashCode(),str2.\rhashCode()));\rSystem. out. println(str1. equals(str2)); str1ï¼š 1179395 | str2ï¼š 1179395 false 10. String ç±»çš„å¸¸ç”¨æ–¹æ³•éƒ½æœ‰é‚£äº›ï¼Ÿ indexOf()ï¼šè¿”å›æŒ‡å®šå­—ç¬¦çš„ç´¢å¼•ã€‚\rcharAt()ï¼šè¿”å›æŒ‡å®šç´¢å¼•å¤„çš„å­—ç¬¦ã€‚\rreplace()ï¼šå­—ç¬¦ä¸²æ›¿æ¢ã€‚\rtrim()ï¼šå»é™¤å­—ç¬¦ä¸²ä¸¤ç«¯ç©ºç™½ã€‚\rsplit()ï¼šåˆ†å‰²å­—ç¬¦ä¸²ï¼Œè¿”å›ä¸€ä¸ªåˆ†å‰²åçš„å­—ç¬¦ä¸²æ•°ç»„ã€‚\rgetBytes()ï¼šè¿”å›å­—ç¬¦ä¸²çš„ byte ç±»å‹æ•°ç»„ã€‚\rlength()ï¼šè¿”å›å­—ç¬¦ä¸²é•¿åº¦ã€‚\rtoLowerCase()ï¼šå°†å­—ç¬¦ä¸²è½¬æˆå°å†™å­—æ¯ã€‚\rtoUpperCase()ï¼šå°†å­—ç¬¦ä¸²è½¬æˆå¤§å†™å­—ç¬¦ã€‚\rsubstring()ï¼šæˆªå–å­—ç¬¦ä¸²ã€‚\requals()ï¼šå­—ç¬¦ä¸²æ¯”è¾ƒã€‚ 11. æŠ½è±¡ç±»å¿…é¡»è¦æœ‰æŠ½è±¡æ–¹æ³•å—ï¼Ÿ ä¸éœ€è¦ï¼ŒæŠ½è±¡ç±»ä¸ä¸€å®šéè¦æœ‰æŠ½è±¡æ–¹æ³•ã€‚ ç¤ºä¾‹ä»£ç ï¼š ä¸Šé¢ä»£ç ï¼ŒæŠ½è±¡ç±»å¹¶æ²¡æœ‰æŠ½è±¡æ–¹æ³•ä½†å®Œå…¨å¯ä»¥æ­£å¸¸è¿è¡Œã€‚ 12. æ™®é€šç±»å’ŒæŠ½è±¡ç±»æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ æ™®é€šç±»ä¸èƒ½åŒ…å«æŠ½è±¡æ–¹æ³•ï¼ŒæŠ½è±¡ç±»å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ã€‚ æŠ½è±¡ç±»ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ï¼Œæ™®é€šç±»å¯ä»¥ç›´æ¥å®ä¾‹åŒ–ã€‚ 13. æŠ½è±¡ç±»èƒ½ä½¿ç”¨ final ä¿®é¥°å—ï¼Ÿ ä¸èƒ½ï¼Œå®šä¹‰æŠ½è±¡ç±»å°±æ˜¯è®©å…¶ä»–ç±»ç»§æ‰¿çš„ï¼Œå¦‚æœå®šä¹‰ä¸º final è¯¥ç±»å°±ä¸èƒ½è¢«ç»§æ‰¿ï¼Œè¿™æ ·å½¼æ­¤å°±ä¼šäº§ç”ŸçŸ›ç›¾ï¼Œæ‰€ä»¥ final ä¸ èƒ½ä¿®é¥°æŠ½è±¡ç±»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç¼–è¾‘å™¨ä¹Ÿä¼šæç¤ºé”™è¯¯ä¿¡æ¯ï¼š\n// StringBuffer reverse StringBuffer stringBuffer = new StringBuffer(); stringBuffer. append(\u0026#34;abcdefg\u0026#34;); System. out. println(stringBuffer. reverse()); // gfedcba // StringBuilder reverse StringBuilder stringBuilder = new StringBuilder(); stringBuilder. append(\u0026#34;abcdefg\u0026#34;); System. out. println(stringBuilder. reverse()); // gfedcba abstract class Cat { public static void sayHi() { System. out. println(\u0026#34;hi~\u0026#34;); } } 14. æ¥å£å’ŒæŠ½è±¡ç±»æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å®ç°ï¼šæŠ½è±¡ç±»çš„å­ç±»ä½¿ç”¨ extends æ¥ç»§æ‰¿ï¼›æ¥å£å¿…é¡»ä½¿ç”¨ implements æ¥å®ç°æ¥å£ã€‚\ræ„é€ å‡½æ•°ï¼šæŠ½è±¡ç±»å¯ä»¥æœ‰æ„é€ å‡½æ•°ï¼›æ¥å£ä¸èƒ½æœ‰ã€‚\rmain æ–¹æ³•ï¼šæŠ½è±¡ç±»å¯ä»¥æœ‰ main æ–¹æ³•ï¼Œå¹¶ä¸”æˆ‘ä»¬èƒ½è¿è¡Œå®ƒï¼›æ¥å£ä¸èƒ½æœ‰ main æ–¹æ³•ã€‚\rå®ç°æ•°é‡ï¼šç±»å¯ä»¥å®ç°å¾ˆå¤šä¸ªæ¥å£ï¼›ä½†æ˜¯åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»ã€‚\rè®¿é—®ä¿®é¥°ç¬¦ï¼šæ¥å£ä¸­çš„æ–¹æ³•é»˜è®¤ä½¿ç”¨ public ä¿®é¥°ï¼›æŠ½è±¡ç±»ä¸­çš„æ–¹æ³•å¯ä»¥æ˜¯ä»»æ„è®¿é—®ä¿®é¥°ç¬¦ã€‚ 15. Java ä¸­ IO æµåˆ†ä¸ºå‡ ç§ï¼Ÿ æŒ‰åŠŸèƒ½æ¥åˆ†ï¼šè¾“å…¥æµï¼ˆinputï¼‰ã€è¾“å‡ºæµï¼ˆoutputï¼‰ã€‚\næŒ‰ç±»å‹æ¥åˆ†ï¼šå­—èŠ‚æµå’Œå­—ç¬¦æµã€‚\nå­—èŠ‚æµå’Œå­—ç¬¦æµçš„åŒºåˆ«æ˜¯ï¼šå­—èŠ‚æµæŒ‰ 8 ä½ä¼ è¾“ä»¥å­—èŠ‚ä¸ºå•ä½è¾“å…¥è¾“å‡ºæ•°æ®ï¼Œå­—ç¬¦æµæŒ‰ 16 ä½ä¼ è¾“ä»¥å­—ç¬¦ä¸ºå•ä½è¾“å…¥è¾“ å‡ºæ•°æ®ã€‚\n16. BIOã€NIOã€AIO æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ BIOï¼šBlock IO åŒæ­¥é˜»å¡å¼ IOï¼Œå°±æ˜¯æˆ‘ä»¬å¹³å¸¸ä½¿ç”¨çš„ä¼ ç»Ÿ IOï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æ¨¡å¼ç®€å•ä½¿ç”¨æ–¹ä¾¿ï¼Œå¹¶å‘å¤„ç†èƒ½åŠ›\rä½ã€‚\rNIOï¼šNew IO åŒæ­¥éé˜»å¡ IOï¼Œæ˜¯ä¼ ç»Ÿ IO çš„å‡çº§ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯é€šè¿‡ Channelï¼ˆé€šé“ï¼‰é€šè®¯ï¼Œå®ç°äº†å¤šè·¯\rå¤ç”¨ã€‚\rAIOï¼šAsynchronous IO æ˜¯ NIO çš„å‡çº§ï¼Œä¹Ÿå« NIO2ï¼Œå®ç°äº†å¼‚æ­¥éå µå¡ IO ï¼Œå¼‚æ­¥ IO çš„æ“ä½œåŸºäºäº‹ä»¶å’Œå›è°ƒ\ræœºåˆ¶ã€‚ 17. Filesçš„å¸¸ç”¨æ–¹æ³•éƒ½æœ‰å“ªäº›ï¼Ÿ Files. exists()ï¼šæ£€æµ‹æ–‡ä»¶è·¯å¾„æ˜¯å¦å­˜åœ¨ã€‚\rFiles. createFile()ï¼šåˆ›å»ºæ–‡ä»¶ã€‚\rFiles. createDirectory()ï¼šåˆ›å»ºæ–‡ä»¶å¤¹ã€‚\rFiles. delete()ï¼šåˆ é™¤ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ã€‚\rFiles. copy()ï¼šå¤åˆ¶æ–‡ä»¶ã€‚\rFiles. move()ï¼šç§»åŠ¨æ–‡ä»¶ã€‚\rFiles. size()ï¼šæŸ¥çœ‹æ–‡ä»¶ä¸ªæ•°ã€‚\rFiles. read()ï¼šè¯»å–æ–‡ä»¶ã€‚\rFiles. write()ï¼šå†™å…¥æ–‡ä»¶ã€‚ å®¹å™¨ 18. Java å®¹å™¨éƒ½æœ‰å“ªäº›ï¼Ÿ Java å®¹å™¨åˆ†ä¸º Collection å’Œ Map ä¸¤å¤§ç±»ï¼Œå…¶ä¸‹åˆæœ‰å¾ˆå¤šå­ç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\nCollection List\rArrayList\rLinkedList\rVector\rStack\rSet\rHashSet\rLinkedHashSet\rTreeSet\rMap\rHashMap\rLinkedHashMap\rTreeMap\rConcurrentHashMap\rHashtable 19. Collection å’Œ Collections æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ Collection æ˜¯ä¸€ä¸ªé›†åˆæ¥å£ï¼Œå®ƒæä¾›äº†å¯¹é›†åˆå¯¹è±¡è¿›è¡ŒåŸºæœ¬æ“ä½œçš„é€šç”¨æ¥å£æ–¹æ³•ï¼Œæ‰€æœ‰é›†åˆéƒ½æ˜¯å®ƒçš„å­ç±»ï¼Œæ¯”\rå¦‚ Listã€Set ç­‰ã€‚\rCollections æ˜¯ä¸€ä¸ªåŒ…è£…ç±»ï¼ŒåŒ…å«äº†å¾ˆå¤šé™æ€æ–¹æ³•ï¼Œä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œå°±åƒä¸€ä¸ªå·¥å…·ç±»ï¼Œæ¯”å¦‚æä¾›çš„æ’åºæ–¹æ³•ï¼š\rCollections. sort(list)ã€‚ 20. Listã€Setã€Map ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ Listã€Setã€Map çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ï¼šå…ƒç´ æ˜¯å¦æœ‰åºã€æ˜¯å¦å…è®¸å…ƒç´ é‡å¤ã€‚\nä¸‰è€…ä¹‹é—´çš„åŒºåˆ«ï¼Œå¦‚ä¸‹è¡¨ï¼š\n21. HashMap å’Œ Hashtable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å­˜å‚¨ï¼šHashMap è¿è¡Œ key å’Œ value ä¸º nullï¼Œè€Œ Hashtable ä¸å…è®¸ã€‚\rçº¿ç¨‹å®‰å…¨ï¼šHashtable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œ HashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚\ræ¨èä½¿ç”¨ï¼šåœ¨ Hashtable çš„ç±»æ³¨é‡Šå¯ä»¥çœ‹åˆ°ï¼ŒHashtable æ˜¯ä¿ç•™ç±»ä¸å»ºè®®ä½¿ç”¨ï¼Œæ¨èåœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨\rHashMap æ›¿ä»£ï¼Œå¦‚æœéœ€è¦å¤šçº¿ç¨‹ä½¿ç”¨åˆ™ç”¨ ConcurrentHashMap æ›¿ä»£ã€‚ 22. å¦‚ä½•å†³å®šä½¿ç”¨ HashMap è¿˜æ˜¯ TreeMapï¼Ÿ å¯¹äºåœ¨ Map ä¸­æ’å…¥ã€åˆ é™¤ã€å®šä½ä¸€ä¸ªå…ƒç´ è¿™ç±»æ“ä½œï¼ŒHashMap æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºç›¸å¯¹è€Œè¨€ HashMap çš„æ’å…¥ä¼š æ›´å¿«ï¼Œä½†å¦‚æœä½ è¦å¯¹ä¸€ä¸ª key é›†åˆè¿›è¡Œæœ‰åºçš„éå†ï¼Œé‚£ TreeMap æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚\n23. è¯´ä¸€ä¸‹ HashMap çš„å®ç°åŸç†ï¼Ÿ HashMap åŸºäº Hash ç®—æ³•å®ç°çš„ï¼Œæˆ‘ä»¬é€šè¿‡ put(key,value)å­˜å‚¨ï¼Œget(key)æ¥è·å–ã€‚å½“ä¼ å…¥ key æ—¶ï¼ŒHashMap ä¼šæ ¹ æ® key. hashCode() è®¡ç®—å‡º hash å€¼ï¼Œæ ¹æ® hash å€¼å°† value ä¿å­˜åœ¨ bucket é‡Œã€‚å½“è®¡ç®—å‡ºçš„ hash å€¼ç›¸åŒæ—¶ï¼Œæˆ‘ä»¬ç§° ä¹‹ä¸º hash å†²çªï¼ŒHashMap çš„åšæ³•æ˜¯ç”¨é“¾è¡¨å’Œçº¢é»‘æ ‘å­˜å‚¨ç›¸åŒ hash å€¼çš„ valueã€‚å½“ hash å†²çªçš„ä¸ªæ•°æ¯”è¾ƒå°‘æ—¶ï¼Œä½¿ ç”¨é“¾è¡¨å¦åˆ™ä½¿ç”¨çº¢é»‘æ ‘ã€‚\n24. è¯´ä¸€ä¸‹ HashSet çš„å®ç°åŸç†ï¼Ÿ HashSet æ˜¯åŸºäº HashMap å®ç°çš„ï¼ŒHashSet åº•å±‚ä½¿ç”¨ HashMap æ¥ä¿å­˜æ‰€æœ‰å…ƒç´ ï¼Œå› æ­¤ HashSet çš„å®ç°æ¯”è¾ƒç®€ å•ï¼Œç›¸å…³ HashSet çš„æ“ä½œï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ç›´æ¥è°ƒç”¨åº•å±‚ HashMap çš„ç›¸å…³æ–¹æ³•æ¥å®Œæˆï¼ŒHashSet ä¸å…è®¸é‡å¤çš„å€¼ã€‚\n25. ArrayList å’Œ LinkedList çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ æ•°æ®ç»“æ„å®ç°ï¼šArrayList æ˜¯åŠ¨æ€æ•°ç»„çš„æ•°æ®ç»“æ„å®ç°ï¼Œè€Œ LinkedList æ˜¯åŒå‘é“¾è¡¨çš„æ•°æ®ç»“æ„å®ç°ã€‚\réšæœºè®¿é—®æ•ˆç‡ï¼šArrayList æ¯” LinkedList åœ¨éšæœºè®¿é—®çš„æ—¶å€™æ•ˆç‡è¦é«˜ï¼Œå› ä¸º LinkedList æ˜¯çº¿æ€§çš„æ•°æ®å­˜å‚¨æ–¹å¼ï¼Œ\ræ‰€ä»¥éœ€è¦ç§»åŠ¨æŒ‡é’ˆä»å‰å¾€åä¾æ¬¡æŸ¥æ‰¾ã€‚\rå¢åŠ å’Œåˆ é™¤æ•ˆç‡ï¼šåœ¨éé¦–å°¾çš„å¢åŠ å’Œåˆ é™¤æ“ä½œï¼ŒLinkedList è¦æ¯” ArrayList æ•ˆç‡è¦é«˜ï¼Œå› ä¸º ArrayList å¢åˆ æ“ä½œ\rè¦å½±å“æ•°ç»„å†…çš„å…¶ä»–æ•°æ®çš„ä¸‹æ ‡ã€‚ ç»¼åˆæ¥è¯´ï¼Œåœ¨éœ€è¦é¢‘ç¹è¯»å–é›†åˆä¸­çš„å…ƒç´ æ—¶ï¼Œæ›´æ¨èä½¿ç”¨ ArrayListï¼Œè€Œåœ¨æ’å…¥å’Œåˆ é™¤æ“ä½œè¾ƒå¤šæ—¶ï¼Œæ›´æ¨èä½¿ç”¨ LinkedListã€‚\n26. å¦‚ä½•å®ç°æ•°ç»„å’Œ List ä¹‹é—´çš„è½¬æ¢ï¼Ÿ æ•°ç»„è½¬ Listï¼šä½¿ç”¨ Arrays. asList(array) è¿›è¡Œè½¬æ¢ã€‚\rList è½¬æ•°ç»„ï¼šä½¿ç”¨ List è‡ªå¸¦çš„ toArray() æ–¹æ³•ã€‚ ä»£ç ç¤ºä¾‹ï¼š\n27. ArrayList å’Œ Vector çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ çº¿ç¨‹å®‰å…¨ï¼šVector ä½¿ç”¨äº† Synchronized æ¥å®ç°çº¿ç¨‹åŒæ­¥ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œ ArrayList æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚\ræ€§èƒ½ï¼šArrayList åœ¨æ€§èƒ½æ–¹é¢è¦ä¼˜äº Vectorã€‚\ræ‰©å®¹ï¼šArrayList å’Œ Vector éƒ½ä¼šæ ¹æ®å®é™…çš„éœ€è¦åŠ¨æ€çš„è°ƒæ•´å®¹é‡ï¼Œåªä¸è¿‡åœ¨ Vector æ‰©å®¹æ¯æ¬¡ä¼šå¢åŠ  1 å€ï¼Œè€Œ\rArrayList åªä¼šå¢åŠ  50%ã€‚ 28. Array å’Œ ArrayList æœ‰ä½•åŒºåˆ«ï¼Ÿ Array å¯ä»¥å­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹å’Œå¯¹è±¡ï¼ŒArrayList åªèƒ½å­˜å‚¨å¯¹è±¡ã€‚\rArray æ˜¯æŒ‡å®šå›ºå®šå¤§å°çš„ï¼Œè€Œ ArrayList å¤§å°æ˜¯è‡ªåŠ¨æ‰©å±•çš„ã€‚ // list to array\rList\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;String\u0026gt;();\rlist. add(\u0026#34;ç‹ç£Š\u0026#34;);\rlist. add(\u0026#34;çš„åšå®¢\u0026#34;);\rlist. toArray();\r// array to list\rString[] array = new String[]{\u0026#34;ç‹ç£Š\u0026#34;,\u0026#34;çš„åšå®¢\u0026#34;};\rArrays. asList(array); Array å†…ç½®æ–¹æ³•æ²¡æœ‰ ArrayList å¤šï¼Œæ¯”å¦‚ addAllã€removeAllã€iteration ç­‰æ–¹æ³•åªæœ‰ ArrayList æœ‰ã€‚ 29. åœ¨ Queue ä¸­ poll()å’Œ remove()æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ ç›¸åŒç‚¹ï¼šéƒ½æ˜¯è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶åœ¨é˜Ÿåˆ—ä¸­åˆ é™¤è¿”å›çš„å¯¹è±¡ã€‚ ä¸åŒç‚¹ï¼šå¦‚æœæ²¡æœ‰å…ƒç´  poll()ä¼šè¿”å› nullï¼Œè€Œ remove()ä¼šç›´æ¥æŠ›å‡º NoSuchElementException å¼‚å¸¸ã€‚ ä»£ç ç¤ºä¾‹ï¼š\n30. å“ªäº›é›†åˆç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ Vectorã€Hashtableã€Stack éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œåƒ HashMap åˆ™æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œä¸è¿‡åœ¨ JDK 1.5 ä¹‹åéšç€ Java. util. concurrent å¹¶å‘åŒ…çš„å‡ºç°ï¼Œå®ƒä»¬ä¹Ÿæœ‰äº†è‡ªå·±å¯¹åº”çš„çº¿ç¨‹å®‰å…¨ç±»ï¼Œæ¯”å¦‚ HashMap å¯¹åº”çš„çº¿ç¨‹å®‰å…¨ç±»å°±æ˜¯ ConcurrentHashMapã€‚\n31. è¿­ä»£å™¨ Iterator æ˜¯ä»€ä¹ˆï¼Ÿ Iterator æ¥å£æä¾›éå†ä»»ä½• Collection çš„æ¥å£ã€‚æˆ‘ä»¬å¯ä»¥ä»ä¸€ä¸ª Collection ä¸­ä½¿ç”¨è¿­ä»£å™¨æ–¹æ³•æ¥è·å–è¿­ä»£å™¨å®ä¾‹ã€‚è¿­ ä»£å™¨å–ä»£äº† Java é›†åˆæ¡†æ¶ä¸­çš„ Enumerationï¼Œè¿­ä»£å™¨å…è®¸è°ƒç”¨è€…åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ç§»é™¤å…ƒç´ ã€‚\n32. Iterator æ€ä¹ˆä½¿ç”¨ï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ Iterator ä½¿ç”¨ä»£ç å¦‚ä¸‹ï¼š\nIterator çš„ç‰¹ç‚¹æ˜¯æ›´åŠ å®‰å…¨ï¼Œå› ä¸ºå®ƒå¯ä»¥ç¡®ä¿ï¼Œåœ¨å½“å‰éå†çš„é›†åˆå…ƒç´ è¢«æ›´æ”¹çš„æ—¶å€™ï¼Œå°±ä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ã€‚\n33. Iterator å’Œ ListIterator æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ Iterator å¯ä»¥éå† Set å’Œ List é›†åˆï¼Œè€Œ ListIterator åªèƒ½éå† Listã€‚\rIterator åªèƒ½å•å‘éå†ï¼Œè€Œ ListIterator å¯ä»¥åŒå‘éå†ï¼ˆå‘å‰/åéå†ï¼‰ã€‚\rListIterator ä» Iterator æ¥å£ç»§æ‰¿ï¼Œç„¶åæ·»åŠ äº†ä¸€äº›é¢å¤–çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ·»åŠ ä¸€ä¸ªå…ƒç´ ã€æ›¿æ¢ä¸€ä¸ªå…ƒç´ ã€è·å–å‰é¢\ræˆ–åé¢å…ƒç´ çš„ç´¢å¼•ä½ç½®ã€‚ 34. æ€ä¹ˆç¡®ä¿ä¸€ä¸ªé›†åˆä¸èƒ½è¢«ä¿®æ”¹ï¼Ÿ å¯ä»¥ä½¿ç”¨ Collections. unmodifiableCollection(Collection c) æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªåªè¯»é›†åˆï¼Œè¿™æ ·æ”¹å˜é›†åˆçš„ä»»ä½•æ“ä½œéƒ½ ä¼šæŠ›å‡º Java. lang. UnsupportedOperationException å¼‚å¸¸ã€‚\nç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\nQueue\u0026lt;String\u0026gt; queue = new LinkedList\u0026lt;String\u0026gt;();\rqueue. offer(\u0026#34;string\u0026#34;); // add\rSystem. out. println(queue. poll());\rSystem. out. println(queue. remove());\rSystem. out. println(queue. size()); List\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;\u0026gt;();\rIterator\u0026lt;String\u0026gt; it = list. iterator();\rwhile(it. hasNext()){\rString obj = it. next();\rSystem. out. println(obj);\r} å¤šçº¿ç¨‹ 35. å¹¶è¡Œå’Œå¹¶å‘æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å¹¶è¡Œï¼šå¤šä¸ªä»»åŠ¡åœ¨åŒä¸€ä¸ª CPU æ ¸ä¸Šï¼ŒæŒ‰ç»†åˆ†çš„æ—¶é—´ç‰‡è½®æµ(äº¤æ›¿)æ‰§è¡Œï¼Œä»é€»è¾‘ä¸Šæ¥çœ‹é‚£äº›ä»»åŠ¡æ˜¯åŒæ—¶æ‰§è¡Œã€‚ å¹¶å‘ï¼šå¤šä¸ªå¤„ç†å™¨æˆ–å¤šæ ¸å¤„ç†å™¨åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ã€‚ å¦‚ä¸‹å›¾ï¼š å¹¶å‘ = ä¸¤ä¸ªé˜Ÿåˆ—å’Œä¸€å°å’–å•¡æœºã€‚ å¹¶è¡Œ = ä¸¤ä¸ªé˜Ÿåˆ—å’Œä¸¤å°å’–å•¡æœºã€‚ 36. çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«ï¼Ÿ ä¸€ä¸ªç¨‹åºä¸‹è‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸‹ä¹Ÿå¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹æ¥å¢åŠ ç¨‹åºçš„æ‰§è¡Œé€Ÿåº¦ã€‚ 37. å®ˆæŠ¤çº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ å®ˆæŠ¤çº¿ç¨‹æ˜¯è¿è¡Œåœ¨åå°çš„ä¸€ç§ç‰¹æ®Šè¿›ç¨‹ã€‚å®ƒç‹¬ç«‹äºæ§åˆ¶ç»ˆç«¯å¹¶ä¸”å‘¨æœŸæ€§åœ°æ‰§è¡ŒæŸç§ä»»åŠ¡æˆ–ç­‰å¾…å¤„ç†æŸäº›å‘ç”Ÿçš„äº‹ä»¶ã€‚ åœ¨ Java ä¸­åƒåœ¾å›æ”¶çº¿ç¨‹å°±æ˜¯ç‰¹æ®Šçš„å®ˆæŠ¤çº¿ç¨‹ã€‚\n38. åˆ›å»ºçº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ List\u0026lt;String\u0026gt; list = new ArrayList\u0026lt;\u0026gt;();\rlist. add(\u0026#34;x\u0026#34;);\rCollection\u0026lt;String\u0026gt; clist = Collections. unmodifiableCollection(list);\rclist. add(\u0026#34;y\u0026#34;); // è¿è¡Œæ—¶æ­¤è¡ŒæŠ¥é”™\rSystem. out. println(list. size()); åˆ›å»ºçº¿ç¨‹æœ‰ä¸‰ç§æ–¹å¼ï¼š ç»§æ‰¿ Thread é‡æ–° run æ–¹æ³•ï¼›\rå®ç° Runnable æ¥å£ï¼›\rå®ç° Callable æ¥å£ã€‚ 39. è¯´ä¸€ä¸‹ runnable å’Œ callable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ runnable æ²¡æœ‰è¿”å›å€¼ï¼Œcallable å¯ä»¥æ‹¿åˆ°æœ‰è¿”å›å€¼ï¼Œcallable å¯ä»¥çœ‹ä½œæ˜¯ runnable çš„è¡¥å……ã€‚\n40. çº¿ç¨‹æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ çº¿ç¨‹çš„çŠ¶æ€ï¼š NEW å°šæœªå¯åŠ¨ RUNNABLE æ­£åœ¨æ‰§è¡Œä¸­ BLOCKED é˜»å¡çš„ï¼ˆè¢«åŒæ­¥é”æˆ–è€…IOé”é˜»å¡ï¼‰ WAITING æ°¸ä¹…ç­‰å¾…çŠ¶æ€ TIMED_WAITING ç­‰å¾…æŒ‡å®šçš„æ—¶é—´é‡æ–°è¢«å”¤é†’çš„çŠ¶æ€ TERMINATED æ‰§è¡Œå®Œæˆ 41. sleep() å’Œ wait() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ ç±»çš„ä¸åŒï¼šsleep() æ¥è‡ª Threadï¼Œwait() æ¥è‡ª Objectã€‚\ré‡Šæ”¾é”ï¼šsleep() ä¸é‡Šæ”¾é”ï¼›wait() é‡Šæ”¾é”ã€‚\rç”¨æ³•ä¸åŒï¼šsleep() æ—¶é—´åˆ°ä¼šè‡ªåŠ¨æ¢å¤ï¼›wait() å¯ä»¥ä½¿ç”¨ notify()/notifyAll()ç›´æ¥å”¤é†’ã€‚ 42. notify()å’Œ notifyAll()æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ notifyAll()ä¼šå”¤é†’æ‰€æœ‰çš„çº¿ç¨‹ï¼Œnotify()ä¹‹åå”¤é†’ä¸€ä¸ªçº¿ç¨‹ã€‚notifyAll() è°ƒç”¨åï¼Œä¼šå°†å…¨éƒ¨çº¿ç¨‹ç”±ç­‰å¾…æ± ç§»åˆ°é”æ± ï¼Œç„¶ åå‚ä¸é”çš„ç«äº‰ï¼Œç«äº‰æˆåŠŸåˆ™ç»§ç»­æ‰§è¡Œï¼Œå¦‚æœä¸æˆåŠŸåˆ™ç•™åœ¨é”æ± ç­‰å¾…é”è¢«é‡Šæ”¾åå†æ¬¡å‚ä¸ç«äº‰ã€‚è€Œ notify()åªä¼šå”¤é†’ ä¸€ä¸ªçº¿ç¨‹ï¼Œå…·ä½“å”¤é†’å“ªä¸€ä¸ªçº¿ç¨‹ç”±è™šæ‹Ÿæœºæ§åˆ¶ã€‚\n43. çº¿ç¨‹çš„ run() å’Œ start() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ start() æ–¹æ³•ç”¨äºå¯åŠ¨çº¿ç¨‹ï¼Œrun() æ–¹æ³•ç”¨äºæ‰§è¡Œçº¿ç¨‹çš„è¿è¡Œæ—¶ä»£ç ã€‚run() å¯ä»¥é‡å¤è°ƒç”¨ï¼Œè€Œ start() åªèƒ½è°ƒç”¨ä¸€æ¬¡ã€‚\n44. åˆ›å»ºçº¿ç¨‹æ± æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ çº¿ç¨‹æ± åˆ›å»ºæœ‰ä¸ƒç§æ–¹å¼ï¼Œæœ€æ ¸å¿ƒçš„æ˜¯æœ€åä¸€ç§ï¼š newSingleThreadExecutor()ï¼šå®ƒçš„ç‰¹ç‚¹åœ¨äºå·¥ä½œçº¿ç¨‹æ•°ç›®è¢«é™åˆ¶ä¸º 1 ï¼Œæ“ä½œä¸€ä¸ªæ— ç•Œçš„å·¥ä½œé˜Ÿåˆ—ï¼Œæ‰€ä»¥å®ƒä¿è¯\räº†æ‰€æœ‰ä»»åŠ¡çš„éƒ½æ˜¯è¢«é¡ºåºæ‰§è¡Œï¼Œæœ€å¤šä¼šæœ‰ä¸€ä¸ªä»»åŠ¡å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œå¹¶ä¸”ä¸å…è®¸ä½¿ç”¨è€…æ”¹åŠ¨çº¿ç¨‹æ± å®ä¾‹ï¼Œå› æ­¤å¯\rä»¥é¿å…å…¶æ”¹å˜çº¿ç¨‹æ•°ç›®ï¼›\rnewCachedThreadPool()ï¼šå®ƒæ˜¯ä¸€ç§ç”¨æ¥å¤„ç†å¤§é‡çŸ­æ—¶é—´å·¥ä½œä»»åŠ¡çš„çº¿ç¨‹æ± ï¼Œå…·æœ‰å‡ ä¸ªé²œæ˜ç‰¹ç‚¹ï¼šå®ƒä¼šè¯•å›¾ç¼“\rå­˜çº¿ç¨‹å¹¶é‡ç”¨ï¼Œå½“æ— ç¼“å­˜çº¿ç¨‹å¯ç”¨æ—¶ï¼Œå°±ä¼šåˆ›å»ºæ–°çš„å·¥ä½œçº¿ç¨‹ï¼›å¦‚æœçº¿ç¨‹é—²ç½®çš„æ—¶é—´è¶…è¿‡ 60 ç§’ï¼Œåˆ™è¢«ç»ˆæ­¢å¹¶ç§»\rå‡ºç¼“å­˜ï¼›é•¿æ—¶é—´é—²ç½®æ—¶ï¼Œè¿™ç§çº¿ç¨‹æ± ï¼Œä¸ä¼šæ¶ˆè€—ä»€ä¹ˆèµ„æºã€‚å…¶å†…éƒ¨ä½¿ç”¨ SynchronousQueue ä½œä¸ºå·¥ä½œé˜Ÿåˆ—ï¼›\rnewFixedThreadPool(int nThreads)ï¼šé‡ç”¨æŒ‡å®šæ•°ç›®ï¼ˆnThreadsï¼‰çš„çº¿ç¨‹ï¼Œå…¶èƒŒåä½¿ç”¨çš„æ˜¯æ— ç•Œçš„å·¥ä½œé˜Ÿåˆ—ï¼Œ\rä»»ä½•æ—¶å€™æœ€å¤šæœ‰ nThreads ä¸ªå·¥ä½œçº¿ç¨‹æ˜¯æ´»åŠ¨çš„ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä»»åŠ¡æ•°é‡è¶…è¿‡äº†æ´»åŠ¨é˜Ÿåˆ—æ•°ç›®ï¼Œå°†åœ¨å·¥ä½œé˜Ÿ\råˆ—ä¸­ç­‰å¾…ç©ºé—²çº¿ç¨‹å‡ºç°ï¼›å¦‚æœæœ‰å·¥ä½œçº¿ç¨‹é€€å‡ºï¼Œå°†ä¼šæœ‰æ–°çš„å·¥ä½œçº¿ç¨‹è¢«åˆ›å»ºï¼Œä»¥è¡¥è¶³æŒ‡å®šçš„æ•°ç›® nThreadsï¼›\rnewSingleThreadScheduledExecutor()ï¼šåˆ›å»ºå•çº¿ç¨‹æ± ï¼Œè¿”å› ScheduledExecutorServiceï¼Œå¯ä»¥è¿›è¡Œå®šæ—¶æˆ–\rå‘¨æœŸæ€§çš„å·¥ä½œè°ƒåº¦ï¼› newScheduledThreadPool(int corePoolSize)ï¼šå’ŒnewSingleThreadScheduledExecutor()ç±»ä¼¼ï¼Œåˆ›å»ºçš„æ˜¯ä¸ª\rScheduledExecutorServiceï¼Œå¯ä»¥è¿›è¡Œå®šæ—¶æˆ–å‘¨æœŸæ€§çš„å·¥ä½œè°ƒåº¦ï¼ŒåŒºåˆ«åœ¨äºå•ä¸€å·¥ä½œçº¿ç¨‹è¿˜æ˜¯å¤šä¸ªå·¥ä½œçº¿ç¨‹ï¼›\rnewWorkStealingPool(int parallelism)ï¼šè¿™æ˜¯ä¸€ä¸ªç»å¸¸è¢«äººå¿½ç•¥çš„çº¿ç¨‹æ± ï¼ŒJava 8 æ‰åŠ å…¥è¿™ä¸ªåˆ›å»ºæ–¹æ³•ï¼Œå…¶å†…\réƒ¨ä¼šæ„å»ºForkJoinPoolï¼Œåˆ©ç”¨Work-Stealingç®—æ³•ï¼Œå¹¶è¡Œåœ°å¤„ç†ä»»åŠ¡ï¼Œä¸ä¿è¯å¤„ç†é¡ºåºï¼›\rThreadPoolExecutor()ï¼šæ˜¯æœ€åŸå§‹çš„çº¿ç¨‹æ± åˆ›å»ºï¼Œä¸Šé¢1-3åˆ›å»ºæ–¹å¼éƒ½æ˜¯å¯¹ThreadPoolExecutorçš„å°è£…ã€‚ 45. çº¿ç¨‹æ± éƒ½æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ RUNNINGï¼šè¿™æ˜¯æœ€æ­£å¸¸çš„çŠ¶æ€ï¼Œæ¥å—æ–°çš„ä»»åŠ¡ï¼Œå¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚ SHUTDOWNï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä½†æ˜¯ä¼šç»§ç»­å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚ STOPï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä¸å†å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œä¸­æ–­æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ã€‚ TIDYINGï¼šæ‰€æœ‰çš„ä»»åŠ¡éƒ½é”€æ¯äº†ï¼ŒworkCount ä¸º 0 ï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€åœ¨è½¬æ¢ä¸º TIDYING çŠ¶æ€æ—¶ï¼Œä¼šæ‰§è¡Œé’©å­æ–¹æ³•\rterminated()ã€‚\rTERMINATEDï¼šterminated()æ–¹æ³•ç»“æŸåï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€å°±ä¼šå˜æˆè¿™ä¸ªã€‚ 46. çº¿ç¨‹æ± ä¸­ submit() å’Œ execute() æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ execute()ï¼šåªèƒ½æ‰§è¡Œ Runnable ç±»å‹çš„ä»»åŠ¡ã€‚\rsubmit()ï¼šå¯ä»¥æ‰§è¡Œ Runnable å’Œ Callable ç±»å‹çš„ä»»åŠ¡ã€‚ Callable ç±»å‹çš„ä»»åŠ¡å¯ä»¥è·å–æ‰§è¡Œçš„è¿”å›å€¼ï¼Œè€Œ Runnable æ‰§è¡Œæ— è¿”å›å€¼ã€‚\n47. åœ¨ Java ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨ï¼Ÿ æ–¹æ³•ä¸€ï¼šä½¿ç”¨å®‰å…¨ç±»ï¼Œæ¯”å¦‚ Java. util. concurrent ä¸‹çš„ç±»ã€‚\ræ–¹æ³•äºŒï¼šä½¿ç”¨è‡ªåŠ¨é” synchronizedã€‚\ræ–¹æ³•ä¸‰ï¼šä½¿ç”¨æ‰‹åŠ¨é” Lockã€‚ æ‰‹åŠ¨é” Java ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n48. å¤šçº¿ç¨‹ä¸­ synchronized é”å‡çº§çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ synchronized é”å‡çº§åŸç†ï¼šåœ¨é”å¯¹è±¡çš„å¯¹è±¡å¤´é‡Œé¢æœ‰ä¸€ä¸ª threadid å­—æ®µï¼Œåœ¨ç¬¬ä¸€æ¬¡è®¿é—®çš„æ—¶å€™ threadid ä¸ºç©ºï¼Œjvm è®©å…¶æŒæœ‰åå‘é”ï¼Œå¹¶å°† threadid è®¾ç½®ä¸ºå…¶çº¿ç¨‹ idï¼Œå†æ¬¡è¿›å…¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­ threadid æ˜¯å¦ä¸å…¶çº¿ç¨‹ id ä¸€è‡´ï¼Œå¦‚æœ ä¸€è‡´åˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨æ­¤å¯¹è±¡ï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œåˆ™å‡çº§åå‘é”ä¸ºè½»é‡çº§é”ï¼Œé€šè¿‡è‡ªæ—‹å¾ªç¯ä¸€å®šæ¬¡æ•°æ¥è·å–é”ï¼Œæ‰§è¡Œä¸€å®šæ¬¡ æ•°ä¹‹åï¼Œå¦‚æœè¿˜æ²¡æœ‰æ­£å¸¸è·å–åˆ°è¦ä½¿ç”¨çš„å¯¹è±¡ï¼Œæ­¤æ—¶å°±ä¼šæŠŠé”ä»è½»é‡çº§å‡çº§ä¸ºé‡é‡çº§é”ï¼Œæ­¤è¿‡ç¨‹å°±æ„æˆäº† synchronized é”çš„å‡çº§ã€‚\né”çš„å‡çº§çš„ç›®çš„ï¼šé”å‡çº§æ˜¯ä¸ºäº†å‡ä½äº†é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ã€‚åœ¨ Java 6 ä¹‹åä¼˜åŒ– synchronized çš„å®ç°æ–¹å¼ï¼Œä½¿ç”¨äº†å å‘é”å‡çº§ä¸ºè½»é‡çº§é”å†å‡çº§åˆ°é‡é‡çº§é”çš„æ–¹å¼ï¼Œä»è€Œå‡ä½äº†é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ã€‚\nLock lock = new ReentrantLock();\rlock. lock();\rtry {\rSystem. out. println(\u0026#34;è·å¾—é”\u0026#34;);\r} catch (Exception e) {\r// TODO: handle exception\r} finally {\rSystem. out. println(\u0026#34;é‡Šæ”¾é”\u0026#34;);\rlock. unlock();\r} 49. ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ å½“çº¿ç¨‹ A æŒæœ‰ç‹¬å é”aï¼Œå¹¶å°è¯•å»è·å–ç‹¬å é” b çš„åŒæ—¶ï¼Œçº¿ç¨‹ B æŒæœ‰ç‹¬å é” bï¼Œå¹¶å°è¯•è·å–ç‹¬å é” a çš„æƒ…å†µä¸‹ï¼Œå°±ä¼š å‘ç”Ÿ AB ä¸¤ä¸ªçº¿ç¨‹ç”±äºäº’ç›¸æŒæœ‰å¯¹æ–¹éœ€è¦çš„é”ï¼Œè€Œå‘ç”Ÿçš„é˜»å¡ç°è±¡ï¼Œæˆ‘ä»¬ç§°ä¸ºæ­»é”ã€‚\n50. æ€ä¹ˆé˜²æ­¢æ­»é”ï¼Ÿ å°½é‡ä½¿ç”¨ tryLock(long timeout, TimeUnit unit)çš„æ–¹æ³•(ReentrantLockã€ReentrantReadWriteLock)ï¼Œè®¾ç½®è¶…\ræ—¶æ—¶é—´ï¼Œè¶…æ—¶å¯ä»¥é€€å‡ºé˜²æ­¢æ­»é”ã€‚\rå°½é‡ä½¿ç”¨ Java. util. concurrent å¹¶å‘ç±»ä»£æ›¿è‡ªå·±æ‰‹å†™é”ã€‚\rå°½é‡é™ä½é”çš„ä½¿ç”¨ç²’åº¦ï¼Œå°½é‡ä¸è¦å‡ ä¸ªåŠŸèƒ½ç”¨åŒä¸€æŠŠé”ã€‚\rå°½é‡å‡å°‘åŒæ­¥çš„ä»£ç å—ã€‚ 51. ThreadLocal æ˜¯ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›ä½¿ç”¨åœºæ™¯ï¼Ÿ ThreadLocal ä¸ºæ¯ä¸ªä½¿ç”¨è¯¥å˜é‡çš„çº¿ç¨‹æä¾›ç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ï¼Œæ‰€ä»¥æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜è‡ªå·±çš„å‰¯æœ¬ï¼Œè€Œä¸ä¼š å½±å“å…¶å®ƒçº¿ç¨‹æ‰€å¯¹åº”çš„å‰¯æœ¬ã€‚\nThreadLocal çš„ç»å…¸ä½¿ç”¨åœºæ™¯æ˜¯æ•°æ®åº“è¿æ¥å’Œ session ç®¡ç†ç­‰ã€‚\n52. è¯´ä¸€ä¸‹ synchronized åº•å±‚å®ç°åŸç†ï¼Ÿ synchronized æ˜¯ç”±ä¸€å¯¹ monitorenter/monitorexit æŒ‡ä»¤å®ç°çš„ï¼Œmonitor å¯¹è±¡æ˜¯åŒæ­¥çš„åŸºæœ¬å®ç°å•å…ƒã€‚åœ¨ Java 6 ä¹‹å‰ï¼Œmonitor çš„å®ç°å®Œå…¨æ˜¯ä¾é æ“ä½œç³»ç»Ÿå†…éƒ¨çš„äº’æ–¥é”ï¼Œå› ä¸ºéœ€è¦è¿›è¡Œç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„åˆ‡æ¢ï¼Œæ‰€ä»¥åŒæ­¥æ“ä½œæ˜¯ä¸€ ä¸ªæ— å·®åˆ«çš„é‡é‡çº§æ“ä½œï¼Œæ€§èƒ½ä¹Ÿå¾ˆä½ã€‚ä½†åœ¨ Java 6 çš„æ—¶å€™ï¼ŒJava è™šæ‹Ÿæœº å¯¹æ­¤è¿›è¡Œäº†å¤§åˆ€é˜”æ–§åœ°æ”¹è¿›ï¼Œæä¾›äº†ä¸‰ç§ä¸ åŒçš„ monitor å®ç°ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„ä¸‰ç§ä¸åŒçš„é”ï¼šåå‘é”ï¼ˆBiased Lockingï¼‰ã€è½»é‡çº§é”å’Œé‡é‡çº§é”ï¼Œå¤§å¤§æ”¹è¿›äº† å…¶æ€§èƒ½ã€‚\n53. synchronized å’Œ volatile çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ volatile æ˜¯å˜é‡ä¿®é¥°ç¬¦ï¼›synchronized æ˜¯ä¿®é¥°ç±»ã€æ–¹æ³•ã€ä»£ç æ®µã€‚\rvolatile ä»…èƒ½å®ç°å˜é‡çš„ä¿®æ”¹å¯è§æ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼›è€Œ synchronized åˆ™å¯ä»¥ä¿è¯å˜é‡çš„ä¿®æ”¹å¯è§æ€§å’ŒåŸå­\ræ€§ã€‚\rvolatile ä¸ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ï¼›synchronized å¯èƒ½ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ã€‚ 54. synchronized å’Œ Lock æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ synchronized å¯ä»¥ç»™ç±»ã€æ–¹æ³•ã€ä»£ç å—åŠ é”ï¼›è€Œ lock åªèƒ½ç»™ä»£ç å—åŠ é”ã€‚\rsynchronized ä¸éœ€è¦æ‰‹åŠ¨è·å–é”å’Œé‡Šæ”¾é”ï¼Œä½¿ç”¨ç®€å•ï¼Œå‘ç”Ÿå¼‚å¸¸ä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œä¸ä¼šé€ æˆæ­»é”ï¼›è€Œ lock éœ€è¦è‡ª\rå·±åŠ é”å’Œé‡Šæ”¾é”ï¼Œå¦‚æœä½¿ç”¨ä¸å½“æ²¡æœ‰ unLock()å»é‡Šæ”¾é”å°±ä¼šé€ æˆæ­»é”ã€‚\ré€šè¿‡ Lock å¯ä»¥çŸ¥é“æœ‰æ²¡æœ‰æˆåŠŸè·å–é”ï¼Œè€Œ synchronized å´æ— æ³•åŠåˆ°ã€‚ 55. synchronized å’Œ ReentrantLock åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ synchronized æ—©æœŸçš„å®ç°æ¯”è¾ƒä½æ•ˆï¼Œå¯¹æ¯” ReentrantLockï¼Œå¤§å¤šæ•°åœºæ™¯æ€§èƒ½éƒ½ç›¸å·®è¾ƒå¤§ï¼Œä½†æ˜¯åœ¨ Java 6 ä¸­å¯¹ synchronized è¿›è¡Œäº†éå¸¸å¤šçš„æ”¹è¿›ã€‚\nä¸»è¦åŒºåˆ«å¦‚ä¸‹ï¼š\nReentrantLock ä½¿ç”¨èµ·æ¥æ¯”è¾ƒçµæ´»ï¼Œä½†æ˜¯å¿…é¡»æœ‰é‡Šæ”¾é”çš„é…åˆåŠ¨ä½œï¼›\rReentrantLock å¿…é¡»æ‰‹åŠ¨è·å–ä¸é‡Šæ”¾é”ï¼Œè€Œ synchronized ä¸éœ€è¦æ‰‹åŠ¨é‡Šæ”¾å’Œå¼€å¯é”ï¼›\rReentrantLock åªé€‚ç”¨äºä»£ç å—é”ï¼Œè€Œ synchronized å¯ç”¨äºä¿®é¥°æ–¹æ³•ã€ä»£ç å—ç­‰ã€‚\rvolatile æ ‡è®°çš„å˜é‡ä¸ä¼šè¢«ç¼–è¯‘å™¨ä¼˜åŒ–ï¼›synchronized æ ‡è®°çš„å˜é‡å¯ä»¥è¢«ç¼–è¯‘å™¨ä¼˜åŒ–ã€‚ 56. è¯´ä¸€ä¸‹ atomic çš„åŸç†ï¼Ÿ atomic ä¸»è¦åˆ©ç”¨ CAS (Compare And Wwap) å’Œ volatile å’Œ native æ–¹æ³•æ¥ä¿è¯åŸå­æ“ä½œï¼Œä»è€Œé¿å… synchronized çš„ é«˜å¼€é”€ï¼Œæ‰§è¡Œæ•ˆç‡å¤§ä¸ºæå‡ã€‚\nåå°„ 57. ä»€ä¹ˆæ˜¯åå°„ï¼Ÿ åå°„æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸º Java è¯­è¨€çš„åå°„æœºåˆ¶ã€‚\n58. ä»€ä¹ˆæ˜¯ Java åºåˆ—åŒ–ï¼Ÿä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦åºåˆ—åŒ–ï¼Ÿ Java åºåˆ—åŒ–æ˜¯ä¸ºäº†ä¿å­˜å„ç§å¯¹è±¡åœ¨å†…å­˜ä¸­çš„çŠ¶æ€ï¼Œå¹¶ä¸”å¯ä»¥æŠŠä¿å­˜çš„å¯¹è±¡çŠ¶æ€å†è¯»å‡ºæ¥ã€‚\nä»¥ä¸‹æƒ…å†µéœ€è¦ä½¿ç”¨ Java åºåˆ—åŒ–ï¼š\næƒ³æŠŠçš„å†…å­˜ä¸­çš„å¯¹è±¡çŠ¶æ€ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­æˆ–è€…æ•°æ®åº“ä¸­æ—¶å€™ï¼›\ræƒ³ç”¨å¥—æ¥å­—åœ¨ç½‘ç»œä¸Šä¼ é€å¯¹è±¡çš„æ—¶å€™ï¼›\ræƒ³é€šè¿‡RMIï¼ˆè¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼‰ä¼ è¾“å¯¹è±¡çš„æ—¶å€™ã€‚ 59. åŠ¨æ€ä»£ç†æ˜¯ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›åº”ç”¨ï¼Ÿ åŠ¨æ€ä»£ç†æ˜¯è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†ç±»ã€‚ åŠ¨æ€ä»£ç†çš„åº”ç”¨æœ‰ spring aopã€hibernate æ•°æ®æŸ¥è¯¢ã€æµ‹è¯•æ¡†æ¶çš„åç«¯ mockã€rpcï¼ŒJavaæ³¨è§£å¯¹è±¡è·å–ç­‰ã€‚\n60. æ€ä¹ˆå®ç°åŠ¨æ€ä»£ç†ï¼Ÿ JDK åŸç”ŸåŠ¨æ€ä»£ç†å’Œ cglib åŠ¨æ€ä»£ç†ã€‚JDK åŸç”ŸåŠ¨æ€ä»£ç†æ˜¯åŸºäºæ¥å£å®ç°çš„ï¼Œè€Œ cglib æ˜¯åŸºäºç»§æ‰¿å½“å‰ç±»çš„å­ç±»å®ç° çš„ã€‚\nå¯¹è±¡æ‹·è´ 61. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å…‹éš†ï¼Ÿ å…‹éš†çš„å¯¹è±¡å¯èƒ½åŒ…å«ä¸€äº›å·²ç»ä¿®æ”¹è¿‡çš„å±æ€§ï¼Œè€Œ new å‡ºæ¥çš„å¯¹è±¡çš„å±æ€§éƒ½è¿˜æ˜¯åˆå§‹åŒ–æ—¶å€™çš„å€¼ï¼Œæ‰€ä»¥å½“éœ€è¦ä¸€ä¸ªæ–° çš„å¯¹è±¡æ¥ä¿å­˜å½“å‰å¯¹è±¡çš„â€œçŠ¶æ€â€å°±é å…‹éš†æ–¹æ³•äº†ã€‚\n62. å¦‚ä½•å®ç°å¯¹è±¡å…‹éš†ï¼Ÿ å®ç° Cloneable æ¥å£å¹¶é‡å†™ Object ç±»ä¸­çš„ clone() æ–¹æ³•ã€‚\rå®ç° Serializable æ¥å£ï¼Œé€šè¿‡å¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–å®ç°å…‹éš†ï¼Œå¯ä»¥å®ç°çœŸæ­£çš„æ·±åº¦å…‹éš†ã€‚ 63. æ·±æ‹·è´å’Œæµ…æ‹·è´åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ æµ…å…‹éš†ï¼šå½“å¯¹è±¡è¢«å¤åˆ¶æ—¶åªå¤åˆ¶å®ƒæœ¬èº«å’Œå…¶ä¸­åŒ…å«çš„å€¼ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œè€Œå¼•ç”¨ç±»å‹çš„æˆå‘˜å¯¹è±¡å¹¶æ²¡æœ‰å¤åˆ¶ã€‚ æ·±å…‹éš†ï¼šé™¤äº†å¯¹è±¡æœ¬èº«è¢«å¤åˆ¶å¤–ï¼Œå¯¹è±¡æ‰€åŒ…å«çš„æ‰€æœ‰æˆå‘˜å˜é‡ä¹Ÿå°†å¤åˆ¶ã€‚ Java Web 64. JSP å’Œ servlet æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ JSP æ˜¯ servlet æŠ€æœ¯çš„æ‰©å±•ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ servlet çš„ç®€æ˜“æ–¹å¼ã€‚servlet å’Œ JSP æœ€ä¸»è¦çš„ä¸åŒç‚¹åœ¨äºï¼Œservlet çš„åº”ç”¨é€» è¾‘æ˜¯åœ¨ Java æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”å®Œå…¨ä»è¡¨ç¤ºå±‚ä¸­çš„ html é‡Œåˆ†ç¦»å¼€æ¥ï¼Œè€Œ JSP çš„æƒ…å†µæ˜¯ Java å’Œ html å¯ä»¥ç»„åˆæˆä¸€ä¸ªæ‰©å±•å ä¸º JSP çš„æ–‡ä»¶ã€‚JSP ä¾§é‡äºè§†å›¾ï¼Œservlet ä¸»è¦ç”¨äºæ§åˆ¶é€»è¾‘ã€‚\n65. JSP æœ‰å“ªäº›å†…ç½®å¯¹è±¡ï¼Ÿä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ JSP æœ‰ 9 å¤§å†…ç½®å¯¹è±¡ï¼š requestï¼šå°è£…å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«æ¥è‡ª get æˆ– post è¯·æ±‚çš„å‚æ•°ï¼›\rresponseï¼šå°è£…æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„å“åº”ï¼›\rpageContextï¼šé€šè¿‡è¯¥å¯¹è±¡å¯ä»¥è·å–å…¶ä»–å¯¹è±¡ï¼›\rsessionï¼šå°è£…ç”¨æˆ·ä¼šè¯çš„å¯¹è±¡ï¼›\rapplicationï¼šå°è£…æœåŠ¡å™¨è¿è¡Œç¯å¢ƒçš„å¯¹è±¡ï¼›\routï¼šè¾“å‡ºæœåŠ¡å™¨å“åº”çš„è¾“å‡ºæµå¯¹è±¡ï¼›\rconfigï¼šWeb åº”ç”¨çš„é…ç½®å¯¹è±¡ï¼›\rpageï¼šJSP é¡µé¢æœ¬èº«ï¼ˆç›¸å½“äº Java ç¨‹åºä¸­çš„ thisï¼‰ï¼›\rexceptionï¼šå°è£…é¡µé¢æŠ›å‡ºå¼‚å¸¸çš„å¯¹è±¡ã€‚ 66. è¯´ä¸€ä¸‹ JSP çš„ 4 ç§ä½œç”¨åŸŸï¼Ÿ pageï¼šä»£è¡¨ä¸ä¸€ä¸ªé¡µé¢ç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ã€‚\rrequestï¼šä»£è¡¨ä¸å®¢æˆ·ç«¯å‘å‡ºçš„ä¸€ä¸ªè¯·æ±‚ç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ã€‚ä¸€ä¸ªè¯·æ±‚å¯èƒ½è·¨è¶Šå¤šä¸ªé¡µé¢ï¼Œæ¶‰åŠå¤šä¸ª Web ç»„\rä»¶ï¼›éœ€è¦åœ¨é¡µé¢æ˜¾ç¤ºçš„ä¸´æ—¶æ•°æ®å¯ä»¥ç½®äºæ­¤ä½œç”¨åŸŸã€‚\rsessionï¼šä»£è¡¨ä¸æŸä¸ªç”¨æˆ·ä¸æœåŠ¡å™¨å»ºç«‹çš„ä¸€æ¬¡ä¼šè¯ç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ã€‚è·ŸæŸä¸ªç”¨æˆ·ç›¸å…³çš„æ•°æ®åº”è¯¥æ”¾åœ¨ç”¨æˆ·è‡ª\rå·±çš„ session ä¸­ã€‚\rapplicationï¼šä»£è¡¨ä¸æ•´ä¸ª Web åº”ç”¨ç¨‹åºç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ï¼Œå®ƒå®è´¨ä¸Šæ˜¯è·¨è¶Šæ•´ä¸ª Web åº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬å¤šä¸ªé¡µ\ré¢ã€è¯·æ±‚å’Œä¼šè¯çš„ä¸€ä¸ªå…¨å±€ä½œç”¨åŸŸã€‚ 67. session å’Œ cookie æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å­˜å‚¨ä½ç½®ä¸åŒï¼šsession å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼›cookie å­˜å‚¨åœ¨æµè§ˆå™¨ç«¯ã€‚\rå®‰å…¨æ€§ä¸åŒï¼šcookie å®‰å…¨æ€§ä¸€èˆ¬ï¼Œåœ¨æµè§ˆå™¨å­˜å‚¨ï¼Œå¯ä»¥è¢«ä¼ªé€ å’Œä¿®æ”¹ã€‚\rå®¹é‡å’Œä¸ªæ•°é™åˆ¶ï¼šcookie æœ‰å®¹é‡é™åˆ¶ï¼Œæ¯ä¸ªç«™ç‚¹ä¸‹çš„ cookie ä¹Ÿæœ‰ä¸ªæ•°é™åˆ¶ã€‚\rå­˜å‚¨çš„å¤šæ ·æ€§ï¼šsession å¯ä»¥å­˜å‚¨åœ¨ Redis ä¸­ã€æ•°æ®åº“ä¸­ã€åº”ç”¨ç¨‹åºä¸­ï¼›è€Œ cookie åªèƒ½å­˜å‚¨åœ¨æµè§ˆå™¨ä¸­ã€‚ 68. è¯´ä¸€ä¸‹ session çš„å·¥ä½œåŸç†ï¼Ÿ session çš„å·¥ä½œåŸç†æ˜¯å®¢æˆ·ç«¯ç™»å½•å®Œæˆä¹‹åï¼ŒæœåŠ¡å™¨ä¼šåˆ›å»ºå¯¹åº”çš„ sessionï¼Œsession åˆ›å»ºå®Œä¹‹åï¼Œä¼šæŠŠ session çš„ id å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å†å­˜å‚¨åˆ°æµè§ˆå™¨ä¸­ã€‚è¿™æ ·å®¢æˆ·ç«¯æ¯æ¬¡è®¿é—®æœåŠ¡å™¨æ—¶ï¼Œéƒ½ä¼šå¸¦ç€ sessionidï¼ŒæœåŠ¡å™¨æ‹¿åˆ° sessionid ä¹‹åï¼Œåœ¨å†…å­˜æ‰¾åˆ°ä¸ä¹‹å¯¹åº”çš„ session è¿™æ ·å°±å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚\n69. å¦‚æœå®¢æˆ·ç«¯ç¦æ­¢ cookie èƒ½å®ç° session è¿˜èƒ½ç”¨å—ï¼Ÿ å¯ä»¥ç”¨ï¼Œsession åªæ˜¯ä¾èµ– cookie å­˜å‚¨ sessionidï¼Œå¦‚æœ cookie è¢«ç¦ç”¨äº†ï¼Œå¯ä»¥ä½¿ç”¨ url ä¸­æ·»åŠ  sessionid çš„æ–¹å¼ä¿ è¯ session èƒ½æ­£å¸¸ä½¿ç”¨ã€‚\n70. spring mvc å’Œ struts çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ æ‹¦æˆªçº§åˆ«ï¼šstruts2 æ˜¯ç±»çº§åˆ«çš„æ‹¦æˆªï¼›spring mvc æ˜¯æ–¹æ³•çº§åˆ«çš„æ‹¦æˆªã€‚\ræ•°æ®ç‹¬ç«‹æ€§ï¼šspring mvc çš„æ–¹æ³•ä¹‹é—´åŸºæœ¬ä¸Šç‹¬ç«‹çš„ï¼Œç‹¬äº« request å’Œ response æ•°æ®ï¼Œè¯·æ±‚æ•°æ®é€šè¿‡å‚æ•°è·\rå–ï¼Œå¤„ç†ç»“æœé€šè¿‡ ModelMap äº¤å›ç»™æ¡†æ¶ï¼Œæ–¹æ³•ä¹‹é—´ä¸å…±äº«å˜é‡ï¼›è€Œ struts2 è™½ç„¶æ–¹æ³•ä¹‹é—´ä¹Ÿæ˜¯ç‹¬ç«‹çš„ï¼Œä½†å…¶\ræ‰€æœ‰ action å˜é‡æ˜¯å…±äº«çš„ï¼Œè¿™ä¸ä¼šå½±å“ç¨‹åºè¿è¡Œï¼Œå´ç»™æˆ‘ä»¬ç¼–ç å’Œè¯»ç¨‹åºæ—¶å¸¦æ¥äº†ä¸€å®šçš„éº»çƒ¦ã€‚ æ‹¦æˆªæœºåˆ¶ï¼šstruts2 æœ‰ä»¥è‡ªå·±çš„ interceptor æœºåˆ¶ï¼Œspring mvc ç”¨çš„æ˜¯ç‹¬ç«‹çš„ aop æ–¹å¼ï¼Œè¿™æ ·å¯¼è‡´struts2 çš„é…\rç½®æ–‡ä»¶é‡æ¯” spring mvc å¤§ã€‚\rå¯¹ ajax çš„æ”¯æŒï¼šspring mvc é›†æˆäº†ajaxï¼Œæ‰€æœ‰ ajax ä½¿ç”¨å¾ˆæ–¹ä¾¿ï¼Œåªéœ€è¦ä¸€ä¸ªæ³¨è§£ @ResponseBody å°±å¯ä»¥å®\rç°äº†ï¼›è€Œ struts2 ä¸€èˆ¬éœ€è¦å®‰è£…æ’ä»¶æˆ–è€…è‡ªå·±å†™ä»£ç æ‰è¡Œã€‚ 71. å¦‚ä½•é¿å… SQL æ³¨å…¥ï¼Ÿ ä½¿ç”¨é¢„å¤„ç† PreparedStatementã€‚\rä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤æ‰å­—ç¬¦ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚ 72. ä»€ä¹ˆæ˜¯ XSS æ”»å‡»ï¼Œå¦‚ä½•é¿å…ï¼Ÿ XSS æ”»å‡»ï¼šå³è·¨ç«™è„šæœ¬æ”»å‡»ï¼Œå®ƒæ˜¯ Web ç¨‹åºä¸­å¸¸è§çš„æ¼æ´ã€‚åŸç†æ˜¯æ”»å‡»è€…å¾€ Web é¡µé¢é‡Œæ’å…¥æ¶æ„çš„è„šæœ¬ä»£ç ï¼ˆcss ä»£ç ã€Javascript ä»£ç ç­‰ï¼‰ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µé¢æ—¶ï¼ŒåµŒå…¥å…¶ä¸­çš„è„šæœ¬ä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ï¼Œ å¦‚ç›—å–ç”¨æˆ· cookieã€ç ´åé¡µé¢ç»“æ„ã€é‡å®šå‘åˆ°å…¶ä»–ç½‘ç«™ç­‰ã€‚\né¢„é˜² XSS çš„æ ¸å¿ƒæ˜¯å¿…é¡»å¯¹è¾“å…¥çš„æ•°æ®åšè¿‡æ»¤å¤„ç†ã€‚\n73. ä»€ä¹ˆæ˜¯ CSRF æ”»å‡»ï¼Œå¦‚ä½•é¿å…ï¼Ÿ CSRFï¼šCross-Site Request Forgeryï¼ˆä¸­æ–‡ï¼šè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰ï¼Œå¯ä»¥ç†è§£ä¸ºæ”»å‡»è€…ç›—ç”¨äº†ä½ çš„èº«ä»½ï¼Œä»¥ä½ çš„åä¹‰å‘é€ æ¶æ„è¯·æ±‚ï¼Œæ¯”å¦‚ï¼šä»¥ä½ åä¹‰å‘é€é‚®ä»¶ã€å‘æ¶ˆæ¯ã€è´­ä¹°å•†å“ï¼Œè™šæ‹Ÿè´§å¸è½¬è´¦ç­‰ã€‚\né˜²å¾¡æ‰‹æ®µï¼š\néªŒè¯è¯·æ±‚æ¥æºåœ°å€ï¼›\rå…³é”®æ“ä½œæ·»åŠ éªŒè¯ç ï¼›\råœ¨è¯·æ±‚åœ°å€æ·»åŠ  token å¹¶éªŒè¯ã€‚ å¼‚å¸¸ 74. throw å’Œ throws çš„åŒºåˆ«ï¼Ÿ throwï¼šæ˜¯çœŸå®æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚\rthrowsï¼šæ˜¯å£°æ˜å¯èƒ½ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ 75. finalã€finallyã€finalize æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ finalï¼šæ˜¯ä¿®é¥°ç¬¦ï¼Œå¦‚æœä¿®é¥°ç±»ï¼Œæ­¤ç±»ä¸èƒ½è¢«ç»§æ‰¿ï¼›å¦‚æœä¿®é¥°æ–¹æ³•å’Œå˜é‡ï¼Œåˆ™è¡¨ç¤ºæ­¤æ–¹æ³•å’Œæ­¤å˜é‡ä¸èƒ½åœ¨è¢«æ”¹\rå˜ï¼Œåªèƒ½ä½¿ç”¨ã€‚\rfinallyï¼šæ˜¯ try{} catch{} finally{} æœ€åä¸€éƒ¨åˆ†ï¼Œè¡¨ç¤ºä¸è®ºå‘ç”Ÿä»»ä½•æƒ…å†µéƒ½ä¼šæ‰§è¡Œï¼Œfinally éƒ¨åˆ†å¯ä»¥çœç•¥ï¼Œä½†å¦‚æœ\rfinally éƒ¨åˆ†å­˜åœ¨ï¼Œåˆ™ä¸€å®šä¼šæ‰§è¡Œ finally é‡Œé¢çš„ä»£ç ã€‚\rfinalizeï¼š æ˜¯ Object ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œåœ¨åƒåœ¾æ”¶é›†å™¨æ‰§è¡Œçš„æ—¶å€™ä¼šè°ƒç”¨è¢«å›æ”¶å¯¹è±¡çš„æ­¤æ–¹æ³•ã€‚ 76. try-catch-finally ä¸­å“ªä¸ªéƒ¨åˆ†å¯ä»¥çœç•¥ï¼Ÿ try-catch-finally å…¶ä¸­ catch å’Œ finally éƒ½å¯ä»¥è¢«çœç•¥ï¼Œä½†æ˜¯ä¸èƒ½åŒæ—¶çœç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´æœ‰ try çš„æ—¶å€™ï¼Œå¿…é¡»åé¢è·Ÿä¸€ä¸ª catch æˆ–è€… finallyã€‚\n77. try-catch-finally ä¸­ï¼Œå¦‚æœ catch ä¸­ return äº†ï¼Œfinally è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿ finally ä¸€å®šä¼šæ‰§è¡Œï¼Œå³ä½¿æ˜¯ catch ä¸­ return äº†ï¼Œcatch ä¸­çš„ return ä¼šç­‰ finally ä¸­çš„ä»£ç æ‰§è¡Œå®Œä¹‹åï¼Œæ‰ä¼šæ‰§è¡Œã€‚\n78. å¸¸è§çš„å¼‚å¸¸ç±»æœ‰å“ªäº›ï¼Ÿ NullPointerException ç©ºæŒ‡é’ˆå¼‚å¸¸\rClassNotFoundException æŒ‡å®šç±»ä¸å­˜åœ¨\rNumberFormatException å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—å¼‚å¸¸\rIndexOutOfBoundsException æ•°ç»„ä¸‹æ ‡è¶Šç•Œå¼‚å¸¸\rClassCastException æ•°æ®ç±»å‹è½¬æ¢å¼‚å¸¸\rFileNotFoundException æ–‡ä»¶æœªæ‰¾åˆ°å¼‚å¸¸\rNoSuchMethodException æ–¹æ³•ä¸å­˜åœ¨å¼‚å¸¸\rIOException IO å¼‚å¸¸\rSocketException Socket å¼‚å¸¸ ç½‘ç»œ 79. http å“åº”ç  301 å’Œ 302 ä»£è¡¨çš„æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ 301 ï¼šæ°¸ä¹…é‡å®šå‘ã€‚ 302 ï¼šæš‚æ—¶é‡å®šå‘ã€‚ å®ƒä»¬çš„åŒºåˆ«æ˜¯ï¼Œ 301 å¯¹æœç´¢å¼•æ“ä¼˜åŒ–ï¼ˆSEOï¼‰æ›´åŠ æœ‰åˆ©ï¼› 302 æœ‰è¢«æç¤ºä¸ºç½‘ç»œæ‹¦æˆªçš„é£é™©ã€‚ 80. forward å’Œ redirect çš„åŒºåˆ«ï¼Ÿ forward æ˜¯è½¬å‘ å’Œ redirect æ˜¯é‡å®šå‘ï¼š\nåœ°å€æ  url æ˜¾ç¤ºï¼šfoward url ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œredirect url ä¼šå‘ç”Ÿæ”¹å˜ï¼›\ræ•°æ®å…±äº«ï¼šforward å¯ä»¥å…±äº« request é‡Œçš„æ•°æ®ï¼Œredirect ä¸èƒ½å…±äº«ï¼›\ræ•ˆç‡ï¼šforward æ¯” redirect æ•ˆç‡é«˜ã€‚ 81. ç®€è¿° tcp å’Œ udpçš„åŒºåˆ«ï¼Ÿ tcp å’Œ udp æ˜¯ OSI æ¨¡å‹ä¸­çš„è¿è¾“å±‚ä¸­çš„åè®®ã€‚tcp æä¾›å¯é çš„é€šä¿¡ä¼ è¾“ï¼Œè€Œ udp åˆ™å¸¸è¢«ç”¨äºè®©å¹¿æ’­å’Œç»†èŠ‚æ§åˆ¶äº¤ç»™ åº”ç”¨çš„é€šä¿¡ä¼ è¾“ã€‚\nä¸¤è€…çš„åŒºåˆ«å¤§è‡´å¦‚ä¸‹ï¼š\ntcp é¢å‘è¿æ¥ï¼Œudp é¢å‘éè¿æ¥å³å‘é€æ•°æ®å‰ä¸éœ€è¦å»ºç«‹é“¾æ¥ï¼›\rtcp æä¾›å¯é çš„æœåŠ¡ï¼ˆæ•°æ®ä¼ è¾“ï¼‰ï¼Œudp æ— æ³•ä¿è¯ï¼›\rtcp é¢å‘å­—èŠ‚æµï¼Œudp é¢å‘æŠ¥æ–‡ï¼›\rtcp æ•°æ®ä¼ è¾“æ…¢ï¼Œudp æ•°æ®ä¼ è¾“å¿«ï¼› 82. tcp ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤æ¬¡ä¸è¡Œå—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ å¦‚æœé‡‡ç”¨ä¸¤æ¬¡æ¡æ‰‹ï¼Œé‚£ä¹ˆåªè¦æœåŠ¡å™¨å‘å‡ºç¡®è®¤æ•°æ®åŒ…å°±ä¼šå»ºç«‹è¿æ¥ï¼Œä½†ç”±äºå®¢æˆ·ç«¯æ­¤æ—¶å¹¶æœªå“åº”æœåŠ¡å™¨ç«¯çš„è¯·æ±‚ï¼Œé‚£ æ­¤æ—¶æœåŠ¡å™¨ç«¯å°±ä¼šä¸€ç›´åœ¨ç­‰å¾…å®¢æˆ·ç«¯ï¼Œè¿™æ ·æœåŠ¡å™¨ç«¯å°±ç™½ç™½æµªè´¹äº†ä¸€å®šçš„èµ„æºã€‚è‹¥é‡‡ç”¨ä¸‰æ¬¡æ¡æ‰‹ï¼ŒæœåŠ¡å™¨ç«¯æ²¡æœ‰æ”¶åˆ° æ¥è‡ªå®¢æˆ·ç«¯çš„å†æ­¤ç¡®è®¤ï¼Œåˆ™å°±ä¼šçŸ¥é“å®¢æˆ·ç«¯å¹¶æ²¡æœ‰è¦æ±‚å»ºç«‹è¯·æ±‚ï¼Œå°±ä¸ä¼šæµªè´¹æœåŠ¡å™¨çš„èµ„æºã€‚ 83. è¯´ä¸€ä¸‹ tcp ç²˜åŒ…æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Ÿ tcp ç²˜åŒ…å¯èƒ½å‘ç”Ÿåœ¨å‘é€ç«¯æˆ–è€…æ¥æ”¶ç«¯ï¼Œåˆ†åˆ«æ¥çœ‹ä¸¤ç«¯å„ç§äº§ç”Ÿç²˜åŒ…çš„åŸå› ï¼š\nå‘é€ç«¯ç²˜åŒ…ï¼šå‘é€ç«¯éœ€è¦ç­‰ç¼“å†²åŒºæ»¡æ‰å‘é€å‡ºå»ï¼Œé€ æˆç²˜åŒ…ï¼›\ræ¥æ”¶æ–¹ç²˜åŒ…ï¼šæ¥æ”¶æ–¹ä¸åŠæ—¶æ¥æ”¶ç¼“å†²åŒºçš„åŒ…ï¼Œé€ æˆå¤šä¸ªåŒ…æ¥æ”¶ã€‚ 84. OSI çš„ä¸ƒå±‚æ¨¡å‹éƒ½æœ‰å“ªäº›ï¼Ÿ ç‰©ç†å±‚ï¼šåˆ©ç”¨ä¼ è¾“ä»‹è´¨ä¸ºæ•°æ®é“¾è·¯å±‚æä¾›ç‰©ç†è¿æ¥ï¼Œå®ç°æ¯”ç‰¹æµçš„é€æ˜ä¼ è¾“ã€‚ æ•°æ®é“¾è·¯å±‚ï¼šè´Ÿè´£å»ºç«‹å’Œç®¡ç†èŠ‚ç‚¹é—´çš„é“¾è·¯ã€‚ ç½‘ç»œå±‚ï¼šé€šè¿‡è·¯ç”±é€‰æ‹©ç®—æ³•ï¼Œä¸ºæŠ¥æ–‡æˆ–åˆ†ç»„é€šè¿‡é€šä¿¡å­ç½‘é€‰æ‹©æœ€é€‚å½“çš„è·¯å¾„ã€‚ ä¼ è¾“å±‚ï¼šå‘ç”¨æˆ·æä¾›å¯é çš„ç«¯åˆ°ç«¯çš„å·®é”™å’Œæµé‡æ§åˆ¶ï¼Œä¿è¯æŠ¥æ–‡çš„æ­£ç¡®ä¼ è¾“ã€‚ ä¼šè¯å±‚ï¼šå‘ä¸¤ä¸ªå®ä½“çš„è¡¨ç¤ºå±‚æä¾›å»ºç«‹å’Œä½¿ç”¨è¿æ¥çš„æ–¹æ³•ã€‚ è¡¨ç¤ºå±‚ï¼šå¤„ç†ç”¨æˆ·ä¿¡æ¯çš„è¡¨ç¤ºé—®é¢˜ï¼Œå¦‚ç¼–ç ã€æ•°æ®æ ¼å¼è½¬æ¢å’ŒåŠ å¯†è§£å¯†ç­‰ã€‚ åº”ç”¨å±‚ï¼šç›´æ¥å‘ç”¨æˆ·æä¾›æœåŠ¡ï¼Œå®Œæˆç”¨æˆ·å¸Œæœ›åœ¨ç½‘ç»œä¸Šå®Œæˆçš„å„ç§å·¥ä½œã€‚ 85. get å’Œ post è¯·æ±‚æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ get è¯·æ±‚ä¼šè¢«æµè§ˆå™¨ä¸»åŠ¨ç¼“å­˜ï¼Œè€Œ post ä¸ä¼šã€‚\rget ä¼ é€’å‚æ•°æœ‰å¤§å°é™åˆ¶ï¼Œè€Œ post æ²¡æœ‰ã€‚\rpost å‚æ•°ä¼ è¾“æ›´å®‰å…¨ï¼Œget çš„å‚æ•°ä¼šæ˜æ–‡é™åˆ¶åœ¨ url ä¸Šï¼Œpost ä¸ä¼šã€‚ 86. å¦‚ä½•å®ç°è·¨åŸŸï¼Ÿ å®ç°è·¨åŸŸæœ‰ä»¥ä¸‹å‡ ç§æ–¹æ¡ˆï¼š æœåŠ¡å™¨ç«¯è¿è¡Œè·¨åŸŸ è®¾ç½® CORS ç­‰äº *ï¼› åœ¨å•ä¸ªæ¥å£ä½¿ç”¨æ³¨è§£ @CrossOrigin è¿è¡Œè·¨åŸŸï¼›\rä½¿ç”¨ jsonp è·¨åŸŸï¼› 87. è¯´ä¸€ä¸‹ JSONP å®ç°åŸç†ï¼Ÿ jsonpï¼šJSON with Paddingï¼Œå®ƒæ˜¯åˆ©ç”¨scriptæ ‡ç­¾çš„ src è¿æ¥å¯ä»¥è®¿é—®ä¸åŒæºçš„ç‰¹æ€§ï¼ŒåŠ è½½è¿œç¨‹è¿”å›çš„â€œJS å‡½æ•°â€æ¥æ‰§ è¡Œçš„ã€‚\nè®¾è®¡æ¨¡å¼ 88. è¯´ä¸€ä¸‹ä½ ç†Ÿæ‚‰çš„è®¾è®¡æ¨¡å¼ï¼Ÿ å•ä¾‹æ¨¡å¼ï¼šä¿è¯è¢«åˆ›å»ºä¸€æ¬¡ï¼ŒèŠ‚çœç³»ç»Ÿå¼€é”€ã€‚ å·¥å‚æ¨¡å¼ï¼ˆç®€å•å·¥å‚ã€æŠ½è±¡å·¥å‚ï¼‰ï¼šè§£è€¦ä»£ç ã€‚ è§‚å¯Ÿè€…æ¨¡å¼ï¼šå®šä¹‰äº†å¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šçš„ä¾èµ–ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜æ—¶ï¼Œå®ƒçš„æ‰€æœ‰çš„ä¾èµ–è€…éƒ½ä¼šæ”¶åˆ°é€š çŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ã€‚ å¤–è§‚æ¨¡å¼ï¼šæä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œç”¨æ¥è®¿é—®å­ç³»ç»Ÿä¸­çš„ä¸€ç¾¤æ¥å£ï¼Œå¤–è§‚å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚çš„æ¥å£ï¼Œè®©å­ç³»ç»Ÿæ›´å®¹ æ˜“ä½¿ç”¨ã€‚ æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼ï¼šå®šä¹‰äº†ä¸€ä¸ªç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œæ¨¡ç‰ˆæ–¹æ³•ä½¿å¾—å­ç±»å¯ä»¥åœ¨ä¸æ”¹å˜ç®—æ³•ç»“ æ„çš„æƒ…å†µä¸‹ï¼Œé‡æ–°å®šä¹‰ç®—æ³•çš„æ­¥éª¤ã€‚ çŠ¶æ€æ¨¡å¼ï¼šå…è®¸å¯¹è±¡åœ¨å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥å¥½åƒä¿®æ”¹äº†å®ƒçš„ç±»ã€‚ 89. ç®€å•å·¥å‚å’ŒæŠ½è±¡å·¥å‚æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ ç®€å•å·¥å‚ï¼šç”¨æ¥ç”Ÿäº§åŒä¸€ç­‰çº§ç»“æ„ä¸­çš„ä»»æ„äº§å“ï¼Œå¯¹äºå¢åŠ æ–°çš„äº§å“ï¼Œæ— èƒ½ä¸ºåŠ›ã€‚ å·¥å‚æ–¹æ³•ï¼šç”¨æ¥ç”Ÿäº§åŒä¸€ç­‰çº§ç»“æ„ä¸­çš„å›ºå®šäº§å“ï¼Œæ”¯æŒå¢åŠ ä»»æ„äº§å“ã€‚ æŠ½è±¡å·¥å‚ï¼šç”¨æ¥ç”Ÿäº§ä¸åŒäº§å“æ—çš„å…¨éƒ¨äº§å“ï¼Œå¯¹äºå¢åŠ æ–°çš„äº§å“ï¼Œæ— èƒ½ä¸ºåŠ›ï¼›æ”¯æŒå¢åŠ äº§å“æ—ã€‚ Spring/Spring MVC 90. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ springï¼Ÿ spring æä¾› ioc æŠ€æœ¯ï¼Œå®¹å™¨ä¼šå¸®ä½ ç®¡ç†ä¾èµ–çš„å¯¹è±¡ï¼Œä»è€Œä¸éœ€è¦è‡ªå·±åˆ›å»ºå’Œç®¡ç†ä¾èµ–å¯¹è±¡äº†ï¼Œæ›´è½»æ¾çš„å®ç°äº†\rç¨‹åºçš„è§£è€¦ã€‚\rspring æä¾›äº†äº‹åŠ¡æ”¯æŒï¼Œä½¿å¾—äº‹åŠ¡æ“ä½œå˜çš„æ›´åŠ æ–¹ä¾¿ã€‚\rspring æä¾›äº†é¢å‘åˆ‡ç‰‡ç¼–ç¨‹ï¼Œè¿™æ ·å¯ä»¥æ›´æ–¹ä¾¿çš„å¤„ç†æŸä¸€ç±»çš„é—®é¢˜ã€‚\ræ›´æ–¹ä¾¿çš„æ¡†æ¶é›†æˆï¼Œspring å¯ä»¥å¾ˆæ–¹ä¾¿çš„é›†æˆå…¶ä»–æ¡†æ¶ï¼Œæ¯”å¦‚ MyBatisã€hibernate ç­‰ã€‚ 91. è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯ aopï¼Ÿ aop æ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½çš„ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ã€‚\nç®€å•æ¥è¯´å°±æ˜¯ç»Ÿä¸€å¤„ç†æŸä¸€â€œåˆ‡é¢â€ï¼ˆç±»ï¼‰çš„é—®é¢˜çš„ç¼–ç¨‹æ€æƒ³ï¼Œæ¯”å¦‚ç»Ÿä¸€å¤„ç†æ—¥å¿—ã€å¼‚å¸¸ç­‰ã€‚\n92. è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯ iocï¼Ÿ iocï¼šInversionof Controlï¼ˆä¸­æ–‡ï¼šæ§åˆ¶åè½¬ï¼‰æ˜¯ spring çš„æ ¸å¿ƒï¼Œå¯¹äº spring æ¡†æ¶æ¥è¯´ï¼Œå°±æ˜¯ç”± spring æ¥è´Ÿè´£æ§åˆ¶ å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå’Œå¯¹è±¡é—´çš„å…³ç³»ã€‚\nç®€å•æ¥è¯´ï¼Œæ§åˆ¶æŒ‡çš„æ˜¯å½“å‰å¯¹è±¡å¯¹å†…éƒ¨æˆå‘˜çš„æ§åˆ¶æƒï¼›æ§åˆ¶åè½¬æŒ‡çš„æ˜¯ï¼Œè¿™ç§æ§åˆ¶æƒä¸ç”±å½“å‰å¯¹è±¡ç®¡ç†äº†ï¼Œç”±å…¶ä»– ï¼ˆç±»,ç¬¬ä¸‰æ–¹å®¹å™¨ï¼‰æ¥ç®¡ç†ã€‚\n93. spring æœ‰å“ªäº›ä¸»è¦æ¨¡å—ï¼Ÿ spring coreï¼šæ¡†æ¶çš„æœ€åŸºç¡€éƒ¨åˆ†ï¼Œæä¾› ioc å’Œä¾èµ–æ³¨å…¥ç‰¹æ€§ã€‚\rspring contextï¼šæ„å»ºäº core å°è£…åŒ…åŸºç¡€ä¸Šçš„ context å°è£…åŒ…ï¼Œæä¾›äº†ä¸€ç§æ¡†æ¶å¼çš„å¯¹è±¡è®¿é—®æ–¹æ³•ã€‚\rspring daoï¼šData Access Object æä¾›äº†JDBCçš„æŠ½è±¡å±‚ã€‚\rspring aopï¼šæä¾›äº†é¢å‘åˆ‡é¢çš„ç¼–ç¨‹å®ç°ï¼Œè®©ä½ å¯ä»¥è‡ªå®šä¹‰æ‹¦æˆªå™¨ã€åˆ‡ç‚¹ç­‰ã€‚\rspring Webï¼šæä¾›äº†é’ˆå¯¹ Web å¼€å‘çš„é›†æˆç‰¹æ€§ï¼Œä¾‹å¦‚æ–‡ä»¶ä¸Šä¼ ï¼Œåˆ©ç”¨ servlet listeners è¿›è¡Œ ioc å®¹å™¨åˆå§‹åŒ–å’Œ\ré’ˆå¯¹ Web çš„ ApplicationContextã€‚\rspring Web mvcï¼šspring ä¸­çš„ mvc å°è£…åŒ…æä¾›äº† Web åº”ç”¨çš„ Model-View-Controllerï¼ˆMVCï¼‰çš„å®ç°ã€‚ 94. spring å¸¸ç”¨çš„æ³¨å…¥æ–¹å¼æœ‰å“ªäº›ï¼Ÿ setter å±æ€§æ³¨å…¥\ræ„é€ æ–¹æ³•æ³¨å…¥\ræ³¨è§£æ–¹å¼æ³¨å…¥ 95. spring ä¸­çš„ bean æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ spring ä¸­çš„ bean é»˜è®¤æ˜¯å•ä¾‹æ¨¡å¼ï¼Œspring æ¡†æ¶å¹¶æ²¡æœ‰å¯¹å•ä¾‹ bean è¿›è¡Œå¤šçº¿ç¨‹çš„å°è£…å¤„ç†ã€‚\nå®é™…ä¸Šå¤§éƒ¨åˆ†æ—¶å€™ spring bean æ— çŠ¶æ€çš„ï¼ˆæ¯”å¦‚ dao ç±»ï¼‰ï¼Œæ‰€æœ‰æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ bean ä¹Ÿæ˜¯å®‰å…¨çš„ï¼Œä½†å¦‚æœ bean æœ‰ çŠ¶æ€çš„è¯ï¼ˆæ¯”å¦‚ view model å¯¹è±¡ï¼‰ï¼Œé‚£å°±è¦å¼€å‘è€…è‡ªå·±å»ä¿è¯çº¿ç¨‹å®‰å…¨äº†ï¼Œæœ€ç®€å•çš„å°±æ˜¯æ”¹å˜ bean çš„ä½œç”¨åŸŸï¼Œ æŠŠâ€œsingletonâ€å˜æ›´ä¸ºâ€œprototypeâ€ï¼Œè¿™æ ·è¯·æ±‚ bean ç›¸å½“äº new Bean()äº†ï¼Œæ‰€ä»¥å°±å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨äº†ã€‚\næœ‰çŠ¶æ€å°±æ˜¯æœ‰æ•°æ®å­˜å‚¨åŠŸèƒ½ã€‚\ræ— çŠ¶æ€å°±æ˜¯ä¸ä¼šä¿å­˜æ•°æ®ã€‚ 96. spring æ”¯æŒå‡ ç§ bean çš„ä½œç”¨åŸŸï¼Ÿ spring æ”¯æŒ 5 ç§ä½œç”¨åŸŸï¼Œå¦‚ä¸‹ï¼š\nsingletonï¼šspring ioc å®¹å™¨ä¸­åªå­˜åœ¨ä¸€ä¸ª bean å®ä¾‹ï¼Œbean ä»¥å•ä¾‹æ¨¡å¼å­˜åœ¨ï¼Œæ˜¯ç³»ç»Ÿé»˜è®¤å€¼ï¼›\rprototypeï¼šæ¯æ¬¡ä»å®¹å™¨è°ƒç”¨ bean æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç¤ºä¾‹ï¼Œæ—¢æ¯æ¬¡ getBean()ç›¸å½“äºæ‰§è¡Œ new Bean()æ“ä½œï¼›\rWeb ç¯å¢ƒä¸‹çš„ä½œç”¨åŸŸï¼š requestï¼šæ¯æ¬¡ http è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ª beanï¼›\rsessionï¼šåŒä¸€ä¸ª http session å…±äº«ä¸€ä¸ª bean å®ä¾‹ï¼›\rglobal-sessionï¼šç”¨äº portlet å®¹å™¨ï¼Œå› ä¸ºæ¯ä¸ª portlet æœ‰å•ç‹¬çš„ sessionï¼Œglobalsession æä¾›ä¸€ä¸ªå…¨å±€æ€§çš„\rhttp sessionã€‚ æ³¨æ„ï¼š ä½¿ç”¨ prototype ä½œç”¨åŸŸéœ€è¦æ…é‡çš„æ€è€ƒï¼Œå› ä¸ºé¢‘ç¹åˆ›å»ºå’Œé”€æ¯ bean ä¼šå¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½å¼€é”€ã€‚\n97. spring è‡ªåŠ¨è£…é… bean æœ‰å“ªäº›æ–¹å¼ï¼Ÿ noï¼šé»˜è®¤å€¼ï¼Œè¡¨ç¤ºæ²¡æœ‰è‡ªåŠ¨è£…é…ï¼Œåº”ä½¿ç”¨æ˜¾å¼ bean å¼•ç”¨è¿›è¡Œè£…é…ã€‚\rbyNameï¼šå®ƒæ ¹æ® bean çš„åç§°æ³¨å…¥å¯¹è±¡ä¾èµ–é¡¹ã€‚\rbyTypeï¼šå®ƒæ ¹æ®ç±»å‹æ³¨å…¥å¯¹è±¡ä¾èµ–é¡¹ã€‚\ræ„é€ å‡½æ•°ï¼šé€šè¿‡æ„é€ å‡½æ•°æ¥æ³¨å…¥ä¾èµ–é¡¹ï¼Œéœ€è¦è®¾ç½®å¤§é‡çš„å‚æ•°ã€‚\rautodetectï¼šå®¹å™¨é¦–å…ˆé€šè¿‡æ„é€ å‡½æ•°ä½¿ç”¨ autowire è£…é…ï¼Œå¦‚æœä¸èƒ½ï¼Œåˆ™é€šè¿‡ byType è‡ªåŠ¨è£…é…ã€‚ 98. spring äº‹åŠ¡å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ å£°æ˜å¼äº‹åŠ¡ï¼šå£°æ˜å¼äº‹åŠ¡ä¹Ÿæœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼ŒåŸºäº xml é…ç½®æ–‡ä»¶çš„æ–¹å¼å’Œæ³¨è§£æ–¹å¼ï¼ˆåœ¨ç±»ä¸Šæ·»åŠ  @Transaction\ræ³¨è§£ï¼‰ã€‚\rç¼–ç æ–¹å¼ï¼šæä¾›ç¼–ç çš„å½¢å¼ç®¡ç†å’Œç»´æŠ¤äº‹åŠ¡ã€‚ 99. è¯´ä¸€ä¸‹ spring çš„äº‹åŠ¡éš”ç¦»ï¼Ÿ spring æœ‰äº”å¤§éš”ç¦»çº§åˆ«ï¼Œé»˜è®¤å€¼ä¸º ISOLATION_DEFAULTï¼ˆä½¿ç”¨æ•°æ®åº“çš„è®¾ç½®ï¼‰ï¼Œå…¶ä»–å››ä¸ªéš”ç¦»çº§åˆ«å’Œæ•°æ®åº“çš„éš”ç¦» çº§åˆ«ä¸€è‡´ï¼š\nISOLATION_DEFAULTï¼šç”¨åº•å±‚æ•°æ®åº“çš„è®¾ç½®éš”ç¦»çº§åˆ«ï¼Œæ•°æ®åº“è®¾ç½®çš„æ˜¯ä»€ä¹ˆæˆ‘å°±ç”¨ä»€ä¹ˆï¼›\nISOLATIONREADUNCOMMITTEDï¼šæœªæäº¤è¯»ï¼Œæœ€ä½éš”ç¦»çº§åˆ«ã€äº‹åŠ¡æœªæäº¤å‰ï¼Œå°±å¯è¢«å…¶ä»–äº‹åŠ¡è¯»å–ï¼ˆä¼šå‡ºç°å¹»è¯»ã€ è„è¯»ã€ä¸å¯é‡å¤è¯»ï¼‰ï¼›\nISOLATIONREADCOMMITTEDï¼šæäº¤è¯»ï¼Œä¸€ä¸ªäº‹åŠ¡æäº¤åæ‰èƒ½è¢«å…¶ä»–äº‹åŠ¡è¯»å–åˆ°ï¼ˆä¼šé€ æˆå¹»è¯»ã€ä¸å¯é‡å¤è¯»ï¼‰ï¼ŒSQL server çš„é»˜è®¤çº§åˆ«ï¼›\nISOLATIONREPEATABLEREADï¼šå¯é‡å¤è¯»ï¼Œä¿è¯å¤šæ¬¡è¯»å–åŒä¸€ä¸ªæ•°æ®æ—¶ï¼Œå…¶å€¼éƒ½å’Œäº‹åŠ¡å¼€å§‹æ—¶å€™çš„å†…å®¹æ˜¯ä¸€è‡´ï¼Œç¦æ­¢ è¯»å–åˆ°åˆ«çš„äº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼ˆä¼šé€ æˆå¹»è¯»ï¼‰ï¼ŒMySQL çš„é»˜è®¤çº§åˆ«ï¼›\nISOLATION_SERIALIZABLEï¼šåºåˆ—åŒ–ï¼Œä»£ä»·æœ€é«˜æœ€å¯é çš„éš”ç¦»çº§åˆ«ï¼Œè¯¥éš”ç¦»çº§åˆ«èƒ½é˜²æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ã€‚\nè„è¯» ï¼šè¡¨ç¤ºä¸€ä¸ªäº‹åŠ¡èƒ½å¤Ÿè¯»å–å¦ä¸€ä¸ªäº‹åŠ¡ä¸­è¿˜æœªæäº¤çš„æ•°æ®ã€‚æ¯”å¦‚ï¼ŒæŸä¸ªäº‹åŠ¡å°è¯•æ’å…¥è®°å½• Aï¼Œæ­¤æ—¶è¯¥äº‹åŠ¡è¿˜æœªæ äº¤ï¼Œç„¶åå¦ä¸€ä¸ªäº‹åŠ¡å°è¯•è¯»å–åˆ°äº†è®°å½• Aã€‚\nä¸å¯é‡å¤è¯» ï¼šæ˜¯æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡å†…ï¼Œå¤šæ¬¡è¯»åŒä¸€æ•°æ®ã€‚\nå¹»è¯» ï¼šæŒ‡åŒä¸€ä¸ªäº‹åŠ¡å†…å¤šæ¬¡æŸ¥è¯¢è¿”å›çš„ç»“æœé›†ä¸ä¸€æ ·ã€‚æ¯”å¦‚åŒä¸€ä¸ªäº‹åŠ¡ A ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ—¶å€™æœ‰ n æ¡è®°å½•ï¼Œä½†æ˜¯ç¬¬äºŒæ¬¡ åŒç­‰æ¡ä»¶ä¸‹æŸ¥è¯¢å´æœ‰ n+1 æ¡è®°å½•ï¼Œè¿™å°±å¥½åƒäº§ç”Ÿäº†å¹»è§‰ã€‚å‘ç”Ÿå¹»è¯»çš„åŸå› ä¹Ÿæ˜¯å¦å¤–ä¸€ä¸ªäº‹åŠ¡æ–°å¢æˆ–è€…åˆ é™¤æˆ–è€…ä¿®æ”¹ äº†ç¬¬ä¸€ä¸ªäº‹åŠ¡ç»“æœé›†é‡Œé¢çš„æ•°æ®ï¼ŒåŒä¸€ä¸ªè®°å½•çš„æ•°æ®å†…å®¹è¢«ä¿®æ”¹äº†ï¼Œæ‰€æœ‰æ•°æ®è¡Œçš„è®°å½•å°±å˜å¤šæˆ–è€…å˜å°‘äº†ã€‚\n100. è¯´ä¸€ä¸‹ spring mvc è¿è¡Œæµç¨‹ï¼Ÿ spring mvc å…ˆå°†è¯·æ±‚å‘é€ç»™ DispatcherServletã€‚\rDispatcherServlet æŸ¥è¯¢ä¸€ä¸ªæˆ–å¤šä¸ª HandlerMappingï¼Œæ‰¾åˆ°å¤„ç†è¯·æ±‚çš„ Controllerã€‚\rDispatcherServlet å†æŠŠè¯·æ±‚æäº¤åˆ°å¯¹åº”çš„ Controllerã€‚\rController è¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†åï¼Œä¼šè¿”å›ä¸€ä¸ªModelAndViewã€‚\rDispathcher æŸ¥è¯¢ä¸€ä¸ªæˆ–å¤šä¸ª ViewResolver è§†å›¾è§£æå™¨ï¼Œæ‰¾åˆ° ModelAndView å¯¹è±¡æŒ‡å®šçš„è§†å›¾å¯¹è±¡ã€‚ è§†å›¾å¯¹è±¡è´Ÿè´£æ¸²æŸ“è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ 101. spring mvc æœ‰å“ªäº›ç»„ä»¶ï¼Ÿ å‰ç½®æ§åˆ¶å™¨ DispatcherServletã€‚\ræ˜ å°„æ§åˆ¶å™¨ HandlerMappingã€‚\rå¤„ç†å™¨ Controllerã€‚\ræ¨¡å‹å’Œè§†å›¾ ModelAndViewã€‚\rè§†å›¾è§£æå™¨ ViewResolverã€‚ 102. @RequestMapping çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ å°† http è¯·æ±‚æ˜ å°„åˆ°ç›¸åº”çš„ç±»/æ–¹æ³•ä¸Šã€‚\n103. @Autowired çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ @Autowired å®ƒå¯ä»¥å¯¹ç±»æˆå‘˜å˜é‡ã€æ–¹æ³•åŠæ„é€ å‡½æ•°è¿›è¡Œæ ‡æ³¨ï¼Œå®Œæˆè‡ªåŠ¨è£…é…çš„å·¥ä½œï¼Œé€šè¿‡@Autowired çš„ä½¿ç”¨æ¥æ¶ˆ é™¤ set/get æ–¹æ³•ã€‚\nSpring Boot/Spring Cloud 104. ä»€ä¹ˆæ˜¯ spring bootï¼Ÿ spring boot æ˜¯ä¸º spring æœåŠ¡çš„ï¼Œæ˜¯ç”¨æ¥ç®€åŒ–æ–° spring åº”ç”¨çš„åˆå§‹æ­å»ºä»¥åŠå¼€å‘è¿‡ç¨‹çš„ã€‚\n105. ä¸ºä»€ä¹ˆè¦ç”¨ spring bootï¼Ÿ é…ç½®ç®€å• ç‹¬ç«‹è¿è¡Œ è‡ªåŠ¨è£…é… æ— ä»£ç ç”Ÿæˆå’Œ xml é…ç½®\ræä¾›åº”ç”¨ç›‘æ§\ræ˜“ä¸Šæ‰‹\ræå‡å¼€å‘æ•ˆç‡ 106. spring boot æ ¸å¿ƒé…ç½®æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ spring boot æ ¸å¿ƒçš„ä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼š\nbootstrap (. yml æˆ–è€…. properties)ï¼šboostrap ç”±çˆ¶ ApplicationContext åŠ è½½çš„ï¼Œæ¯” applicaton ä¼˜å…ˆåŠ è½½ï¼Œä¸”\rboostrap é‡Œé¢çš„å±æ€§ä¸èƒ½è¢«è¦†ç›–ï¼›\rapplication (. yml æˆ–è€…. properties)ï¼šç”¨äº spring boot é¡¹ç›®çš„è‡ªåŠ¨åŒ–é…ç½®ã€‚ 107. spring boot é…ç½®æ–‡ä»¶æœ‰å“ªå‡ ç§ç±»å‹ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ é…ç½®æ–‡ä»¶æœ‰. properties æ ¼å¼å’Œ. yml æ ¼å¼ï¼Œå®ƒä»¬ä¸»è¦çš„åŒºåˆ«æ˜¯ä¹¦æ³•é£æ ¼ä¸åŒã€‚\n. properties é…ç½®å¦‚ä¸‹ï¼š . yml é…ç½®å¦‚ä¸‹ï¼š\nspring. RabbitMQ. port=5672 . yml æ ¼å¼ä¸æ”¯æŒ @PropertySource æ³¨è§£å¯¼å…¥ã€‚\n108. spring boot æœ‰å“ªäº›æ–¹å¼å¯ä»¥å®ç°çƒ­éƒ¨ç½²ï¼Ÿ ä½¿ç”¨ devtools å¯åŠ¨çƒ­éƒ¨ç½²ï¼Œæ·»åŠ  devtools åº“ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­æŠŠ spring. devtools. restart. enabled è®¾ç½®ä¸º\rtrueï¼›\rä½¿ç”¨ Intellij Idea ç¼–è¾‘å™¨ï¼Œæ²Ÿä¸Šè‡ªåŠ¨ç¼–è¯‘æˆ–æ‰‹åŠ¨é‡æ–°ç¼–è¯‘ã€‚ 109. jpa å’Œ hibernate æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ jpa å…¨ç§° Java Persistence APIï¼Œæ˜¯ Java æŒä¹…åŒ–æ¥å£è§„èŒƒï¼Œhibernate å±äº jpa çš„å…·ä½“å®ç°ã€‚\n110. ä»€ä¹ˆæ˜¯ spring cloudï¼Ÿ spring cloud æ˜¯ä¸€ç³»åˆ—æ¡†æ¶çš„æœ‰åºé›†åˆã€‚å®ƒåˆ©ç”¨ spring boot çš„å¼€å‘ä¾¿åˆ©æ€§å·§å¦™åœ°ç®€åŒ–äº†åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€è®¾æ–½çš„å¼€ å‘ï¼Œå¦‚æœåŠ¡å‘ç°æ³¨å†Œã€é…ç½®ä¸­å¿ƒã€æ¶ˆæ¯æ€»çº¿ã€è´Ÿè½½å‡è¡¡ã€æ–­è·¯å™¨ã€æ•°æ®ç›‘æ§ç­‰ï¼Œéƒ½å¯ä»¥ç”¨ spring boot çš„å¼€å‘é£æ ¼åš åˆ°ä¸€é”®å¯åŠ¨å’Œéƒ¨ç½²ã€‚\n111. spring cloud æ–­è·¯å™¨çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ åœ¨åˆ†å¸ƒå¼æ¶æ„ä¸­ï¼Œæ–­è·¯å™¨æ¨¡å¼çš„ä½œç”¨ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œå½“æŸä¸ªæœåŠ¡å•å…ƒå‘ç”Ÿæ•…éšœï¼ˆç±»ä¼¼ç”¨ç”µå™¨å‘ç”ŸçŸ­è·¯ï¼‰ä¹‹åï¼Œé€šè¿‡æ–­è·¯ å™¨çš„æ•…éšœç›‘æ§ï¼ˆç±»ä¼¼ç†”æ–­ä¿é™©ä¸ï¼‰ï¼Œå‘è°ƒç”¨æ–¹è¿”å›ä¸€ä¸ªé”™è¯¯å“åº”ï¼Œè€Œä¸æ˜¯é•¿æ—¶é—´çš„ç­‰å¾…ã€‚è¿™æ ·å°±ä¸ä¼šä½¿å¾—çº¿ç¨‹å› è°ƒç”¨ æ•…éšœæœåŠ¡è¢«é•¿æ—¶é—´å ç”¨ä¸é‡Šæ”¾ï¼Œé¿å…äº†æ•…éšœåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è”“å»¶ã€‚ 112. spring cloud çš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ Eurekaï¼šæœåŠ¡æ³¨å†Œäºå‘ç°ã€‚\rFeignï¼šåŸºäºåŠ¨æ€ä»£ç†æœºåˆ¶ï¼Œæ ¹æ®æ³¨è§£å’Œé€‰æ‹©çš„æœºå™¨ï¼Œæ‹¼æ¥è¯·æ±‚ url åœ°å€ï¼Œå‘èµ·è¯·æ±‚ã€‚\rRibbonï¼šå®ç°è´Ÿè½½å‡è¡¡ï¼Œä»ä¸€ä¸ªæœåŠ¡çš„å¤šå°æœºå™¨ä¸­é€‰æ‹©ä¸€å°ã€‚\rHystrixï¼šæä¾›çº¿ç¨‹æ± ï¼Œä¸åŒçš„æœåŠ¡èµ°ä¸åŒçš„çº¿ç¨‹æ± ï¼Œå®ç°äº†ä¸åŒæœåŠ¡è°ƒç”¨çš„éš”ç¦»ï¼Œé¿å…äº†æœåŠ¡é›ªå´©çš„é—®é¢˜ã€‚\rZuulï¼šç½‘å…³ç®¡ç†ï¼Œç”± Zuul ç½‘å…³è½¬å‘è¯·æ±‚ç»™å¯¹åº”çš„æœåŠ¡ã€‚ Hibernate 113. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ hibernateï¼Ÿ hibernate æ˜¯å¯¹ jdbc çš„å°è£…ï¼Œå¤§å¤§ç®€åŒ–äº†æ•°æ®è®¿é—®å±‚çš„ç¹ççš„é‡å¤æ€§ä»£ç ã€‚\rhibernate æ˜¯ä¸€ä¸ªä¼˜ç§€çš„ ORM å®ç°ï¼Œå¾ˆå¤šç¨‹åº¦ä¸Šç®€åŒ–äº† DAO å±‚çš„ç¼–ç åŠŸèƒ½ã€‚\rå¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡Œæ•°æ®åº“çš„ç§»æ¤å·¥ä½œã€‚\ræä¾›äº†ç¼“å­˜æœºåˆ¶ï¼Œæ˜¯ç¨‹åºæ‰§è¡Œæ›´æ”¹çš„é«˜æ•ˆã€‚ 114. ä»€ä¹ˆæ˜¯ ORM æ¡†æ¶ï¼Ÿ ORMï¼ˆObject Relation Mappingï¼‰å¯¹è±¡å…³ç³»æ˜ å°„ï¼Œæ˜¯æŠŠæ•°æ®åº“ä¸­çš„å…³ç³»æ•°æ®æ˜ å°„æˆä¸ºç¨‹åºä¸­çš„å¯¹è±¡ã€‚\nä½¿ç”¨ ORM çš„ä¼˜ç‚¹ï¼šæé«˜äº†å¼€å‘æ•ˆç‡é™ä½äº†å¼€å‘æˆæœ¬ã€å¼€å‘æ›´ç®€å•æ›´å¯¹è±¡åŒ–ã€å¯ç§»æ¤æ›´å¼ºã€‚\n115. hibernate ä¸­å¦‚ä½•åœ¨æ§åˆ¶å°æŸ¥çœ‹æ‰“å°çš„ SQL è¯­å¥ï¼Ÿ spring:\rRabbitMQ:\rport: 5672 åœ¨ Config é‡Œé¢æŠŠ hibernate. show_SQL è®¾ç½®ä¸º true å°±å¯ä»¥ã€‚ä½†ä¸å»ºè®®å¼€å¯ï¼Œå¼€å¯ä¹‹åä¼šé™ä½ç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚\n116. hibernate æœ‰å‡ ç§æŸ¥è¯¢æ–¹å¼ï¼Ÿ ä¸‰ç§ï¼šhqlã€åŸç”Ÿ SQLã€æ¡ä»¶æŸ¥è¯¢ Criteriaã€‚\n117. hibernate å®ä½“ç±»å¯ä»¥è¢«å®šä¹‰ä¸º final å—ï¼Ÿ å®ä½“ç±»å¯ä»¥å®šä¹‰ä¸º final ç±»ï¼Œä½†è¿™æ ·çš„è¯å°±ä¸èƒ½ä½¿ç”¨ hibernate ä»£ç†æ¨¡å¼ä¸‹çš„å»¶è¿Ÿå…³è”æä¾›æ€§èƒ½äº†ï¼Œæ‰€ä»¥ä¸å»ºè®®å®šä¹‰ å®ä½“ç±»ä¸º finalã€‚\n118. åœ¨ hibernate ä¸­ä½¿ç”¨ Integer å’Œ int åšæ˜ å°„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ Integer ç±»å‹ä¸ºå¯¹è±¡ï¼Œå®ƒçš„å€¼å…è®¸ä¸º nullï¼Œè€Œ int å±äºåŸºç¡€æ•°æ®ç±»å‹ï¼Œå€¼ä¸èƒ½ä¸º nullã€‚\n119. hibernate æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ è¯»å–å¹¶è§£æé…ç½®æ–‡ä»¶ã€‚ è¯»å–å¹¶è§£ææ˜ å°„æ–‡ä»¶ï¼Œåˆ›å»º SessionFactoryã€‚\ræ‰“å¼€ Sessionã€‚\råˆ›å»ºäº‹åŠ¡ã€‚\rè¿›è¡ŒæŒä¹…åŒ–æ“ä½œã€‚\ræäº¤äº‹åŠ¡ã€‚\rå…³é—­ Sessionã€‚\rå…³é—­ SessionFactoryã€‚ 120. get()å’Œ load()çš„åŒºåˆ«ï¼Ÿ æ•°æ®æŸ¥è¯¢æ—¶ï¼Œæ²¡æœ‰ OID æŒ‡å®šçš„å¯¹è±¡ï¼Œget() è¿”å› nullï¼›load() è¿”å›ä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚\rload()æ”¯æŒå»¶è¿ŸåŠ è½½ï¼›get() ä¸æ”¯æŒå»¶è¿ŸåŠ è½½ã€‚ 121. è¯´ä¸€ä¸‹ hibernate çš„ç¼“å­˜æœºåˆ¶ï¼Ÿ hibernate å¸¸ç”¨çš„ç¼“å­˜æœ‰ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ï¼š\nä¸€çº§ç¼“å­˜ï¼šä¹Ÿå« Session ç¼“å­˜ï¼Œåªåœ¨ Session ä½œç”¨èŒƒå›´å†…æœ‰æ•ˆï¼Œä¸éœ€è¦ç”¨æˆ·å¹²æ¶‰ï¼Œç”± hibernate è‡ªèº«ç»´æŠ¤ï¼Œå¯ä»¥é€š è¿‡ï¼ševict(object)æ¸…é™¤ object çš„ç¼“å­˜ï¼›clear()æ¸…é™¤ä¸€çº§ç¼“å­˜ä¸­çš„æ‰€æœ‰ç¼“å­˜ï¼›flush()åˆ·å‡ºç¼“å­˜ï¼›\näºŒçº§ç¼“å­˜ï¼šåº”ç”¨çº§åˆ«çš„ç¼“å­˜ï¼Œåœ¨æ‰€æœ‰ Session ä¸­éƒ½æœ‰æ•ˆï¼Œæ”¯æŒé…ç½®ç¬¬ä¸‰æ–¹çš„ç¼“å­˜ï¼Œå¦‚ï¼šEhCacheã€‚\n122. hibernate å¯¹è±¡æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ ä¸´æ—¶/ç¬æ—¶çŠ¶æ€ï¼šç›´æ¥ new å‡ºæ¥çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡è¿˜æ²¡è¢«æŒä¹…åŒ–ï¼ˆæ²¡ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼‰ï¼Œä¸å— Session ç®¡ç†ã€‚\ræŒä¹…åŒ–çŠ¶æ€ï¼šå½“è°ƒç”¨ Session çš„ save/saveOrupdate/get/load/list ç­‰æ–¹æ³•çš„æ—¶å€™ï¼Œå¯¹è±¡å°±æ˜¯æŒä¹…åŒ–çŠ¶æ€ã€‚\ræ¸¸ç¦»çŠ¶æ€ï¼šSession å…³é—­ä¹‹åå¯¹è±¡å°±æ˜¯æ¸¸ç¦»çŠ¶æ€ã€‚ 123. åœ¨ hibernate ä¸­ getCurrentSession å’Œ openSession çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ getCurrentSession ä¼šç»‘å®šå½“å‰çº¿ç¨‹ï¼Œè€Œ openSession åˆ™ä¸ä¼šã€‚\rgetCurrentSession äº‹åŠ¡æ˜¯ Spring æ§åˆ¶çš„ï¼Œå¹¶ä¸”ä¸éœ€è¦æ‰‹åŠ¨å…³é—­ï¼Œè€Œ openSession éœ€è¦æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨å¼€å¯å’Œæ\räº¤äº‹åŠ¡ã€‚ 124. hibernate å®ä½“ç±»å¿…é¡»è¦æœ‰æ— å‚æ„é€ å‡½æ•°å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ hibernate ä¸­æ¯ä¸ªå®ä½“ç±»å¿…é¡»æä¾›ä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°ï¼Œå› ä¸º hibernate æ¡†æ¶è¦ä½¿ç”¨ reflection apiï¼Œé€šè¿‡è°ƒç”¨ ClassnewInstance() æ¥åˆ›å»ºå®ä½“ç±»çš„å®ä¾‹ï¼Œå¦‚æœæ²¡æœ‰æ— å‚çš„æ„é€ å‡½æ•°å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚\nMyBatis 125. MyBatis ä¸­ #{}å’Œ ${}çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ #{}æ˜¯é¢„ç¼–è¯‘å¤„ç†ï¼Œ${}æ˜¯å­—ç¬¦æ›¿æ¢ã€‚ åœ¨ä½¿ç”¨ #{}æ—¶ï¼ŒMyBatis ä¼šå°† SQL ä¸­çš„ #{}æ›¿æ¢æˆâ€œ?â€ï¼Œé…åˆ PreparedStatement çš„ set æ–¹æ³•èµ‹å€¼ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢ SQL æ³¨å…¥ï¼Œä¿è¯ç¨‹åºçš„è¿è¡Œå®‰å…¨ã€‚\n126. MyBatis æœ‰å‡ ç§åˆ†é¡µæ–¹å¼ï¼Ÿ åˆ†é¡µæ–¹å¼ï¼šé€»è¾‘åˆ†é¡µå’Œç‰©ç†åˆ†é¡µã€‚ é€»è¾‘åˆ†é¡µï¼š ä½¿ç”¨ MyBatis è‡ªå¸¦çš„ RowBounds è¿›è¡Œåˆ†é¡µï¼Œå®ƒæ˜¯ä¸€æ¬¡æ€§æŸ¥è¯¢å¾ˆå¤šæ•°æ®ï¼Œç„¶ååœ¨æ•°æ®ä¸­å†è¿›è¡Œæ£€ç´¢ã€‚\nç‰©ç†åˆ†é¡µï¼š è‡ªå·±æ‰‹å†™ SQL åˆ†é¡µæˆ–ä½¿ç”¨åˆ†é¡µæ’ä»¶ PageHelperï¼Œå»æ•°æ®åº“æŸ¥è¯¢æŒ‡å®šæ¡æ•°çš„åˆ†é¡µæ•°æ®çš„å½¢å¼ã€‚\n127. RowBounds æ˜¯ä¸€æ¬¡æ€§æŸ¥è¯¢å…¨éƒ¨ç»“æœå—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ RowBounds è¡¨é¢æ˜¯åœ¨â€œæ‰€æœ‰â€æ•°æ®ä¸­æ£€ç´¢æ•°æ®ï¼Œå…¶å®å¹¶éæ˜¯ä¸€æ¬¡æ€§æŸ¥è¯¢å‡ºæ‰€æœ‰æ•°æ®ï¼Œå› ä¸º MyBatis æ˜¯å¯¹ jdbc çš„å° è£…ï¼Œåœ¨ jdbc é©±åŠ¨ä¸­æœ‰ä¸€ä¸ª Fetch Size çš„é…ç½®ï¼Œå®ƒè§„å®šäº†æ¯æ¬¡æœ€å¤šä»æ•°æ®åº“æŸ¥è¯¢å¤šå°‘æ¡æ•°æ®ï¼Œå‡å¦‚ä½ è¦æŸ¥è¯¢æ›´çš„æ•° æ®ï¼Œå®ƒä¼šåœ¨ä½ æ‰§è¡Œ next()çš„æ—¶å€™ï¼Œå»æŸ¥è¯¢æ›´å¤šçš„æ•°æ®ã€‚å°±å¥½æ¯”ä½ å»è‡ªåŠ¨å–æ¬¾æœºå– 10000 å…ƒï¼Œä½†å–æ¬¾æœºæ¯æ¬¡æœ€å¤šèƒ½å– 2500 å…ƒï¼Œæ‰€ä»¥ä½ è¦å– 4 æ¬¡æ‰èƒ½æŠŠé’±å–å®Œã€‚åªæ˜¯å¯¹äº jdbc æ¥è¯´ï¼Œå½“ä½ è°ƒç”¨ next()çš„æ—¶å€™ä¼šè‡ªåŠ¨å¸®ä½ å®ŒæˆæŸ¥è¯¢å·¥ä½œã€‚è¿™ æ ·åšçš„å¥½å¤„å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢å†…å­˜æº¢å‡ºã€‚\nFetch Size å®˜æ–¹ç›¸å…³æ–‡æ¡£ï¼šhttp://t. cn/EfSE2g3\n128. MyBatis é€»è¾‘åˆ†é¡µå’Œç‰©ç†åˆ†é¡µçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ é€»è¾‘åˆ†é¡µæ˜¯ä¸€æ¬¡æ€§æŸ¥è¯¢å¾ˆå¤šæ•°æ®ï¼Œç„¶åå†åœ¨ç»“æœä¸­æ£€ç´¢åˆ†é¡µçš„æ•°æ®ã€‚è¿™æ ·åšå¼Šç«¯æ˜¯éœ€è¦æ¶ˆè€—å¤§é‡çš„å†…å­˜ã€æœ‰å†… å­˜æº¢å‡ºçš„é£é™©ã€å¯¹æ•°æ®åº“å‹åŠ›è¾ƒå¤§ã€‚ ç‰©ç†åˆ†é¡µæ˜¯ä»æ•°æ®åº“æŸ¥è¯¢æŒ‡å®šæ¡æ•°çš„æ•°æ®ï¼Œå¼¥è¡¥äº†ä¸€æ¬¡æ€§å…¨éƒ¨æŸ¥å‡ºçš„æ‰€æœ‰æ•°æ®çš„ç§ç§ç¼ºç‚¹ï¼Œæ¯”å¦‚éœ€è¦å¤§é‡çš„å†… å­˜ï¼Œå¯¹æ•°æ®åº“æŸ¥è¯¢å‹åŠ›è¾ƒå¤§ç­‰é—®é¢˜ã€‚ 129. MyBatis æ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Ÿå»¶è¿ŸåŠ è½½çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ MyBatis æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œè®¾ç½® lazyLoadingEnabled=true å³å¯ã€‚\nå»¶è¿ŸåŠ è½½çš„åŸç†çš„æ˜¯è°ƒç”¨çš„æ—¶å€™è§¦å‘åŠ è½½ï¼Œè€Œä¸æ˜¯åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±åŠ è½½ä¿¡æ¯ã€‚æ¯”å¦‚è°ƒç”¨ a. getB(). getName()ï¼Œè¿™ ä¸ªæ—¶å€™å‘ç° a. getB() çš„å€¼ä¸º nullï¼Œæ­¤æ—¶ä¼šå•ç‹¬è§¦å‘äº‹å…ˆä¿å­˜å¥½çš„å…³è” B å¯¹è±¡çš„ SQLï¼Œå…ˆæŸ¥è¯¢å‡ºæ¥ Bï¼Œç„¶åå†è°ƒç”¨ a. setB(b)ï¼Œè€Œè¿™æ—¶å€™å†è°ƒç”¨ a. getB(). getName() å°±æœ‰å€¼äº†ï¼Œè¿™å°±æ˜¯å»¶è¿ŸåŠ è½½çš„åŸºæœ¬åŸç†ã€‚\n130. è¯´ä¸€ä¸‹ MyBatis çš„ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ï¼Ÿ ä¸€çº§ç¼“å­˜ï¼šåŸºäº PerpetualCache çš„ HashMap æœ¬åœ°ç¼“å­˜ï¼Œå®ƒçš„å£°æ˜å‘¨æœŸæ˜¯å’Œ SQLSession ä¸€è‡´çš„ï¼Œæœ‰å¤šä¸ª\rSQLSession æˆ–è€…åˆ†å¸ƒå¼çš„ç¯å¢ƒä¸­æ•°æ®åº“æ“ä½œï¼Œå¯èƒ½ä¼šå‡ºç°è„æ•°æ®ã€‚å½“ Session flush æˆ– close ä¹‹åï¼Œè¯¥\rSession ä¸­çš„æ‰€æœ‰ Cache å°±å°†æ¸…ç©ºï¼Œé»˜è®¤ä¸€çº§ç¼“å­˜æ˜¯å¼€å¯çš„ã€‚\räºŒçº§ç¼“å­˜ï¼šä¹Ÿæ˜¯åŸºäº PerpetualCache çš„ HashMap æœ¬åœ°ç¼“å­˜ï¼Œä¸åŒåœ¨äºå…¶å­˜å‚¨ä½œç”¨åŸŸä¸º Mapper çº§åˆ«çš„ï¼Œå¦‚\ræœå¤šä¸ªSQLSessionä¹‹é—´éœ€è¦å…±äº«ç¼“å­˜ï¼Œåˆ™éœ€è¦ä½¿ç”¨åˆ°äºŒçº§ç¼“å­˜ï¼Œå¹¶ä¸”äºŒçº§ç¼“å­˜å¯è‡ªå®šä¹‰å­˜å‚¨æºï¼Œå¦‚ Ehcacheã€‚\ré»˜è®¤ä¸æ‰“å¼€äºŒçº§ç¼“å­˜ï¼Œè¦å¼€å¯äºŒçº§ç¼“å­˜ï¼Œä½¿ç”¨äºŒçº§ç¼“å­˜å±æ€§ç±»éœ€è¦å®ç° Serializable åºåˆ—åŒ–æ¥å£(å¯ç”¨æ¥ä¿å­˜å¯¹\rè±¡çš„çŠ¶æ€)ã€‚ å¼€å¯äºŒçº§ç¼“å­˜æ•°æ®æŸ¥è¯¢æµç¨‹ï¼šäºŒçº§ç¼“å­˜ -\u0026gt; ä¸€çº§ç¼“å­˜ -\u0026gt; æ•°æ®åº“ã€‚\nç¼“å­˜æ›´æ–°æœºåˆ¶ï¼šå½“æŸä¸€ä¸ªä½œç”¨åŸŸ(ä¸€çº§ç¼“å­˜ Session/äºŒçº§ç¼“å­˜ Mapper)è¿›è¡Œäº†C/U/D æ“ä½œåï¼Œé»˜è®¤è¯¥ä½œç”¨åŸŸä¸‹æ‰€æœ‰ select ä¸­çš„ç¼“å­˜å°†è¢« clearã€‚\n131. MyBatis å’Œ hibernate çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ çµæ´»æ€§ï¼šMyBatis æ›´åŠ çµæ´»ï¼Œè‡ªå·±å¯ä»¥å†™ SQL è¯­å¥ï¼Œä½¿ç”¨èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ã€‚\rå¯ç§»æ¤æ€§ï¼šMyBatis æœ‰å¾ˆå¤šè‡ªå·±å†™çš„ SQLï¼Œå› ä¸ºæ¯ä¸ªæ•°æ®åº“çš„ SQL å¯ä»¥ä¸ç›¸åŒï¼Œæ‰€ä»¥å¯ç§»æ¤æ€§æ¯”è¾ƒå·®ã€‚\rå­¦ä¹ å’Œä½¿ç”¨é—¨æ§›ï¼šMyBatis å…¥é—¨æ¯”è¾ƒç®€å•ï¼Œä½¿ç”¨é—¨æ§›ä¹Ÿæ›´ä½ã€‚\räºŒçº§ç¼“å­˜ï¼šhibernate æ‹¥æœ‰æ›´å¥½çš„äºŒçº§ç¼“å­˜ï¼Œå®ƒçš„äºŒçº§ç¼“å­˜å¯ä»¥è‡ªè¡Œæ›´æ¢ä¸ºç¬¬ä¸‰æ–¹çš„äºŒçº§ç¼“å­˜ã€‚ 132. MyBatis æœ‰å“ªäº›æ‰§è¡Œå™¨ï¼ˆExecutorï¼‰ï¼Ÿ MyBatis æœ‰ä¸‰ç§åŸºæœ¬çš„Executoræ‰§è¡Œå™¨ï¼š\nSimpleExecutorï¼šæ¯æ‰§è¡Œä¸€æ¬¡ update æˆ– select å°±å¼€å¯ä¸€ä¸ª Statement å¯¹è±¡ï¼Œç”¨å®Œç«‹åˆ»å…³é—­ Statement å¯¹\rè±¡ï¼›\rReuseExecutorï¼šæ‰§è¡Œ update æˆ– selectï¼Œä»¥ SQL ä½œä¸º key æŸ¥æ‰¾ Statement å¯¹è±¡ï¼Œå­˜åœ¨å°±ä½¿ç”¨ï¼Œä¸å­˜åœ¨å°±åˆ›\rå»ºï¼Œç”¨å®Œåä¸å…³é—­ Statement å¯¹è±¡ï¼Œè€Œæ˜¯æ”¾ç½®äº Map å†…ä¾›ä¸‹ä¸€æ¬¡ä½¿ç”¨ã€‚ç®€è¨€ä¹‹ï¼Œå°±æ˜¯é‡å¤ä½¿ç”¨ Statement å¯¹\rè±¡ï¼›\rBatchExecutorï¼šæ‰§è¡Œ updateï¼ˆæ²¡æœ‰ selectï¼Œjdbc æ‰¹å¤„ç†ä¸æ”¯æŒ selectï¼‰ï¼Œå°†æ‰€æœ‰ SQL éƒ½æ·»åŠ åˆ°æ‰¹å¤„ç†ä¸­\rï¼ˆaddBatch()ï¼‰ï¼Œç­‰å¾…ç»Ÿä¸€æ‰§è¡Œï¼ˆexecuteBatch()ï¼‰ï¼Œå®ƒç¼“å­˜äº†å¤šä¸ª Statement å¯¹è±¡ï¼Œæ¯ä¸ª Statement å¯¹è±¡éƒ½\ræ˜¯ addBatch()å®Œæ¯•åï¼Œç­‰å¾…é€ä¸€æ‰§è¡Œ executeBatch()æ‰¹å¤„ç†ï¼Œä¸ jdbc æ‰¹å¤„ç†ç›¸åŒã€‚ 133. MyBatis åˆ†é¡µæ’ä»¶çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ åˆ†é¡µæ’ä»¶çš„åŸºæœ¬åŸç†æ˜¯ä½¿ç”¨ MyBatis æä¾›çš„æ’ä»¶æ¥å£ï¼Œå®ç°è‡ªå®šä¹‰æ’ä»¶ï¼Œåœ¨æ’ä»¶çš„æ‹¦æˆªæ–¹æ³•å†…æ‹¦æˆªå¾…æ‰§è¡Œçš„ SQLï¼Œ ç„¶åé‡å†™ SQLï¼Œæ ¹æ® dialect æ–¹è¨€ï¼Œæ·»åŠ å¯¹åº”çš„ç‰©ç†åˆ†é¡µè¯­å¥å’Œç‰©ç†åˆ†é¡µå‚æ•°ã€‚\n134. MyBatis å¦‚ä½•ç¼–å†™ä¸€ä¸ªè‡ªå®šä¹‰æ’ä»¶ï¼Ÿ è‡ªå®šä¹‰æ’ä»¶å®ç°åŸç† MyBatis è‡ªå®šä¹‰æ’ä»¶é’ˆå¯¹ MyBatis å››å¤§å¯¹è±¡ï¼ˆExecutorã€StatementHandlerã€ParameterHandlerã€ ResultSetHandlerï¼‰è¿›è¡Œæ‹¦æˆªï¼š\nExecutorï¼šæ‹¦æˆªå†…éƒ¨æ‰§è¡Œå™¨ï¼Œå®ƒè´Ÿè´£è°ƒç”¨ StatementHandler æ“ä½œæ•°æ®åº“ï¼Œå¹¶æŠŠç»“æœé›†é€šè¿‡ ResultSetHandler\rè¿›è¡Œè‡ªåŠ¨æ˜ å°„ï¼Œå¦å¤–å®ƒè¿˜å¤„ç†äº†äºŒçº§ç¼“å­˜çš„æ“ä½œï¼›\rStatementHandlerï¼šæ‹¦æˆª SQL è¯­æ³•æ„å»ºçš„å¤„ç†ï¼Œå®ƒæ˜¯ MyBatis ç›´æ¥å’Œæ•°æ®åº“æ‰§è¡Œ SQL è„šæœ¬çš„å¯¹è±¡ï¼Œå¦å¤–å®ƒä¹Ÿ\rå®ç°äº† MyBatis çš„ä¸€çº§ç¼“å­˜ï¼›\rParameterHandlerï¼šæ‹¦æˆªå‚æ•°çš„å¤„ç†ï¼›\rResultSetHandlerï¼šæ‹¦æˆªç»“æœé›†çš„å¤„ç†ã€‚ è‡ªå®šä¹‰æ’ä»¶å®ç°å…³é”®\nMyBatis æ’ä»¶è¦å®ç° Interceptor æ¥å£ï¼Œæ¥å£åŒ…å«çš„æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š\npublic interface Interceptor {\rObject intercept(Invocation invocation) throws Throwable;\rObject plugin(Object target);\rvoid setProperties(Properties properties);\r} setProperties æ–¹æ³•æ˜¯åœ¨ MyBatis è¿›è¡Œé…ç½®æ’ä»¶çš„æ—¶å€™å¯ä»¥é…ç½®è‡ªå®šä¹‰ç›¸å…³å±æ€§ï¼Œå³ï¼šæ¥å£å®ç°å¯¹è±¡çš„å‚æ•°é…\rç½®ï¼›\rplugin æ–¹æ³•æ˜¯æ’ä»¶ç”¨äºå°è£…ç›®æ ‡å¯¹è±¡çš„ï¼Œé€šè¿‡è¯¥æ–¹æ³•æˆ‘ä»¬å¯ä»¥è¿”å›ç›®æ ‡å¯¹è±¡æœ¬èº«ï¼Œä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªå®ƒçš„ä»£ç†ï¼Œ\rå¯ä»¥å†³å®šæ˜¯å¦è¦è¿›è¡Œæ‹¦æˆªè¿›è€Œå†³å®šè¦è¿”å›ä¸€ä¸ªä»€ä¹ˆæ ·çš„ç›®æ ‡å¯¹è±¡ï¼Œå®˜æ–¹æä¾›äº†ç¤ºä¾‹ï¼šreturn Plugin.\rwrap(target, this)ï¼›\rintercept æ–¹æ³•å°±æ˜¯è¦è¿›è¡Œæ‹¦æˆªçš„æ—¶å€™è¦æ‰§è¡Œçš„æ–¹æ³•ã€‚ è‡ªå®šä¹‰æ’ä»¶å®ç°ç¤ºä¾‹\nå®˜æ–¹æ’ä»¶å®ç°ï¼š\nRabbitMQ 135. RabbitMQ çš„ä½¿ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ æŠ¢è´­æ´»åŠ¨ï¼Œå‰Šå³°å¡«è°·ï¼Œé˜²æ­¢ç³»ç»Ÿå´©å¡Œã€‚ å»¶è¿Ÿä¿¡æ¯å¤„ç†ï¼Œæ¯”å¦‚ 10 åˆ†é’Ÿä¹‹åç»™ä¸‹å•æœªä»˜æ¬¾çš„ç”¨æˆ·å‘é€é‚®ä»¶æé†’ã€‚ è§£è€¦ç³»ç»Ÿï¼Œå¯¹äºæ–°å¢çš„åŠŸèƒ½å¯ä»¥å•ç‹¬å†™æ¨¡å—æ‰©å±•ï¼Œæ¯”å¦‚ç”¨æˆ·ç¡®è®¤è¯„ä»·ä¹‹åï¼Œæ–°å¢äº†ç»™ç”¨æˆ·è¿”ç§¯åˆ†çš„åŠŸèƒ½ï¼Œè¿™ä¸ª æ—¶å€™ä¸ç”¨åœ¨ä¸šåŠ¡ä»£ç é‡Œæ·»åŠ æ–°å¢ç§¯åˆ†çš„åŠŸèƒ½ï¼Œåªéœ€è¦æŠŠæ–°å¢ç§¯åˆ†çš„æ¥å£è®¢é˜…ç¡®è®¤è¯„ä»·çš„æ¶ˆæ¯é˜Ÿåˆ—å³å¯ï¼Œåé¢å† æ·»åŠ ä»»ä½•åŠŸèƒ½åªéœ€è¦è®¢é˜…å¯¹åº”çš„æ¶ˆæ¯é˜Ÿåˆ—å³å¯ã€‚ 136. RabbitMQ æœ‰å“ªäº›é‡è¦çš„è§’è‰²ï¼Ÿ RabbitMQ ä¸­é‡è¦çš„è§’è‰²æœ‰ï¼šç”Ÿäº§è€…ã€æ¶ˆè´¹è€…å’Œä»£ç†ï¼š\nç”Ÿäº§è€…ï¼šæ¶ˆæ¯çš„åˆ›å»ºè€…ï¼Œè´Ÿè´£åˆ›å»ºå’Œæ¨é€æ•°æ®åˆ°æ¶ˆæ¯æœåŠ¡å™¨ï¼›\ræ¶ˆè´¹è€…ï¼šæ¶ˆæ¯çš„æ¥æ”¶æ–¹ï¼Œç”¨äºå¤„ç†æ•°æ®å’Œç¡®è®¤æ¶ˆæ¯ï¼›\rä»£ç†ï¼šå°±æ˜¯ RabbitMQ æœ¬èº«ï¼Œç”¨äºæ‰®æ¼”â€œå¿«é€’â€çš„è§’è‰²ï¼Œæœ¬èº«ä¸ç”Ÿäº§æ¶ˆæ¯ï¼Œåªæ˜¯æ‰®æ¼”â€œå¿«é€’â€çš„è§’è‰²ã€‚ 137. RabbitMQ æœ‰å“ªäº›é‡è¦çš„ç»„ä»¶ï¼Ÿ ConnectionFactoryï¼ˆè¿æ¥ç®¡ç†å™¨ï¼‰ï¼šåº”ç”¨ç¨‹åºä¸Rabbitä¹‹é—´å»ºç«‹è¿æ¥çš„ç®¡ç†å™¨ï¼Œç¨‹åºä»£ç ä¸­ä½¿ç”¨ã€‚\rChannelï¼ˆä¿¡é“ï¼‰ï¼šæ¶ˆæ¯æ¨é€ä½¿ç”¨çš„é€šé“ã€‚\rExchangeï¼ˆäº¤æ¢å™¨ï¼‰ï¼šç”¨äºæ¥å—ã€åˆ†é…æ¶ˆæ¯ã€‚ @Intercepts({@Signature(type = Executor. class, method = \u0026#34;query\u0026#34;,\rargs = {MappedStatement. class, Object. class, RowBounds. class, ResultHandler.\rclass})})\rpublic class TestInterceptor implements Interceptor {\rpublic Object intercept(Invocation invocation) throws Throwable {\rObject target = invocation. getTarget(); //è¢«ä»£ç†å¯¹è±¡\rMethod method = invocation. getMethod(); //ä»£ç†æ–¹æ³•\rObject[] args = invocation. getArgs(); //æ–¹æ³•å‚æ•°\r// do something...... æ–¹æ³•æ‹¦æˆªå‰æ‰§è¡Œä»£ç å—\rObject result = invocation. proceed();\r// do something....... æ–¹æ³•æ‹¦æˆªåæ‰§è¡Œä»£ç å—\rreturn result;\r}\rpublic Object plugin(Object target) {\rreturn Plugin. wrap(target, this);\r}\r} Queueï¼ˆé˜Ÿåˆ—ï¼‰ï¼šç”¨äºå­˜å‚¨ç”Ÿäº§è€…çš„æ¶ˆæ¯ã€‚\rRoutingKeyï¼ˆè·¯ç”±é”®ï¼‰ï¼šç”¨äºæŠŠç”Ÿæˆè€…çš„æ•°æ®åˆ†é…åˆ°äº¤æ¢å™¨ä¸Šã€‚\rBindingKeyï¼ˆç»‘å®šé”®ï¼‰ï¼šç”¨äºæŠŠäº¤æ¢å™¨çš„æ¶ˆæ¯ç»‘å®šåˆ°é˜Ÿåˆ—ä¸Šã€‚ 138. RabbitMQ ä¸­ vhost çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ vhostï¼šæ¯ä¸ª RabbitMQ éƒ½èƒ½åˆ›å»ºå¾ˆå¤š vhostï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºè™šæ‹Ÿä¸»æœºï¼Œæ¯ä¸ªè™šæ‹Ÿä¸»æœºå…¶å®éƒ½æ˜¯ mini ç‰ˆçš„RabbitMQï¼Œ å®ƒæ‹¥æœ‰è‡ªå·±çš„é˜Ÿåˆ—ï¼Œäº¤æ¢å™¨å’Œç»‘å®šï¼Œæ‹¥æœ‰è‡ªå·±çš„æƒé™æœºåˆ¶ã€‚\n139. RabbitMQ çš„æ¶ˆæ¯æ˜¯æ€ä¹ˆå‘é€çš„ï¼Ÿ é¦–å…ˆå®¢æˆ·ç«¯å¿…é¡»è¿æ¥åˆ° RabbitMQ æœåŠ¡å™¨æ‰èƒ½å‘å¸ƒå’Œæ¶ˆè´¹æ¶ˆæ¯ï¼Œå®¢æˆ·ç«¯å’Œ rabbit server ä¹‹é—´ä¼šåˆ›å»ºä¸€ä¸ª tcp è¿æ¥ï¼Œ ä¸€æ—¦ tcp æ‰“å¼€å¹¶é€šè¿‡äº†è®¤è¯ï¼ˆè®¤è¯å°±æ˜¯ä½ å‘é€ç»™ rabbit æœåŠ¡å™¨çš„ç”¨æˆ·åå’Œå¯†ç ï¼‰ï¼Œä½ çš„å®¢æˆ·ç«¯å’Œ RabbitMQ å°±åˆ›å»º äº†ä¸€æ¡ amqp ä¿¡é“ï¼ˆchannelï¼‰ï¼Œä¿¡é“æ˜¯åˆ›å»ºåœ¨â€œçœŸå®â€ tcp ä¸Šçš„è™šæ‹Ÿè¿æ¥ï¼Œamqp å‘½ä»¤éƒ½æ˜¯é€šè¿‡ä¿¡é“å‘é€å‡ºå»çš„ï¼Œæ¯ ä¸ªä¿¡é“éƒ½ä¼šæœ‰ä¸€ä¸ªå”¯ä¸€çš„ idï¼Œä¸è®ºæ˜¯å‘å¸ƒæ¶ˆæ¯ï¼Œè®¢é˜…é˜Ÿåˆ—éƒ½æ˜¯é€šè¿‡è¿™ä¸ªä¿¡é“å®Œæˆçš„ã€‚\n140. RabbitMQ æ€ä¹ˆä¿è¯æ¶ˆæ¯çš„ç¨³å®šæ€§ï¼Ÿ æä¾›äº†äº‹åŠ¡çš„åŠŸèƒ½ã€‚ é€šè¿‡å°† channel è®¾ç½®ä¸º confirmï¼ˆç¡®è®¤ï¼‰æ¨¡å¼ã€‚ 141. RabbitMQ æ€ä¹ˆé¿å…æ¶ˆæ¯ä¸¢å¤±ï¼Ÿ æŠŠæ¶ˆæ¯æŒä¹…åŒ–ç£ç›˜ï¼Œä¿è¯æœåŠ¡å™¨é‡å¯æ¶ˆæ¯ä¸ä¸¢å¤±ã€‚ æ¯ä¸ªé›†ç¾¤ä¸­è‡³å°‘æœ‰ä¸€ä¸ªç‰©ç† 142. è¦ä¿è¯æ¶ˆæ¯æŒä¹…åŒ–æˆåŠŸçš„æ¡ä»¶æœ‰å“ªäº›ï¼Ÿ å£°æ˜é˜Ÿåˆ—å¿…é¡»è®¾ç½®æŒä¹…åŒ– durable è®¾ç½®ä¸º true.\ræ¶ˆæ¯æ¨é€æŠ•é€’æ¨¡å¼å¿…é¡»è®¾ç½®æŒä¹…åŒ–ï¼ŒdeliveryMode è®¾ç½®ä¸º 2 ï¼ˆæŒä¹…ï¼‰ã€‚\ræ¶ˆæ¯å·²ç»åˆ°è¾¾æŒä¹…åŒ–äº¤æ¢å™¨ã€‚\ræ¶ˆæ¯å·²ç»åˆ°è¾¾æŒä¹…åŒ–é˜Ÿåˆ—ã€‚ ä»¥ä¸Šå››ä¸ªæ¡ä»¶éƒ½æ»¡è¶³æ‰èƒ½ä¿è¯æ¶ˆæ¯æŒä¹…åŒ–æˆåŠŸã€‚\n143. RabbitMQ æŒä¹…åŒ–æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ æŒä¹…åŒ–çš„ç¼ºåœ°å°±æ˜¯é™ä½äº†æœåŠ¡å™¨çš„ååé‡ï¼Œå› ä¸ºä½¿ç”¨çš„æ˜¯ç£ç›˜è€Œéå†…å­˜å­˜å‚¨ï¼Œä»è€Œé™ä½äº†ååé‡ã€‚å¯å°½é‡ä½¿ç”¨ ssd ç¡¬ ç›˜æ¥ç¼“è§£ååé‡çš„é—®é¢˜ã€‚\n144. RabbitMQ æœ‰å‡ ç§å¹¿æ’­ç±»å‹ï¼Ÿ directï¼ˆé»˜è®¤æ–¹å¼ï¼‰ï¼šæœ€åŸºç¡€æœ€ç®€å•çš„æ¨¡å¼ï¼Œå‘é€æ–¹æŠŠæ¶ˆæ¯å‘é€ç»™è®¢é˜…æ–¹ï¼Œå¦‚æœæœ‰å¤šä¸ªè®¢é˜…è€…ï¼Œé»˜è®¤é‡‡å–è½®è¯¢çš„\ræ–¹å¼è¿›è¡Œæ¶ˆæ¯å‘é€ã€‚\rheadersï¼šä¸ direct ç±»ä¼¼ï¼Œåªæ˜¯æ€§èƒ½å¾ˆå·®ï¼Œæ­¤ç±»å‹å‡ ä¹ç”¨ä¸åˆ°ã€‚\rfanoutï¼šåˆ†å‘æ¨¡å¼ï¼ŒæŠŠæ¶ˆè´¹åˆ†å‘ç»™æ‰€æœ‰è®¢é˜…è€…ã€‚\rtopicï¼šåŒ¹é…è®¢é˜…æ¨¡å¼ï¼Œä½¿ç”¨æ­£åˆ™åŒ¹é…åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œèƒ½åŒ¹é…åˆ°çš„éƒ½èƒ½æ¥æ”¶åˆ°ã€‚ 145. RabbitMQ æ€ä¹ˆå®ç°å»¶è¿Ÿæ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ å»¶è¿Ÿé˜Ÿåˆ—çš„å®ç°æœ‰ä¸¤ç§æ–¹å¼ï¼š é€šè¿‡æ¶ˆæ¯è¿‡æœŸåè¿›å…¥æ­»ä¿¡äº¤æ¢å™¨ï¼Œå†ç”±äº¤æ¢å™¨è½¬å‘åˆ°å»¶è¿Ÿæ¶ˆè´¹é˜Ÿåˆ—ï¼Œå®ç°å»¶è¿ŸåŠŸèƒ½ï¼› ä½¿ç”¨ RabbitMQ-delayed-message-exchange æ’ä»¶å®ç°å»¶è¿ŸåŠŸèƒ½ã€‚ 146. RabbitMQ é›†ç¾¤æœ‰ä»€ä¹ˆç”¨ï¼Ÿ é›†ç¾¤ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªç”¨é€”ï¼š é«˜å¯ç”¨ï¼šæŸä¸ªæœåŠ¡å™¨å‡ºç°é—®é¢˜ï¼Œæ•´ä¸ª RabbitMQ è¿˜å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼›\ré«˜å®¹é‡ï¼šé›†ç¾¤å¯ä»¥æ‰¿è½½æ›´å¤šçš„æ¶ˆæ¯é‡ã€‚ 147. RabbitMQ èŠ‚ç‚¹çš„ç±»å‹æœ‰å“ªäº›ï¼Ÿ ç£ç›˜èŠ‚ç‚¹ï¼šæ¶ˆæ¯ä¼šå­˜å‚¨åˆ°ç£ç›˜ã€‚ å†…å­˜èŠ‚ç‚¹ï¼šæ¶ˆæ¯éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œé‡å¯æœåŠ¡å™¨æ¶ˆæ¯ä¸¢å¤±ï¼Œæ€§èƒ½é«˜äºç£ç›˜ç±»å‹ã€‚ 148. RabbitMQ é›†ç¾¤æ­å»ºéœ€è¦æ³¨æ„å“ªäº›é—®é¢˜ï¼Ÿ å„èŠ‚ç‚¹ä¹‹é—´ä½¿ç”¨â€œ--linkâ€è¿æ¥ï¼Œæ­¤å±æ€§ä¸èƒ½å¿½ç•¥ã€‚\rå„èŠ‚ç‚¹ä½¿ç”¨çš„ erlang cookie å€¼å¿…é¡»ç›¸åŒï¼Œæ­¤å€¼ç›¸å½“äºâ€œç§˜é’¥â€çš„åŠŸèƒ½ï¼Œç”¨äºå„èŠ‚ç‚¹çš„è®¤è¯ã€‚\ræ•´ä¸ªé›†ç¾¤ä¸­å¿…é¡»åŒ…å«ä¸€ä¸ªç£ç›˜èŠ‚ç‚¹ã€‚ 149. RabbitMQ æ¯ä¸ªèŠ‚ç‚¹æ˜¯å…¶ä»–èŠ‚ç‚¹çš„å®Œæ•´æ‹·è´å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ ä¸æ˜¯ï¼ŒåŸå› æœ‰ä»¥ä¸‹ä¸¤ä¸ªï¼š å­˜å‚¨ç©ºé—´çš„è€ƒè™‘ï¼šå¦‚æœæ¯ä¸ªèŠ‚ç‚¹éƒ½æ‹¥æœ‰æ‰€æœ‰é˜Ÿåˆ—çš„å®Œå…¨æ‹·è´ï¼Œè¿™æ ·æ–°å¢èŠ‚ç‚¹ä¸ä½†æ²¡æœ‰æ–°å¢å­˜å‚¨ç©ºé—´ï¼Œåè€Œå¢åŠ  äº†æ›´å¤šçš„å†—ä½™æ•°æ®ï¼› æ€§èƒ½çš„è€ƒè™‘ï¼šå¦‚æœæ¯æ¡æ¶ˆæ¯éƒ½éœ€è¦å®Œæ•´æ‹·è´åˆ°æ¯ä¸€ä¸ªé›†ç¾¤èŠ‚ç‚¹ï¼Œé‚£æ–°å¢èŠ‚ç‚¹å¹¶æ²¡æœ‰æå‡å¤„ç†æ¶ˆæ¯çš„èƒ½åŠ›ï¼Œæœ€å¤š æ˜¯ä¿æŒå’Œå•èŠ‚ç‚¹ç›¸åŒçš„æ€§èƒ½ç”šè‡³æ˜¯æ›´ç³Ÿã€‚ 150. RabbitMQ é›†ç¾¤ä¸­å”¯ä¸€ä¸€ä¸ªç£ç›˜èŠ‚ç‚¹å´©æºƒäº†ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ å¦‚æœå”¯ä¸€ç£ç›˜çš„ç£ç›˜èŠ‚ç‚¹å´©æºƒäº†ï¼Œä¸èƒ½è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š ä¸èƒ½åˆ›å»ºé˜Ÿåˆ— ä¸èƒ½åˆ›å»ºäº¤æ¢å™¨ ä¸èƒ½åˆ›å»ºç»‘å®š ä¸èƒ½æ·»åŠ ç”¨æˆ· ä¸èƒ½æ›´æ”¹æƒé™ ä¸èƒ½æ·»åŠ å’Œåˆ é™¤é›†ç¾¤èŠ‚ç‚¹ å”¯ä¸€ç£ç›˜èŠ‚ç‚¹å´©æºƒäº†ï¼Œé›†ç¾¤æ˜¯å¯ä»¥ä¿æŒè¿è¡Œçš„ï¼Œä½†ä½ ä¸èƒ½æ›´æ”¹ä»»ä½•ä¸œè¥¿ã€‚ 151. RabbitMQ å¯¹é›†ç¾¤èŠ‚ç‚¹åœæ­¢é¡ºåºæœ‰è¦æ±‚å—ï¼Ÿ RabbitMQ å¯¹é›†ç¾¤çš„åœæ­¢çš„é¡ºåºæ˜¯æœ‰è¦æ±‚çš„ï¼Œåº”è¯¥å…ˆå…³é—­å†…å­˜èŠ‚ç‚¹ï¼Œæœ€åå†å…³é—­ç£ç›˜èŠ‚ç‚¹ã€‚å¦‚æœé¡ºåºæ°å¥½ç›¸åçš„è¯ï¼Œ å¯èƒ½ä¼šé€ æˆæ¶ˆæ¯çš„ä¸¢å¤±ã€‚\nKafka 152. kafka å¯ä»¥è„±ç¦» zookeeper å•ç‹¬ä½¿ç”¨å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ kafka ä¸èƒ½è„±ç¦» zookeeper å•ç‹¬ä½¿ç”¨ï¼Œå› ä¸º kafka ä½¿ç”¨ zookeeper ç®¡ç†å’Œåè°ƒ kafka çš„èŠ‚ç‚¹æœåŠ¡å™¨ã€‚\n153. kafka æœ‰å‡ ç§æ•°æ®ä¿ç•™çš„ç­–ç•¥ï¼Ÿ kafka æœ‰ä¸¤ç§æ•°æ®ä¿å­˜ç­–ç•¥ï¼šæŒ‰ç…§è¿‡æœŸæ—¶é—´ä¿ç•™å’ŒæŒ‰ç…§å­˜å‚¨çš„æ¶ˆæ¯å¤§å°ä¿ç•™ã€‚\n154. kafka åŒæ—¶è®¾ç½®äº† 7 å¤©å’Œ 10G æ¸…é™¤æ•°æ®ï¼Œåˆ°ç¬¬äº”å¤©çš„æ—¶å€™æ¶ˆæ¯è¾¾åˆ°äº† 10Gï¼Œè¿™ä¸ªæ—¶å€™ kafka å°†å¦‚ä½•å¤„ç†ï¼Ÿ è¿™ä¸ªæ—¶å€™ kafka ä¼šæ‰§è¡Œæ•°æ®æ¸…é™¤å·¥ä½œï¼Œæ—¶é—´å’Œå¤§å°ä¸è®ºé‚£ä¸ªæ»¡è¶³æ¡ä»¶ï¼Œéƒ½ä¼šæ¸…ç©ºæ•°æ®ã€‚\n155. ä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´ kafka è¿è¡Œå˜æ…¢ï¼Ÿ cpu æ€§èƒ½ç“¶é¢ˆ\rç£ç›˜è¯»å†™ç“¶é¢ˆ\rç½‘ç»œç“¶é¢ˆ 156. ä½¿ç”¨ kafka é›†ç¾¤éœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ é›†ç¾¤çš„æ•°é‡ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œæœ€å¥½ä¸è¦è¶…è¿‡ 7 ä¸ªï¼Œå› ä¸ºèŠ‚ç‚¹è¶Šå¤šï¼Œæ¶ˆæ¯å¤åˆ¶éœ€è¦çš„æ—¶é—´å°±è¶Šé•¿ï¼Œæ•´ä¸ªç¾¤ç»„çš„åå é‡å°±è¶Šä½ã€‚ é›†ç¾¤æ•°é‡æœ€å¥½æ˜¯å•æ•°ï¼Œå› ä¸ºè¶…è¿‡ä¸€åŠæ•…éšœé›†ç¾¤å°±ä¸èƒ½ç”¨äº†ï¼Œè®¾ç½®ä¸ºå•æ•°å®¹é”™ç‡æ›´é«˜ã€‚ Zookeeper 157. zookeeper æ˜¯ä»€ä¹ˆï¼Ÿ zookeeper æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ï¼Œå¼€æ”¾æºç çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºåè°ƒæœåŠ¡ï¼Œæ˜¯ google chubby çš„å¼€æºå®ç°ï¼Œæ˜¯ hadoop å’Œ hbase çš„é‡è¦ç»„ä»¶ã€‚å®ƒæ˜¯ä¸€ä¸ªä¸ºåˆ†å¸ƒå¼åº”ç”¨æä¾›ä¸€è‡´æ€§æœåŠ¡çš„è½¯ä»¶ï¼Œæä¾›çš„åŠŸèƒ½åŒ…æ‹¬ï¼šé…ç½®ç»´æŠ¤ã€åŸŸåæœåŠ¡ã€åˆ†å¸ƒå¼ åŒæ­¥ã€ç»„æœåŠ¡ç­‰ã€‚\n158. zookeeper éƒ½æœ‰å“ªäº›åŠŸèƒ½ï¼Ÿ é›†ç¾¤ç®¡ç†ï¼šç›‘æ§èŠ‚ç‚¹å­˜æ´»çŠ¶æ€ã€è¿è¡Œè¯·æ±‚ç­‰ã€‚ ä¸»èŠ‚ç‚¹é€‰ä¸¾ï¼šä¸»èŠ‚ç‚¹æŒ‚æ‰äº†ä¹‹åå¯ä»¥ä»å¤‡ç”¨çš„èŠ‚ç‚¹å¼€å§‹æ–°ä¸€è½®é€‰ä¸»ï¼Œä¸»èŠ‚ç‚¹é€‰ä¸¾è¯´çš„å°±æ˜¯è¿™ä¸ªé€‰ä¸¾çš„è¿‡ç¨‹ï¼Œä½¿ ç”¨ zookeeper å¯ä»¥ååŠ©å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚\råˆ†å¸ƒå¼é”ï¼šzookeeper æä¾›ä¸¤ç§é”ï¼šç‹¬å é”ã€å…±äº«é”ã€‚ç‹¬å é”å³ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨èµ„æºï¼Œå…±äº«é”æ˜¯è¯»é”\rå…±äº«ï¼Œè¯»å†™äº’æ–¥ï¼Œå³å¯ä»¥æœ‰å¤šçº¿çº¿ç¨‹åŒæ—¶è¯»åŒä¸€ä¸ªèµ„æºï¼Œå¦‚æœè¦ä½¿ç”¨å†™é”ä¹Ÿåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ã€‚zookeeper\rå¯ä»¥å¯¹åˆ†å¸ƒå¼é”è¿›è¡Œæ§åˆ¶ã€‚\rå‘½åæœåŠ¡ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œé€šè¿‡ä½¿ç”¨å‘½åæœåŠ¡ï¼Œå®¢æˆ·ç«¯åº”ç”¨èƒ½å¤Ÿæ ¹æ®æŒ‡å®šåå­—æ¥è·å–èµ„æºæˆ–æœåŠ¡çš„åœ°å€ï¼Œæ\rä¾›è€…ç­‰ä¿¡æ¯ã€‚ 159. zookeeper æœ‰å‡ ç§éƒ¨ç½²æ¨¡å¼ï¼Ÿ zookeeper æœ‰ä¸‰ç§éƒ¨ç½²æ¨¡å¼ï¼š\nå•æœºéƒ¨ç½²ï¼šä¸€å°é›†ç¾¤ä¸Šè¿è¡Œï¼›\ré›†ç¾¤éƒ¨ç½²ï¼šå¤šå°é›†ç¾¤è¿è¡Œï¼›\rä¼ªé›†ç¾¤éƒ¨ç½²ï¼šä¸€å°é›†ç¾¤å¯åŠ¨å¤šä¸ª zookeeper å®ä¾‹è¿è¡Œã€‚ 160. zookeeper æ€ä¹ˆä¿è¯ä¸»ä»èŠ‚ç‚¹çš„çŠ¶æ€åŒæ­¥ï¼Ÿ zookeeper çš„æ ¸å¿ƒæ˜¯åŸå­å¹¿æ’­ï¼Œè¿™ä¸ªæœºåˆ¶ä¿è¯äº†å„ä¸ª server ä¹‹é—´çš„åŒæ­¥ã€‚å®ç°è¿™ä¸ªæœºåˆ¶çš„åè®®å«åš zab åè®®ã€‚ zab åè®®æœ‰ä¸¤ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯æ¢å¤æ¨¡å¼ï¼ˆé€‰ä¸»ï¼‰å’Œå¹¿æ’­æ¨¡å¼ï¼ˆåŒæ­¥ï¼‰ã€‚å½“æœåŠ¡å¯åŠ¨æˆ–è€…åœ¨é¢†å¯¼è€…å´©æºƒåï¼Œzab å°±è¿›å…¥äº†æ¢ å¤æ¨¡å¼ï¼Œå½“é¢†å¯¼è€…è¢«é€‰ä¸¾å‡ºæ¥ï¼Œä¸”å¤§å¤šæ•° server å®Œæˆäº†å’Œ leader çš„çŠ¶æ€åŒæ­¥ä»¥åï¼Œæ¢å¤æ¨¡å¼å°±ç»“æŸäº†ã€‚çŠ¶æ€åŒæ­¥ä¿ è¯äº† leader å’Œ server å…·æœ‰ç›¸åŒçš„ç³»ç»ŸçŠ¶æ€ã€‚\n161. é›†ç¾¤ä¸­ä¸ºä»€ä¹ˆè¦æœ‰ä¸»èŠ‚ç‚¹ï¼Ÿ åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œæœ‰äº›ä¸šåŠ¡é€»è¾‘åªéœ€è¦é›†ç¾¤ä¸­çš„æŸä¸€å°æœºå™¨è¿›è¡Œæ‰§è¡Œï¼Œå…¶ä»–çš„æœºå™¨å¯ä»¥å…±äº«è¿™ä¸ªç»“æœï¼Œè¿™æ ·å¯ä»¥å¤§å¤§ å‡å°‘é‡å¤è®¡ç®—ï¼Œæé«˜æ€§èƒ½ï¼Œæ‰€ä»¥å°±éœ€è¦ä¸»èŠ‚ç‚¹ã€‚ 162. é›†ç¾¤ä¸­æœ‰ 3 å°æœåŠ¡å™¨ï¼Œå…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹å®•æœºï¼Œè¿™ä¸ªæ—¶å€™ zookeeper è¿˜å¯ä»¥ä½¿ç”¨å—ï¼Ÿ å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œå•æ•°æœåŠ¡å™¨åªè¦æ²¡è¶…è¿‡ä¸€åŠçš„æœåŠ¡å™¨å®•æœºå°±å¯ä»¥ç»§ç»­ä½¿ç”¨ã€‚ 163. è¯´ä¸€ä¸‹ zookeeper çš„é€šçŸ¥æœºåˆ¶ï¼Ÿ å®¢æˆ·ç«¯ç«¯ä¼šå¯¹æŸä¸ª znode å»ºç«‹ä¸€ä¸ª watcher äº‹ä»¶ï¼Œå½“è¯¥ znode å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¿™äº›å®¢æˆ·ç«¯ä¼šæ”¶åˆ° zookeeper çš„é€š çŸ¥ï¼Œç„¶åå®¢æˆ·ç«¯å¯ä»¥æ ¹æ® znode å˜åŒ–æ¥åšå‡ºä¸šåŠ¡ä¸Šçš„æ”¹å˜ã€‚\nMySQL 164. æ•°æ®åº“çš„ä¸‰èŒƒå¼æ˜¯ä»€ä¹ˆï¼Ÿ ç¬¬ä¸€èŒƒå¼ï¼šå¼ºè°ƒçš„æ˜¯åˆ—çš„åŸå­æ€§ï¼Œå³æ•°æ®åº“è¡¨çš„æ¯ä¸€åˆ—éƒ½æ˜¯ä¸å¯åˆ†å‰²çš„åŸå­æ•°æ®é¡¹ã€‚ ç¬¬äºŒèŒƒå¼ï¼šè¦æ±‚å®ä½“çš„å±æ€§å®Œå…¨ä¾èµ–äºä¸»å…³é”®å­—ã€‚æ‰€è°“å®Œå…¨ä¾èµ–æ˜¯æŒ‡ä¸èƒ½å­˜åœ¨ä»…ä¾èµ–ä¸»å…³é”®å­—ä¸€éƒ¨åˆ†çš„å±æ€§ã€‚ ç¬¬ä¸‰èŒƒå¼ï¼šä»»ä½•éä¸»å±æ€§ä¸ä¾èµ–äºå…¶å®ƒéä¸»å±æ€§ã€‚ 165. ä¸€å¼ è‡ªå¢è¡¨é‡Œé¢æ€»å…±æœ‰ 7 æ¡æ•°æ®ï¼Œåˆ é™¤äº†æœ€å 2 æ¡æ•°æ®ï¼Œé‡å¯ MySQL æ•°æ®åº“ï¼Œåˆæ’å…¥ äº†ä¸€æ¡æ•°æ®ï¼Œæ­¤æ—¶ id æ˜¯å‡ ï¼Ÿ è¡¨ç±»å‹å¦‚æœæ˜¯ MyISAM ï¼Œé‚£ id å°±æ˜¯ 8 ã€‚\rè¡¨ç±»å‹å¦‚æœæ˜¯ InnoDBï¼Œé‚£ id å°±æ˜¯ 6 ã€‚ InnoDB è¡¨åªä¼šæŠŠè‡ªå¢ä¸»é”®çš„æœ€å¤§ id è®°å½•åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥é‡å¯ä¹‹åä¼šå¯¼è‡´æœ€å¤§ id ä¸¢å¤±ã€‚\n166. å¦‚ä½•è·å–å½“å‰æ•°æ®åº“ç‰ˆæœ¬ï¼Ÿ ä½¿ç”¨ select version() è·å–å½“å‰ MySQL æ•°æ®åº“ç‰ˆæœ¬ã€‚\n167. è¯´ä¸€ä¸‹ ACID æ˜¯ä»€ä¹ˆï¼Ÿ Atomicityï¼ˆåŸå­æ€§ï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡ï¼ˆtransactionï¼‰ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œæˆ–è€…å…¨éƒ¨å®Œæˆï¼Œæˆ–è€…å…¨éƒ¨ä¸å®Œæˆï¼Œä¸ä¼šç»“æŸåœ¨\rä¸­é—´æŸä¸ªç¯èŠ‚ã€‚äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œä¼šè¢«æ¢å¤ï¼ˆRollbackï¼‰åˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œå°±åƒè¿™ä¸ªäº‹åŠ¡ä»æ¥\ræ²¡æœ‰æ‰§è¡Œè¿‡ä¸€æ ·ã€‚å³ï¼Œäº‹åŠ¡ä¸å¯åˆ†å‰²ã€ä¸å¯çº¦ç®€ã€‚\rConsistencyï¼ˆä¸€è‡´æ€§ï¼‰ï¼šåœ¨äº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œäº‹åŠ¡ç»“æŸä»¥åï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§æ²¡æœ‰è¢«ç ´åã€‚è¿™è¡¨ç¤ºå†™å…¥çš„èµ„æ–™å¿…\ré¡»å®Œå…¨ç¬¦åˆæ‰€æœ‰çš„é¢„è®¾çº¦æŸã€è§¦å‘å™¨ã€çº§è”å›æ»šç­‰ã€‚\rIsolationï¼ˆéš”ç¦»æ€§ï¼‰ï¼šæ•°æ®åº“å…è®¸å¤šä¸ªå¹¶å‘äº‹åŠ¡åŒæ—¶å¯¹å…¶æ•°æ®è¿›è¡Œè¯»å†™å’Œä¿®æ”¹çš„èƒ½åŠ›ï¼Œéš”ç¦»æ€§å¯ä»¥é˜²æ­¢å¤šä¸ªäº‹\råŠ¡å¹¶å‘æ‰§è¡Œæ—¶ç”±äºäº¤å‰æ‰§è¡Œè€Œå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´ã€‚äº‹åŠ¡éš”ç¦»åˆ†ä¸ºä¸åŒçº§åˆ«ï¼ŒåŒ…æ‹¬è¯»æœªæäº¤ï¼ˆRead\runcommittedï¼‰ã€è¯»æäº¤ï¼ˆread committedï¼‰ã€å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰å’Œä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰ã€‚\rDurabilityï¼ˆæŒä¹…æ€§ï¼‰ï¼šäº‹åŠ¡å¤„ç†ç»“æŸåï¼Œå¯¹æ•°æ®çš„ä¿®æ”¹å°±æ˜¯æ°¸ä¹…çš„ï¼Œå³ä¾¿ç³»ç»Ÿæ•…éšœä¹Ÿä¸ä¼šä¸¢å¤±ã€‚ 168. char å’Œ varchar çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ char(n) ï¼šå›ºå®šé•¿åº¦ç±»å‹ï¼Œæ¯”å¦‚è®¢é˜… char(10)ï¼Œå½“ä½ è¾“å…¥\u0026#34;abc\u0026#34;ä¸‰ä¸ªå­—ç¬¦çš„æ—¶å€™ï¼Œå®ƒä»¬å çš„ç©ºé—´è¿˜æ˜¯ 10 ä¸ªå­—\rèŠ‚ï¼Œå…¶ä»– 7 ä¸ªæ˜¯ç©ºå­—èŠ‚ã€‚ chat ä¼˜ç‚¹ï¼šæ•ˆç‡é«˜ï¼›ç¼ºç‚¹ï¼šå ç”¨ç©ºé—´ï¼›é€‚ç”¨åœºæ™¯ï¼šå­˜å‚¨å¯†ç çš„ md5 å€¼ï¼Œå›ºå®šé•¿åº¦çš„ï¼Œä½¿ç”¨ char éå¸¸åˆé€‚ã€‚\nvarchar(n) ï¼šå¯å˜é•¿åº¦ï¼Œå­˜å‚¨çš„å€¼æ˜¯æ¯ä¸ªå€¼å ç”¨çš„å­—èŠ‚å†åŠ ä¸Šä¸€ä¸ªç”¨æ¥è®°å½•å…¶é•¿åº¦çš„å­—èŠ‚çš„é•¿åº¦ã€‚ æ‰€ä»¥ï¼Œä»ç©ºé—´ä¸Šè€ƒè™‘ varcahr æ¯”è¾ƒåˆé€‚ï¼›ä»æ•ˆç‡ä¸Šè€ƒè™‘ char æ¯”è¾ƒåˆé€‚ï¼ŒäºŒè€…ä½¿ç”¨éœ€è¦æƒè¡¡ã€‚\n169. float å’Œ double çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ float æœ€å¤šå¯ä»¥å­˜å‚¨ 8 ä½çš„åè¿›åˆ¶æ•°ï¼Œå¹¶åœ¨å†…å­˜ä¸­å  4 å­—èŠ‚ã€‚\rdouble æœ€å¯å¯ä»¥å­˜å‚¨ 16 ä½çš„åè¿›åˆ¶æ•°ï¼Œå¹¶åœ¨å†…å­˜ä¸­å  8 å­—èŠ‚ã€‚ 170. MySQL çš„å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å†…è¿æ¥å…³é”®å­—ï¼šinner joinï¼›å·¦è¿æ¥ï¼šleft joinï¼›å³è¿æ¥ï¼šright joinã€‚\nå†…è¿æ¥æ˜¯æŠŠåŒ¹é…çš„å…³è”æ•°æ®æ˜¾ç¤ºå‡ºæ¥ï¼›å·¦è¿æ¥æ˜¯å·¦è¾¹çš„è¡¨å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ï¼Œå³è¾¹çš„è¡¨æ˜¾ç¤ºå‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›å³è¿æ¥æ­£ å¥½ç›¸åã€‚\n171. MySQL ç´¢å¼•æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ ç´¢å¼•æ˜¯æ»¡è¶³æŸç§ç‰¹å®šæŸ¥æ‰¾ç®—æ³•çš„æ•°æ®ç»“æ„ï¼Œè€Œè¿™äº›æ•°æ®ç»“æ„ä¼šä»¥æŸç§æ–¹å¼æŒ‡å‘æ•°æ®ï¼Œä»è€Œå®ç°é«˜æ•ˆæŸ¥æ‰¾æ•°æ®ã€‚ å…·ä½“æ¥è¯´ MySQL ä¸­çš„ç´¢å¼•ï¼Œä¸åŒçš„æ•°æ®å¼•æ“å®ç°æœ‰æ‰€ä¸åŒï¼Œä½†ç›®å‰ä¸»æµçš„æ•°æ®åº“å¼•æ“çš„ç´¢å¼•éƒ½æ˜¯ B+ æ ‘å®ç°çš„ï¼ŒB+ æ ‘çš„æœç´¢æ•ˆç‡ï¼Œå¯ä»¥åˆ°è¾¾äºŒåˆ†æ³•çš„æ€§èƒ½ï¼Œæ‰¾åˆ°æ•°æ®åŒºåŸŸä¹‹åå°±æ‰¾åˆ°äº†å®Œæ•´çš„æ•°æ®ç»“æ„äº†ï¼Œæ‰€æœ‰ç´¢å¼•çš„æ€§èƒ½ä¹Ÿæ˜¯æ›´å¥½ çš„ã€‚\n172. æ€ä¹ˆéªŒè¯ MySQL çš„ç´¢å¼•æ˜¯å¦æ»¡è¶³éœ€æ±‚ï¼Ÿ ä½¿ç”¨ explain æŸ¥çœ‹ SQL æ˜¯å¦‚ä½•æ‰§è¡ŒæŸ¥è¯¢è¯­å¥çš„ï¼Œä»è€Œåˆ†æä½ çš„ç´¢å¼•æ˜¯å¦æ»¡è¶³éœ€æ±‚ã€‚\nexplain è¯­æ³•ï¼šexplain select * from table where type=1ã€‚\n173. è¯´ä¸€ä¸‹æ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»ï¼Ÿ MySQL çš„äº‹åŠ¡éš”ç¦»æ˜¯åœ¨ MySQL. ini é…ç½®æ–‡ä»¶é‡Œæ·»åŠ çš„ï¼Œåœ¨æ–‡ä»¶çš„æœ€åæ·»åŠ ï¼š\ntransaction-isolation = REPEATABLE-READ å¯ç”¨çš„é…ç½®å€¼ï¼šREAD-UNCOMMITTEDã€READ-COMMITTEDã€REPEATABLE-READã€SERIALIZABLEã€‚\nREAD-UNCOMMITTEDï¼šæœªæäº¤è¯»ï¼Œæœ€ä½éš”ç¦»çº§åˆ«ã€äº‹åŠ¡æœªæäº¤å‰ï¼Œå°±å¯è¢«å…¶ä»–äº‹åŠ¡è¯»å–ï¼ˆä¼šå‡ºç°å¹»è¯»ã€è„\rè¯»ã€ä¸å¯é‡å¤è¯»ï¼‰ã€‚\rREAD-COMMITTEDï¼šæäº¤è¯»ï¼Œä¸€ä¸ªäº‹åŠ¡æäº¤åæ‰èƒ½è¢«å…¶ä»–äº‹åŠ¡è¯»å–åˆ°ï¼ˆä¼šé€ æˆå¹»è¯»ã€ä¸å¯é‡å¤è¯»ï¼‰ã€‚\rREPEATABLE-READï¼šå¯é‡å¤è¯»ï¼Œé»˜è®¤çº§åˆ«ï¼Œä¿è¯å¤šæ¬¡è¯»å–åŒä¸€ä¸ªæ•°æ®æ—¶ï¼Œå…¶å€¼éƒ½å’Œäº‹åŠ¡å¼€å§‹æ—¶å€™çš„å†…å®¹æ˜¯ä¸€\rè‡´ï¼Œç¦æ­¢è¯»å–åˆ°åˆ«çš„äº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼ˆä¼šé€ æˆå¹»è¯»ï¼‰ã€‚\rSERIALIZABLEï¼šåºåˆ—åŒ–ï¼Œä»£ä»·æœ€é«˜æœ€å¯é çš„éš”ç¦»çº§åˆ«ï¼Œè¯¥éš”ç¦»çº§åˆ«èƒ½é˜²æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ã€‚ è„è¯» ï¼šè¡¨ç¤ºä¸€ä¸ªäº‹åŠ¡èƒ½å¤Ÿè¯»å–å¦ä¸€ä¸ªäº‹åŠ¡ä¸­è¿˜æœªæäº¤çš„æ•°æ®ã€‚æ¯”å¦‚ï¼ŒæŸä¸ªäº‹åŠ¡å°è¯•æ’å…¥è®°å½• Aï¼Œæ­¤æ—¶è¯¥äº‹åŠ¡è¿˜æœªæ äº¤ï¼Œç„¶åå¦ä¸€ä¸ªäº‹åŠ¡å°è¯•è¯»å–åˆ°äº†è®°å½• Aã€‚\nä¸å¯é‡å¤è¯» ï¼šæ˜¯æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡å†…ï¼Œå¤šæ¬¡è¯»åŒä¸€æ•°æ®ã€‚\nå¹»è¯» ï¼šæŒ‡åŒä¸€ä¸ªäº‹åŠ¡å†…å¤šæ¬¡æŸ¥è¯¢è¿”å›çš„ç»“æœé›†ä¸ä¸€æ ·ã€‚æ¯”å¦‚åŒä¸€ä¸ªäº‹åŠ¡ A ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ—¶å€™æœ‰ n æ¡è®°å½•ï¼Œä½†æ˜¯ç¬¬äºŒæ¬¡ åŒç­‰æ¡ä»¶ä¸‹æŸ¥è¯¢å´æœ‰ n+1 æ¡è®°å½•ï¼Œè¿™å°±å¥½åƒäº§ç”Ÿäº†å¹»è§‰ã€‚å‘ç”Ÿå¹»è¯»çš„åŸå› ä¹Ÿæ˜¯å¦å¤–ä¸€ä¸ªäº‹åŠ¡æ–°å¢æˆ–è€…åˆ é™¤æˆ–è€…ä¿®æ”¹ äº†ç¬¬ä¸€ä¸ªäº‹åŠ¡ç»“æœé›†é‡Œé¢çš„æ•°æ®ï¼ŒåŒä¸€ä¸ªè®°å½•çš„æ•°æ®å†…å®¹è¢«ä¿®æ”¹äº†ï¼Œæ‰€æœ‰æ•°æ®è¡Œçš„è®°å½•å°±å˜å¤šæˆ–è€…å˜å°‘äº†ã€‚\n174. è¯´ä¸€ä¸‹ MySQL å¸¸ç”¨çš„å¼•æ“ï¼Ÿ InnoDB å¼•æ“ï¼šmysql 5.1 åé»˜è®¤çš„æ•°æ®åº“å¼•æ“ï¼Œæä¾›äº†å¯¹æ•°æ®åº“ acid äº‹åŠ¡çš„æ”¯æŒï¼Œå¹¶ä¸”è¿˜æä¾›äº†è¡Œçº§é”å’Œå¤–\ré”®çš„çº¦æŸï¼Œå®ƒçš„è®¾è®¡çš„ç›®æ ‡å°±æ˜¯å¤„ç†å¤§æ•°æ®å®¹é‡çš„æ•°æ®åº“ç³»ç»Ÿã€‚MySQL è¿è¡Œçš„æ—¶å€™ï¼ŒInnoDB ä¼šåœ¨å†…å­˜ä¸­å»ºç«‹\rç¼“å†²æ± ï¼Œç”¨äºç¼“å†²æ•°æ®å’Œç´¢å¼•ã€‚ä½†æ˜¯è¯¥å¼•æ“æ˜¯ä¸æ”¯æŒå…¨æ–‡æœç´¢ï¼ŒåŒæ—¶å¯åŠ¨ä¹Ÿæ¯”è¾ƒçš„æ…¢ï¼Œå®ƒæ˜¯ä¸ä¼šä¿å­˜è¡¨çš„è¡Œæ•° çš„ï¼Œæ‰€ä»¥å½“è¿›è¡Œ select count(*) from table æŒ‡ä»¤çš„æ—¶å€™ï¼Œéœ€è¦è¿›è¡Œæ‰«æå…¨è¡¨ã€‚ç”±äºé”çš„ç²’åº¦å°ï¼Œå†™æ“ä½œæ˜¯ä¸ä¼š\ré”å®šå…¨è¡¨çš„,æ‰€ä»¥åœ¨å¹¶å‘åº¦è¾ƒé«˜çš„åœºæ™¯ä¸‹ä½¿ç”¨ä¼šæå‡æ•ˆç‡çš„ã€‚\rMyIASM å¼•æ“ï¼šä¸æä¾›äº‹åŠ¡çš„æ”¯æŒï¼Œä¹Ÿä¸æ”¯æŒè¡Œçº§é”å’Œå¤–é”®ã€‚å› æ­¤å½“æ‰§è¡Œæ’å…¥å’Œæ›´æ–°è¯­å¥æ—¶ï¼Œå³æ‰§è¡Œå†™æ“ä½œçš„\ræ—¶å€™éœ€è¦é”å®šè¿™ä¸ªè¡¨ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´æ•ˆç‡ä¼šé™ä½ã€‚ä¸è¿‡å’Œ InnoDB ä¸åŒçš„æ˜¯ï¼ŒMyIASM å¼•æ“æ˜¯ä¿å­˜äº†è¡¨çš„è¡Œæ•°ï¼Œ\räºæ˜¯å½“è¿›è¡Œ select count(*) from table è¯­å¥æ—¶ï¼Œå¯ä»¥ç›´æ¥çš„è¯»å–å·²ç»ä¿å­˜çš„å€¼è€Œä¸éœ€è¦è¿›è¡Œæ‰«æå…¨è¡¨ã€‚æ‰€ä»¥ï¼Œ\rå¦‚æœè¡¨çš„è¯»æ“ä½œè¿œè¿œå¤šäºå†™æ“ä½œæ—¶ï¼Œå¹¶ä¸”ä¸éœ€è¦äº‹åŠ¡çš„æ”¯æŒçš„ï¼Œå¯ä»¥å°† MyIASM ä½œä¸ºæ•°æ®åº“å¼•æ“çš„é¦–é€‰ã€‚ 175. è¯´ä¸€ä¸‹ MySQL çš„è¡Œé”å’Œè¡¨é”ï¼Ÿ MyISAM åªæ”¯æŒè¡¨é”ï¼ŒInnoDB æ”¯æŒè¡¨é”å’Œè¡Œé”ï¼Œé»˜è®¤ä¸ºè¡Œé”ã€‚\nè¡¨çº§é”ï¼šå¼€é”€å°ï¼ŒåŠ é”å¿«ï¼Œä¸ä¼šå‡ºç°æ­»é”ã€‚é”å®šç²’åº¦å¤§ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘é‡æœ€ä½ã€‚\rè¡Œçº§é”ï¼šå¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼Œä¼šå‡ºç°æ­»é”ã€‚é”åŠ›åº¦å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡å°ï¼Œå¹¶å‘åº¦æœ€é«˜ã€‚ 176. è¯´ä¸€ä¸‹ä¹è§‚é”å’Œæ‚²è§‚é”ï¼Ÿ ä¹è§‚é”ï¼šæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æäº¤æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸ é—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ã€‚ æ‚²è§‚é”ï¼šæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ® å°±ä¼šé˜»æ­¢ï¼Œç›´åˆ°è¿™ä¸ªé”è¢«é‡Šæ”¾ã€‚ æ•°æ®åº“çš„ä¹è§‚é”éœ€è¦è‡ªå·±å®ç°ï¼Œåœ¨è¡¨é‡Œé¢æ·»åŠ ä¸€ä¸ª version å­—æ®µï¼Œæ¯æ¬¡ä¿®æ”¹æˆåŠŸå€¼åŠ  1 ï¼Œè¿™æ ·æ¯æ¬¡ä¿®æ”¹çš„æ—¶å€™å…ˆå¯¹æ¯” ä¸€ä¸‹ï¼Œè‡ªå·±æ‹¥æœ‰çš„ version å’Œæ•°æ®åº“ç°åœ¨çš„ version æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸ä¸€è‡´å°±ä¸ä¿®æ”¹ï¼Œè¿™æ ·å°±å®ç°äº†ä¹è§‚é”ã€‚\n177. MySQL é—®é¢˜æ’æŸ¥éƒ½æœ‰å“ªäº›æ‰‹æ®µï¼Ÿ ä½¿ç”¨ show processlist å‘½ä»¤æŸ¥çœ‹å½“å‰æ‰€æœ‰è¿æ¥ä¿¡æ¯ã€‚\rä½¿ç”¨ explain å‘½ä»¤æŸ¥è¯¢ SQL è¯­å¥æ‰§è¡Œè®¡åˆ’ã€‚\rå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ŒæŸ¥çœ‹æ…¢æŸ¥è¯¢çš„ SQLã€‚ 178. å¦‚ä½•åš MySQL çš„æ€§èƒ½ä¼˜åŒ–ï¼Ÿ ä¸ºæœç´¢å­—æ®µåˆ›å»ºç´¢å¼•ã€‚ é¿å…ä½¿ç”¨ select *ï¼Œåˆ—å‡ºéœ€è¦æŸ¥è¯¢çš„å­—æ®µã€‚\rå‚ç›´åˆ†å‰²åˆ†è¡¨ã€‚\ré€‰æ‹©æ­£ç¡®çš„å­˜å‚¨å¼•æ“ã€‚ Redis 179. Redis æ˜¯ä»€ä¹ˆï¼Ÿéƒ½æœ‰å“ªäº›ä½¿ç”¨åœºæ™¯ï¼Ÿ Redis æ˜¯ä¸€ä¸ªä½¿ç”¨ C è¯­è¨€å¼€å‘çš„é«˜é€Ÿç¼“å­˜æ•°æ®åº“ã€‚\nRedis ä½¿ç”¨åœºæ™¯ï¼š\nè®°å½•å¸–å­ç‚¹èµæ•°ã€ç‚¹å‡»æ•°ã€è¯„è®ºæ•°ï¼›\rç¼“å­˜è¿‘æœŸçƒ­å¸–ï¼›\rç¼“å­˜æ–‡ç« è¯¦æƒ…ä¿¡æ¯ï¼›\rè®°å½•ç”¨æˆ·ä¼šè¯ä¿¡æ¯ã€‚ 180. Redis æœ‰å“ªäº›åŠŸèƒ½ï¼Ÿ æ•°æ®ç¼“å­˜åŠŸèƒ½ åˆ†å¸ƒå¼é”çš„åŠŸèƒ½ æ”¯æŒæ•°æ®æŒä¹…åŒ– æ”¯æŒäº‹åŠ¡ æ”¯æŒæ¶ˆæ¯é˜Ÿåˆ— 181. Redis å’Œ memcache æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å­˜å‚¨æ–¹å¼ä¸åŒï¼šmemcache æŠŠæ•°æ®å…¨éƒ¨å­˜åœ¨å†…å­˜ä¹‹ä¸­ï¼Œæ–­ç”µåä¼šæŒ‚æ‰ï¼Œæ•°æ®ä¸èƒ½è¶…è¿‡å†…å­˜å¤§å°ï¼›Redis æœ‰éƒ¨ä»½\rå­˜åœ¨ç¡¬ç›˜ä¸Šï¼Œè¿™æ ·èƒ½ä¿è¯æ•°æ®çš„æŒä¹…æ€§ã€‚\ræ•°æ®æ”¯æŒç±»å‹ï¼šmemcache å¯¹æ•°æ®ç±»å‹æ”¯æŒç›¸å¯¹ç®€å•ï¼›Redis æœ‰å¤æ‚çš„æ•°æ®ç±»å‹ã€‚\rä½¿ç”¨åº•å±‚æ¨¡å‹ä¸åŒï¼šå®ƒä»¬ä¹‹é—´åº•å±‚å®ç°æ–¹å¼ï¼Œä»¥åŠä¸å®¢æˆ·ç«¯ä¹‹é—´é€šä¿¡çš„åº”ç”¨åè®®ä¸ä¸€æ ·ï¼ŒRedis è‡ªå·±æ„å»ºäº† vm\ræœºåˆ¶ï¼Œå› ä¸ºä¸€èˆ¬çš„ç³»ç»Ÿè°ƒç”¨ç³»ç»Ÿå‡½æ•°çš„è¯ï¼Œä¼šæµªè´¹ä¸€å®šçš„æ—¶é—´å»ç§»åŠ¨å’Œè¯·æ±‚ã€‚\rvalue å€¼å¤§å°ä¸åŒï¼šRedis æœ€å¤§å¯ä»¥è¾¾åˆ° 512mbï¼›memcache åªæœ‰ 1mbã€‚ 182. Redis ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„ï¼Ÿ å› ä¸º cpu ä¸æ˜¯ Redis çš„ç“¶é¢ˆï¼ŒRedis çš„ç“¶é¢ˆæœ€æœ‰å¯èƒ½æ˜¯æœºå™¨å†…å­˜æˆ–è€…ç½‘ç»œå¸¦å®½ã€‚æ—¢ç„¶å•çº¿ç¨‹å®¹æ˜“å®ç°ï¼Œè€Œä¸” cpu åˆ ä¸ä¼šæˆä¸ºç“¶é¢ˆï¼Œé‚£å°±é¡ºç†æˆç« åœ°é‡‡ç”¨å•çº¿ç¨‹çš„æ–¹æ¡ˆäº†ã€‚\nå…³äº Redis çš„æ€§èƒ½ï¼Œå®˜æ–¹ç½‘ç«™ä¹Ÿæœ‰ï¼Œæ™®é€šç¬”è®°æœ¬è½»æ¾å¤„ç†æ¯ç§’å‡ åä¸‡çš„è¯·æ±‚ã€‚\nè€Œä¸”å•çº¿ç¨‹å¹¶ä¸ä»£è¡¨å°±æ…¢ nginx å’Œ nodejs ä¹Ÿéƒ½æ˜¯é«˜æ€§èƒ½å•çº¿ç¨‹çš„ä»£è¡¨ã€‚\n183. ä»€ä¹ˆæ˜¯ç¼“å­˜ç©¿é€ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ ç¼“å­˜ç©¿é€ï¼šæŒ‡æŸ¥è¯¢ä¸€ä¸ªä¸€å®šä¸å­˜åœ¨çš„æ•°æ®ï¼Œç”±äºç¼“å­˜æ˜¯ä¸å‘½ä¸­æ—¶éœ€è¦ä»æ•°æ®åº“æŸ¥è¯¢ï¼ŒæŸ¥ä¸åˆ°æ•°æ®åˆ™ä¸å†™å…¥ç¼“å­˜ï¼Œè¿™å°† å¯¼è‡´è¿™ä¸ªä¸å­˜åœ¨çš„æ•°æ®æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ°æ•°æ®åº“å»æŸ¥è¯¢ï¼Œé€ æˆç¼“å­˜ç©¿é€ã€‚ è§£å†³æ–¹æ¡ˆï¼šæœ€ç®€å•ç²—æš´çš„æ–¹æ³•å¦‚æœä¸€ä¸ªæŸ¥è¯¢è¿”å›çš„æ•°æ®ä¸ºç©ºï¼ˆä¸ç®¡æ˜¯æ•°æ®ä¸å­˜åœ¨ï¼Œè¿˜æ˜¯ç³»ç»Ÿæ•…éšœï¼‰ï¼Œæˆ‘ä»¬å°±æŠŠè¿™ä¸ªç©º ç»“æœè¿›è¡Œç¼“å­˜ï¼Œä½†å®ƒçš„è¿‡æœŸæ—¶é—´ä¼šå¾ˆçŸ­ï¼Œæœ€é•¿ä¸è¶…è¿‡äº”åˆ†é’Ÿã€‚ 184. Redis æ”¯æŒçš„æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Ÿ Redis æ”¯æŒçš„æ•°æ®ç±»å‹ï¼šstringï¼ˆå­—ç¬¦ä¸²ï¼‰ã€listï¼ˆåˆ—è¡¨ï¼‰ã€hashï¼ˆå­—å…¸ï¼‰ã€setï¼ˆé›†åˆï¼‰ã€zsetï¼ˆæœ‰åºé›†åˆï¼‰ã€‚\n185. Redis æ”¯æŒçš„ Java å®¢æˆ·ç«¯éƒ½æœ‰å“ªäº›ï¼Ÿ æ”¯æŒçš„ Java å®¢æˆ·ç«¯æœ‰ Redissonã€jedisã€lettuce ç­‰ã€‚\n186. jedis å’Œ Redisson æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ jedisï¼šæä¾›äº†æ¯”è¾ƒå…¨é¢çš„ Redis å‘½ä»¤çš„æ”¯æŒã€‚\rRedissonï¼šå®ç°äº†åˆ†å¸ƒå¼å’Œå¯æ‰©å±•çš„ Java æ•°æ®ç»“æ„ï¼Œä¸ jedis ç›¸æ¯” Redisson çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸æ”¯æŒæ’åºã€\räº‹åŠ¡ã€ç®¡é“ã€åˆ†åŒºç­‰ Redis ç‰¹æ€§ã€‚ 187. æ€ä¹ˆä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§ï¼Ÿ åˆç†è®¾ç½®ç¼“å­˜çš„è¿‡æœŸæ—¶é—´ã€‚ æ–°å¢ã€æ›´æ”¹ã€åˆ é™¤æ•°æ®åº“æ“ä½œæ—¶åŒæ­¥æ›´æ–° Redisï¼Œå¯ä»¥ä½¿ç”¨äº‹ç‰©æœºåˆ¶æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚ 188. Redis æŒä¹…åŒ–æœ‰å‡ ç§æ–¹å¼ï¼Ÿ Redis çš„æŒä¹…åŒ–æœ‰ä¸¤ç§æ–¹å¼ï¼Œæˆ–è€…è¯´æœ‰ä¸¤ç§ç­–ç•¥ï¼š\nRDBï¼ˆRedis Databaseï¼‰ï¼šæŒ‡å®šçš„æ—¶é—´é—´éš”èƒ½å¯¹ä½ çš„æ•°æ®è¿›è¡Œå¿«ç…§å­˜å‚¨ã€‚\rAOFï¼ˆAppend Only Fileï¼‰ï¼šæ¯ä¸€ä¸ªæ”¶åˆ°çš„å†™å‘½ä»¤éƒ½é€šè¿‡writeå‡½æ•°è¿½åŠ åˆ°æ–‡ä»¶ä¸­ã€‚ 189. Redis æ€ä¹ˆå®ç°åˆ†å¸ƒå¼é”ï¼Ÿ Redis åˆ†å¸ƒå¼é”å…¶å®å°±æ˜¯åœ¨ç³»ç»Ÿé‡Œé¢å ä¸€ä¸ªâ€œå‘â€ï¼Œå…¶ä»–ç¨‹åºä¹Ÿè¦å â€œå‘â€çš„æ—¶å€™ï¼Œå ç”¨æˆåŠŸäº†å°±å¯ä»¥ç»§ç»­æ‰§è¡Œï¼Œå¤±è´¥äº† å°±åªèƒ½æ”¾å¼ƒæˆ–ç¨åé‡è¯•ã€‚\nå å‘ä¸€èˆ¬ä½¿ç”¨ setnx(set if not exists)æŒ‡ä»¤ï¼Œåªå…è®¸è¢«ä¸€ä¸ªç¨‹åºå æœ‰ï¼Œä½¿ç”¨å®Œè°ƒç”¨ del é‡Šæ”¾é”ã€‚\n190. Redis åˆ†å¸ƒå¼é”æœ‰ä»€ä¹ˆç¼ºé™·ï¼Ÿ Redis åˆ†å¸ƒå¼é”ä¸èƒ½è§£å†³è¶…æ—¶çš„é—®é¢˜ï¼Œåˆ†å¸ƒå¼é”æœ‰ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œç¨‹åºçš„æ‰§è¡Œå¦‚æœè¶…å‡ºäº†é”çš„è¶…æ—¶æ—¶é—´å°±ä¼šå‡ºç°é—® é¢˜ã€‚\n191. Redis å¦‚ä½•åšå†…å­˜ä¼˜åŒ–ï¼Ÿ å°½é‡ä½¿ç”¨ Redis çš„æ•£åˆ—è¡¨ï¼ŒæŠŠç›¸å…³çš„ä¿¡æ¯æ”¾åˆ°æ•£åˆ—è¡¨é‡Œé¢å­˜å‚¨ï¼Œè€Œä¸æ˜¯æŠŠæ¯ä¸ªå­—æ®µå•ç‹¬å­˜å‚¨ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆçš„å‡å°‘å†… å­˜ä½¿ç”¨ã€‚æ¯”å¦‚å°† Web ç³»ç»Ÿçš„ç”¨æˆ·å¯¹è±¡ï¼Œåº”è¯¥æ”¾åˆ°æ•£åˆ—è¡¨é‡Œé¢å†æ•´ä½“å­˜å‚¨åˆ° Redisï¼Œè€Œä¸æ˜¯æŠŠç”¨æˆ·çš„å§“åã€å¹´é¾„ã€å¯† ç ã€é‚®ç®±ç­‰å­—æ®µåˆ†åˆ«è®¾ç½® key è¿›è¡Œå­˜å‚¨ã€‚\n192. Redis æ·˜æ±°ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ volatile-lruï¼šä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®é›†ï¼ˆserver. db[i]. expiresï¼‰ä¸­æŒ‘é€‰æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ®æ·˜æ±°ã€‚\rvolatile-ttlï¼šä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®é›†ï¼ˆserver. db[i]. expiresï¼‰ä¸­æŒ‘é€‰å°†è¦è¿‡æœŸçš„æ•°æ®æ·˜æ±°ã€‚\rvolatile-randomï¼šä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„æ•°æ®é›†ï¼ˆserver. db[i]. expiresï¼‰ä¸­ä»»æ„é€‰æ‹©æ•°æ®æ·˜æ±°ã€‚\rallkeys-lruï¼šä»æ•°æ®é›†ï¼ˆserver. db[i]. dictï¼‰ä¸­æŒ‘é€‰æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ®æ·˜æ±°ã€‚\rallkeys-randomï¼šä»æ•°æ®é›†ï¼ˆserver. db[i]. dictï¼‰ä¸­ä»»æ„é€‰æ‹©æ•°æ®æ·˜æ±°ã€‚\rno-envictionï¼ˆé©±é€ï¼‰ï¼šç¦æ­¢é©±é€æ•°æ®ã€‚ 193. Redis å¸¸è§çš„æ€§èƒ½é—®é¢˜æœ‰å“ªäº›ï¼Ÿè¯¥å¦‚ä½•è§£å†³ï¼Ÿ ä¸»æœåŠ¡å™¨å†™å†…å­˜å¿«ç…§ï¼Œä¼šé˜»å¡ä¸»çº¿ç¨‹çš„å·¥ä½œï¼Œå½“å¿«ç…§æ¯”è¾ƒå¤§æ—¶å¯¹æ€§èƒ½å½±å“æ˜¯éå¸¸å¤§çš„ï¼Œä¼šé—´æ–­æ€§æš‚åœæœåŠ¡ï¼Œæ‰€ ä»¥ä¸»æœåŠ¡å™¨æœ€å¥½ä¸è¦å†™å†…å­˜å¿«ç…§ã€‚ Redis ä¸»ä»å¤åˆ¶çš„æ€§èƒ½é—®é¢˜ï¼Œä¸ºäº†ä¸»ä»å¤åˆ¶çš„é€Ÿåº¦å’Œè¿æ¥çš„ç¨³å®šæ€§ï¼Œä¸»ä»åº“æœ€å¥½åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…ã€‚ JVM 194. è¯´ä¸€ä¸‹ JVM çš„ä¸»è¦ç»„æˆéƒ¨åˆ†ï¼ŸåŠå…¶ä½œç”¨ï¼Ÿ ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰\rè¿è¡Œæ—¶æ•°æ®åŒºï¼ˆRuntime Data Areaï¼‰\ræ‰§è¡Œå¼•æ“ï¼ˆExecution Engineï¼‰\ræœ¬åœ°åº“æ¥å£ï¼ˆNative Interfaceï¼‰ ç»„ä»¶çš„ä½œç”¨ï¼š é¦–å…ˆé€šè¿‡ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰ä¼šæŠŠ Java ä»£ç è½¬æ¢æˆå­—èŠ‚ç ï¼Œè¿è¡Œæ—¶æ•°æ®åŒºï¼ˆRuntime Data Areaï¼‰å†æŠŠå­—èŠ‚ç åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè€Œå­—èŠ‚ç æ–‡ä»¶åªæ˜¯ JVM çš„ä¸€å¥—æŒ‡ä»¤é›†è§„èŒƒï¼Œå¹¶ä¸èƒ½ç›´æ¥äº¤ç»™åº•å±‚æ“ä½œç³»ç»Ÿå»æ‰§ è¡Œï¼Œå› æ­¤éœ€è¦ç‰¹å®šçš„å‘½ä»¤è§£æå™¨æ‰§è¡Œå¼•æ“ï¼ˆExecution Engineï¼‰ï¼Œå°†å­—èŠ‚ç ç¿»è¯‘æˆåº•å±‚ç³»ç»ŸæŒ‡ä»¤ï¼Œå†äº¤ç”± CPU å»æ‰§ è¡Œï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦è°ƒç”¨å…¶ä»–è¯­è¨€çš„æœ¬åœ°åº“æ¥å£ï¼ˆNative Interfaceï¼‰æ¥å®ç°æ•´ä¸ªç¨‹åºçš„åŠŸèƒ½ã€‚\n195. è¯´ä¸€ä¸‹ JVM è¿è¡Œæ—¶æ•°æ®åŒºï¼Ÿ ä¸åŒè™šæ‹Ÿæœºçš„è¿è¡Œæ—¶æ•°æ®åŒºå¯èƒ½ç•¥å¾®æœ‰æ‰€ä¸åŒï¼Œä½†éƒ½ä¼šéµä» Java è™šæ‹Ÿæœºè§„èŒƒï¼Œ Java è™šæ‹Ÿæœºè§„èŒƒè§„å®šçš„åŒºåŸŸåˆ†ä¸ºä»¥ä¸‹ 5 ä¸ªéƒ¨åˆ†ï¼š\nç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰ï¼šå½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ï¼Œå­—èŠ‚ç è§£æå™¨çš„å·¥ä½œæ˜¯\ré€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼ï¼Œæ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰\råŸºç¡€åŠŸèƒ½ï¼Œéƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆï¼›\rJava è™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰ï¼šç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡\ræ¯ï¼›\ræœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰ï¼šä¸è™šæ‹Ÿæœºæ ˆçš„ä½œç”¨æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡è™šæ‹Ÿæœºæ ˆæ˜¯æœåŠ¡ Java æ–¹æ³•çš„ï¼Œè€Œ\ræœ¬åœ°æ–¹æ³•æ ˆæ˜¯ä¸ºè™šæ‹Ÿæœºè°ƒç”¨ Native æ–¹æ³•æœåŠ¡çš„ï¼›\rJava å †ï¼ˆJava Heapï¼‰ï¼šJava è™šæ‹Ÿæœºä¸­å†…å­˜æœ€å¤§çš„ä¸€å—ï¼Œæ˜¯è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½åœ¨è¿™é‡Œ\råˆ†é…å†…å­˜ï¼›\ræ–¹æ³•åŒºï¼ˆMethed Areaï¼‰ï¼šç”¨äºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚ 196. è¯´ä¸€ä¸‹å †æ ˆçš„åŒºåˆ«ï¼Ÿ åŠŸèƒ½æ–¹é¢ï¼šå †æ˜¯ç”¨æ¥å­˜æ”¾å¯¹è±¡çš„ï¼Œæ ˆæ˜¯ç”¨æ¥æ‰§è¡Œç¨‹åºçš„ã€‚ å…±äº«æ€§ï¼šå †æ˜¯çº¿ç¨‹å…±äº«çš„ï¼Œæ ˆæ˜¯çº¿ç¨‹ç§æœ‰çš„ã€‚ ç©ºé—´å¤§å°ï¼šå †å¤§å°è¿œè¿œå¤§äºæ ˆã€‚ 197. é˜Ÿåˆ—å’Œæ ˆæ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ é˜Ÿåˆ—å’Œæ ˆéƒ½æ˜¯è¢«ç”¨æ¥é¢„å­˜å‚¨æ•°æ®çš„ã€‚ é˜Ÿåˆ—å…è®¸å…ˆè¿›å…ˆå‡ºæ£€ç´¢å…ƒç´ ï¼Œä½†ä¹Ÿæœ‰ä¾‹å¤–çš„æƒ…å†µï¼ŒDeque æ¥å£å…è®¸ä»ä¸¤ç«¯æ£€ç´¢å…ƒç´ ã€‚\næ ˆå’Œé˜Ÿåˆ—å¾ˆç›¸ä¼¼ï¼Œä½†å®ƒè¿è¡Œå¯¹å…ƒç´ è¿›è¡Œåè¿›å…ˆå‡ºè¿›è¡Œæ£€ç´¢ã€‚\n198. ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ åœ¨ä»‹ç»åŒäº²å§”æ´¾æ¨¡å‹ä¹‹å‰å…ˆè¯´ä¸‹ç±»åŠ è½½å™¨ã€‚å¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½éœ€è¦ç”±åŠ è½½å®ƒçš„ç±»åŠ è½½å™¨å’Œè¿™ä¸ªç±»æœ¬èº«ä¸€åŒç¡®ç«‹åœ¨ JVM ä¸­çš„å”¯ä¸€æ€§ï¼Œæ¯ä¸€ä¸ªç±»åŠ è½½å™¨ï¼Œéƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç±»åç§°ç©ºé—´ã€‚ç±»åŠ è½½å™¨å°±æ˜¯æ ¹æ®æŒ‡å®šå…¨é™å®šåç§°å°† class æ–‡ä»¶åŠ  è½½åˆ° JVM å†…å­˜ï¼Œç„¶åå†è½¬åŒ–ä¸º class å¯¹è±¡ã€‚\nç±»åŠ è½½å™¨åˆ†ç±»ï¼š\nå¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰ï¼Œæ˜¯è™šæ‹Ÿæœºè‡ªèº«çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥åŠ è½½Java_HOME/lib/ç›®å½•ä¸­çš„ï¼Œæˆ–è€…\rè¢« -Xbootclasspath å‚æ•°æ‰€æŒ‡å®šçš„è·¯å¾„ä¸­å¹¶ä¸”è¢«è™šæ‹Ÿæœºè¯†åˆ«çš„ç±»åº“ï¼›\rå…¶ä»–ç±»åŠ è½½å™¨ï¼š\ræ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰ï¼šè´Ÿè´£åŠ è½½\\lib\\extç›®å½•æˆ–Java. ext. dirsç³»ç»Ÿå˜é‡æŒ‡å®šçš„è·¯å¾„ä¸­çš„æ‰€æœ‰\rç±»åº“ï¼›\råº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ˆApplication ClassLoaderï¼‰ã€‚è´Ÿè´£åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ï¼ˆclasspathï¼‰ä¸Šçš„æŒ‡å®šç±»åº“ï¼Œæˆ‘ä»¬å¯ä»¥\rç›´æ¥ä½¿ç”¨è¿™ä¸ªç±»åŠ è½½å™¨ã€‚ä¸€èˆ¬æƒ…å†µï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰è‡ªå®šä¹‰ç±»åŠ è½½å™¨é»˜è®¤å°±æ˜¯ç”¨è¿™ä¸ªåŠ è½½å™¨ã€‚ åŒäº²å§”æ´¾æ¨¡å‹ï¼šå¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½çš„è¯·æ±‚ï¼Œå®ƒé¦–å…ˆä¸ä¼šè‡ªå·±å»åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ´¾ç»™çˆ¶ç±» åŠ è½½å™¨å»å®Œæˆï¼Œæ¯ä¸€å±‚çš„ç±»åŠ è½½å™¨éƒ½æ˜¯å¦‚æ­¤ï¼Œè¿™æ ·æ‰€æœ‰çš„åŠ è½½è¯·æ±‚éƒ½ä¼šè¢«ä¼ é€åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ä¸­ï¼Œåªæœ‰å½“çˆ¶åŠ  è½½æ— æ³•å®ŒæˆåŠ è½½è¯·æ±‚ï¼ˆå®ƒçš„æœç´¢èŒƒå›´ä¸­æ²¡æ‰¾åˆ°æ‰€éœ€çš„ç±»ï¼‰æ—¶ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•å»åŠ è½½ç±»ã€‚\n199. è¯´ä¸€ä¸‹ç±»è£…è½½çš„æ‰§è¡Œè¿‡ç¨‹ï¼Ÿ ç±»è£…è½½åˆ†ä¸ºä»¥ä¸‹ 5 ä¸ªæ­¥éª¤ï¼š åŠ è½½ï¼šæ ¹æ®æŸ¥æ‰¾è·¯å¾„æ‰¾åˆ°ç›¸åº”çš„ class æ–‡ä»¶ç„¶åå¯¼å…¥ï¼›\ræ£€æŸ¥ï¼šæ£€æŸ¥åŠ è½½çš„ class æ–‡ä»¶çš„æ­£ç¡®æ€§ï¼›\rå‡†å¤‡ï¼šç»™ç±»ä¸­çš„é™æ€å˜é‡åˆ†é…å†…å­˜ç©ºé—´ï¼› è§£æï¼šè™šæ‹Ÿæœºå°†å¸¸é‡æ± ä¸­çš„ç¬¦å·å¼•ç”¨æ›¿æ¢æˆç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚ç¬¦å·å¼•ç”¨å°±ç†è§£ä¸ºä¸€ä¸ªæ ‡ç¤ºï¼Œè€Œåœ¨ç›´æ¥å¼•ç”¨ç›´æ¥ æŒ‡å‘å†…å­˜ä¸­çš„åœ°å€ï¼› åˆå§‹åŒ–ï¼šå¯¹é™æ€å˜é‡å’Œé™æ€ä»£ç å—æ‰§è¡Œåˆå§‹åŒ–å·¥ä½œã€‚ 200. æ€ä¹ˆåˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯ä»¥è¢«å›æ”¶ï¼Ÿ ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•æ¥åˆ¤æ–­ï¼š å¼•ç”¨è®¡æ•°å™¨ï¼šä¸ºæ¯ä¸ªå¯¹è±¡åˆ›å»ºä¸€ä¸ªå¼•ç”¨è®¡æ•°ï¼Œæœ‰å¯¹è±¡å¼•ç”¨æ—¶è®¡æ•°å™¨ +1ï¼Œå¼•ç”¨è¢«é‡Šæ”¾æ—¶è®¡æ•° -1ï¼Œå½“è®¡æ•°å™¨ä¸º 0 æ—¶ å°±å¯ä»¥è¢«å›æ”¶ã€‚å®ƒæœ‰ä¸€ä¸ªç¼ºç‚¹ä¸èƒ½è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼› å¯è¾¾æ€§åˆ†æï¼šä» GC Roots å¼€å§‹å‘ä¸‹æœç´¢ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾ã€‚å½“ä¸€ä¸ªå¯¹è±¡åˆ° GC Roots æ²¡æœ‰ä»»ä½•å¼•\rç”¨é“¾ç›¸è¿æ—¶ï¼Œåˆ™è¯æ˜æ­¤å¯¹è±¡æ˜¯å¯ä»¥è¢«å›æ”¶çš„ã€‚ 201. Java ä¸­éƒ½æœ‰å“ªäº›å¼•ç”¨ç±»å‹ï¼Ÿ å¼ºå¼•ç”¨ï¼šå‘ç”Ÿ gc çš„æ—¶å€™ä¸ä¼šè¢«å›æ”¶ã€‚\rè½¯å¼•ç”¨ï¼šæœ‰ç”¨ä½†ä¸æ˜¯å¿…é¡»çš„å¯¹è±¡ï¼Œåœ¨å‘ç”Ÿå†…å­˜æº¢å‡ºä¹‹å‰ä¼šè¢«å›æ”¶ã€‚\rå¼±å¼•ç”¨ï¼šæœ‰ç”¨ä½†ä¸æ˜¯å¿…é¡»çš„å¯¹è±¡ï¼Œåœ¨ä¸‹ä¸€æ¬¡GCæ—¶ä¼šè¢«å›æ”¶ã€‚\rè™šå¼•ç”¨ï¼ˆå¹½çµå¼•ç”¨/å¹»å½±å¼•ç”¨ï¼‰ï¼šæ— æ³•é€šè¿‡è™šå¼•ç”¨è·å¾—å¯¹è±¡ï¼Œç”¨ PhantomReference å®ç°è™šå¼•ç”¨ï¼Œè™šå¼•ç”¨çš„ç”¨é€”\ræ˜¯åœ¨ gc æ—¶è¿”å›ä¸€ä¸ªé€šçŸ¥ã€‚ 202. è¯´ä¸€ä¸‹ JVM æœ‰å“ªäº›åƒåœ¾å›æ”¶ç®—æ³•ï¼Ÿ æ ‡è®°-æ¸…é™¤ç®—æ³•ï¼šæ ‡è®°æ— ç”¨å¯¹è±¡ï¼Œç„¶åè¿›è¡Œæ¸…é™¤å›æ”¶ã€‚ç¼ºç‚¹ï¼šæ•ˆç‡ä¸é«˜ï¼Œæ— æ³•æ¸…é™¤åƒåœ¾ç¢ç‰‡ã€‚ æ ‡è®°-æ•´ç†ç®—æ³•ï¼šæ ‡è®°æ— ç”¨å¯¹è±¡ï¼Œè®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…é™¤æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚ å¤åˆ¶ç®—æ³•ï¼šæŒ‰ç…§å®¹é‡åˆ’åˆ†äºŒä¸ªå¤§å°ç›¸ç­‰çš„å†…å­˜åŒºåŸŸï¼Œå½“ä¸€å—ç”¨å®Œçš„æ—¶å€™å°†æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—ä¸Šï¼Œç„¶åå† æŠŠå·²ä½¿ç”¨çš„å†…å­˜ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰ã€‚ç¼ºç‚¹ï¼šå†…å­˜ä½¿ç”¨ç‡ä¸é«˜ï¼Œåªæœ‰åŸæ¥çš„ä¸€åŠã€‚ åˆ†ä»£ç®—æ³•ï¼šæ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸ºå‡ å—ï¼Œä¸€èˆ¬æ˜¯æ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œæ–°ç”Ÿä»£åŸºæœ¬é‡‡ç”¨å¤åˆ¶ç®—æ³•ï¼Œ è€å¹´ä»£é‡‡ç”¨æ ‡è®°æ•´ç†ç®—æ³•ã€‚ 203. è¯´ä¸€ä¸‹ JVM æœ‰å“ªäº›åƒåœ¾å›æ”¶å™¨ï¼Ÿ Serialï¼šæœ€æ—©çš„å•çº¿ç¨‹ä¸²è¡Œåƒåœ¾å›æ”¶å™¨ã€‚\rSerial Oldï¼šSerial åƒåœ¾å›æ”¶å™¨çš„è€å¹´ç‰ˆæœ¬ï¼ŒåŒæ ·ä¹Ÿæ˜¯å•çº¿ç¨‹çš„ï¼Œå¯ä»¥ä½œä¸º CMS åƒåœ¾å›æ”¶å™¨çš„å¤‡é€‰é¢„æ¡ˆã€‚\rParNewï¼šæ˜¯ Serial çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ã€‚\rParallel å’Œ ParNew æ”¶é›†å™¨ç±»ä¼¼æ˜¯å¤šçº¿ç¨‹çš„ï¼Œä½† Parallel æ˜¯ååé‡ä¼˜å…ˆçš„æ”¶é›†å™¨ï¼Œå¯ä»¥ç‰ºç‰²ç­‰å¾…æ—¶é—´æ¢å–ç³»ç»Ÿçš„\rååé‡ã€‚\rParallel Old æ˜¯ Parallel è€ç”Ÿä»£ç‰ˆæœ¬ï¼ŒParallel ä½¿ç”¨çš„æ˜¯å¤åˆ¶çš„å†…å­˜å›æ”¶ç®—æ³•ï¼ŒParallel Old ä½¿ç”¨çš„æ˜¯æ ‡è®°-æ•´ç†\rçš„å†…å­˜å›æ”¶ç®—æ³•ã€‚\rCMSï¼šä¸€ç§ä»¥è·å¾—æœ€çŸ­åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ï¼Œéå¸¸é€‚ç”¨ B/S ç³»ç»Ÿã€‚\rG1ï¼šä¸€ç§å…¼é¡¾ååé‡å’Œåœé¡¿æ—¶é—´çš„ GC å®ç°ï¼Œæ˜¯ JDK 9 ä»¥åçš„é»˜è®¤ GC é€‰é¡¹ã€‚ 204. è¯¦ç»†ä»‹ç»ä¸€ä¸‹ CMS åƒåœ¾å›æ”¶å™¨ï¼Ÿ CMS æ˜¯è‹±æ–‡ Concurrent Mark-Sweep çš„ç®€ç§°ï¼Œæ˜¯ä»¥ç‰ºç‰²ååé‡ä¸ºä»£ä»·æ¥è·å¾—æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´çš„åƒåœ¾å›æ”¶å™¨ã€‚å¯¹ äºè¦æ±‚æœåŠ¡å™¨å“åº”é€Ÿåº¦çš„åº”ç”¨ä¸Šï¼Œè¿™ç§åƒåœ¾å›æ”¶å™¨éå¸¸é€‚åˆã€‚åœ¨å¯åŠ¨ JVM çš„å‚æ•°åŠ ä¸Šâ€œ- XX:+UseConcMarkSweepGCâ€æ¥æŒ‡å®šä½¿ç”¨ CMS åƒåœ¾å›æ”¶å™¨ã€‚\nCMS ä½¿ç”¨çš„æ˜¯æ ‡è®°-æ¸…é™¤çš„ç®—æ³•å®ç°çš„ï¼Œæ‰€ä»¥åœ¨ gc çš„æ—¶å€™å›äº§ç”Ÿå¤§é‡çš„å†…å­˜ç¢ç‰‡ï¼Œå½“å‰©ä½™å†…å­˜ä¸èƒ½æ»¡è¶³ç¨‹åºè¿è¡Œè¦ æ±‚æ—¶ï¼Œç³»ç»Ÿå°†ä¼šå‡ºç° Concurrent Mode Failureï¼Œä¸´æ—¶ CMS ä¼šé‡‡ç”¨ Serial Old å›æ”¶å™¨è¿›è¡Œåƒåœ¾æ¸…é™¤ï¼Œæ­¤æ—¶çš„æ€§èƒ½å°† ä¼šè¢«é™ä½ã€‚\n205. æ–°ç”Ÿä»£åƒåœ¾å›æ”¶å™¨å’Œè€ç”Ÿä»£åƒåœ¾å›æ”¶å™¨éƒ½æœ‰å“ªäº›ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ æ–°ç”Ÿä»£å›æ”¶å™¨ï¼šSerialã€ParNewã€Parallel Scavenge\rè€å¹´ä»£å›æ”¶å™¨ï¼šSerial Oldã€Parallel Oldã€CMS\ræ•´å †å›æ”¶å™¨ï¼šG1 æ–°ç”Ÿä»£åƒåœ¾å›æ”¶å™¨ä¸€èˆ¬é‡‡ç”¨çš„æ˜¯å¤åˆ¶ç®—æ³•ï¼Œå¤åˆ¶ç®—æ³•çš„ä¼˜ç‚¹æ˜¯æ•ˆç‡é«˜ï¼Œç¼ºç‚¹æ˜¯å†…å­˜åˆ©ç”¨ç‡ä½ï¼›è€å¹´ä»£å›æ”¶å™¨ä¸€èˆ¬é‡‡ç”¨ çš„æ˜¯æ ‡è®°-æ•´ç†çš„ç®—æ³•è¿›è¡Œåƒåœ¾å›æ”¶ã€‚\n206. ç®€è¿°åˆ†ä»£åƒåœ¾å›æ”¶å™¨æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ åˆ†ä»£å›æ”¶å™¨æœ‰ä¸¤ä¸ªåˆ†åŒºï¼šè€ç”Ÿä»£å’Œæ–°ç”Ÿä»£ï¼Œæ–°ç”Ÿä»£é»˜è®¤çš„ç©ºé—´å æ¯”æ€»ç©ºé—´çš„ 1/3ï¼Œè€ç”Ÿä»£çš„é»˜è®¤å æ¯”æ˜¯ 2/3ã€‚ æ–°ç”Ÿä»£ä½¿ç”¨çš„æ˜¯å¤åˆ¶ç®—æ³•ï¼Œæ–°ç”Ÿä»£é‡Œæœ‰ 3 ä¸ªåˆ†åŒºï¼šEdenã€To Survivorã€From Survivorï¼Œå®ƒä»¬çš„é»˜è®¤å æ¯”æ˜¯ 8:1:1ï¼Œ å®ƒçš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š\næŠŠ Eden + From Survivor å­˜æ´»çš„å¯¹è±¡æ”¾å…¥ To Survivor åŒºï¼› æ¸…ç©º Eden å’Œ From Survivor åˆ†åŒºï¼› From Survivor å’Œ To Survivor åˆ†åŒºäº¤æ¢ï¼ŒFrom Survivor å˜ To Survivorï¼ŒTo Survivor å˜ From Survivorã€‚ æ¯æ¬¡åœ¨ From Survivor åˆ° To Survivor ç§»åŠ¨æ—¶éƒ½å­˜æ´»çš„å¯¹è±¡ï¼Œå¹´é¾„å°± +1ï¼Œå½“å¹´é¾„åˆ°è¾¾ 15 ï¼ˆé»˜è®¤é…ç½®æ˜¯ 15 ï¼‰æ—¶ï¼Œå‡çº§ ä¸ºè€ç”Ÿä»£ã€‚å¤§å¯¹è±¡ä¹Ÿä¼šç›´æ¥è¿›å…¥è€ç”Ÿä»£ã€‚\nè€ç”Ÿä»£å½“ç©ºé—´å ç”¨åˆ°è¾¾æŸä¸ªå€¼ä¹‹åå°±ä¼šè§¦å‘å…¨å±€åƒåœ¾æ”¶å›ï¼Œä¸€èˆ¬ä½¿ç”¨æ ‡è®°æ•´ç†çš„æ‰§è¡Œç®—æ³•ã€‚ä»¥ä¸Šè¿™äº›å¾ªç¯å¾€å¤å°±æ„æˆ äº†æ•´ä¸ªåˆ†ä»£åƒåœ¾å›æ”¶çš„æ•´ä½“æ‰§è¡Œæµç¨‹ã€‚\n207. è¯´ä¸€ä¸‹ JVM è°ƒä¼˜çš„å·¥å…·ï¼Ÿ JDK è‡ªå¸¦äº†å¾ˆå¤šç›‘æ§å·¥å…·ï¼Œéƒ½ä½äº JDK çš„ bin ç›®å½•ä¸‹ï¼Œå…¶ä¸­æœ€å¸¸ç”¨çš„æ˜¯ jconsole å’Œ jvisualvm è¿™ä¸¤æ¬¾è§†å›¾ç›‘æ§å·¥ å…·ã€‚\njconsoleï¼šç”¨äºå¯¹ JVM ä¸­çš„å†…å­˜ã€çº¿ç¨‹å’Œç±»ç­‰è¿›è¡Œç›‘æ§ï¼›\rjvisualvmï¼šJDK è‡ªå¸¦çš„å…¨èƒ½åˆ†æå·¥å…·ï¼Œå¯ä»¥åˆ†æï¼šå†…å­˜å¿«ç…§ã€çº¿ç¨‹å¿«ç…§ã€ç¨‹åºæ­»é”ã€ç›‘æ§å†…å­˜çš„å˜åŒ–ã€gc å˜åŒ–\rç­‰ã€‚ 208. å¸¸ç”¨çš„ JVM è°ƒä¼˜çš„å‚æ•°éƒ½æœ‰å“ªäº›ï¼Ÿ -Xms2gï¼šåˆå§‹åŒ–æ¨å¤§å°ä¸º 2gï¼›\r-Xmx2gï¼šå †æœ€å¤§å†…å­˜ä¸º 2gï¼›\r-XX:NewRatio=4ï¼šè®¾ç½®å¹´è½»çš„å’Œè€å¹´ä»£çš„å†…å­˜æ¯”ä¾‹ä¸º 1:4ï¼›\r-XX:SurvivorRatio=8ï¼šè®¾ç½®æ–°ç”Ÿä»£ Eden å’Œ Survivor æ¯”ä¾‹ä¸º 8:2ï¼›\râ€“XX:+UseParNewGCï¼šæŒ‡å®šä½¿ç”¨ ParNew + Serial Old åƒåœ¾å›æ”¶å™¨ç»„åˆï¼›\r-XX:+UseParallelOldGCï¼šæŒ‡å®šä½¿ç”¨ ParNew + ParNew Old åƒåœ¾å›æ”¶å™¨ç»„åˆï¼›\r-XX:+UseConcMarkSweepGCï¼šæŒ‡å®šä½¿ç”¨ CMS + Serial Old åƒåœ¾å›æ”¶å™¨ç»„åˆï¼›\r-XX:+PrintGCï¼šå¼€å¯æ‰“å° gc ä¿¡æ¯ï¼›\r-XX:+PrintGCDetailsï¼šæ‰“å° gc è¯¦ç»†ä¿¡æ¯ã€‚ ","permalink":"https://XianCH.github.io/posts/tech/java/java%E9%9D%A2%E8%AF%95%E9%A2%98/","summary":"\u003ch2 id=\"åŒ…å«çš„æ¨¡å—\"\u003eåŒ…å«çš„æ¨¡å—\u003c/h2\u003e\n\u003cp\u003eåä¹ä¸ªæ¨¡å—ï¼Œåˆ†åˆ«æ˜¯ï¼š Java åŸºç¡€ã€å®¹å™¨ã€å¤šçº¿ç¨‹ã€åå°„ã€å¯¹è±¡æ‹·è´ã€Java Web ã€å¼‚å¸¸ã€ç½‘ç»œã€è®¾è®¡æ¨¡å¼ã€\nSpring/Spring MVCã€Spring Boot/Spring Cloudã€Hibernateã€MyBatisã€RabbitMQã€Kafkaã€Zookeeperã€\nMySQLã€Redisã€JVM ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"java%E9%9D%A2%E8%AF%95.assets/image-20220630174606851.png\" alt=\"image-20220630174606851\"  /\u003e\n\u003c/p\u003e\n\u003ch1 id=\"java-åŸºç¡€\"\u003eJava åŸºç¡€\u003c/h1\u003e\n\u003ch2 id=\"1-jdk-å’Œ-jre-æœ‰ä»€ä¹ˆåŒºåˆ«\"\u003e1. JDK å’Œ JRE æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eJDKï¼šJava Development Kit çš„ç®€ç§°ï¼ŒJava å¼€å‘å·¥å…·åŒ…ï¼Œæä¾›äº† Java çš„å¼€å‘ç¯å¢ƒå’Œè¿è¡Œç¯å¢ƒã€‚\u003c/li\u003e\n\u003cli\u003eJREï¼šJava Runtime Environment çš„ç®€ç§°ï¼ŒJava è¿è¡Œç¯å¢ƒï¼Œä¸º Java çš„è¿è¡Œæä¾›äº†æ‰€éœ€ç¯å¢ƒã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eå…·ä½“æ¥è¯´ JDK å…¶å®åŒ…å«äº† JREï¼ŒåŒæ—¶è¿˜åŒ…å«äº†ç¼–è¯‘ Java æºç çš„ç¼–è¯‘å™¨ Javacï¼Œè¿˜åŒ…å«äº†å¾ˆå¤š Java ç¨‹åºè°ƒè¯•å’Œåˆ†æçš„\nå·¥å…·ã€‚ç®€å•æ¥è¯´ï¼šå¦‚æœä½ éœ€è¦è¿è¡Œ Java ç¨‹åºï¼Œåªéœ€å®‰è£… JRE å°±å¯ä»¥äº†ï¼Œå¦‚æœä½ éœ€è¦ç¼–å†™ Java ç¨‹åºï¼Œéœ€è¦å®‰è£… JDKã€‚\u003c/p\u003e","title":"javaé¢è¯•é¢˜"},{"content":"//æŸ¥è¯¢æœªæˆå¹´ä½œå®¶çš„è¯„åˆ†åœ¨70ä»¥ä¸Šçš„ä¹¦ç± ç”±äºæ´‹æµå½±å“æ‰€ä»¥ä½œå®¶å’Œä¹¦ç±å¯èƒ½å‡ºç°é‡å¤ï¼Œéœ€è¦è¿›è¡Œå»é‡ List\u0026lt;Book\u0026gt; bookList = new ArrayList\u0026lt;\u0026gt;(); Set\u0026lt;Book\u0026gt; uniqueBookValues = new HashSet\u0026lt;\u0026gt;(); Set\u0026lt;Author\u0026gt; uniqueAuthorValues = new HashSet\u0026lt;\u0026gt;(); for (Author author : authors) { if (uniqueAuthorValues.add(author)) { if (author.getAge() \u0026lt; 18) { List\u0026lt;Book\u0026gt; books = author.getBooks(); for (Book book : books) { if (book.getScore() \u0026gt; 70) { if (uniqueBookValues.add(book)) { bookList.add(book); } } } } } } System.out.println(bookList); List\u0026lt;Book\u0026gt; collect = authors.stream() .distinct() .filter(author -\u0026gt; author.getAge() \u0026lt; 18) .map(author -\u0026gt; author.getBooks()) .flatMap(Collection::stream) .filter(book -\u0026gt; book.getScore() \u0026gt; 70) .distinct() .collect(Collectors.toList()); System.out.println(collect); 1.2 å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ 1.2.1 æ¦‚å¿µ â€‹\té¢å‘å¯¹è±¡æ€æƒ³éœ€è¦å…³æ³¨ç”¨ä»€ä¹ˆå¯¹è±¡å®Œæˆä»€ä¹ˆäº‹æƒ…ã€‚è€Œå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³å°±ç±»ä¼¼äºæˆ‘ä»¬æ•°å­¦ä¸­çš„å‡½æ•°ã€‚å®ƒä¸»è¦å…³æ³¨çš„æ˜¯å¯¹æ•°æ®è¿›è¡Œäº†ä»€ä¹ˆæ“ä½œã€‚\n1.2.2 ä¼˜ç‚¹ ä»£ç ç®€æ´ï¼Œå¼€å‘å¿«é€Ÿ æ¥è¿‘è‡ªç„¶è¯­è¨€ï¼Œæ˜“äºç†è§£ æ˜“äº\u0026quot;å¹¶å‘ç¼–ç¨‹\u0026quot; 2. Lambdaè¡¨è¾¾å¼ 2.1 æ¦‚è¿° â€‹\tLambdaæ˜¯JDK8ä¸­ä¸€ä¸ªè¯­æ³•ç³–ã€‚ä»–å¯ä»¥å¯¹æŸäº›åŒ¿åå†…éƒ¨ç±»çš„å†™æ³•è¿›è¡Œç®€åŒ–ã€‚å®ƒæ˜¯å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³çš„ä¸€ä¸ªé‡è¦ä½“ç°ã€‚è®©æˆ‘ä»¬ä¸ç”¨å…³æ³¨æ˜¯ä»€ä¹ˆå¯¹è±¡ã€‚è€Œæ˜¯æ›´å…³æ³¨æˆ‘ä»¬å¯¹æ•°æ®è¿›è¡Œäº†ä»€ä¹ˆæ“ä½œã€‚\n2.2 æ ¸å¿ƒåŸåˆ™ å¯æ¨å¯¼å¯çœç•¥\n2. 3 åŸºæœ¬æ ¼å¼ (å‚æ•°åˆ—è¡¨)-\u0026gt;{ä»£ç } ä¾‹ä¸€ æˆ‘ä»¬åœ¨åˆ›å»ºçº¿ç¨‹å¹¶å¯åŠ¨æ—¶å¯ä»¥ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»çš„å†™æ³•ï¼š\nnew Thread(new Runnable() { @Override public void run() { System.out.println(\u0026#34;ä½ çŸ¥é“å— æˆ‘æ¯”ä½ æƒ³è±¡çš„ æ›´æƒ³åœ¨ä½ èº«è¾¹\u0026#34;); } }).start(); å¯ä»¥ä½¿ç”¨Lambdaçš„æ ¼å¼å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚ä¿®æ”¹åå¦‚ä¸‹ï¼š\nnew Thread(()-\u0026gt;{ System.out.println(\u0026#34;ä½ çŸ¥é“å— æˆ‘æ¯”ä½ æƒ³è±¡çš„ æ›´æƒ³åœ¨ä½ èº«è¾¹\u0026#34;); }).start(); ä¾‹äºŒ: ç°æœ‰æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼Œå…¶ä¸­IntBinaryOperatoræ˜¯ä¸€ä¸ªæ¥å£ã€‚å…ˆä½¿ç”¨åŒ¿åå†…éƒ¨ç±»çš„å†™æ³•è°ƒç”¨è¯¥æ–¹æ³•ã€‚\npublic static int calculateNum(IntBinaryOperator operator){ int a = 10; int b = 20; return operator.applyAsInt(a, b); } public static void main(String[] args) { int i = calculateNum(new IntBinaryOperator() { @Override public int applyAsInt(int left, int right) { return left + right; } }); System.out.println(i); } Lambdaå†™æ³•ï¼š\npublic static void main(String[] args) { int i = calculateNum((int left, int right)-\u0026gt;{ return left + right; }); System.out.println(i); } ä¾‹ä¸‰ï¼š ç°æœ‰æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼Œå…¶ä¸­IntPredicateæ˜¯ä¸€ä¸ªæ¥å£ã€‚å…ˆä½¿ç”¨åŒ¿åå†…éƒ¨ç±»çš„å†™æ³•è°ƒç”¨è¯¥æ–¹æ³•ã€‚\npublic static void printNum(IntPredicate predicate){ int[] arr = {1,2,3,4,5,6,7,8,9,10}; for (int i : arr) { if(predicate.test(i)){ System.out.println(i); } } } public static void main(String[] args) { printNum(new IntPredicate() { @Override public boolean test(int value) { return value%2==0; } }); } Lambdaå†™æ³•ï¼š\npublic static void main(String[] args) { printNum((int value)-\u0026gt; { return value%2==0; }); } public static void printNum(IntPredicate predicate){ int[] arr = {1,2,3,4,5,6,7,8,9,10}; for (int i : arr) { if(predicate.test(i)){ System.out.println(i); } } } ä¾‹å››ï¼š ç°æœ‰æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼Œå…¶ä¸­Functionæ˜¯ä¸€ä¸ªæ¥å£ã€‚å…ˆä½¿ç”¨åŒ¿åå†…éƒ¨ç±»çš„å†™æ³•è°ƒç”¨è¯¥æ–¹æ³•ã€‚\npublic static \u0026lt;R\u0026gt; R typeConver(Function\u0026lt;String,R\u0026gt; function){ String str = \u0026#34;1235\u0026#34;; R result = function.apply(str); return result; } public static void main(String[] args) { Integer result = typeConver(new Function\u0026lt;String, Integer\u0026gt;() { @Override public Integer apply(String s) { return Integer.valueOf(s); } }); System.out.println(result); } Lambdaå†™æ³•ï¼š\nInteger result = typeConver((String s)-\u0026gt;{ return Integer.valueOf(s); }); System.out.println(result); ä¾‹äº”ï¼š ç°æœ‰æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼Œå…¶ä¸­IntConsumeræ˜¯ä¸€ä¸ªæ¥å£ã€‚å…ˆä½¿ç”¨åŒ¿åå†…éƒ¨ç±»çš„å†™æ³•è°ƒç”¨è¯¥æ–¹æ³•ã€‚\npublic static void foreachArr(IntConsumer consumer){ int[] arr = {1,2,3,4,5,6,7,8,9,10}; for (int i : arr) { consumer.accept(i); } } public static void main(String[] args) { foreachArr(new IntConsumer() { @Override public void accept(int value) { System.out.println(value); } }); } Lambdaå†™æ³•ï¼š\npublic static void main(String[] args) { foreachArr((int value)-\u0026gt;{ System.out.println(value); }); } 2.4 çœç•¥è§„åˆ™ å‚æ•°ç±»å‹å¯ä»¥çœç•¥ æ–¹æ³•ä½“åªæœ‰ä¸€å¥ä»£ç æ—¶å¤§æ‹¬å·returnå’Œå”¯ä¸€ä¸€å¥ä»£ç çš„åˆ†å·å¯ä»¥çœç•¥ æ–¹æ³•åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶å°æ‹¬å·å¯ä»¥çœç•¥ ä»¥ä¸Šè¿™äº›è§„åˆ™éƒ½è®°ä¸ä½ä¹Ÿå¯ä»¥çœç•¥ä¸è®° 3. Streamæµ 3.1 æ¦‚è¿° â€‹\tJava8çš„Streamä½¿ç”¨çš„æ˜¯å‡½æ•°å¼ç¼–ç¨‹æ¨¡å¼ï¼Œå¦‚åŒå®ƒçš„åå­—ä¸€æ ·ï¼Œå®ƒå¯ä»¥è¢«ç”¨æ¥å¯¹é›†åˆæˆ–æ•°ç»„è¿›è¡Œé“¾çŠ¶æµå¼çš„æ“ä½œã€‚å¯ä»¥æ›´æ–¹ä¾¿çš„è®©æˆ‘ä»¬å¯¹é›†åˆæˆ–æ•°ç»„æ“ä½œã€‚\n3.2 æ¡ˆä¾‹æ•°æ®å‡†å¤‡ \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.projectlombok\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;lombok\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.18.16\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; @Data @NoArgsConstructor @AllArgsConstructor @EqualsAndHashCode//ç”¨äºåæœŸçš„å»é‡ä½¿ç”¨ public class Author { //id private Long id; //å§“å private String name; //å¹´é¾„ private Integer age; //ç®€ä»‹ private String intro; //ä½œå“ private List\u0026lt;Book\u0026gt; books; } @Data @AllArgsConstructor @NoArgsConstructor @EqualsAndHashCode//ç”¨äºåæœŸçš„å»é‡ä½¿ç”¨ public class Book { //id private Long id; //ä¹¦å private String name; //åˆ†ç±» private String category; //è¯„åˆ† private Integer score; //ç®€ä»‹ private String intro; } private static List\u0026lt;Author\u0026gt; getAuthors() { //æ•°æ®åˆå§‹åŒ– Author author = new Author(1L,\u0026#34;è’™å¤š\u0026#34;,33,\u0026#34;ä¸€ä¸ªä»èœåˆ€ä¸­æ˜æ‚Ÿå“²ç†çš„ç¥–å®‰äºº\u0026#34;,null); Author author2 = new Author(2L,\u0026#34;äºšæ‹‰ç´¢\u0026#34;,15,\u0026#34;ç‹‚é£ä¹Ÿè¿½é€ä¸ä¸Šä»–çš„æ€è€ƒé€Ÿåº¦\u0026#34;,null); Author author3 = new Author(3L,\u0026#34;æ˜“\u0026#34;,14,\u0026#34;æ˜¯è¿™ä¸ªä¸–ç•Œåœ¨é™åˆ¶ä»–çš„æ€ç»´\u0026#34;,null); Author author4 = new Author(3L,\u0026#34;æ˜“\u0026#34;,14,\u0026#34;æ˜¯è¿™ä¸ªä¸–ç•Œåœ¨é™åˆ¶ä»–çš„æ€ç»´\u0026#34;,null); //ä¹¦ç±åˆ—è¡¨ List\u0026lt;Book\u0026gt; books1 = new ArrayList\u0026lt;\u0026gt;(); List\u0026lt;Book\u0026gt; books2 = new ArrayList\u0026lt;\u0026gt;(); List\u0026lt;Book\u0026gt; books3 = new ArrayList\u0026lt;\u0026gt;(); books1.add(new Book(1L,\u0026#34;åˆ€çš„ä¸¤ä¾§æ˜¯å…‰æ˜ä¸é»‘æš—\u0026#34;,\u0026#34;å“²å­¦,çˆ±æƒ…\u0026#34;,88,\u0026#34;ç”¨ä¸€æŠŠåˆ€åˆ’åˆ†äº†çˆ±æ¨\u0026#34;)); books1.add(new Book(2L,\u0026#34;ä¸€ä¸ªäººä¸èƒ½æ­»åœ¨åŒä¸€æŠŠåˆ€ä¸‹\u0026#34;,\u0026#34;ä¸ªäººæˆé•¿,çˆ±æƒ…\u0026#34;,99,\u0026#34;è®²è¿°å¦‚ä½•ä»å¤±è´¥ä¸­æ˜æ‚ŸçœŸç†\u0026#34;)); books2.add(new Book(3L,\u0026#34;é‚£é£å¹ä¸åˆ°çš„åœ°æ–¹\u0026#34;,\u0026#34;å“²å­¦\u0026#34;,85,\u0026#34;å¸¦ä½ ç”¨æ€ç»´å»é¢†ç•¥ä¸–ç•Œçš„å°½å¤´\u0026#34;)); books2.add(new Book(3L,\u0026#34;é‚£é£å¹ä¸åˆ°çš„åœ°æ–¹\u0026#34;,\u0026#34;å“²å­¦\u0026#34;,85,\u0026#34;å¸¦ä½ ç”¨æ€ç»´å»é¢†ç•¥ä¸–ç•Œçš„å°½å¤´\u0026#34;)); books2.add(new Book(4L,\u0026#34;å¹æˆ–ä¸å¹\u0026#34;,\u0026#34;çˆ±æƒ…,ä¸ªäººä¼ è®°\u0026#34;,56,\u0026#34;ä¸€ä¸ªå“²å­¦å®¶çš„æ‹çˆ±è§‚æ³¨å®šå¾ˆéš¾æŠŠä»–æ‰€åœ¨çš„æ—¶ä»£ç†è§£\u0026#34;)); books3.add(new Book(5L,\u0026#34;ä½ çš„å‰‘å°±æ˜¯æˆ‘çš„å‰‘\u0026#34;,\u0026#34;çˆ±æƒ…\u0026#34;,56,\u0026#34;æ— æ³•æƒ³è±¡ä¸€ä¸ªæ­¦è€…èƒ½å¯¹ä»–çš„ä¼´ä¾£è¿™ä¹ˆçš„å®½å®¹\u0026#34;)); books3.add(new Book(6L,\u0026#34;é£ä¸å‰‘\u0026#34;,\u0026#34;ä¸ªäººä¼ è®°\u0026#34;,100,\u0026#34;ä¸¤ä¸ªå“²å­¦å®¶çµé­‚å’Œè‚‰ä½“çš„ç¢°æ’ä¼šæ¿€èµ·æ€ä¹ˆæ ·çš„ç«èŠ±å‘¢ï¼Ÿ\u0026#34;)); books3.add(new Book(6L,\u0026#34;é£ä¸å‰‘\u0026#34;,\u0026#34;ä¸ªäººä¼ è®°\u0026#34;,100,\u0026#34;ä¸¤ä¸ªå“²å­¦å®¶çµé­‚å’Œè‚‰ä½“çš„ç¢°æ’ä¼šæ¿€èµ·æ€ä¹ˆæ ·çš„ç«èŠ±å‘¢ï¼Ÿ\u0026#34;)); author.setBooks(books1); author2.setBooks(books2); author3.setBooks(books3); author4.setBooks(books3); List\u0026lt;Author\u0026gt; authorList = new ArrayList\u0026lt;\u0026gt;(Arrays.asList(author,author2,author3,author4)); return authorList; } 3.3 å¿«é€Ÿå…¥é—¨ 3.3.1 éœ€æ±‚ â€‹\tæˆ‘ä»¬å¯ä»¥è°ƒç”¨getAuthorsæ–¹æ³•è·å–åˆ°ä½œå®¶çš„é›†åˆã€‚ç°åœ¨éœ€è¦æ‰“å°æ‰€æœ‰å¹´é¾„å°äº18çš„ä½œå®¶çš„åå­—ï¼Œå¹¶ä¸”è¦æ³¨æ„å»é‡ã€‚\n3.3.2 å®ç° //æ‰“å°æ‰€æœ‰å¹´é¾„å°äº18çš„ä½œå®¶çš„åå­—ï¼Œå¹¶ä¸”è¦æ³¨æ„å»é‡ List\u0026lt;Author\u0026gt; authors = getAuthors(); authors. stream()//æŠŠé›†åˆè½¬æ¢æˆæµ .distinct()//å…ˆå»é™¤é‡å¤çš„ä½œå®¶ .filter(author -\u0026gt; author.getAge()\u0026lt;18)//ç­›é€‰å¹´é¾„å°äº18çš„ .forEach(author -\u0026gt; System.out.println(author.getName()));//éå†æ‰“å°åå­— 3.4 å¸¸ç”¨æ“ä½œ 3.4.1 åˆ›å»ºæµ å•åˆ—é›†åˆï¼š é›†åˆå¯¹è±¡.stream()\nList\u0026lt;Author\u0026gt; authors = getAuthors(); Stream\u0026lt;Author\u0026gt; stream = authors.stream(); æ•°ç»„ï¼šArrays.stream(æ•°ç»„) æˆ–è€…ä½¿ç”¨Stream.ofæ¥åˆ›å»º\nInteger[] arr = {1,2,3,4,5}; Stream\u0026lt;Integer\u0026gt; stream = Arrays.stream(arr); Stream\u0026lt;Integer\u0026gt; stream2 = Stream.of(arr); åŒåˆ—é›†åˆï¼šè½¬æ¢æˆå•åˆ—é›†åˆåå†åˆ›å»º\nMap\u0026lt;String,Integer\u0026gt; map = new HashMap\u0026lt;\u0026gt;(); map.put(\u0026#34;èœ¡ç¬”å°æ–°\u0026#34;,19); map.put(\u0026#34;é»‘å­\u0026#34;,17); map.put(\u0026#34;æ—¥å‘ç¿”é˜³\u0026#34;,16); Stream\u0026lt;Map.Entry\u0026lt;String, Integer\u0026gt;\u0026gt; stream = map.entrySet().stream(); 3.4.2 ä¸­é—´æ“ä½œ filter â€‹\tå¯ä»¥å¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œæ¡ä»¶è¿‡æ»¤ï¼Œç¬¦åˆè¿‡æ»¤æ¡ä»¶çš„æ‰èƒ½ç»§ç»­ç•™åœ¨æµä¸­ã€‚\nä¾‹å¦‚ï¼š\nâ€‹\tæ‰“å°æ‰€æœ‰å§“åé•¿åº¦å¤§äº1çš„ä½œå®¶çš„å§“å\nList\u0026lt;Author\u0026gt; authors = getAuthors(); authors.stream() .filter(author -\u0026gt; author.getName().length()\u0026gt;1) .forEach(author -\u0026gt; System.out.println(author.getName())); map â€‹\tå¯ä»¥æŠŠå¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œè®¡ç®—æˆ–è½¬æ¢ã€‚\nä¾‹å¦‚ï¼š\nâ€‹\tæ‰“å°æ‰€æœ‰ä½œå®¶çš„å§“å\nList\u0026lt;Author\u0026gt; authors = getAuthors(); authors .stream() .map(author -\u0026gt; author.getName()) .forEach(name-\u0026gt;System.out.println(name)); // æ‰“å°æ‰€æœ‰ä½œå®¶çš„å§“å List\u0026lt;Author\u0026gt; authors = getAuthors(); // authors.stream() // .map(author -\u0026gt; author.getName()) // .forEach(s -\u0026gt; System.out.println(s)); authors.stream() .map(author -\u0026gt; author.getAge()) .map(age-\u0026gt;age+10) .forEach(age-\u0026gt; System.out.println(age)); distinct â€‹\tå¯ä»¥å»é™¤æµä¸­çš„é‡å¤å…ƒç´ ã€‚\nä¾‹å¦‚ï¼š\nâ€‹\tæ‰“å°æ‰€æœ‰ä½œå®¶çš„å§“åï¼Œå¹¶ä¸”è¦æ±‚å…¶ä¸­ä¸èƒ½æœ‰é‡å¤å…ƒç´ ã€‚\nList\u0026lt;Author\u0026gt; authors = getAuthors(); authors.stream() .distinct() .forEach(author -\u0026gt; System.out.println(author.getName())); æ³¨æ„ï¼šdistinctæ–¹æ³•æ˜¯ä¾èµ–Objectçš„equalsæ–¹æ³•æ¥åˆ¤æ–­æ˜¯å¦æ˜¯ç›¸åŒå¯¹è±¡çš„ã€‚æ‰€ä»¥éœ€è¦æ³¨æ„é‡å†™equalsæ–¹æ³•ã€‚\nsorted â€‹\tå¯ä»¥å¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œæ’åºã€‚\nä¾‹å¦‚ï¼š\nâ€‹\tå¯¹æµä¸­çš„å…ƒç´ æŒ‰ç…§å¹´é¾„è¿›è¡Œé™åºæ’åºï¼Œå¹¶ä¸”è¦æ±‚ä¸èƒ½æœ‰é‡å¤çš„å…ƒç´ ã€‚\nList\u0026lt;Author\u0026gt; authors = getAuthors(); // å¯¹æµä¸­çš„å…ƒç´ æŒ‰ç…§å¹´é¾„è¿›è¡Œé™åºæ’åºï¼Œå¹¶ä¸”è¦æ±‚ä¸èƒ½æœ‰é‡å¤çš„å…ƒç´ ã€‚ authors.stream() .distinct() .sorted() .forEach(author -\u0026gt; System.out.println(author.getAge())); List\u0026lt;Author\u0026gt; authors = getAuthors(); // å¯¹æµä¸­çš„å…ƒç´ æŒ‰ç…§å¹´é¾„è¿›è¡Œé™åºæ’åºï¼Œå¹¶ä¸”è¦æ±‚ä¸èƒ½æœ‰é‡å¤çš„å…ƒç´ ã€‚ authors.stream() .distinct() .sorted((o1, o2) -\u0026gt; o2.getAge()-o1.getAge()) .forEach(author -\u0026gt; System.out.println(author.getAge())); æ³¨æ„ï¼šå¦‚æœè°ƒç”¨ç©ºå‚çš„sorted()æ–¹æ³•ï¼Œéœ€è¦æµä¸­çš„å…ƒç´ æ˜¯å®ç°äº†Comparableã€‚\nâ€‹\nlimit â€‹\tå¯ä»¥è®¾ç½®æµçš„æœ€å¤§é•¿åº¦ï¼Œè¶…å‡ºçš„éƒ¨åˆ†å°†è¢«æŠ›å¼ƒã€‚\nä¾‹å¦‚ï¼š\nâ€‹\tå¯¹æµä¸­çš„å…ƒç´ æŒ‰ç…§å¹´é¾„è¿›è¡Œé™åºæ’åºï¼Œå¹¶ä¸”è¦æ±‚ä¸èƒ½æœ‰é‡å¤çš„å…ƒç´ ,ç„¶åæ‰“å°å…¶ä¸­å¹´é¾„æœ€å¤§çš„ä¸¤ä¸ªä½œå®¶çš„å§“åã€‚\nList\u0026lt;Author\u0026gt; authors = getAuthors(); authors.stream() .distinct() .sorted() .limit(2) .forEach(author -\u0026gt; System.out.println(author.getName())); skip â€‹\tè·³è¿‡æµä¸­çš„å‰nä¸ªå…ƒç´ ï¼Œè¿”å›å‰©ä¸‹çš„å…ƒç´ \nä¾‹å¦‚ï¼š\nâ€‹\tæ‰“å°é™¤äº†å¹´é¾„æœ€å¤§çš„ä½œå®¶å¤–çš„å…¶ä»–ä½œå®¶ï¼Œè¦æ±‚ä¸èƒ½æœ‰é‡å¤å…ƒç´ ï¼Œå¹¶ä¸”æŒ‰ç…§å¹´é¾„é™åºæ’åºã€‚\n// æ‰“å°é™¤äº†å¹´é¾„æœ€å¤§çš„ä½œå®¶å¤–çš„å…¶ä»–ä½œå®¶ï¼Œè¦æ±‚ä¸èƒ½æœ‰é‡å¤å…ƒç´ ï¼Œå¹¶ä¸”æŒ‰ç…§å¹´é¾„é™åºæ’åºã€‚ List\u0026lt;Author\u0026gt; authors = getAuthors(); authors.stream() .distinct() .sorted() .skip(1) .forEach(author -\u0026gt; System.out.println(author.getName())); flatMap â€‹\tmapåªèƒ½æŠŠä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆå¦ä¸€ä¸ªå¯¹è±¡æ¥ä½œä¸ºæµä¸­çš„å…ƒç´ ã€‚è€ŒflatMapå¯ä»¥æŠŠä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆå¤šä¸ªå¯¹è±¡ä½œä¸ºæµä¸­çš„å…ƒç´ ã€‚\nä¾‹ä¸€ï¼š\nâ€‹\tæ‰“å°æ‰€æœ‰ä¹¦ç±çš„åå­—ã€‚è¦æ±‚å¯¹é‡å¤çš„å…ƒç´ è¿›è¡Œå»é‡ã€‚\n// æ‰“å°æ‰€æœ‰ä¹¦ç±çš„åå­—ã€‚è¦æ±‚å¯¹é‡å¤çš„å…ƒç´ è¿›è¡Œå»é‡ã€‚ List\u0026lt;Author\u0026gt; authors = getAuthors(); authors.stream() .flatMap(author -\u0026gt; author.getBooks().stream()) .distinct() .forEach(book -\u0026gt; System.out.println(book.getName())); ä¾‹äºŒï¼š\nâ€‹\tæ‰“å°ç°æœ‰æ•°æ®çš„æ‰€æœ‰åˆ†ç±»ã€‚è¦æ±‚å¯¹åˆ†ç±»è¿›è¡Œå»é‡ã€‚ä¸èƒ½å‡ºç°è¿™ç§æ ¼å¼ï¼šå“²å­¦,çˆ±æƒ…\n// æ‰“å°ç°æœ‰æ•°æ®çš„æ‰€æœ‰åˆ†ç±»ã€‚è¦æ±‚å¯¹åˆ†ç±»è¿›è¡Œå»é‡ã€‚ä¸èƒ½å‡ºç°è¿™ç§æ ¼å¼ï¼šå“²å­¦,çˆ±æƒ… çˆ±æƒ… List\u0026lt;Author\u0026gt; authors = getAuthors(); authors.stream() .flatMap(author -\u0026gt; author.getBooks().stream()) .distinct() .flatMap(book -\u0026gt; Arrays.stream(book.getCategory().split(\u0026#34;,\u0026#34;))) .distinct() .forEach(category-\u0026gt; System.out.println(category)); 3.4.3 ç»ˆç»“æ“ä½œ forEach â€‹\tå¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œéå†æ“ä½œï¼Œæˆ‘ä»¬é€šè¿‡ä¼ å…¥çš„å‚æ•°å»æŒ‡å®šå¯¹éå†åˆ°çš„å…ƒç´ è¿›è¡Œä»€ä¹ˆå…·ä½“æ“ä½œã€‚\nä¾‹å­ï¼š\nâ€‹\tè¾“å‡ºæ‰€æœ‰ä½œå®¶çš„åå­—\n// è¾“å‡ºæ‰€æœ‰ä½œå®¶çš„åå­— List\u0026lt;Author\u0026gt; authors = getAuthors(); authors.stream() .map(author -\u0026gt; author.getName()) .distinct() .forEach(name-\u0026gt; System.out.println(name)); count â€‹\tå¯ä»¥ç”¨æ¥è·å–å½“å‰æµä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚\nä¾‹å­ï¼š\nâ€‹\tæ‰“å°è¿™äº›ä½œå®¶çš„æ‰€å‡ºä¹¦ç±çš„æ•°ç›®ï¼Œæ³¨æ„åˆ é™¤é‡å¤å…ƒç´ ã€‚\n// æ‰“å°è¿™äº›ä½œå®¶çš„æ‰€å‡ºä¹¦ç±çš„æ•°ç›®ï¼Œæ³¨æ„åˆ é™¤é‡å¤å…ƒç´ ã€‚ List\u0026lt;Author\u0026gt; authors = getAuthors(); long count = authors.stream() .flatMap(author -\u0026gt; author.getBooks().stream()) .distinct() .count(); System.out.println(count); max\u0026amp;min â€‹\tå¯ä»¥ç”¨æ¥æˆ–è€…æµä¸­çš„æœ€å€¼ã€‚\nä¾‹å­ï¼š\nâ€‹\tåˆ†åˆ«è·å–è¿™äº›ä½œå®¶çš„æ‰€å‡ºä¹¦ç±çš„æœ€é«˜åˆ†å’Œæœ€ä½åˆ†å¹¶æ‰“å°ã€‚\n// åˆ†åˆ«è·å–è¿™äº›ä½œå®¶çš„æ‰€å‡ºä¹¦ç±çš„æœ€é«˜åˆ†å’Œæœ€ä½åˆ†å¹¶æ‰“å°ã€‚ //Stream\u0026lt;Author\u0026gt; -\u0026gt; Stream\u0026lt;Book\u0026gt; -\u0026gt;Stream\u0026lt;Integer\u0026gt; -\u0026gt;æ±‚å€¼ List\u0026lt;Author\u0026gt; authors = getAuthors(); Optional\u0026lt;Integer\u0026gt; max = authors.stream() .flatMap(author -\u0026gt; author.getBooks().stream()) .map(book -\u0026gt; book.getScore()) .max((score1, score2) -\u0026gt; score1 - score2); Optional\u0026lt;Integer\u0026gt; min = authors.stream() .flatMap(author -\u0026gt; author.getBooks().stream()) .map(book -\u0026gt; book.getScore()) .min((score1, score2) -\u0026gt; score1 - score2); System.out.println(max.get()); System.out.println(min.get()); collect â€‹\tæŠŠå½“å‰æµè½¬æ¢æˆä¸€ä¸ªé›†åˆã€‚\nä¾‹å­ï¼š\nâ€‹\tè·å–ä¸€ä¸ªå­˜æ”¾æ‰€æœ‰ä½œè€…åå­—çš„Listé›†åˆã€‚\n// è·å–ä¸€ä¸ªå­˜æ”¾æ‰€æœ‰ä½œè€…åå­—çš„Listé›†åˆã€‚ List\u0026lt;Author\u0026gt; authors = getAuthors(); List\u0026lt;String\u0026gt; nameList = authors.stream() .map(author -\u0026gt; author.getName()) .collect(Collectors.toList()); System.out.println(nameList); â€‹\tè·å–ä¸€ä¸ªæ‰€æœ‰ä¹¦åçš„Seté›†åˆã€‚\n// è·å–ä¸€ä¸ªæ‰€æœ‰ä¹¦åçš„Seté›†åˆã€‚ List\u0026lt;Author\u0026gt; authors = getAuthors(); Set\u0026lt;Book\u0026gt; books = authors.stream() .flatMap(author -\u0026gt; author.getBooks().stream()) .collect(Collectors.toSet()); System.out.println(books); â€‹\tè·å–ä¸€ä¸ªMapé›†åˆï¼Œmapçš„keyä¸ºä½œè€…åï¼Œvalueä¸ºList\n// è·å–ä¸€ä¸ªMapé›†åˆï¼Œmapçš„keyä¸ºä½œè€…åï¼Œvalueä¸ºList\u0026lt;Book\u0026gt; List\u0026lt;Author\u0026gt; authors = getAuthors(); Map\u0026lt;String, List\u0026lt;Book\u0026gt;\u0026gt; map = authors.stream() .distinct() .collect(Collectors.toMap(author -\u0026gt; author.getName(), author -\u0026gt; author.getBooks())); System.out.println(map); æŸ¥æ‰¾ä¸åŒ¹é… anyMatch â€‹\tå¯ä»¥ç”¨æ¥åˆ¤æ–­æ˜¯å¦æœ‰ä»»æ„ç¬¦åˆåŒ¹é…æ¡ä»¶çš„å…ƒç´ ï¼Œç»“æœä¸ºbooleanç±»å‹ã€‚\nä¾‹å­ï¼š\nâ€‹\tåˆ¤æ–­æ˜¯å¦æœ‰å¹´é¾„åœ¨29ä»¥ä¸Šçš„ä½œå®¶\n// åˆ¤æ–­æ˜¯å¦æœ‰å¹´é¾„åœ¨29ä»¥ä¸Šçš„ä½œå®¶ List\u0026lt;Author\u0026gt; authors = getAuthors(); boolean flag = authors.stream() .anyMatch(author -\u0026gt; author.getAge() \u0026gt; 29); System.out.println(flag); allMatch â€‹\tå¯ä»¥ç”¨æ¥åˆ¤æ–­æ˜¯å¦éƒ½ç¬¦åˆåŒ¹é…æ¡ä»¶ï¼Œç»“æœä¸ºbooleanç±»å‹ã€‚å¦‚æœéƒ½ç¬¦åˆç»“æœä¸ºtrueï¼Œå¦åˆ™ç»“æœä¸ºfalseã€‚\nä¾‹å­ï¼š\nâ€‹\tåˆ¤æ–­æ˜¯å¦æ‰€æœ‰çš„ä½œå®¶éƒ½æ˜¯æˆå¹´äºº\n// åˆ¤æ–­æ˜¯å¦æ‰€æœ‰çš„ä½œå®¶éƒ½æ˜¯æˆå¹´äºº List\u0026lt;Author\u0026gt; authors = getAuthors(); boolean flag = authors.stream() .allMatch(author -\u0026gt; author.getAge() \u0026gt;= 18); System.out.println(flag); noneMatch â€‹\tå¯ä»¥åˆ¤æ–­æµä¸­çš„å…ƒç´ æ˜¯å¦éƒ½ä¸ç¬¦åˆåŒ¹é…æ¡ä»¶ã€‚å¦‚æœéƒ½ä¸ç¬¦åˆç»“æœä¸ºtrueï¼Œå¦åˆ™ç»“æœä¸ºfalse\nä¾‹å­ï¼š\nâ€‹\tåˆ¤æ–­ä½œå®¶æ˜¯å¦éƒ½æ²¡æœ‰è¶…è¿‡100å²çš„ã€‚\n// åˆ¤æ–­ä½œå®¶æ˜¯å¦éƒ½æ²¡æœ‰è¶…è¿‡100å²çš„ã€‚ List\u0026lt;Author\u0026gt; authors = getAuthors(); boolean b = authors.stream() .noneMatch(author -\u0026gt; author.getAge() \u0026gt; 100); System.out.println(b); findAny â€‹\tè·å–æµä¸­çš„ä»»æ„ä¸€ä¸ªå…ƒç´ ã€‚è¯¥æ–¹æ³•æ²¡æœ‰åŠæ³•ä¿è¯è·å–çš„ä¸€å®šæ˜¯æµä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚\nä¾‹å­ï¼š\nâ€‹\tè·å–ä»»æ„ä¸€ä¸ªå¹´é¾„å¤§äº18çš„ä½œå®¶ï¼Œå¦‚æœå­˜åœ¨å°±è¾“å‡ºä»–çš„åå­—\n// è·å–ä»»æ„ä¸€ä¸ªå¹´é¾„å¤§äº18çš„ä½œå®¶ï¼Œå¦‚æœå­˜åœ¨å°±è¾“å‡ºä»–çš„åå­— List\u0026lt;Author\u0026gt; authors = getAuthors(); Optional\u0026lt;Author\u0026gt; optionalAuthor = authors.stream() .filter(author -\u0026gt; author.getAge()\u0026gt;18) .findAny(); optionalAuthor.ifPresent(author -\u0026gt; System.out.println(author.getName())); findFirst â€‹\tè·å–æµä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚\nä¾‹å­ï¼š\nâ€‹\tè·å–ä¸€ä¸ªå¹´é¾„æœ€å°çš„ä½œå®¶ï¼Œå¹¶è¾“å‡ºä»–çš„å§“åã€‚\n// è·å–ä¸€ä¸ªå¹´é¾„æœ€å°çš„ä½œå®¶ï¼Œå¹¶è¾“å‡ºä»–çš„å§“åã€‚ List\u0026lt;Author\u0026gt; authors = getAuthors(); Optional\u0026lt;Author\u0026gt; first = authors.stream() .sorted((o1, o2) -\u0026gt; o1.getAge() - o2.getAge()) .findFirst(); first.ifPresent(author -\u0026gt; System.out.println(author.getName())); reduceå½’å¹¶ â€‹\tå¯¹æµä¸­çš„æ•°æ®æŒ‰ç…§ä½ æŒ‡å®šçš„è®¡ç®—æ–¹å¼è®¡ç®—å‡ºä¸€ä¸ªç»“æœã€‚ï¼ˆç¼©å‡æ“ä½œï¼‰\nâ€‹\treduceçš„ä½œç”¨æ˜¯æŠŠstreamä¸­çš„å…ƒç´ ç»™ç»„åˆèµ·æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªåˆå§‹å€¼ï¼Œå®ƒä¼šæŒ‰ç…§æˆ‘ä»¬çš„è®¡ç®—æ–¹å¼ä¾æ¬¡æ‹¿æµä¸­çš„å…ƒç´ å’Œåˆå§‹åŒ–å€¼è¿›è¡Œè®¡ç®—ï¼Œè®¡ç®—ç»“æœå†å’Œåé¢çš„å…ƒç´ è®¡ç®—ã€‚\nâ€‹\treduceä¸¤ä¸ªå‚æ•°çš„é‡è½½å½¢å¼å†…éƒ¨çš„è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š\nT result = identity; for (T element : this stream) result = accumulator.apply(result, element) return result; â€‹\tå…¶ä¸­identityå°±æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ–¹æ³•å‚æ•°ä¼ å…¥çš„åˆå§‹å€¼ï¼Œaccumulatorçš„applyå…·ä½“è¿›è¡Œä»€ä¹ˆè®¡ç®—ä¹Ÿæ˜¯æˆ‘ä»¬é€šè¿‡æ–¹æ³•å‚æ•°æ¥ç¡®å®šçš„ã€‚\nä¾‹å­ï¼š\nâ€‹\tä½¿ç”¨reduceæ±‚æ‰€æœ‰ä½œè€…å¹´é¾„çš„å’Œ\n// ä½¿ç”¨reduceæ±‚æ‰€æœ‰ä½œè€…å¹´é¾„çš„å’Œ List\u0026lt;Author\u0026gt; authors = getAuthors(); Integer sum = authors.stream() .distinct() .map(author -\u0026gt; author.getAge()) .reduce(0, (result, element) -\u0026gt; result + element); System.out.println(sum); â€‹\tä½¿ç”¨reduceæ±‚æ‰€æœ‰ä½œè€…ä¸­å¹´é¾„çš„æœ€å¤§å€¼\n// ä½¿ç”¨reduceæ±‚æ‰€æœ‰ä½œè€…ä¸­å¹´é¾„çš„æœ€å¤§å€¼ List\u0026lt;Author\u0026gt; authors = getAuthors(); Integer max = authors.stream() .map(author -\u0026gt; author.getAge()) .reduce(Integer.MIN_VALUE, (result, element) -\u0026gt; result \u0026lt; element ? element : result); System.out.println(max); â€‹\tä½¿ç”¨reduceæ±‚æ‰€æœ‰ä½œè€…ä¸­å¹´é¾„çš„æœ€å°å€¼\n// ä½¿ç”¨reduceæ±‚æ‰€æœ‰ä½œè€…ä¸­å¹´é¾„çš„æœ€å°å€¼ List\u0026lt;Author\u0026gt; authors = getAuthors(); Integer min = authors.stream() .map(author -\u0026gt; author.getAge()) .reduce(Integer.MAX_VALUE, (result, element) -\u0026gt; result \u0026gt; element ? element : result); System.out.println(min); â€‹\treduceä¸€ä¸ªå‚æ•°çš„é‡è½½å½¢å¼å†…éƒ¨çš„è®¡ç®—\nboolean foundAny = false; T result = null; for (T element : this stream) { if (!foundAny) { foundAny = true; result = element; } else result = accumulator.apply(result, element); } return foundAny ? Optional.of(result) : Optional.empty(); â€‹\tå¦‚æœç”¨ä¸€ä¸ªå‚æ•°çš„é‡è½½æ–¹æ³•å»æ±‚æœ€å°å€¼ä»£ç å¦‚ä¸‹ï¼š\n// ä½¿ç”¨reduceæ±‚æ‰€æœ‰ä½œè€…ä¸­å¹´é¾„çš„æœ€å°å€¼ List\u0026lt;Author\u0026gt; authors = getAuthors(); Optional\u0026lt;Integer\u0026gt; minOptional = authors.stream() .map(author -\u0026gt; author.getAge()) .reduce((result, element) -\u0026gt; result \u0026gt; element ? element : result); minOptional.ifPresent(age-\u0026gt; System.out.println(age)); 3.5 æ³¨æ„äº‹é¡¹ æƒ°æ€§æ±‚å€¼ï¼ˆå¦‚æœæ²¡æœ‰ç»ˆç»“æ“ä½œï¼Œæ²¡æœ‰ä¸­é—´æ“ä½œæ˜¯ä¸ä¼šå¾—åˆ°æ‰§è¡Œçš„ï¼‰ æµæ˜¯ä¸€æ¬¡æ€§çš„ï¼ˆä¸€æ—¦ä¸€ä¸ªæµå¯¹è±¡ç»è¿‡ä¸€ä¸ªç»ˆç»“æ“ä½œåã€‚è¿™ä¸ªæµå°±ä¸èƒ½å†è¢«ä½¿ç”¨ï¼‰ ä¸ä¼šå½±å“åŸæ•°æ®ï¼ˆæˆ‘ä»¬åœ¨æµä¸­å¯ä»¥å¤šæ•°æ®åšå¾ˆå¤šå¤„ç†ã€‚ä½†æ˜¯æ­£å¸¸æƒ…å†µä¸‹æ˜¯ä¸ä¼šå½±å“åŸæ¥é›†åˆä¸­çš„å…ƒç´ çš„ã€‚è¿™å¾€å¾€ä¹Ÿæ˜¯æˆ‘ä»¬æœŸæœ›çš„ï¼‰ 4. Optional 4.1 æ¦‚è¿° â€‹\tæˆ‘ä»¬åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™å‡ºç°æœ€å¤šçš„å°±æ˜¯ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚æ‰€ä»¥åœ¨å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦åšå„ç§éç©ºçš„åˆ¤æ–­ã€‚\nâ€‹\tä¾‹å¦‚ï¼š\nAuthor author = getAuthor(); if(author!=null){ System.out.println(author.getName()); } â€‹\tå°¤å…¶æ˜¯å¯¹è±¡ä¸­çš„å±æ€§è¿˜æ˜¯ä¸€ä¸ªå¯¹è±¡çš„æƒ…å†µä¸‹ã€‚è¿™ç§åˆ¤æ–­ä¼šæ›´å¤šã€‚\nâ€‹\tè€Œè¿‡å¤šçš„åˆ¤æ–­è¯­å¥ä¼šè®©æˆ‘ä»¬çš„ä»£ç æ˜¾å¾—è‡ƒè‚¿ä¸å ªã€‚\nâ€‹\tæ‰€ä»¥åœ¨JDK8ä¸­å¼•å…¥äº†Optional,å…»æˆä½¿ç”¨Optionalçš„ä¹ æƒ¯åä½ å¯ä»¥å†™å‡ºæ›´ä¼˜é›…çš„ä»£ç æ¥é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚\nâ€‹\tå¹¶ä¸”åœ¨å¾ˆå¤šå‡½æ•°å¼ç¼–ç¨‹ç›¸å…³çš„APIä¸­ä¹Ÿéƒ½ç”¨åˆ°äº†Optionalï¼Œå¦‚æœä¸ä¼šä½¿ç”¨Optionalä¹Ÿä¼šå¯¹å‡½æ•°å¼ç¼–ç¨‹çš„å­¦ä¹ é€ æˆå½±å“ã€‚\n4.2 ä½¿ç”¨ 4.2.1 åˆ›å»ºå¯¹è±¡ â€‹\tOptionalå°±å¥½åƒæ˜¯åŒ…è£…ç±»ï¼Œå¯ä»¥æŠŠæˆ‘ä»¬çš„å…·ä½“æ•°æ®å°è£…Optionalå¯¹è±¡å†…éƒ¨ã€‚ç„¶åæˆ‘ä»¬å»ä½¿ç”¨Optionalä¸­å°è£…å¥½çš„æ–¹æ³•æ“ä½œå°è£…è¿›å»çš„æ•°æ®å°±å¯ä»¥éå¸¸ä¼˜é›…çš„é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚\nâ€‹\tæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨Optionalçš„é™æ€æ–¹æ³•ofNullableæ¥æŠŠæ•°æ®å°è£…æˆä¸€ä¸ªOptionalå¯¹è±¡ã€‚æ— è®ºä¼ å…¥çš„å‚æ•°æ˜¯å¦ä¸ºnulléƒ½ä¸ä¼šå‡ºç°é—®é¢˜ã€‚\nAuthor author = getAuthor(); Optional\u0026lt;Author\u0026gt; authorOptional = Optional.ofNullable(author); â€‹\tä½ å¯èƒ½ä¼šè§‰å¾—è¿˜è¦åŠ ä¸€è¡Œä»£ç æ¥å°è£…æ•°æ®æ¯”è¾ƒéº»çƒ¦ã€‚ä½†æ˜¯å¦‚æœæ”¹é€ ä¸‹getAuthoræ–¹æ³•ï¼Œè®©å…¶çš„è¿”å›å€¼å°±æ˜¯å°è£…å¥½çš„Optionalçš„è¯ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨æ—¶å°±ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚\nâ€‹\tè€Œä¸”åœ¨å®é™…å¼€å‘ä¸­æˆ‘ä»¬çš„æ•°æ®å¾ˆå¤šæ˜¯ä»æ•°æ®åº“è·å–çš„ã€‚Mybatisä»3.5ç‰ˆæœ¬å¯ä»¥ä¹Ÿå·²ç»æ”¯æŒOptionaläº†ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠdaoæ–¹æ³•çš„è¿”å›å€¼ç±»å‹å®šä¹‰æˆOptionalç±»å‹ï¼ŒMyBastisä¼šè‡ªå·±æŠŠæ•°æ®å°è£…æˆOptionalå¯¹è±¡è¿”å›ã€‚å°è£…çš„è¿‡ç¨‹ä¹Ÿä¸éœ€è¦æˆ‘ä»¬è‡ªå·±æ“ä½œã€‚\nâ€‹\tå¦‚æœä½ ç¡®å®šä¸€ä¸ªå¯¹è±¡ä¸æ˜¯ç©ºçš„åˆ™å¯ä»¥ä½¿ç”¨Optionalçš„é™æ€æ–¹æ³•ofæ¥æŠŠæ•°æ®å°è£…æˆOptionalå¯¹è±¡ã€‚\nAuthor author = new Author(); Optional\u0026lt;Author\u0026gt; authorOptional = Optional.of(author); â€‹\tä½†æ˜¯ä¸€å®šè¦æ³¨æ„ï¼Œå¦‚æœä½¿ç”¨ofçš„æ—¶å€™ä¼ å…¥çš„å‚æ•°å¿…é¡»ä¸ä¸ºnullã€‚ï¼ˆå°è¯•ä¸‹ä¼ å…¥nullä¼šå‡ºç°ä»€ä¹ˆç»“æœï¼‰\nâ€‹\tå¦‚æœä¸€ä¸ªæ–¹æ³•çš„è¿”å›å€¼ç±»å‹æ˜¯Optionalç±»å‹ã€‚è€Œå¦‚æœæˆ‘ä»¬ç»åˆ¤æ–­å‘ç°æŸæ¬¡è®¡ç®—å¾—åˆ°çš„è¿”å›å€¼ä¸ºnullï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æŠŠnullå°è£…æˆOptionalå¯¹è±¡è¿”å›ã€‚è¿™æ—¶åˆ™å¯ä»¥ä½¿ç”¨Optionalçš„é™æ€æ–¹æ³•emptyæ¥è¿›è¡Œå°è£…ã€‚\nOptional.empty() â€‹\nâ€‹\tæ‰€ä»¥æœ€åä½ è§‰å¾—å“ªç§æ–¹å¼ä¼šæ›´æ–¹ä¾¿å‘¢ï¼ŸofNullable\n4.2.2 å®‰å…¨æ¶ˆè´¹å€¼ â€‹\tæˆ‘ä»¬è·å–åˆ°ä¸€ä¸ªOptionalå¯¹è±¡åè‚¯å®šéœ€è¦å¯¹å…¶ä¸­çš„æ•°æ®è¿›è¡Œä½¿ç”¨ã€‚è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ifPresentæ–¹æ³•å¯¹æ¥æ¶ˆè´¹å…¶ä¸­çš„å€¼ã€‚\nâ€‹\tè¿™ä¸ªæ–¹æ³•ä¼šåˆ¤æ–­å…¶å†…å°è£…çš„æ•°æ®æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºæ—¶æ‰ä¼šæ‰§è¡Œå…·ä½“çš„æ¶ˆè´¹ä»£ç ã€‚è¿™æ ·ä½¿ç”¨èµ·æ¥å°±æ›´åŠ å®‰å…¨äº†ã€‚\nâ€‹\tä¾‹å¦‚,ä»¥ä¸‹å†™æ³•å°±ä¼˜é›…çš„é¿å…äº†ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚\nOptional\u0026lt;Author\u0026gt; authorOptional = Optional.ofNullable(getAuthor()); authorOptional.ifPresent(author -\u0026gt; System.out.println(author.getName())); 4.2.3 è·å–å€¼ â€‹\tå¦‚æœæˆ‘ä»¬æƒ³è·å–å€¼è‡ªå·±è¿›è¡Œå¤„ç†å¯ä»¥ä½¿ç”¨getæ–¹æ³•è·å–ï¼Œä½†æ˜¯ä¸æ¨èã€‚å› ä¸ºå½“Optionalå†…éƒ¨çš„æ•°æ®ä¸ºç©ºçš„æ—¶å€™ä¼šå‡ºç°å¼‚å¸¸ã€‚\n4.2.4 å®‰å…¨è·å–å€¼ â€‹\tå¦‚æœæˆ‘ä»¬æœŸæœ›å®‰å…¨çš„è·å–å€¼ã€‚æˆ‘ä»¬ä¸æ¨èä½¿ç”¨getæ–¹æ³•ï¼Œè€Œæ˜¯ä½¿ç”¨Optionalæä¾›çš„ä»¥ä¸‹æ–¹æ³•ã€‚\norElseGet\nè·å–æ•°æ®å¹¶ä¸”è®¾ç½®æ•°æ®ä¸ºç©ºæ—¶çš„é»˜è®¤å€¼ã€‚å¦‚æœæ•°æ®ä¸ä¸ºç©ºå°±èƒ½è·å–åˆ°è¯¥æ•°æ®ã€‚å¦‚æœä¸ºç©ºåˆ™æ ¹æ®ä½ ä¼ å…¥çš„å‚æ•°æ¥åˆ›å»ºå¯¹è±¡ä½œä¸ºé»˜è®¤å€¼è¿”å›ã€‚\nOptional\u0026lt;Author\u0026gt; authorOptional = Optional.ofNullable(getAuthor()); Author author1 = authorOptional.orElseGet(() -\u0026gt; new Author()); orElseThrow\nè·å–æ•°æ®ï¼Œå¦‚æœæ•°æ®ä¸ä¸ºç©ºå°±èƒ½è·å–åˆ°è¯¥æ•°æ®ã€‚å¦‚æœä¸ºç©ºåˆ™æ ¹æ®ä½ ä¼ å…¥çš„å‚æ•°æ¥åˆ›å»ºå¼‚å¸¸æŠ›å‡ºã€‚\nOptional\u0026lt;Author\u0026gt; authorOptional = Optional.ofNullable(getAuthor()); try { Author author = authorOptional.orElseThrow((Supplier\u0026lt;Throwable\u0026gt;) () -\u0026gt; new RuntimeException(\u0026#34;authorä¸ºç©º\u0026#34;)); System.out.println(author.getName()); } catch (Throwable throwable) { throwable.printStackTrace(); } 4.2.5 è¿‡æ»¤ â€‹\tæˆ‘ä»¬å¯ä»¥ä½¿ç”¨filteræ–¹æ³•å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ã€‚å¦‚æœåŸæœ¬æ˜¯æœ‰æ•°æ®çš„ï¼Œä½†æ˜¯ä¸ç¬¦åˆåˆ¤æ–­ï¼Œä¹Ÿä¼šå˜æˆä¸€ä¸ªæ— æ•°æ®çš„Optionalå¯¹è±¡ã€‚\nOptional\u0026lt;Author\u0026gt; authorOptional = Optional.ofNullable(getAuthor()); authorOptional.filter(author -\u0026gt; author.getAge()\u0026gt;100).ifPresent(author -\u0026gt; System.out.println(author.getName())); 4.2.6 åˆ¤æ–­ â€‹\tæˆ‘ä»¬å¯ä»¥ä½¿ç”¨isPresentæ–¹æ³•è¿›è¡Œæ˜¯å¦å­˜åœ¨æ•°æ®çš„åˆ¤æ–­ã€‚å¦‚æœä¸ºç©ºè¿”å›å€¼ä¸ºfalse,å¦‚æœä¸ä¸ºç©ºï¼Œè¿”å›å€¼ä¸ºtrueã€‚ä½†æ˜¯è¿™ç§æ–¹å¼å¹¶ä¸èƒ½ä½“ç°Optionalçš„å¥½å¤„ï¼Œæ›´æ¨èä½¿ç”¨ifPresentæ–¹æ³•ã€‚\nOptional\u0026lt;Author\u0026gt; authorOptional = Optional.ofNullable(getAuthor()); if (authorOptional.isPresent()) { System.out.println(authorOptional.get().getName()); } 4.2.7 æ•°æ®è½¬æ¢ â€‹\tOptionalè¿˜æä¾›äº†mapå¯ä»¥è®©æˆ‘ä»¬çš„å¯¹æ•°æ®è¿›è¡Œè½¬æ¢ï¼Œå¹¶ä¸”è½¬æ¢å¾—åˆ°çš„æ•°æ®ä¹Ÿè¿˜æ˜¯è¢«OptionalåŒ…è£…å¥½çš„ï¼Œä¿è¯äº†æˆ‘ä»¬çš„ä½¿ç”¨å®‰å…¨ã€‚\nä¾‹å¦‚æˆ‘ä»¬æƒ³è·å–ä½œå®¶çš„ä¹¦ç±é›†åˆã€‚\nprivate static void testMap() { Optional\u0026lt;Author\u0026gt; authorOptional = getAuthorOptional(); Optional\u0026lt;List\u0026lt;Book\u0026gt;\u0026gt; optionalBooks = authorOptional.map(author -\u0026gt; author.getBooks()); optionalBooks.ifPresent(books -\u0026gt; System.out.println(books)); } 5. å‡½æ•°å¼æ¥å£ 5.1 æ¦‚è¿° â€‹\tåªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£æˆ‘ä»¬ç§°ä¹‹ä¸ºå‡½æ•°æ¥å£ã€‚\nâ€‹\tJDKçš„å‡½æ•°å¼æ¥å£éƒ½åŠ ä¸Šäº†**@FunctionalInterface** æ³¨è§£è¿›è¡Œæ ‡è¯†ã€‚ä½†æ˜¯æ— è®ºæ˜¯å¦åŠ ä¸Šè¯¥æ³¨è§£åªè¦æ¥å£ä¸­åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œéƒ½æ˜¯å‡½æ•°å¼æ¥å£ã€‚\n5.2 å¸¸è§å‡½æ•°å¼æ¥å£ â€‹\tConsumer æ¶ˆè´¹æ¥å£\næ ¹æ®å…¶ä¸­æŠ½è±¡æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹çŸ¥é“ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ–¹æ³•ä¸­å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œæ¶ˆè´¹ã€‚\nâ€‹\tFunction è®¡ç®—è½¬æ¢æ¥å£\næ ¹æ®å…¶ä¸­æŠ½è±¡æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹çŸ¥é“ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ–¹æ³•ä¸­å¯¹ä¼ å…¥çš„å‚æ•°è®¡ç®—æˆ–è½¬æ¢ï¼ŒæŠŠç»“æœè¿”å›\nâ€‹\tPredicate åˆ¤æ–­æ¥å£\næ ¹æ®å…¶ä¸­æŠ½è±¡æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹çŸ¥é“ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ–¹æ³•ä¸­å¯¹ä¼ å…¥çš„å‚æ•°æ¡ä»¶åˆ¤æ–­ï¼Œè¿”å›åˆ¤æ–­ç»“æœ\nâ€‹\tSupplier ç”Ÿäº§å‹æ¥å£\næ ¹æ®å…¶ä¸­æŠ½è±¡æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹çŸ¥é“ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ–¹æ³•ä¸­åˆ›å»ºå¯¹è±¡ï¼ŒæŠŠåˆ›å»ºå¥½çš„å¯¹è±¡è¿”å›\n5.3 å¸¸ç”¨çš„é»˜è®¤æ–¹æ³• and\næˆ‘ä»¬åœ¨ä½¿ç”¨Predicateæ¥å£æ—¶å€™å¯èƒ½éœ€è¦è¿›è¡Œåˆ¤æ–­æ¡ä»¶çš„æ‹¼æ¥ã€‚è€Œandæ–¹æ³•ç›¸å½“äºæ˜¯ä½¿ç”¨\u0026amp;\u0026amp;æ¥æ‹¼æ¥ä¸¤ä¸ªåˆ¤æ–­æ¡ä»¶\nä¾‹å¦‚ï¼š\næ‰“å°ä½œå®¶ä¸­å¹´é¾„å¤§äº17å¹¶ä¸”å§“åçš„é•¿åº¦å¤§äº1çš„ä½œå®¶ã€‚\nList\u0026lt;Author\u0026gt; authors = getAuthors(); Stream\u0026lt;Author\u0026gt; authorStream = authors.stream(); authorStream.filter(new Predicate\u0026lt;Author\u0026gt;() { @Override public boolean test(Author author) { return author.getAge()\u0026gt;17; } }.and(new Predicate\u0026lt;Author\u0026gt;() { @Override public boolean test(Author author) { return author.getName().length()\u0026gt;1; } })).forEach(author -\u0026gt; System.out.println(author)); or\næˆ‘ä»¬åœ¨ä½¿ç”¨Predicateæ¥å£æ—¶å€™å¯èƒ½éœ€è¦è¿›è¡Œåˆ¤æ–­æ¡ä»¶çš„æ‹¼æ¥ã€‚è€Œoræ–¹æ³•ç›¸å½“äºæ˜¯ä½¿ç”¨||æ¥æ‹¼æ¥ä¸¤ä¸ªåˆ¤æ–­æ¡ä»¶ã€‚\nä¾‹å¦‚ï¼š\næ‰“å°ä½œå®¶ä¸­å¹´é¾„å¤§äº17æˆ–è€…å§“åçš„é•¿åº¦å°äº2çš„ä½œå®¶ã€‚\n// æ‰“å°ä½œå®¶ä¸­å¹´é¾„å¤§äº17æˆ–è€…å§“åçš„é•¿åº¦å°äº2çš„ä½œå®¶ã€‚ List\u0026lt;Author\u0026gt; authors = getAuthors(); authors.stream() .filter(new Predicate\u0026lt;Author\u0026gt;() { @Override public boolean test(Author author) { return author.getAge()\u0026gt;17; } }.or(new Predicate\u0026lt;Author\u0026gt;() { @Override public boolean test(Author author) { return author.getName().length()\u0026lt;2; } })).forEach(author -\u0026gt; System.out.println(author.getName())); negate\nPredicateæ¥å£ä¸­çš„æ–¹æ³•ã€‚negateæ–¹æ³•ç›¸å½“äºæ˜¯åœ¨åˆ¤æ–­æ·»åŠ å‰é¢åŠ äº†ä¸ª! è¡¨ç¤ºå–å\nä¾‹å¦‚ï¼š\næ‰“å°ä½œå®¶ä¸­å¹´é¾„ä¸å¤§äº17çš„ä½œå®¶ã€‚\n// æ‰“å°ä½œå®¶ä¸­å¹´é¾„ä¸å¤§äº17çš„ä½œå®¶ã€‚ List\u0026lt;Author\u0026gt; authors = getAuthors(); authors.stream() .filter(new Predicate\u0026lt;Author\u0026gt;() { @Override public boolean test(Author author) { return author.getAge()\u0026gt;17; } }.negate()).forEach(author -\u0026gt; System.out.println(author.getAge())); 6. æ–¹æ³•å¼•ç”¨ â€‹\tæˆ‘ä»¬åœ¨ä½¿ç”¨lambdaæ—¶ï¼Œå¦‚æœæ–¹æ³•ä½“ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•çš„è°ƒç”¨çš„è¯ï¼ˆåŒ…æ‹¬æ„é€ æ–¹æ³•ï¼‰,æˆ‘ä»¬å¯ä»¥ç”¨æ–¹æ³•å¼•ç”¨è¿›ä¸€æ­¥ç®€åŒ–ä»£ç ã€‚\n6.1 æ¨èç”¨æ³• â€‹\tæˆ‘ä»¬åœ¨ä½¿ç”¨lambdaæ—¶ä¸éœ€è¦è€ƒè™‘ä»€ä¹ˆæ—¶å€™ç”¨æ–¹æ³•å¼•ç”¨ï¼Œç”¨å“ªç§æ–¹æ³•å¼•ç”¨ï¼Œæ–¹æ³•å¼•ç”¨çš„æ ¼å¼æ˜¯ä»€ä¹ˆã€‚æˆ‘ä»¬åªéœ€è¦åœ¨å†™å®Œlambdaæ–¹æ³•å‘ç°æ–¹æ³•ä½“åªæœ‰ä¸€è¡Œä»£ç ï¼Œå¹¶ä¸”æ˜¯æ–¹æ³•çš„è°ƒç”¨æ—¶ä½¿ç”¨å¿«æ·é”®å°è¯•æ˜¯å¦èƒ½å¤Ÿè½¬æ¢æˆæ–¹æ³•å¼•ç”¨å³å¯ã€‚\nâ€‹\tå½“æˆ‘ä»¬æ–¹æ³•å¼•ç”¨ä½¿ç”¨çš„å¤šäº†æ…¢æ…¢çš„ä¹Ÿå¯ä»¥ç›´æ¥å†™å‡ºæ–¹æ³•å¼•ç”¨ã€‚\n6.2 åŸºæœ¬æ ¼å¼ â€‹\tç±»åæˆ–è€…å¯¹è±¡å::æ–¹æ³•å\n6.3 è¯­æ³•è¯¦è§£(äº†è§£) 6.3.1 å¼•ç”¨ç±»çš„é™æ€æ–¹æ³• â€‹\tå…¶å®å°±æ˜¯å¼•ç”¨ç±»çš„é™æ€æ–¹æ³•\næ ¼å¼ ç±»å::æ–¹æ³•å ä½¿ç”¨å‰æ â€‹\tå¦‚æœæˆ‘ä»¬åœ¨é‡å†™æ–¹æ³•çš„æ—¶å€™ï¼Œæ–¹æ³•ä½“ä¸­åªæœ‰ä¸€è¡Œä»£ç ï¼Œå¹¶ä¸”è¿™è¡Œä»£ç æ˜¯è°ƒç”¨äº†æŸä¸ªç±»çš„é™æ€æ–¹æ³•ï¼Œå¹¶ä¸”æˆ‘ä»¬æŠŠè¦é‡å†™çš„æŠ½è±¡æ–¹æ³•ä¸­æ‰€æœ‰çš„å‚æ•°éƒ½æŒ‰ç…§é¡ºåºä¼ å…¥äº†è¿™ä¸ªé™æ€æ–¹æ³•ä¸­ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¼•ç”¨ç±»çš„é™æ€æ–¹æ³•ã€‚\nâ€‹\nä¾‹å¦‚ï¼š\nå¦‚ä¸‹ä»£ç å°±å¯ä»¥ç”¨æ–¹æ³•å¼•ç”¨è¿›è¡Œç®€åŒ–\nList\u0026lt;Author\u0026gt; authors = getAuthors(); Stream\u0026lt;Author\u0026gt; authorStream = authors.stream(); authorStream.map(author -\u0026gt; author.getAge()) .map(age-\u0026gt;String.valueOf(age)); æ³¨æ„ï¼Œå¦‚æœæˆ‘ä»¬æ‰€é‡å†™çš„æ–¹æ³•æ˜¯æ²¡æœ‰å‚æ•°çš„ï¼Œè°ƒç”¨çš„æ–¹æ³•ä¹Ÿæ˜¯æ²¡æœ‰å‚æ•°çš„ä¹Ÿç›¸å½“äºç¬¦åˆä»¥ä¸Šè§„åˆ™ã€‚\nä¼˜åŒ–åå¦‚ä¸‹ï¼š\nList\u0026lt;Author\u0026gt; authors = getAuthors(); Stream\u0026lt;Author\u0026gt; authorStream = authors.stream(); authorStream.map(author -\u0026gt; author.getAge()) .map(String::valueOf); 6.3.2 å¼•ç”¨å¯¹è±¡çš„å®ä¾‹æ–¹æ³• æ ¼å¼ å¯¹è±¡å::æ–¹æ³•å ä½¿ç”¨å‰æ â€‹\tå¦‚æœæˆ‘ä»¬åœ¨é‡å†™æ–¹æ³•çš„æ—¶å€™ï¼Œæ–¹æ³•ä½“ä¸­åªæœ‰ä¸€è¡Œä»£ç ï¼Œå¹¶ä¸”è¿™è¡Œä»£ç æ˜¯è°ƒç”¨äº†æŸä¸ªå¯¹è±¡çš„æˆå‘˜æ–¹æ³•ï¼Œå¹¶ä¸”æˆ‘ä»¬æŠŠè¦é‡å†™çš„æŠ½è±¡æ–¹æ³•ä¸­æ‰€æœ‰çš„å‚æ•°éƒ½æŒ‰ç…§é¡ºåºä¼ å…¥äº†è¿™ä¸ªæˆå‘˜æ–¹æ³•ä¸­ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¼•ç”¨å¯¹è±¡çš„å®ä¾‹æ–¹æ³•\nä¾‹å¦‚ï¼š\nList\u0026lt;Author\u0026gt; authors = getAuthors(); Stream\u0026lt;Author\u0026gt; authorStream = authors.stream(); StringBuilder sb = new StringBuilder(); authorStream.map(author -\u0026gt; author.getName()) .forEach(name-\u0026gt;sb.append(name)); ä¼˜åŒ–åï¼š\nList\u0026lt;Author\u0026gt; authors = getAuthors(); Stream\u0026lt;Author\u0026gt; authorStream = authors.stream(); StringBuilder sb = new StringBuilder(); authorStream.map(author -\u0026gt; author.getName()) .forEach(sb::append); 6.3.4 å¼•ç”¨ç±»çš„å®ä¾‹æ–¹æ³• æ ¼å¼ ç±»å::æ–¹æ³•å ä½¿ç”¨å‰æ â€‹\tå¦‚æœæˆ‘ä»¬åœ¨é‡å†™æ–¹æ³•çš„æ—¶å€™ï¼Œæ–¹æ³•ä½“ä¸­åªæœ‰ä¸€è¡Œä»£ç ï¼Œå¹¶ä¸”è¿™è¡Œä»£ç æ˜¯è°ƒç”¨äº†ç¬¬ä¸€ä¸ªå‚æ•°çš„æˆå‘˜æ–¹æ³•ï¼Œå¹¶ä¸”æˆ‘ä»¬æŠŠè¦é‡å†™çš„æŠ½è±¡æ–¹æ³•ä¸­å‰©ä½™çš„æ‰€æœ‰çš„å‚æ•°éƒ½æŒ‰ç…§é¡ºåºä¼ å…¥äº†è¿™ä¸ªæˆå‘˜æ–¹æ³•ä¸­ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¼•ç”¨ç±»çš„å®ä¾‹æ–¹æ³•ã€‚\nä¾‹å¦‚ï¼š\ninterface UseString{ String use(String str,int start,int length); } public static String subAuthorName(String str, UseString useString){ int start = 0; int length = 1; return useString.use(str,start,length); } public static void main(String[] args) { subAuthorName(\u0026#34;ä¸‰æ›´è‰å ‚\u0026#34;, new UseString() { @Override public String use(String str, int start, int length) { return str.substring(start,length); } }); } ä¼˜åŒ–åå¦‚ä¸‹ï¼š\npublic static void main(String[] args) { subAuthorName(\u0026#34;ä¸‰æ›´è‰å ‚\u0026#34;, String::substring); } 6.3.5 æ„é€ å™¨å¼•ç”¨ â€‹\tå¦‚æœæ–¹æ³•ä½“ä¸­çš„ä¸€è¡Œä»£ç æ˜¯æ„é€ å™¨çš„è¯å°±å¯ä»¥ä½¿ç”¨æ„é€ å™¨å¼•ç”¨ã€‚\næ ¼å¼ ç±»å::new ä½¿ç”¨å‰æ â€‹\tå¦‚æœæˆ‘ä»¬åœ¨é‡å†™æ–¹æ³•çš„æ—¶å€™ï¼Œæ–¹æ³•ä½“ä¸­åªæœ‰ä¸€è¡Œä»£ç ï¼Œå¹¶ä¸”è¿™è¡Œä»£ç æ˜¯è°ƒç”¨äº†æŸä¸ªç±»çš„æ„é€ æ–¹æ³•ï¼Œå¹¶ä¸”æˆ‘ä»¬æŠŠè¦é‡å†™çš„æŠ½è±¡æ–¹æ³•ä¸­çš„æ‰€æœ‰çš„å‚æ•°éƒ½æŒ‰ç…§é¡ºåºä¼ å…¥äº†è¿™ä¸ªæ„é€ æ–¹æ³•ä¸­ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¼•ç”¨æ„é€ å™¨ã€‚\nä¾‹å¦‚ï¼š\nList\u0026lt;Author\u0026gt; authors = getAuthors(); authors.stream() .map(author -\u0026gt; author.getName()) .map(name-\u0026gt;new StringBuilder(name)) .map(sb-\u0026gt;sb.append(\u0026#34;-ä¸‰æ›´\u0026#34;).toString()) .forEach(str-\u0026gt; System.out.println(str)); ä¼˜åŒ–åï¼š\nList\u0026lt;Author\u0026gt; authors = getAuthors(); authors.stream() .map(author -\u0026gt; author.getName()) .map(StringBuilder::new) .map(sb-\u0026gt;sb.append(\u0026#34;-ä¸‰æ›´\u0026#34;).toString()) .forEach(str-\u0026gt; System.out.println(str)); 7. é«˜çº§ç”¨æ³• åŸºæœ¬æ•°æ®ç±»å‹ä¼˜åŒ– â€‹\tæˆ‘ä»¬ä¹‹å‰ç”¨åˆ°çš„å¾ˆå¤šStreamçš„æ–¹æ³•ç”±äºéƒ½ä½¿ç”¨äº†æ³›å‹ã€‚æ‰€ä»¥æ¶‰åŠåˆ°çš„å‚æ•°å’Œè¿”å›å€¼éƒ½æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ã€‚\nâ€‹\tå³ä½¿æˆ‘ä»¬æ“ä½œçš„æ˜¯æ•´æ•°å°æ•°ï¼Œä½†æ˜¯å®é™…ç”¨çš„éƒ½æ˜¯ä»–ä»¬çš„åŒ…è£…ç±»ã€‚JDK5ä¸­å¼•å…¥çš„è‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®±è®©æˆ‘ä»¬åœ¨ä½¿ç”¨å¯¹åº”çš„åŒ…è£…ç±»æ—¶å°±å¥½åƒä½¿ç”¨åŸºæœ¬æ•°æ®ç±»å‹ä¸€æ ·æ–¹ä¾¿ã€‚ä½†æ˜¯ä½ ä¸€å®šè¦çŸ¥é“è£…ç®±å’Œæ‹†ç®±è‚¯å®šæ˜¯è¦æ¶ˆè€—æ—¶é—´çš„ã€‚è™½ç„¶è¿™ä¸ªæ—¶é—´æ¶ˆè€—å¾ˆä¸‹ã€‚ä½†æ˜¯åœ¨å¤§é‡çš„æ•°æ®ä¸æ–­çš„é‡å¤è£…ç®±æ‹†ç®±çš„æ—¶å€™ï¼Œä½ å°±ä¸èƒ½æ— è§†è¿™ä¸ªæ—¶é—´æŸè€—äº†ã€‚\nâ€‹\tæ‰€ä»¥ä¸ºäº†è®©æˆ‘ä»¬èƒ½å¤Ÿå¯¹è¿™éƒ¨åˆ†çš„æ—¶é—´æ¶ˆè€—è¿›è¡Œä¼˜åŒ–ã€‚Streamè¿˜æä¾›äº†å¾ˆå¤šä¸“é—¨é’ˆå¯¹åŸºæœ¬æ•°æ®ç±»å‹çš„æ–¹æ³•ã€‚\nâ€‹\tä¾‹å¦‚ï¼šmapToInt,mapToLong,mapToDouble,flatMapToInt,flatMapToDoubleç­‰ã€‚\nprivate static void test27() { List\u0026lt;Author\u0026gt; authors = getAuthors(); authors.stream() .map(author -\u0026gt; author.getAge()) .map(age -\u0026gt; age + 10) .filter(age-\u0026gt;age\u0026gt;18) .map(age-\u0026gt;age+2) .forEach(System.out::println); authors.stream() .mapToInt(author -\u0026gt; author.getAge()) .map(age -\u0026gt; age + 10) .filter(age-\u0026gt;age\u0026gt;18) .map(age-\u0026gt;age+2) .forEach(System.out::println); } å¹¶è¡Œæµ â€‹\tå½“æµä¸­æœ‰å¤§é‡å…ƒç´ æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¹¶è¡Œæµå»æé«˜æ“ä½œçš„æ•ˆç‡ã€‚å…¶å®å¹¶è¡Œæµå°±æ˜¯æŠŠä»»åŠ¡åˆ†é…ç»™å¤šä¸ªçº¿ç¨‹å»å®Œå…¨ã€‚å¦‚æœæˆ‘ä»¬è‡ªå·±å»ç”¨ä»£ç å®ç°çš„è¯å…¶å®ä¼šéå¸¸çš„å¤æ‚ï¼Œå¹¶ä¸”è¦æ±‚ä½ å¯¹å¹¶å‘ç¼–ç¨‹æœ‰è¶³å¤Ÿçš„ç†è§£å’Œè®¤è¯†ã€‚è€Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨Streamçš„è¯ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹ä¸€ä¸ªæ–¹æ³•çš„è°ƒç”¨å°±å¯ä»¥ä½¿ç”¨å¹¶è¡Œæµæ¥å¸®æˆ‘ä»¬å®ç°ï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚\nâ€‹\tparallelæ–¹æ³•å¯ä»¥æŠŠä¸²è¡Œæµè½¬æ¢æˆå¹¶è¡Œæµã€‚\nprivate static void test28() { Stream\u0026lt;Integer\u0026gt; stream = Stream.of(1, 2, 3, 4, 5, 6, 7, 8, 9, 10); Integer sum = stream.parallel() .peek(new Consumer\u0026lt;Integer\u0026gt;() { @Override public void accept(Integer num) { System.out.println(num+Thread.currentThread().getName()); } }) .filter(num -\u0026gt; num \u0026gt; 5) .reduce((result, ele) -\u0026gt; result + ele) .get(); System.out.println(sum); } â€‹\tä¹Ÿå¯ä»¥é€šè¿‡parallelStreamç›´æ¥è·å–å¹¶è¡Œæµå¯¹è±¡ã€‚\nList\u0026lt;Author\u0026gt; authors = getAuthors(); authors.parallelStream() .map(author -\u0026gt; author.getAge()) .map(age -\u0026gt; age + 10) .filter(age-\u0026gt;age\u0026gt;18) .map(age-\u0026gt;age+2) .forEach(System.out::println); ","permalink":"https://XianCH.github.io/posts/tech/java/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e//æŸ¥è¯¢æœªæˆå¹´ä½œå®¶çš„è¯„åˆ†åœ¨70ä»¥ä¸Šçš„ä¹¦ç± ç”±äºæ´‹æµå½±å“æ‰€ä»¥ä½œå®¶å’Œä¹¦ç±å¯èƒ½å‡ºç°é‡å¤ï¼Œéœ€è¦è¿›è¡Œå»é‡\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eList\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eBook\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e bookList \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enew\u003c/span\u003e ArrayList\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSet\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eBook\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e uniqueBookValues \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enew\u003c/span\u003e HashSet\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSet\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eAuthor\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e uniqueAuthorValues \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enew\u003c/span\u003e HashSet\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e (Author author : authors) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (uniqueAuthorValues.\u003cspan style=\"color:#a6e22e\"\u003eadd\u003c/span\u003e(author)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (author.\u003cspan style=\"color:#a6e22e\"\u003egetAge\u003c/span\u003e() \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e 18) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            List\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eBook\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e books \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e author.\u003cspan style=\"color:#a6e22e\"\u003egetBooks\u003c/span\u003e();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e (Book book : books) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (book.\u003cspan style=\"color:#a6e22e\"\u003egetScore\u003c/span\u003e() \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e 70) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (uniqueBookValues.\u003cspan style=\"color:#a6e22e\"\u003eadd\u003c/span\u003e(book)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                        bookList.\u003cspan style=\"color:#a6e22e\"\u003eadd\u003c/span\u003e(book);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSystem.\u003cspan style=\"color:#a6e22e\"\u003eout\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eprintln\u003c/span\u003e(bookList);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eList\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eBook\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e collect \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e authors.\u003cspan style=\"color:#a6e22e\"\u003estream\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    .\u003cspan style=\"color:#a6e22e\"\u003edistinct\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    .\u003cspan style=\"color:#a6e22e\"\u003efilter\u003c/span\u003e(author \u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e author.\u003cspan style=\"color:#a6e22e\"\u003egetAge\u003c/span\u003e() \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e 18)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    .\u003cspan style=\"color:#a6e22e\"\u003emap\u003c/span\u003e(author \u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e author.\u003cspan style=\"color:#a6e22e\"\u003egetBooks\u003c/span\u003e())\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    .\u003cspan style=\"color:#a6e22e\"\u003eflatMap\u003c/span\u003e(Collection::stream)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    .\u003cspan style=\"color:#a6e22e\"\u003efilter\u003c/span\u003e(book \u003cspan style=\"color:#f92672\"\u003e-\u0026gt;\u003c/span\u003e book.\u003cspan style=\"color:#a6e22e\"\u003egetScore\u003c/span\u003e() \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e 70)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    .\u003cspan style=\"color:#a6e22e\"\u003edistinct\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    .\u003cspan style=\"color:#a6e22e\"\u003ecollect\u003c/span\u003e(Collectors.\u003cspan style=\"color:#a6e22e\"\u003etoList\u003c/span\u003e());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eSystem.\u003cspan style=\"color:#a6e22e\"\u003eout\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003eprintln\u003c/span\u003e(collect);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"12-å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³\"\u003e1.2 å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³\u003c/h3\u003e\n\u003ch4 id=\"121-æ¦‚å¿µ\"\u003e1.2.1 æ¦‚å¿µ\u003c/h4\u003e\n\u003cp\u003eâ€‹\té¢å‘å¯¹è±¡æ€æƒ³éœ€è¦å…³æ³¨ç”¨ä»€ä¹ˆå¯¹è±¡å®Œæˆä»€ä¹ˆäº‹æƒ…ã€‚è€Œå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³å°±ç±»ä¼¼äºæˆ‘ä»¬æ•°å­¦ä¸­çš„å‡½æ•°ã€‚å®ƒä¸»è¦å…³æ³¨çš„æ˜¯å¯¹æ•°æ®è¿›è¡Œäº†ä»€ä¹ˆæ“ä½œã€‚\u003c/p\u003e","title":"javaå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³"},{"content":"å¾®æœåŠ¡ä¿æŠ¤ 1.åˆè¯†Sentinel 1.1.é›ªå´©é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ 1.1.1.é›ªå´©é—®é¢˜ å¾®æœåŠ¡ä¸­ï¼ŒæœåŠ¡é—´è°ƒç”¨å…³ç³»é”™ç»¼å¤æ‚ï¼Œä¸€ä¸ªå¾®æœåŠ¡å¾€å¾€ä¾èµ–äºå¤šä¸ªå…¶å®ƒå¾®æœåŠ¡ã€‚\nå¦‚å›¾ï¼Œå¦‚æœæœåŠ¡æä¾›è€…Iå‘ç”Ÿäº†æ•…éšœï¼Œå½“å‰çš„åº”ç”¨çš„éƒ¨åˆ†ä¸šåŠ¡å› ä¸ºä¾èµ–äºæœåŠ¡Iï¼Œå› æ­¤ä¹Ÿä¼šè¢«é˜»å¡ã€‚æ­¤æ—¶ï¼Œå…¶å®ƒä¸ä¾èµ–äºæœåŠ¡Içš„ä¸šåŠ¡ä¼¼ä¹ä¸å—å½±å“ã€‚\nä½†æ˜¯ï¼Œä¾èµ–æœåŠ¡Içš„ä¸šåŠ¡è¯·æ±‚è¢«é˜»å¡ï¼Œç”¨æˆ·ä¸ä¼šå¾—åˆ°å“åº”ï¼Œåˆ™tomcatçš„è¿™ä¸ªçº¿ç¨‹ä¸ä¼šé‡Šæ”¾ï¼Œäºæ˜¯è¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·è¯·æ±‚åˆ°æ¥ï¼Œè¶Šæ¥è¶Šå¤šçš„çº¿ç¨‹ä¼šé˜»å¡ï¼š\næœåŠ¡å™¨æ”¯æŒçš„çº¿ç¨‹å’Œå¹¶å‘æ•°æœ‰é™ï¼Œè¯·æ±‚ä¸€ç›´é˜»å¡ï¼Œä¼šå¯¼è‡´æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œä»è€Œå¯¼è‡´æ‰€æœ‰å…¶å®ƒæœåŠ¡éƒ½ä¸å¯ç”¨ï¼Œé‚£ä¹ˆå½“å‰æœåŠ¡ä¹Ÿå°±ä¸å¯ç”¨äº†ã€‚\né‚£ä¹ˆï¼Œä¾èµ–äºå½“å‰æœåŠ¡çš„å…¶å®ƒæœåŠ¡éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæœ€ç»ˆä¹Ÿéƒ½ä¼šå˜çš„ä¸å¯ç”¨ï¼Œå½¢æˆçº§è”å¤±è´¥ï¼Œé›ªå´©å°±å‘ç”Ÿäº†ï¼š\n1.1.2.è¶…æ—¶å¤„ç† è§£å†³é›ªå´©é—®é¢˜çš„å¸¸è§æ–¹å¼æœ‰å››ç§ï¼š\nâ€¢è¶…æ—¶å¤„ç†ï¼šè®¾å®šè¶…æ—¶æ—¶é—´ï¼Œè¯·æ±‚è¶…è¿‡ä¸€å®šæ—¶é—´æ²¡æœ‰å“åº”å°±è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œä¸ä¼šæ— ä¼‘æ­¢ç­‰å¾…\n1.1.3.ä»“å£æ¨¡å¼ æ–¹æ¡ˆ2ï¼šä»“å£æ¨¡å¼\nä»“å£æ¨¡å¼æ¥æºäºèˆ¹èˆ±çš„è®¾è®¡ï¼š\nèˆ¹èˆ±éƒ½ä¼šè¢«éš”æ¿åˆ†ç¦»ä¸ºå¤šä¸ªç‹¬ç«‹ç©ºé—´ï¼Œå½“èˆ¹ä½“ç ´æŸæ—¶ï¼Œåªä¼šå¯¼è‡´éƒ¨åˆ†ç©ºé—´è¿›å…¥ï¼Œå°†æ•…éšœæ§åˆ¶åœ¨ä¸€å®šèŒƒå›´å†…ï¼Œé¿å…æ•´ä¸ªèˆ¹ä½“éƒ½è¢«æ·¹æ²¡ã€‚\näºæ­¤ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥é™å®šæ¯ä¸ªä¸šåŠ¡èƒ½ä½¿ç”¨çš„çº¿ç¨‹æ•°ï¼Œé¿å…è€—å°½æ•´ä¸ªtomcatçš„èµ„æºï¼Œå› æ­¤ä¹Ÿå«çº¿ç¨‹éš”ç¦»ã€‚\n1.1.4.æ–­è·¯å™¨ æ–­è·¯å™¨æ¨¡å¼ï¼šç”±æ–­è·¯å™¨ç»Ÿè®¡ä¸šåŠ¡æ‰§è¡Œçš„å¼‚å¸¸æ¯”ä¾‹ï¼Œå¦‚æœè¶…å‡ºé˜ˆå€¼åˆ™ä¼šç†”æ–­è¯¥ä¸šåŠ¡ï¼Œæ‹¦æˆªè®¿é—®è¯¥ä¸šåŠ¡çš„ä¸€åˆ‡è¯·æ±‚ã€‚\næ–­è·¯å™¨ä¼šç»Ÿè®¡è®¿é—®æŸä¸ªæœåŠ¡çš„è¯·æ±‚æ•°é‡ï¼Œå¼‚å¸¸æ¯”ä¾‹ï¼š\nå½“å‘ç°è®¿é—®æœåŠ¡Dçš„è¯·æ±‚å¼‚å¸¸æ¯”ä¾‹è¿‡é«˜æ—¶ï¼Œè®¤ä¸ºæœåŠ¡Dæœ‰å¯¼è‡´é›ªå´©çš„é£é™©ï¼Œä¼šæ‹¦æˆªè®¿é—®æœåŠ¡Dçš„ä¸€åˆ‡è¯·æ±‚ï¼Œå½¢æˆç†”æ–­ï¼š\n1.1.5.é™æµ æµé‡æ§åˆ¶ï¼šé™åˆ¶ä¸šåŠ¡è®¿é—®çš„QPSï¼Œé¿å…æœåŠ¡å› æµé‡çš„çªå¢è€Œæ•…éšœã€‚\n1.1.6.æ€»ç»“ ä»€ä¹ˆæ˜¯é›ªå´©é—®é¢˜ï¼Ÿ\nå¾®æœåŠ¡ä¹‹é—´ç›¸äº’è°ƒç”¨ï¼Œå› ä¸ºè°ƒç”¨é“¾ä¸­çš„ä¸€ä¸ªæœåŠ¡æ•…éšœï¼Œå¼•èµ·æ•´ä¸ªé“¾è·¯éƒ½æ— æ³•è®¿é—®çš„æƒ…å†µã€‚ å¯ä»¥è®¤ä¸ºï¼š\né™æµæ˜¯å¯¹æœåŠ¡çš„ä¿æŠ¤ï¼Œé¿å…å› ç¬é—´é«˜å¹¶å‘æµé‡è€Œå¯¼è‡´æœåŠ¡æ•…éšœï¼Œè¿›è€Œé¿å…é›ªå´©ã€‚æ˜¯ä¸€ç§é¢„é˜²æªæ–½ã€‚\nè¶…æ—¶å¤„ç†ã€çº¿ç¨‹éš”ç¦»ã€é™çº§ç†”æ–­æ˜¯åœ¨éƒ¨åˆ†æœåŠ¡æ•…éšœæ—¶ï¼Œå°†æ•…éšœæ§åˆ¶åœ¨ä¸€å®šèŒƒå›´ï¼Œé¿å…é›ªå´©ã€‚æ˜¯ä¸€ç§è¡¥æ•‘æªæ–½ã€‚\n1.2.æœåŠ¡ä¿æŠ¤æŠ€æœ¯å¯¹æ¯” åœ¨SpringCloudå½“ä¸­æ”¯æŒå¤šç§æœåŠ¡ä¿æŠ¤æŠ€æœ¯ï¼š\nNetfix Hystrix Sentinel Resilience4J æ—©æœŸæ¯”è¾ƒæµè¡Œçš„æ˜¯Hystrixæ¡†æ¶ï¼Œä½†ç›®å‰å›½å†…å®ç”¨æœ€å¹¿æ³›çš„è¿˜æ˜¯é˜¿é‡Œå·´å·´çš„Sentinelæ¡†æ¶ï¼Œè¿™é‡Œæˆ‘ä»¬åšä¸‹å¯¹æ¯”ï¼š\nSentinel Hystrix éš”ç¦»ç­–ç•¥ ä¿¡å·é‡éš”ç¦» çº¿ç¨‹æ± éš”ç¦»/ä¿¡å·é‡éš”ç¦» ç†”æ–­é™çº§ç­–ç•¥ åŸºäºæ…¢è°ƒç”¨æ¯”ä¾‹æˆ–å¼‚å¸¸æ¯”ä¾‹ åŸºäºå¤±è´¥æ¯”ç‡ å®æ—¶æŒ‡æ ‡å®ç° æ»‘åŠ¨çª—å£ æ»‘åŠ¨çª—å£ï¼ˆåŸºäº RxJavaï¼‰ è§„åˆ™é…ç½® æ”¯æŒå¤šç§æ•°æ®æº æ”¯æŒå¤šç§æ•°æ®æº æ‰©å±•æ€§ å¤šä¸ªæ‰©å±•ç‚¹ æ’ä»¶çš„å½¢å¼ åŸºäºæ³¨è§£çš„æ”¯æŒ æ”¯æŒ æ”¯æŒ é™æµ åŸºäº QPSï¼Œæ”¯æŒåŸºäºè°ƒç”¨å…³ç³»çš„é™æµ æœ‰é™çš„æ”¯æŒ æµé‡æ•´å½¢ æ”¯æŒæ…¢å¯åŠ¨ã€åŒ€é€Ÿæ’é˜Ÿæ¨¡å¼ ä¸æ”¯æŒ ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤ æ”¯æŒ ä¸æ”¯æŒ æ§åˆ¶å° å¼€ç®±å³ç”¨ï¼Œå¯é…ç½®è§„åˆ™ã€æŸ¥çœ‹ç§’çº§ç›‘æ§ã€æœºå™¨å‘ç°ç­‰ ä¸å®Œå–„ å¸¸è§æ¡†æ¶çš„é€‚é… Servletã€Spring Cloudã€Dubboã€gRPC ç­‰ Servletã€Spring Cloud Netflix 1.3.Sentinelä»‹ç»å’Œå®‰è£… 1.3.1.åˆè¯†Sentinel Sentinelæ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€æ¬¾å¾®æœåŠ¡æµé‡æ§åˆ¶ç»„ä»¶ã€‚å®˜ç½‘åœ°å€ï¼šhttps://sentinelguard.io/zh-cn/index.html\nSentinel å…·æœ‰ä»¥ä¸‹ç‰¹å¾:\nâ€¢ä¸°å¯Œçš„åº”ç”¨åœºæ™¯ï¼šSentinel æ‰¿æ¥äº†é˜¿é‡Œå·´å·´è¿‘ 10 å¹´çš„åŒåä¸€å¤§ä¿ƒæµé‡çš„æ ¸å¿ƒåœºæ™¯ï¼Œä¾‹å¦‚ç§’æ€ï¼ˆå³çªå‘æµé‡æ§åˆ¶åœ¨ç³»ç»Ÿå®¹é‡å¯ä»¥æ‰¿å—çš„èŒƒå›´ï¼‰ã€æ¶ˆæ¯å‰Šå³°å¡«è°·ã€é›†ç¾¤æµé‡æ§åˆ¶ã€å®æ—¶ç†”æ–­ä¸‹æ¸¸ä¸å¯ç”¨åº”ç”¨ç­‰ã€‚\nâ€¢å®Œå¤‡çš„å®æ—¶ç›‘æ§ï¼šSentinel åŒæ—¶æä¾›å®æ—¶çš„ç›‘æ§åŠŸèƒ½ã€‚æ‚¨å¯ä»¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°æ¥å…¥åº”ç”¨çš„å•å°æœºå™¨ç§’çº§æ•°æ®ï¼Œç”šè‡³ 500 å°ä»¥ä¸‹è§„æ¨¡çš„é›†ç¾¤çš„æ±‡æ€»è¿è¡Œæƒ…å†µã€‚\nâ€¢å¹¿æ³›çš„å¼€æºç”Ÿæ€ï¼šSentinel æä¾›å¼€ç®±å³ç”¨çš„ä¸å…¶å®ƒå¼€æºæ¡†æ¶/åº“çš„æ•´åˆæ¨¡å—ï¼Œä¾‹å¦‚ä¸ Spring Cloudã€Dubboã€gRPC çš„æ•´åˆã€‚æ‚¨åªéœ€è¦å¼•å…¥ç›¸åº”çš„ä¾èµ–å¹¶è¿›è¡Œç®€å•çš„é…ç½®å³å¯å¿«é€Ÿåœ°æ¥å…¥ Sentinelã€‚\nâ€¢å®Œå–„çš„ SPI æ‰©å±•ç‚¹ï¼šSentinel æä¾›ç®€å•æ˜“ç”¨ã€å®Œå–„çš„ SPI æ‰©å±•æ¥å£ã€‚æ‚¨å¯ä»¥é€šè¿‡å®ç°æ‰©å±•æ¥å£æ¥å¿«é€Ÿåœ°å®šåˆ¶é€»è¾‘ã€‚ä¾‹å¦‚å®šåˆ¶è§„åˆ™ç®¡ç†ã€é€‚é…åŠ¨æ€æ•°æ®æºç­‰ã€‚\n1.3.2.å®‰è£…Sentinel 1ï¼‰ä¸‹è½½\nsentinelå®˜æ–¹æä¾›äº†UIæ§åˆ¶å°ï¼Œæ–¹ä¾¿æˆ‘ä»¬å¯¹ç³»ç»Ÿåšé™æµè®¾ç½®ã€‚å¤§å®¶å¯ä»¥åœ¨GitHubä¸‹è½½ã€‚\nè¯¾å‰èµ„æ–™ä¹Ÿæä¾›äº†ä¸‹è½½å¥½çš„jaråŒ…ï¼š\n2ï¼‰è¿è¡Œ\nå°†jaråŒ…æ”¾åˆ°ä»»æ„éä¸­æ–‡ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š\njava -jar sentinel-dashboard-1.8.1.jar å¦‚æœè¦ä¿®æ”¹Sentinelçš„é»˜è®¤ç«¯å£ã€è´¦æˆ·ã€å¯†ç ï¼Œå¯ä»¥é€šè¿‡ä¸‹åˆ—é…ç½®ï¼š\né…ç½®é¡¹ é»˜è®¤å€¼ è¯´æ˜ server.port 8080 æœåŠ¡ç«¯å£ sentinel.dashboard.auth.username sentinel é»˜è®¤ç”¨æˆ·å sentinel.dashboard.auth.password sentinel é»˜è®¤å¯†ç  ä¾‹å¦‚ï¼Œä¿®æ”¹ç«¯å£ï¼š\njava -Dserver.port=8090 -jar sentinel-dashboard-1.8.1.jar 3ï¼‰è®¿é—®\nè®¿é—®http://localhost:8080é¡µé¢ï¼Œå°±å¯ä»¥çœ‹åˆ°sentinelçš„æ§åˆ¶å°äº†ï¼š\néœ€è¦è¾“å…¥è´¦å·å’Œå¯†ç ï¼Œé»˜è®¤éƒ½æ˜¯ï¼šsentinel\nç™»å½•åï¼Œå‘ç°ä¸€ç‰‡ç©ºç™½ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ï¼š\nè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰ä¸å¾®æœåŠ¡æ•´åˆã€‚\n1.4.å¾®æœåŠ¡æ•´åˆSentinel æˆ‘ä»¬åœ¨order-serviceä¸­æ•´åˆsentinelï¼Œå¹¶è¿æ¥sentinelçš„æ§åˆ¶å°ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š\n1ï¼‰å¼•å…¥sentinelä¾èµ–\n\u0026lt;!--sentinel--\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-alibaba-sentinel\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; 2ï¼‰é…ç½®æ§åˆ¶å°\nä¿®æ”¹application.yamlæ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢å†…å®¹ï¼š\nserver: port: 8088 spring: cloud: sentinel: transport: dashboard: localhost:8080 3ï¼‰è®¿é—®order-serviceçš„ä»»æ„ç«¯ç‚¹\næ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®http://localhost:8088/order/101ï¼Œè¿™æ ·æ‰èƒ½è§¦å‘sentinelçš„ç›‘æ§ã€‚\nç„¶åå†è®¿é—®sentinelçš„æ§åˆ¶å°ï¼ŒæŸ¥çœ‹æ•ˆæœï¼š\n2.æµé‡æ§åˆ¶ é›ªå´©é—®é¢˜è™½ç„¶æœ‰å››ç§æ–¹æ¡ˆï¼Œä½†æ˜¯é™æµæ˜¯é¿å…æœåŠ¡å› çªå‘çš„æµé‡è€Œå‘ç”Ÿæ•…éšœï¼Œæ˜¯å¯¹å¾®æœåŠ¡é›ªå´©é—®é¢˜çš„é¢„é˜²ã€‚æˆ‘ä»¬å…ˆå­¦ä¹ è¿™ç§æ¨¡å¼ã€‚\n2.1.ç°‡ç‚¹é“¾è·¯ å½“è¯·æ±‚è¿›å…¥å¾®æœåŠ¡æ—¶ï¼Œé¦–å…ˆä¼šè®¿é—®DispatcherServletï¼Œç„¶åè¿›å…¥Controllerã€Serviceã€Mapperï¼Œè¿™æ ·çš„ä¸€ä¸ªè°ƒç”¨é“¾å°±å«åšç°‡ç‚¹é“¾è·¯ã€‚ç°‡ç‚¹é“¾è·¯ä¸­è¢«ç›‘æ§çš„æ¯ä¸€ä¸ªæ¥å£å°±æ˜¯ä¸€ä¸ªèµ„æºã€‚\né»˜è®¤æƒ…å†µä¸‹sentinelä¼šç›‘æ§SpringMVCçš„æ¯ä¸€ä¸ªç«¯ç‚¹ï¼ˆEndpointï¼Œä¹Ÿå°±æ˜¯controllerä¸­çš„æ–¹æ³•ï¼‰ï¼Œå› æ­¤SpringMVCçš„æ¯ä¸€ä¸ªç«¯ç‚¹ï¼ˆEndpointï¼‰å°±æ˜¯è°ƒç”¨é“¾è·¯ä¸­çš„ä¸€ä¸ªèµ„æºã€‚\nä¾‹å¦‚ï¼Œæˆ‘ä»¬åˆšæ‰è®¿é—®çš„order-serviceä¸­çš„OrderControllerä¸­çš„ç«¯ç‚¹ï¼š/order/{orderId}\næµæ§ã€ç†”æ–­ç­‰éƒ½æ˜¯é’ˆå¯¹ç°‡ç‚¹é“¾è·¯ä¸­çš„èµ„æºæ¥è®¾ç½®çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç‚¹å‡»å¯¹åº”èµ„æºåé¢çš„æŒ‰é’®æ¥è®¾ç½®è§„åˆ™ï¼š\næµæ§ï¼šæµé‡æ§åˆ¶ é™çº§ï¼šé™çº§ç†”æ–­ çƒ­ç‚¹ï¼šçƒ­ç‚¹å‚æ•°é™æµï¼Œæ˜¯é™æµçš„ä¸€ç§ æˆæƒï¼šè¯·æ±‚çš„æƒé™æ§åˆ¶ 2.1.å¿«é€Ÿå…¥é—¨ 2.1.1.ç¤ºä¾‹ ç‚¹å‡»èµ„æº/order/{orderId}åé¢çš„æµæ§æŒ‰é’®ï¼Œå°±å¯ä»¥å¼¹å‡ºè¡¨å•ã€‚\nè¡¨å•ä¸­å¯ä»¥å¡«å†™é™æµè§„åˆ™ï¼Œå¦‚ä¸‹ï¼š\nå…¶å«ä¹‰æ˜¯é™åˆ¶ /order/{orderId}è¿™ä¸ªèµ„æºçš„å•æœºQPSä¸º1ï¼Œå³æ¯ç§’åªå…è®¸1æ¬¡è¯·æ±‚ï¼Œè¶…å‡ºçš„è¯·æ±‚ä¼šè¢«æ‹¦æˆªå¹¶æŠ¥é”™ã€‚\n2.1.2.ç»ƒä¹ ï¼š éœ€æ±‚ï¼šç»™ /order/{orderId}è¿™ä¸ªèµ„æºè®¾ç½®æµæ§è§„åˆ™ï¼ŒQPSä¸èƒ½è¶…è¿‡ 5ï¼Œç„¶åæµ‹è¯•ã€‚\n1ï¼‰é¦–å…ˆåœ¨sentinelæ§åˆ¶å°æ·»åŠ é™æµè§„åˆ™\n2ï¼‰åˆ©ç”¨jmeteræµ‹è¯•\nå¦‚æœæ²¡æœ‰ç”¨è¿‡jmeterï¼Œå¯ä»¥å‚è€ƒè¯¾å‰èµ„æ–™æä¾›çš„æ–‡æ¡£ã€ŠJmeterå¿«é€Ÿå…¥é—¨.mdã€‹\nè¯¾å‰èµ„æ–™æä¾›äº†ç¼–å†™å¥½çš„Jmeteræµ‹è¯•æ ·ä¾‹ï¼š\næ‰“å¼€jmeterï¼Œå¯¼å…¥è¯¾å‰èµ„æ–™æä¾›çš„æµ‹è¯•æ ·ä¾‹ï¼š\né€‰æ‹©ï¼š\n20ä¸ªç”¨æˆ·ï¼Œ2ç§’å†…è¿è¡Œå®Œï¼ŒQPSæ˜¯10ï¼Œè¶…è¿‡äº†5.\né€‰ä¸­æµæ§å…¥é—¨ï¼ŒQPS\u0026lt;5å³é”®è¿è¡Œï¼š\næ³¨æ„ï¼Œä¸è¦ç‚¹å‡»èœå•ä¸­çš„æ‰§è¡ŒæŒ‰é’®æ¥è¿è¡Œã€‚\nç»“æœï¼š\nå¯ä»¥çœ‹åˆ°ï¼ŒæˆåŠŸçš„è¯·æ±‚æ¯æ¬¡åªæœ‰5ä¸ª\n2.2.æµæ§æ¨¡å¼ åœ¨æ·»åŠ é™æµè§„åˆ™æ—¶ï¼Œç‚¹å‡»é«˜çº§é€‰é¡¹ï¼Œå¯ä»¥é€‰æ‹©ä¸‰ç§æµæ§æ¨¡å¼ï¼š\nç›´æ¥ï¼šç»Ÿè®¡å½“å‰èµ„æºçš„è¯·æ±‚ï¼Œè§¦å‘é˜ˆå€¼æ—¶å¯¹å½“å‰èµ„æºç›´æ¥é™æµï¼Œä¹Ÿæ˜¯é»˜è®¤çš„æ¨¡å¼ å…³è”ï¼šç»Ÿè®¡ä¸å½“å‰èµ„æºç›¸å…³çš„å¦ä¸€ä¸ªèµ„æºï¼Œè§¦å‘é˜ˆå€¼æ—¶ï¼Œå¯¹å½“å‰èµ„æºé™æµ é“¾è·¯ï¼šç»Ÿè®¡ä»æŒ‡å®šé“¾è·¯è®¿é—®åˆ°æœ¬èµ„æºçš„è¯·æ±‚ï¼Œè§¦å‘é˜ˆå€¼æ—¶ï¼Œå¯¹æŒ‡å®šé“¾è·¯é™æµ å¿«é€Ÿå…¥é—¨æµ‹è¯•çš„å°±æ˜¯ç›´æ¥æ¨¡å¼ã€‚\n2.2.1.å…³è”æ¨¡å¼ å…³è”æ¨¡å¼ï¼šç»Ÿè®¡ä¸å½“å‰èµ„æºç›¸å…³çš„å¦ä¸€ä¸ªèµ„æºï¼Œè§¦å‘é˜ˆå€¼æ—¶ï¼Œå¯¹å½“å‰èµ„æºé™æµ\né…ç½®è§„åˆ™ï¼š\nè¯­æ³•è¯´æ˜ï¼šå½“/writeèµ„æºè®¿é—®é‡è§¦å‘é˜ˆå€¼æ—¶ï¼Œå°±ä¼šå¯¹/readèµ„æºé™æµï¼Œé¿å…å½±å“/writeèµ„æºã€‚\nä½¿ç”¨åœºæ™¯ï¼šæ¯”å¦‚ç”¨æˆ·æ”¯ä»˜æ—¶éœ€è¦ä¿®æ”¹è®¢å•çŠ¶æ€ï¼ŒåŒæ—¶ç”¨æˆ·è¦æŸ¥è¯¢è®¢å•ã€‚æŸ¥è¯¢å’Œä¿®æ”¹æ“ä½œä¼šäº‰æŠ¢æ•°æ®åº“é”ï¼Œäº§ç”Ÿç«äº‰ã€‚ä¸šåŠ¡éœ€æ±‚æ˜¯ä¼˜å…ˆæ”¯ä»˜å’Œæ›´æ–°è®¢å•çš„ä¸šåŠ¡ï¼Œå› æ­¤å½“ä¿®æ”¹è®¢å•ä¸šåŠ¡è§¦å‘é˜ˆå€¼æ—¶ï¼Œéœ€è¦å¯¹æŸ¥è¯¢è®¢å•ä¸šåŠ¡é™æµã€‚\néœ€æ±‚è¯´æ˜ï¼š\nåœ¨OrderControlleræ–°å»ºä¸¤ä¸ªç«¯ç‚¹ï¼š/order/queryå’Œ/order/updateï¼Œæ— éœ€å®ç°ä¸šåŠ¡\né…ç½®æµæ§è§„åˆ™ï¼Œå½“/order/ updateèµ„æºè¢«è®¿é—®çš„QPSè¶…è¿‡5æ—¶ï¼Œå¯¹/order/queryè¯·æ±‚é™æµ\n1ï¼‰å®šä¹‰/order/queryç«¯ç‚¹ï¼Œæ¨¡æ‹Ÿè®¢å•æŸ¥è¯¢\n@GetMapping(\u0026#34;/query\u0026#34;) public String queryOrder() { return \u0026#34;æŸ¥è¯¢è®¢å•æˆåŠŸ\u0026#34;; } 2ï¼‰å®šä¹‰/order/updateç«¯ç‚¹ï¼Œæ¨¡æ‹Ÿè®¢å•æ›´æ–°\n@GetMapping(\u0026#34;/update\u0026#34;) public String updateOrder() { return \u0026#34;æ›´æ–°è®¢å•æˆåŠŸ\u0026#34;; } é‡å¯æœåŠ¡ï¼ŒæŸ¥çœ‹sentinelæ§åˆ¶å°çš„ç°‡ç‚¹é“¾è·¯ï¼š\n3ï¼‰é…ç½®æµæ§è§„åˆ™\nå¯¹å“ªä¸ªç«¯ç‚¹é™æµï¼Œå°±ç‚¹å‡»å“ªä¸ªç«¯ç‚¹åé¢çš„æŒ‰é’®ã€‚æˆ‘ä»¬æ˜¯å¯¹è®¢å•æŸ¥è¯¢/order/queryé™æµï¼Œå› æ­¤ç‚¹å‡»å®ƒåé¢çš„æŒ‰é’®ï¼š\nåœ¨è¡¨å•ä¸­å¡«å†™æµæ§è§„åˆ™ï¼š\n4ï¼‰åœ¨Jmeteræµ‹è¯•\né€‰æ‹©ã€Šæµæ§æ¨¡å¼-å…³è”ã€‹ï¼š\nå¯ä»¥çœ‹åˆ°1000ä¸ªç”¨æˆ·ï¼Œ100ç§’ï¼Œå› æ­¤QPSä¸º10ï¼Œè¶…è¿‡äº†æˆ‘ä»¬è®¾å®šçš„é˜ˆå€¼ï¼š5\næŸ¥çœ‹httpè¯·æ±‚ï¼š\nè¯·æ±‚çš„ç›®æ ‡æ˜¯/order/updateï¼Œè¿™æ ·è¿™ä¸ªæ–­ç‚¹å°±ä¼šè§¦å‘é˜ˆå€¼ã€‚\nä½†é™æµçš„ç›®æ ‡æ˜¯/order/queryï¼Œæˆ‘ä»¬åœ¨æµè§ˆå™¨è®¿é—®ï¼Œå¯ä»¥å‘ç°ï¼š\nç¡®å®è¢«é™æµäº†ã€‚\n5ï¼‰æ€»ç»“\n2.2.2.é“¾è·¯æ¨¡å¼ é“¾è·¯æ¨¡å¼ï¼šåªé’ˆå¯¹ä»æŒ‡å®šé“¾è·¯è®¿é—®åˆ°æœ¬èµ„æºçš„è¯·æ±‚åšç»Ÿè®¡ï¼Œåˆ¤æ–­æ˜¯å¦è¶…è¿‡é˜ˆå€¼ã€‚\né…ç½®ç¤ºä¾‹ï¼š\nä¾‹å¦‚æœ‰ä¸¤æ¡è¯·æ±‚é“¾è·¯ï¼š\n/test1 \u0026ndash;\u0026gt; /common\n/test2 \u0026ndash;\u0026gt; /common\nå¦‚æœåªå¸Œæœ›ç»Ÿè®¡ä»/test2è¿›å…¥åˆ°/commonçš„è¯·æ±‚ï¼Œåˆ™å¯ä»¥è¿™æ ·é…ç½®ï¼š\nå®æˆ˜æ¡ˆä¾‹\néœ€æ±‚ï¼šæœ‰æŸ¥è¯¢è®¢å•å’Œåˆ›å»ºè®¢å•ä¸šåŠ¡ï¼Œä¸¤è€…éƒ½éœ€è¦æŸ¥è¯¢å•†å“ã€‚é’ˆå¯¹ä»æŸ¥è¯¢è®¢å•è¿›å…¥åˆ°æŸ¥è¯¢å•†å“çš„è¯·æ±‚ç»Ÿè®¡ï¼Œå¹¶è®¾ç½®é™æµã€‚\næ­¥éª¤ï¼š\nåœ¨OrderServiceä¸­æ·»åŠ ä¸€ä¸ªqueryGoodsæ–¹æ³•ï¼Œä¸ç”¨å®ç°ä¸šåŠ¡\nåœ¨OrderControllerä¸­ï¼Œæ”¹é€ /order/queryç«¯ç‚¹ï¼Œè°ƒç”¨OrderServiceä¸­çš„queryGoodsæ–¹æ³•\nåœ¨OrderControllerä¸­æ·»åŠ ä¸€ä¸ª/order/saveçš„ç«¯ç‚¹ï¼Œè°ƒç”¨OrderServiceçš„queryGoodsæ–¹æ³•\nç»™queryGoodsè®¾ç½®é™æµè§„åˆ™ï¼Œä»/order/queryè¿›å…¥queryGoodsçš„æ–¹æ³•é™åˆ¶QPSå¿…é¡»å°äº2\nå®ç°ï¼š\n1ï¼‰æ·»åŠ æŸ¥è¯¢å•†å“æ–¹æ³• åœ¨order-serviceæœåŠ¡ä¸­ï¼Œç»™OrderServiceç±»æ·»åŠ ä¸€ä¸ªqueryGoodsæ–¹æ³•ï¼š\npublic void queryGoods(){ System.err.println(\u0026#34;æŸ¥è¯¢å•†å“\u0026#34;); } 2ï¼‰æŸ¥è¯¢è®¢å•æ—¶ï¼ŒæŸ¥è¯¢å•†å“ åœ¨order-serviceçš„OrderControllerä¸­ï¼Œä¿®æ”¹/order/queryç«¯ç‚¹çš„ä¸šåŠ¡é€»è¾‘ï¼š\n@GetMapping(\u0026#34;/query\u0026#34;) public String queryOrder() { // æŸ¥è¯¢å•†å“ orderService.queryGoods(); // æŸ¥è¯¢è®¢å• System.out.println(\u0026#34;æŸ¥è¯¢è®¢å•\u0026#34;); return \u0026#34;æŸ¥è¯¢è®¢å•æˆåŠŸ\u0026#34;; } 3ï¼‰æ–°å¢è®¢å•ï¼ŒæŸ¥è¯¢å•†å“ åœ¨order-serviceçš„OrderControllerä¸­ï¼Œä¿®æ”¹/order/saveç«¯ç‚¹ï¼Œæ¨¡æ‹Ÿæ–°å¢è®¢å•ï¼š\n@GetMapping(\u0026#34;/save\u0026#34;) public String saveOrder() { // æŸ¥è¯¢å•†å“ orderService.queryGoods(); // æŸ¥è¯¢è®¢å• System.err.println(\u0026#34;æ–°å¢è®¢å•\u0026#34;); return \u0026#34;æ–°å¢è®¢å•æˆåŠŸ\u0026#34;; } 4ï¼‰ç»™æŸ¥è¯¢å•†å“æ·»åŠ èµ„æºæ ‡è®° é»˜è®¤æƒ…å†µä¸‹ï¼ŒOrderServiceä¸­çš„æ–¹æ³•æ˜¯ä¸è¢«Sentinelç›‘æ§çš„ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±é€šè¿‡æ³¨è§£æ¥æ ‡è®°è¦ç›‘æ§çš„æ–¹æ³•ã€‚\nç»™OrderServiceçš„queryGoodsæ–¹æ³•æ·»åŠ @SentinelResourceæ³¨è§£ï¼š\n@SentinelResource(\u0026#34;goods\u0026#34;) public void queryGoods(){ System.err.println(\u0026#34;æŸ¥è¯¢å•†å“\u0026#34;); } é“¾è·¯æ¨¡å¼ä¸­ï¼Œæ˜¯å¯¹ä¸åŒæ¥æºçš„ä¸¤ä¸ªé“¾è·¯åšç›‘æ§ã€‚ä½†æ˜¯sentinelé»˜è®¤ä¼šç»™è¿›å…¥SpringMVCçš„æ‰€æœ‰è¯·æ±‚è®¾ç½®åŒä¸€ä¸ªrootèµ„æºï¼Œä¼šå¯¼è‡´é“¾è·¯æ¨¡å¼å¤±æ•ˆã€‚\næˆ‘ä»¬éœ€è¦å…³é—­è¿™ç§å¯¹SpringMVCçš„èµ„æºèšåˆï¼Œä¿®æ”¹order-serviceæœåŠ¡çš„application.ymlæ–‡ä»¶ï¼š\nspring: cloud: sentinel: web-context-unify: false # å…³é—­contextæ•´åˆ é‡å¯æœåŠ¡ï¼Œè®¿é—®/order/queryå’Œ/order/saveï¼Œå¯ä»¥æŸ¥çœ‹åˆ°sentinelçš„ç°‡ç‚¹é“¾è·¯è§„åˆ™ä¸­ï¼Œå‡ºç°äº†æ–°çš„èµ„æºï¼š\n5ï¼‰æ·»åŠ æµæ§è§„åˆ™ ç‚¹å‡»goodsèµ„æºåé¢çš„æµæ§æŒ‰é’®ï¼Œåœ¨å¼¹å‡ºçš„è¡¨å•ä¸­å¡«å†™ä¸‹é¢ä¿¡æ¯ï¼š\nåªç»Ÿè®¡ä»/order/queryè¿›å…¥/goodsçš„èµ„æºï¼ŒQPSé˜ˆå€¼ä¸º2ï¼Œè¶…å‡ºåˆ™è¢«é™æµã€‚\n6ï¼‰Jmeteræµ‹è¯• é€‰æ‹©ã€Šæµæ§æ¨¡å¼-é“¾è·¯ã€‹ï¼š\nå¯ä»¥çœ‹åˆ°è¿™é‡Œ200ä¸ªç”¨æˆ·ï¼Œ50ç§’å†…å‘å®Œï¼ŒQPSä¸º4ï¼Œè¶…è¿‡äº†æˆ‘ä»¬è®¾å®šçš„é˜ˆå€¼2\nä¸€ä¸ªhttpè¯·æ±‚æ˜¯è®¿é—®/order/saveï¼š\nè¿è¡Œçš„ç»“æœï¼š\nå®Œå…¨ä¸å—å½±å“ã€‚\nå¦ä¸€ä¸ªæ˜¯è®¿é—®/order/queryï¼š\nè¿è¡Œç»“æœï¼š\næ¯æ¬¡åªæœ‰2ä¸ªé€šè¿‡ã€‚\n2.2.3.æ€»ç»“ æµæ§æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ\nâ€¢ç›´æ¥ï¼šå¯¹å½“å‰èµ„æºé™æµ\nâ€¢å…³è”ï¼šé«˜ä¼˜å…ˆçº§èµ„æºè§¦å‘é˜ˆå€¼ï¼Œå¯¹ä½ä¼˜å…ˆçº§èµ„æºé™æµã€‚\nâ€¢é“¾è·¯ï¼šé˜ˆå€¼ç»Ÿè®¡æ—¶ï¼Œåªç»Ÿè®¡ä»æŒ‡å®šèµ„æºè¿›å…¥å½“å‰èµ„æºçš„è¯·æ±‚ï¼Œæ˜¯å¯¹è¯·æ±‚æ¥æºçš„é™æµ\n2.3.æµæ§æ•ˆæœ åœ¨æµæ§çš„é«˜çº§é€‰é¡¹ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªæµæ§æ•ˆæœé€‰é¡¹ï¼š\næµæ§æ•ˆæœæ˜¯æŒ‡è¯·æ±‚è¾¾åˆ°æµæ§é˜ˆå€¼æ—¶åº”è¯¥é‡‡å–çš„æªæ–½ï¼ŒåŒ…æ‹¬ä¸‰ç§ï¼š\nå¿«é€Ÿå¤±è´¥ï¼šè¾¾åˆ°é˜ˆå€¼åï¼Œæ–°çš„è¯·æ±‚ä¼šè¢«ç«‹å³æ‹’ç»å¹¶æŠ›å‡ºFlowExceptionå¼‚å¸¸ã€‚æ˜¯é»˜è®¤çš„å¤„ç†æ–¹å¼ã€‚\nwarm upï¼šé¢„çƒ­æ¨¡å¼ï¼Œå¯¹è¶…å‡ºé˜ˆå€¼çš„è¯·æ±‚åŒæ ·æ˜¯æ‹’ç»å¹¶æŠ›å‡ºå¼‚å¸¸ã€‚ä½†è¿™ç§æ¨¡å¼é˜ˆå€¼ä¼šåŠ¨æ€å˜åŒ–ï¼Œä»ä¸€ä¸ªè¾ƒå°å€¼é€æ¸å¢åŠ åˆ°æœ€å¤§é˜ˆå€¼ã€‚\næ’é˜Ÿç­‰å¾…ï¼šè®©æ‰€æœ‰çš„è¯·æ±‚æŒ‰ç…§å…ˆåæ¬¡åºæ’é˜Ÿæ‰§è¡Œï¼Œä¸¤ä¸ªè¯·æ±‚çš„é—´éš”ä¸èƒ½å°äºæŒ‡å®šæ—¶é•¿\n2.3.1.warm up é˜ˆå€¼ä¸€èˆ¬æ˜¯ä¸€ä¸ªå¾®æœåŠ¡èƒ½æ‰¿æ‹…çš„æœ€å¤§QPSï¼Œä½†æ˜¯ä¸€ä¸ªæœåŠ¡åˆšåˆšå¯åŠ¨æ—¶ï¼Œä¸€åˆ‡èµ„æºå°šæœªåˆå§‹åŒ–ï¼ˆå†·å¯åŠ¨ï¼‰ï¼Œå¦‚æœç›´æ¥å°†QPSè·‘åˆ°æœ€å¤§å€¼ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡ç¬é—´å®•æœºã€‚\nwarm upä¹Ÿå«é¢„çƒ­æ¨¡å¼ï¼Œæ˜¯åº”å¯¹æœåŠ¡å†·å¯åŠ¨çš„ä¸€ç§æ–¹æ¡ˆã€‚è¯·æ±‚é˜ˆå€¼åˆå§‹å€¼æ˜¯ maxThreshold / coldFactorï¼ŒæŒç»­æŒ‡å®šæ—¶é•¿åï¼Œé€æ¸æé«˜åˆ°maxThresholdå€¼ã€‚è€ŒcoldFactorçš„é»˜è®¤å€¼æ˜¯3.\nä¾‹å¦‚ï¼Œæˆ‘è®¾ç½®QPSçš„maxThresholdä¸º10ï¼Œé¢„çƒ­æ—¶é—´ä¸º5ç§’ï¼Œé‚£ä¹ˆåˆå§‹é˜ˆå€¼å°±æ˜¯ 10 / 3 ï¼Œä¹Ÿå°±æ˜¯3ï¼Œç„¶ååœ¨5ç§’åé€æ¸å¢é•¿åˆ°10.\næ¡ˆä¾‹\néœ€æ±‚ï¼šç»™/order/{orderId}è¿™ä¸ªèµ„æºè®¾ç½®é™æµï¼Œæœ€å¤§QPSä¸º10ï¼Œåˆ©ç”¨warm upæ•ˆæœï¼Œé¢„çƒ­æ—¶é•¿ä¸º5ç§’\n1ï¼‰é…ç½®æµæ§è§„åˆ™ï¼š 2ï¼‰Jmeteræµ‹è¯• é€‰æ‹©ã€Šæµæ§æ•ˆæœï¼Œwarm upã€‹ï¼š\nQPSä¸º10.\nåˆšåˆšå¯åŠ¨æ—¶ï¼Œå¤§éƒ¨åˆ†è¯·æ±‚å¤±è´¥ï¼ŒæˆåŠŸçš„åªæœ‰3ä¸ªï¼Œè¯´æ˜QPSè¢«é™å®šåœ¨3ï¼š\néšç€æ—¶é—´æ¨ç§»ï¼ŒæˆåŠŸæ¯”ä¾‹è¶Šæ¥è¶Šé«˜ï¼š\nåˆ°Sentinelæ§åˆ¶å°æŸ¥çœ‹å®æ—¶ç›‘æ§ï¼š\nä¸€æ®µæ—¶é—´åï¼š\n2.3.2.æ’é˜Ÿç­‰å¾… å½“è¯·æ±‚è¶…è¿‡QPSé˜ˆå€¼æ—¶ï¼Œå¿«é€Ÿå¤±è´¥å’Œwarm up ä¼šæ‹’ç»æ–°çš„è¯·æ±‚å¹¶æŠ›å‡ºå¼‚å¸¸ã€‚\nè€Œæ’é˜Ÿç­‰å¾…åˆ™æ˜¯è®©æ‰€æœ‰è¯·æ±‚è¿›å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç„¶åæŒ‰ç…§é˜ˆå€¼å…è®¸çš„æ—¶é—´é—´éš”ä¾æ¬¡æ‰§è¡Œã€‚åæ¥çš„è¯·æ±‚å¿…é¡»ç­‰å¾…å‰é¢æ‰§è¡Œå®Œæˆï¼Œå¦‚æœè¯·æ±‚é¢„æœŸçš„ç­‰å¾…æ—¶é—´è¶…å‡ºæœ€å¤§æ—¶é•¿ï¼Œåˆ™ä¼šè¢«æ‹’ç»ã€‚\nå·¥ä½œåŸç†\nä¾‹å¦‚ï¼šQPS = 5ï¼Œæ„å‘³ç€æ¯200mså¤„ç†ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„è¯·æ±‚ï¼›timeout = 2000ï¼Œæ„å‘³ç€é¢„æœŸç­‰å¾…æ—¶é•¿è¶…è¿‡2000msçš„è¯·æ±‚ä¼šè¢«æ‹’ç»å¹¶æŠ›å‡ºå¼‚å¸¸ã€‚\né‚£ä»€ä¹ˆå«åšé¢„æœŸç­‰å¾…æ—¶é•¿å‘¢ï¼Ÿ\næ¯”å¦‚ç°åœ¨ä¸€ä¸‹å­æ¥äº†12 ä¸ªè¯·æ±‚ï¼Œå› ä¸ºæ¯200msæ‰§è¡Œä¸€ä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆï¼š\nç¬¬6ä¸ªè¯·æ±‚çš„é¢„æœŸç­‰å¾…æ—¶é•¿ = 200 * ï¼ˆ6 - 1ï¼‰ = 1000ms ç¬¬12ä¸ªè¯·æ±‚çš„é¢„æœŸç­‰å¾…æ—¶é•¿ = 200 * ï¼ˆ12-1ï¼‰ = 2200ms ç°åœ¨ï¼Œç¬¬1ç§’åŒæ—¶æ¥æ”¶åˆ°10ä¸ªè¯·æ±‚ï¼Œä½†ç¬¬2ç§’åªæœ‰1ä¸ªè¯·æ±‚ï¼Œæ­¤æ—¶QPSçš„æ›²çº¿è¿™æ ·çš„ï¼š\nå¦‚æœä½¿ç”¨é˜Ÿåˆ—æ¨¡å¼åšæµæ§ï¼Œæ‰€æœ‰è¿›å…¥çš„è¯·æ±‚éƒ½è¦æ’é˜Ÿï¼Œä»¥å›ºå®šçš„200msçš„é—´éš”æ‰§è¡Œï¼ŒQPSä¼šå˜çš„å¾ˆå¹³æ»‘ï¼š\nå¹³æ»‘çš„QPSæ›²çº¿ï¼Œå¯¹äºæœåŠ¡å™¨æ¥è¯´æ˜¯æ›´å‹å¥½çš„ã€‚\næ¡ˆä¾‹\néœ€æ±‚ï¼šç»™/order/{orderId}è¿™ä¸ªèµ„æºè®¾ç½®é™æµï¼Œæœ€å¤§QPSä¸º10ï¼Œåˆ©ç”¨æ’é˜Ÿçš„æµæ§æ•ˆæœï¼Œè¶…æ—¶æ—¶é•¿è®¾ç½®ä¸º5s\n1ï¼‰æ·»åŠ æµæ§è§„åˆ™ 2ï¼‰Jmeteræµ‹è¯• é€‰æ‹©ã€Šæµæ§æ•ˆæœï¼Œé˜Ÿåˆ—ã€‹ï¼š\nQPSä¸º15ï¼Œå·²ç»è¶…è¿‡äº†æˆ‘ä»¬è®¾å®šçš„10ã€‚\nå¦‚æœæ˜¯ä¹‹å‰çš„ å¿«é€Ÿå¤±è´¥ã€warmupæ¨¡å¼ï¼Œè¶…å‡ºçš„è¯·æ±‚åº”è¯¥ä¼šç›´æ¥æŠ¥é”™ã€‚\nä½†æ˜¯æˆ‘ä»¬çœ‹çœ‹é˜Ÿåˆ—æ¨¡å¼çš„è¿è¡Œç»“æœï¼š\nå…¨éƒ¨éƒ½é€šè¿‡äº†ã€‚\nå†å»sentinelæŸ¥çœ‹å®æ—¶ç›‘æ§çš„QPSæ›²çº¿ï¼š\nQPSéå¸¸å¹³æ»‘ï¼Œä¸€è‡´ä¿æŒåœ¨10ï¼Œä½†æ˜¯è¶…å‡ºçš„è¯·æ±‚æ²¡æœ‰è¢«æ‹’ç»ï¼Œè€Œæ˜¯æ”¾å…¥é˜Ÿåˆ—ã€‚å› æ­¤å“åº”æ—¶é—´ï¼ˆç­‰å¾…æ—¶é—´ï¼‰ä¼šè¶Šæ¥è¶Šé•¿ã€‚\nå½“é˜Ÿåˆ—æ»¡äº†ä»¥åï¼Œæ‰ä¼šæœ‰éƒ¨åˆ†è¯·æ±‚å¤±è´¥ï¼š\n2.3.3.æ€»ç»“ æµæ§æ•ˆæœæœ‰å“ªäº›ï¼Ÿ\nå¿«é€Ÿå¤±è´¥ï¼šQPSè¶…è¿‡é˜ˆå€¼æ—¶ï¼Œæ‹’ç»æ–°çš„è¯·æ±‚\nwarm upï¼š QPSè¶…è¿‡é˜ˆå€¼æ—¶ï¼Œæ‹’ç»æ–°çš„è¯·æ±‚ï¼›QPSé˜ˆå€¼æ˜¯é€æ¸æå‡çš„ï¼Œå¯ä»¥é¿å…å†·å¯åŠ¨æ—¶é«˜å¹¶å‘å¯¼è‡´æœåŠ¡å®•æœºã€‚\næ’é˜Ÿç­‰å¾…ï¼šè¯·æ±‚ä¼šè¿›å…¥é˜Ÿåˆ—ï¼ŒæŒ‰ç…§é˜ˆå€¼å…è®¸çš„æ—¶é—´é—´éš”ä¾æ¬¡æ‰§è¡Œè¯·æ±‚ï¼›å¦‚æœè¯·æ±‚é¢„æœŸç­‰å¾…æ—¶é•¿å¤§äºè¶…æ—¶æ—¶é—´ï¼Œç›´æ¥æ‹’ç»\n2.4.çƒ­ç‚¹å‚æ•°é™æµ ä¹‹å‰çš„é™æµæ˜¯ç»Ÿè®¡è®¿é—®æŸä¸ªèµ„æºçš„æ‰€æœ‰è¯·æ±‚ï¼Œåˆ¤æ–­æ˜¯å¦è¶…è¿‡QPSé˜ˆå€¼ã€‚è€Œçƒ­ç‚¹å‚æ•°é™æµæ˜¯åˆ†åˆ«ç»Ÿè®¡å‚æ•°å€¼ç›¸åŒçš„è¯·æ±‚ï¼Œåˆ¤æ–­æ˜¯å¦è¶…è¿‡QPSé˜ˆå€¼ã€‚\n2.4.1.å…¨å±€å‚æ•°é™æµ ä¾‹å¦‚ï¼Œä¸€ä¸ªæ ¹æ®idæŸ¥è¯¢å•†å“çš„æ¥å£ï¼š\nè®¿é—®/goods/{id}çš„è¯·æ±‚ä¸­ï¼Œidå‚æ•°å€¼ä¼šæœ‰å˜åŒ–ï¼Œçƒ­ç‚¹å‚æ•°é™æµä¼šæ ¹æ®å‚æ•°å€¼åˆ†åˆ«ç»Ÿè®¡QPSï¼Œç»Ÿè®¡ç»“æœï¼š\nå½“id=1çš„è¯·æ±‚è§¦å‘é˜ˆå€¼è¢«é™æµæ—¶ï¼Œidå€¼ä¸ä¸º1çš„è¯·æ±‚ä¸å—å½±å“ã€‚\né…ç½®ç¤ºä¾‹ï¼š\nä»£è¡¨çš„å«ä¹‰æ˜¯ï¼šå¯¹hotè¿™ä¸ªèµ„æºçš„0å·å‚æ•°ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰åšç»Ÿè®¡ï¼Œæ¯1ç§’ç›¸åŒå‚æ•°å€¼çš„è¯·æ±‚æ•°ä¸èƒ½è¶…è¿‡5\n2.4.2.çƒ­ç‚¹å‚æ•°é™æµ åˆšæ‰çš„é…ç½®ä¸­ï¼Œå¯¹æŸ¥è¯¢å•†å“è¿™ä¸ªæ¥å£çš„æ‰€æœ‰å•†å“ä¸€è§†åŒä»ï¼ŒQPSéƒ½é™å®šä¸º5.\nè€Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œå¯èƒ½éƒ¨åˆ†å•†å“æ˜¯çƒ­ç‚¹å•†å“ï¼Œä¾‹å¦‚ç§’æ€å•†å“ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™éƒ¨åˆ†å•†å“çš„QPSé™åˆ¶ä¸å…¶å®ƒå•†å“ä¸ä¸€æ ·ï¼Œé«˜ä¸€äº›ã€‚é‚£å°±éœ€è¦é…ç½®çƒ­ç‚¹å‚æ•°é™æµçš„é«˜çº§é€‰é¡¹äº†ï¼š\nç»“åˆä¸Šä¸€ä¸ªé…ç½®ï¼Œè¿™é‡Œçš„å«ä¹‰æ˜¯å¯¹0å·çš„longç±»å‹å‚æ•°é™æµï¼Œæ¯1ç§’ç›¸åŒå‚æ•°çš„QPSä¸èƒ½è¶…è¿‡5ï¼Œæœ‰ä¸¤ä¸ªä¾‹å¤–ï¼š\nâ€¢å¦‚æœå‚æ•°å€¼æ˜¯100ï¼Œåˆ™æ¯1ç§’å…è®¸çš„QPSä¸º10\nâ€¢å¦‚æœå‚æ•°å€¼æ˜¯101ï¼Œåˆ™æ¯1ç§’å…è®¸çš„QPSä¸º15\n2.4.4.æ¡ˆä¾‹ æ¡ˆä¾‹éœ€æ±‚ï¼šç»™/order/{orderId}è¿™ä¸ªèµ„æºæ·»åŠ çƒ­ç‚¹å‚æ•°é™æµï¼Œè§„åˆ™å¦‚ä¸‹ï¼š\nâ€¢é»˜è®¤çš„çƒ­ç‚¹å‚æ•°è§„åˆ™æ˜¯æ¯1ç§’è¯·æ±‚é‡ä¸è¶…è¿‡2\nâ€¢ç»™102è¿™ä¸ªå‚æ•°è®¾ç½®ä¾‹å¤–ï¼šæ¯1ç§’è¯·æ±‚é‡ä¸è¶…è¿‡4\nâ€¢ç»™103è¿™ä¸ªå‚æ•°è®¾ç½®ä¾‹å¤–ï¼šæ¯1ç§’è¯·æ±‚é‡ä¸è¶…è¿‡10\næ³¨æ„äº‹é¡¹ï¼šçƒ­ç‚¹å‚æ•°é™æµå¯¹é»˜è®¤çš„SpringMVCèµ„æºæ— æ•ˆï¼Œéœ€è¦åˆ©ç”¨@SentinelResourceæ³¨è§£æ ‡è®°èµ„æº\n1ï¼‰æ ‡è®°èµ„æº ç»™order-serviceä¸­çš„OrderControllerä¸­çš„/order/{orderId}èµ„æºæ·»åŠ æ³¨è§£ï¼š\n2ï¼‰çƒ­ç‚¹å‚æ•°é™æµè§„åˆ™ è®¿é—®è¯¥æ¥å£ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ ‡è®°çš„hotèµ„æºå‡ºç°äº†ï¼š\nè¿™é‡Œä¸è¦ç‚¹å‡»hotåé¢çš„æŒ‰é’®ï¼Œé¡µé¢æœ‰BUG\nç‚¹å‡»å·¦ä¾§èœå•ä¸­çƒ­ç‚¹è§„åˆ™èœå•ï¼š\nç‚¹å‡»æ–°å¢ï¼Œå¡«å†™è¡¨å•ï¼š\n3ï¼‰Jmeteræµ‹è¯• é€‰æ‹©ã€Šçƒ­ç‚¹å‚æ•°é™æµ QPS1ã€‹ï¼š\nè¿™é‡Œå‘èµ·è¯·æ±‚çš„QPSä¸º5.\nåŒ…å«3ä¸ªhttpè¯·æ±‚ï¼š\næ™®é€šå‚æ•°ï¼ŒQPSé˜ˆå€¼ä¸º2\nè¿è¡Œç»“æœï¼š\nä¾‹å¤–é¡¹ï¼ŒQPSé˜ˆå€¼ä¸º4\nè¿è¡Œç»“æœï¼š\nä¾‹å¤–é¡¹ï¼ŒQPSé˜ˆå€¼ä¸º10\nè¿è¡Œç»“æœï¼š\n3.éš”ç¦»å’Œé™çº§ é™æµæ˜¯ä¸€ç§é¢„é˜²æªæ–½ï¼Œè™½ç„¶é™æµå¯ä»¥å°½é‡é¿å…å› é«˜å¹¶å‘è€Œå¼•èµ·çš„æœåŠ¡æ•…éšœï¼Œä½†æœåŠ¡è¿˜ä¼šå› ä¸ºå…¶å®ƒåŸå› è€Œæ•…éšœã€‚\nè€Œè¦å°†è¿™äº›æ•…éšœæ§åˆ¶åœ¨ä¸€å®šèŒƒå›´ï¼Œé¿å…é›ªå´©ï¼Œå°±è¦é çº¿ç¨‹éš”ç¦»ï¼ˆèˆ±å£æ¨¡å¼ï¼‰å’Œç†”æ–­é™çº§æ‰‹æ®µäº†ã€‚\nçº¿ç¨‹éš”ç¦»ä¹‹å‰è®²åˆ°è¿‡ï¼šè°ƒç”¨è€…åœ¨è°ƒç”¨æœåŠ¡æä¾›è€…æ—¶ï¼Œç»™æ¯ä¸ªè°ƒç”¨çš„è¯·æ±‚åˆ†é…ç‹¬ç«‹çº¿ç¨‹æ± ï¼Œå‡ºç°æ•…éšœæ—¶ï¼Œæœ€å¤šæ¶ˆè€—è¿™ä¸ªçº¿ç¨‹æ± å†…èµ„æºï¼Œé¿å…æŠŠè°ƒç”¨è€…çš„æ‰€æœ‰èµ„æºè€—å°½ã€‚\nç†”æ–­é™çº§ï¼šæ˜¯åœ¨è°ƒç”¨æ–¹è¿™è¾¹åŠ å…¥æ–­è·¯å™¨ï¼Œç»Ÿè®¡å¯¹æœåŠ¡æä¾›è€…çš„è°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨çš„å¤±è´¥æ¯”ä¾‹è¿‡é«˜ï¼Œåˆ™ç†”æ–­è¯¥ä¸šåŠ¡ï¼Œä¸å…è®¸è®¿é—®è¯¥æœåŠ¡çš„æä¾›è€…äº†ã€‚\nå¯ä»¥çœ‹åˆ°ï¼Œä¸ç®¡æ˜¯çº¿ç¨‹éš”ç¦»è¿˜æ˜¯ç†”æ–­é™çº§ï¼Œéƒ½æ˜¯å¯¹å®¢æˆ·ç«¯ï¼ˆè°ƒç”¨æ–¹ï¼‰çš„ä¿æŠ¤ã€‚éœ€è¦åœ¨è°ƒç”¨æ–¹ å‘èµ·è¿œç¨‹è°ƒç”¨æ—¶åšçº¿ç¨‹éš”ç¦»ã€æˆ–è€…æœåŠ¡ç†”æ–­ã€‚\nè€Œæˆ‘ä»¬çš„å¾®æœåŠ¡è¿œç¨‹è°ƒç”¨éƒ½æ˜¯åŸºäºFeignæ¥å®Œæˆçš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†Feignä¸Sentinelæ•´åˆï¼Œåœ¨Feigné‡Œé¢å®ç°çº¿ç¨‹éš”ç¦»å’ŒæœåŠ¡ç†”æ–­ã€‚\n3.1.FeignClientæ•´åˆSentinel SpringCloudä¸­ï¼Œå¾®æœåŠ¡è°ƒç”¨éƒ½æ˜¯é€šè¿‡Feignæ¥å®ç°çš„ï¼Œå› æ­¤åšå®¢æˆ·ç«¯ä¿æŠ¤å¿…é¡»æ•´åˆFeignå’ŒSentinelã€‚\n3.1.1.ä¿®æ”¹é…ç½®ï¼Œå¼€å¯sentinelåŠŸèƒ½ ä¿®æ”¹OrderServiceçš„application.ymlæ–‡ä»¶ï¼Œå¼€å¯Feignçš„SentinelåŠŸèƒ½ï¼š\nfeign: sentinel: enabled: true # å¼€å¯feignå¯¹sentinelçš„æ”¯æŒ 3.1.2.ç¼–å†™å¤±è´¥é™çº§é€»è¾‘ ä¸šåŠ¡å¤±è´¥åï¼Œä¸èƒ½ç›´æ¥æŠ¥é”™ï¼Œè€Œåº”è¯¥è¿”å›ç”¨æˆ·ä¸€ä¸ªå‹å¥½æç¤ºæˆ–è€…é»˜è®¤ç»“æœï¼Œè¿™ä¸ªå°±æ˜¯å¤±è´¥é™çº§é€»è¾‘ã€‚\nç»™FeignClientç¼–å†™å¤±è´¥åçš„é™çº§é€»è¾‘\nâ‘ æ–¹å¼ä¸€ï¼šFallbackClassï¼Œæ— æ³•å¯¹è¿œç¨‹è°ƒç”¨çš„å¼‚å¸¸åšå¤„ç†\nâ‘¡æ–¹å¼äºŒï¼šFallbackFactoryï¼Œå¯ä»¥å¯¹è¿œç¨‹è°ƒç”¨çš„å¼‚å¸¸åšå¤„ç†ï¼Œæˆ‘ä»¬é€‰æ‹©è¿™ç§\nè¿™é‡Œæˆ‘ä»¬æ¼”ç¤ºæ–¹å¼äºŒçš„å¤±è´¥é™çº§å¤„ç†ã€‚\næ­¥éª¤ä¸€ï¼šåœ¨feing-apié¡¹ç›®ä¸­å®šä¹‰ç±»ï¼Œå®ç°FallbackFactoryï¼š\nä»£ç ï¼š\npackage cn.itcast.feign.clients.fallback; import cn.itcast.feign.clients.UserClient; import cn.itcast.feign.pojo.User; import feign.hystrix.FallbackFactory; import lombok.extern.slf4j.Slf4j; @Slf4j public class UserClientFallbackFactory implements FallbackFactory\u0026lt;UserClient\u0026gt; { @Override public UserClient create(Throwable throwable) { return new UserClient() { @Override public User findById(Long id) { log.error(\u0026#34;æŸ¥è¯¢ç”¨æˆ·å¼‚å¸¸\u0026#34;, throwable); return new User(); } }; } } æ­¥éª¤äºŒï¼šåœ¨feing-apié¡¹ç›®ä¸­çš„DefaultFeignConfigurationç±»ä¸­å°†UserClientFallbackFactoryæ³¨å†Œä¸ºä¸€ä¸ªBeanï¼š\n@Bean public UserClientFallbackFactory userClientFallbackFactory(){ return new UserClientFallbackFactory(); } æ­¥éª¤ä¸‰ï¼šåœ¨feing-apié¡¹ç›®ä¸­çš„UserClientæ¥å£ä¸­ä½¿ç”¨UserClientFallbackFactoryï¼š\nimport cn.itcast.feign.clients.fallback.UserClientFallbackFactory; import cn.itcast.feign.pojo.User; import org.springframework.cloud.openfeign.FeignClient; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.PathVariable; @FeignClient(value = \u0026#34;userservice\u0026#34;, fallbackFactory = UserClientFallbackFactory.class) public interface UserClient { @GetMapping(\u0026#34;/user/{id}\u0026#34;) User findById(@PathVariable(\u0026#34;id\u0026#34;) Long id); } é‡å¯åï¼Œè®¿é—®ä¸€æ¬¡è®¢å•æŸ¥è¯¢ä¸šåŠ¡ï¼Œç„¶åæŸ¥çœ‹sentinelæ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°æ–°çš„ç°‡ç‚¹é“¾è·¯ï¼š\n3.1.3.æ€»ç»“ Sentinelæ”¯æŒçš„é›ªå´©è§£å†³æ–¹æ¡ˆï¼š\nçº¿ç¨‹éš”ç¦»ï¼ˆä»“å£æ¨¡å¼ï¼‰ é™çº§ç†”æ–­ Feignæ•´åˆSentinelçš„æ­¥éª¤ï¼š\nåœ¨application.ymlä¸­é…ç½®ï¼šfeign.sentienl.enable=true ç»™FeignClientç¼–å†™FallbackFactoryå¹¶æ³¨å†Œä¸ºBean å°†FallbackFactoryé…ç½®åˆ°FeignClient 3.2.çº¿ç¨‹éš”ç¦»ï¼ˆèˆ±å£æ¨¡å¼ï¼‰ 3.2.1.çº¿ç¨‹éš”ç¦»çš„å®ç°æ–¹å¼ çº¿ç¨‹éš”ç¦»æœ‰ä¸¤ç§æ–¹å¼å®ç°ï¼š\nçº¿ç¨‹æ± éš”ç¦»\nä¿¡å·é‡éš”ç¦»ï¼ˆSentinelé»˜è®¤é‡‡ç”¨ï¼‰\nå¦‚å›¾ï¼š\nçº¿ç¨‹æ± éš”ç¦»ï¼šç»™æ¯ä¸ªæœåŠ¡è°ƒç”¨ä¸šåŠ¡åˆ†é…ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œåˆ©ç”¨çº¿ç¨‹æ± æœ¬èº«å®ç°éš”ç¦»æ•ˆæœ\nä¿¡å·é‡éš”ç¦»ï¼šä¸åˆ›å»ºçº¿ç¨‹æ± ï¼Œè€Œæ˜¯è®¡æ•°å™¨æ¨¡å¼ï¼Œè®°å½•ä¸šåŠ¡ä½¿ç”¨çš„çº¿ç¨‹æ•°é‡ï¼Œè¾¾åˆ°ä¿¡å·é‡ä¸Šé™æ—¶ï¼Œç¦æ­¢æ–°çš„è¯·æ±‚ã€‚\nä¸¤è€…çš„ä¼˜ç¼ºç‚¹ï¼š\n3.2.2.sentinelçš„çº¿ç¨‹éš”ç¦» ç”¨æ³•è¯´æ˜ï¼š\nåœ¨æ·»åŠ é™æµè§„åˆ™æ—¶ï¼Œå¯ä»¥é€‰æ‹©ä¸¤ç§é˜ˆå€¼ç±»å‹ï¼š\nQPSï¼šå°±æ˜¯æ¯ç§’çš„è¯·æ±‚æ•°ï¼Œåœ¨å¿«é€Ÿå…¥é—¨ä¸­å·²ç»æ¼”ç¤ºè¿‡\nçº¿ç¨‹æ•°ï¼šæ˜¯è¯¥èµ„æºèƒ½ä½¿ç”¨ç”¨çš„tomcatçº¿ç¨‹æ•°çš„æœ€å¤§å€¼ã€‚ä¹Ÿå°±æ˜¯é€šè¿‡é™åˆ¶çº¿ç¨‹æ•°é‡ï¼Œå®ç°çº¿ç¨‹éš”ç¦»ï¼ˆèˆ±å£æ¨¡å¼ï¼‰ã€‚\næ¡ˆä¾‹éœ€æ±‚ï¼šç»™ order-serviceæœåŠ¡ä¸­çš„UserClientçš„æŸ¥è¯¢ç”¨æˆ·æ¥å£è®¾ç½®æµæ§è§„åˆ™ï¼Œçº¿ç¨‹æ•°ä¸èƒ½è¶…è¿‡ 2ã€‚ç„¶ååˆ©ç”¨jemeteræµ‹è¯•ã€‚\n1ï¼‰é…ç½®éš”ç¦»è§„åˆ™ é€‰æ‹©feignæ¥å£åé¢çš„æµæ§æŒ‰é’®ï¼š\nå¡«å†™è¡¨å•ï¼š\n2ï¼‰Jmeteræµ‹è¯• é€‰æ‹©ã€Šé˜ˆå€¼ç±»å‹-çº¿ç¨‹æ•°\u0026lt;2ã€‹ï¼š\nä¸€æ¬¡å‘ç”Ÿ10ä¸ªè¯·æ±‚ï¼Œæœ‰è¾ƒå¤§æ¦‚ç‡å¹¶å‘çº¿ç¨‹æ•°è¶…è¿‡2ï¼Œè€Œè¶…å‡ºçš„è¯·æ±‚ä¼šèµ°ä¹‹å‰å®šä¹‰çš„å¤±è´¥é™çº§é€»è¾‘ã€‚\næŸ¥çœ‹è¿è¡Œç»“æœï¼š\nå‘ç°è™½ç„¶ç»“æœéƒ½æ˜¯é€šè¿‡äº†ï¼Œä¸è¿‡éƒ¨åˆ†è¯·æ±‚å¾—åˆ°çš„å“åº”æ˜¯é™çº§è¿”å›çš„nullä¿¡æ¯ã€‚\n3.2.3.æ€»ç»“ çº¿ç¨‹éš”ç¦»çš„ä¸¤ç§æ‰‹æ®µæ˜¯ï¼Ÿ\nä¿¡å·é‡éš”ç¦»\nçº¿ç¨‹æ± éš”ç¦»\nä¿¡å·é‡éš”ç¦»çš„ç‰¹ç‚¹æ˜¯ï¼Ÿ\nåŸºäºè®¡æ•°å™¨æ¨¡å¼ï¼Œç®€å•ï¼Œå¼€é”€å° çº¿ç¨‹æ± éš”ç¦»çš„ç‰¹ç‚¹æ˜¯ï¼Ÿ\nåŸºäºçº¿ç¨‹æ± æ¨¡å¼ï¼Œæœ‰é¢å¤–å¼€é”€ï¼Œä½†éš”ç¦»æ§åˆ¶æ›´å¼º 3.3.ç†”æ–­é™çº§ ç†”æ–­é™çº§æ˜¯è§£å†³é›ªå´©é—®é¢˜çš„é‡è¦æ‰‹æ®µã€‚å…¶æ€è·¯æ˜¯ç”±æ–­è·¯å™¨ç»Ÿè®¡æœåŠ¡è°ƒç”¨çš„å¼‚å¸¸æ¯”ä¾‹ã€æ…¢è¯·æ±‚æ¯”ä¾‹ï¼Œå¦‚æœè¶…å‡ºé˜ˆå€¼åˆ™ä¼šç†”æ–­è¯¥æœåŠ¡ã€‚å³æ‹¦æˆªè®¿é—®è¯¥æœåŠ¡çš„ä¸€åˆ‡è¯·æ±‚ï¼›è€Œå½“æœåŠ¡æ¢å¤æ—¶ï¼Œæ–­è·¯å™¨ä¼šæ”¾è¡Œè®¿é—®è¯¥æœåŠ¡çš„è¯·æ±‚ã€‚\næ–­è·¯å™¨æ§åˆ¶ç†”æ–­å’Œæ”¾è¡Œæ˜¯é€šè¿‡çŠ¶æ€æœºæ¥å®Œæˆçš„ï¼š\nçŠ¶æ€æœºåŒ…æ‹¬ä¸‰ä¸ªçŠ¶æ€ï¼š\nclosedï¼šå…³é—­çŠ¶æ€ï¼Œæ–­è·¯å™¨æ”¾è¡Œæ‰€æœ‰è¯·æ±‚ï¼Œå¹¶å¼€å§‹ç»Ÿè®¡å¼‚å¸¸æ¯”ä¾‹ã€æ…¢è¯·æ±‚æ¯”ä¾‹ã€‚è¶…è¿‡é˜ˆå€¼åˆ™åˆ‡æ¢åˆ°opençŠ¶æ€ openï¼šæ‰“å¼€çŠ¶æ€ï¼ŒæœåŠ¡è°ƒç”¨è¢«ç†”æ–­ï¼Œè®¿é—®è¢«ç†”æ–­æœåŠ¡çš„è¯·æ±‚ä¼šè¢«æ‹’ç»ï¼Œå¿«é€Ÿå¤±è´¥ï¼Œç›´æ¥èµ°é™çº§é€»è¾‘ã€‚OpençŠ¶æ€5ç§’åä¼šè¿›å…¥half-opençŠ¶æ€ half-openï¼šåŠå¼€çŠ¶æ€ï¼Œæ”¾è¡Œä¸€æ¬¡è¯·æ±‚ï¼Œæ ¹æ®æ‰§è¡Œç»“æœæ¥åˆ¤æ–­æ¥ä¸‹æ¥çš„æ“ä½œã€‚ è¯·æ±‚æˆåŠŸï¼šåˆ™åˆ‡æ¢åˆ°closedçŠ¶æ€ è¯·æ±‚å¤±è´¥ï¼šåˆ™åˆ‡æ¢åˆ°opençŠ¶æ€ æ–­è·¯å™¨ç†”æ–­ç­–ç•¥æœ‰ä¸‰ç§ï¼šæ…¢è°ƒç”¨ã€å¼‚å¸¸æ¯”ä¾‹ã€å¼‚å¸¸æ•°\n3.3.1.æ…¢è°ƒç”¨ æ…¢è°ƒç”¨ï¼šä¸šåŠ¡çš„å“åº”æ—¶é•¿ï¼ˆRTï¼‰å¤§äºæŒ‡å®šæ—¶é•¿çš„è¯·æ±‚è®¤å®šä¸ºæ…¢è°ƒç”¨è¯·æ±‚ã€‚åœ¨æŒ‡å®šæ—¶é—´å†…ï¼Œå¦‚æœè¯·æ±‚æ•°é‡è¶…è¿‡è®¾å®šçš„æœ€å°æ•°é‡ï¼Œæ…¢è°ƒç”¨æ¯”ä¾‹å¤§äºè®¾å®šçš„é˜ˆå€¼ï¼Œåˆ™è§¦å‘ç†”æ–­ã€‚\nä¾‹å¦‚ï¼š\nè§£è¯»ï¼šRTè¶…è¿‡500msçš„è°ƒç”¨æ˜¯æ…¢è°ƒç”¨ï¼Œç»Ÿè®¡æœ€è¿‘10000mså†…çš„è¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚é‡è¶…è¿‡10æ¬¡ï¼Œå¹¶ä¸”æ…¢è°ƒç”¨æ¯”ä¾‹ä¸ä½äº0.5ï¼Œåˆ™è§¦å‘ç†”æ–­ï¼Œç†”æ–­æ—¶é•¿ä¸º5ç§’ã€‚ç„¶åè¿›å…¥half-opençŠ¶æ€ï¼Œæ”¾è¡Œä¸€æ¬¡è¯·æ±‚åšæµ‹è¯•ã€‚\næ¡ˆä¾‹\néœ€æ±‚ï¼šç»™ UserClientçš„æŸ¥è¯¢ç”¨æˆ·æ¥å£è®¾ç½®é™çº§è§„åˆ™ï¼Œæ…¢è°ƒç”¨çš„RTé˜ˆå€¼ä¸º50msï¼Œç»Ÿè®¡æ—¶é—´ä¸º1ç§’ï¼Œæœ€å°è¯·æ±‚æ•°é‡ä¸º5ï¼Œå¤±è´¥é˜ˆå€¼æ¯”ä¾‹ä¸º0.4ï¼Œç†”æ–­æ—¶é•¿ä¸º5\n1ï¼‰è®¾ç½®æ…¢è°ƒç”¨ ä¿®æ”¹user-serviceä¸­çš„/user/{id}è¿™ä¸ªæ¥å£çš„ä¸šåŠ¡ã€‚é€šè¿‡ä¼‘çœ æ¨¡æ‹Ÿä¸€ä¸ªå»¶è¿Ÿæ—¶é—´ï¼š\næ­¤æ—¶ï¼ŒorderId=101çš„è®¢å•ï¼Œå…³è”çš„æ˜¯idä¸º1çš„ç”¨æˆ·ï¼Œè°ƒç”¨æ—¶é•¿ä¸º60msï¼š\norderId=102çš„è®¢å•ï¼Œå…³è”çš„æ˜¯idä¸º2çš„ç”¨æˆ·ï¼Œè°ƒç”¨æ—¶é•¿ä¸ºéå¸¸çŸ­ï¼›\n2ï¼‰è®¾ç½®ç†”æ–­è§„åˆ™ ä¸‹é¢ï¼Œç»™feignæ¥å£è®¾ç½®é™çº§è§„åˆ™ï¼š\nè§„åˆ™ï¼š\nè¶…è¿‡50msçš„è¯·æ±‚éƒ½ä¼šè¢«è®¤ä¸ºæ˜¯æ…¢è¯·æ±‚\n3ï¼‰æµ‹è¯• åœ¨æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8088/order/101ï¼Œå¿«é€Ÿåˆ·æ–°5æ¬¡ï¼Œå¯ä»¥å‘ç°ï¼š\nè§¦å‘äº†ç†”æ–­ï¼Œè¯·æ±‚æ—¶é•¿ç¼©çŸ­è‡³5msï¼Œå¿«é€Ÿå¤±è´¥äº†ï¼Œå¹¶ä¸”èµ°é™çº§é€»è¾‘ï¼Œè¿”å›çš„null\nåœ¨æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8088/order/102ï¼Œç«Ÿç„¶ä¹Ÿè¢«ç†”æ–­äº†ï¼š\n3.3.2.å¼‚å¸¸æ¯”ä¾‹ã€å¼‚å¸¸æ•° å¼‚å¸¸æ¯”ä¾‹æˆ–å¼‚å¸¸æ•°ï¼šç»Ÿè®¡æŒ‡å®šæ—¶é—´å†…çš„è°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨æ¬¡æ•°è¶…è¿‡æŒ‡å®šè¯·æ±‚æ•°ï¼Œå¹¶ä¸”å‡ºç°å¼‚å¸¸çš„æ¯”ä¾‹è¾¾åˆ°è®¾å®šçš„æ¯”ä¾‹é˜ˆå€¼ï¼ˆæˆ–è¶…è¿‡æŒ‡å®šå¼‚å¸¸æ•°ï¼‰ï¼Œåˆ™è§¦å‘ç†”æ–­ã€‚\nä¾‹å¦‚ï¼Œä¸€ä¸ªå¼‚å¸¸æ¯”ä¾‹è®¾ç½®ï¼š\nè§£è¯»ï¼šç»Ÿè®¡æœ€è¿‘1000mså†…çš„è¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚é‡è¶…è¿‡10æ¬¡ï¼Œå¹¶ä¸”å¼‚å¸¸æ¯”ä¾‹ä¸ä½äº0.4ï¼Œåˆ™è§¦å‘ç†”æ–­ã€‚\nä¸€ä¸ªå¼‚å¸¸æ•°è®¾ç½®ï¼š\nè§£è¯»ï¼šç»Ÿè®¡æœ€è¿‘1000mså†…çš„è¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚é‡è¶…è¿‡10æ¬¡ï¼Œå¹¶ä¸”å¼‚å¸¸æ¯”ä¾‹ä¸ä½äº2æ¬¡ï¼Œåˆ™è§¦å‘ç†”æ–­ã€‚\næ¡ˆä¾‹\néœ€æ±‚ï¼šç»™ UserClientçš„æŸ¥è¯¢ç”¨æˆ·æ¥å£è®¾ç½®é™çº§è§„åˆ™ï¼Œç»Ÿè®¡æ—¶é—´ä¸º1ç§’ï¼Œæœ€å°è¯·æ±‚æ•°é‡ä¸º5ï¼Œå¤±è´¥é˜ˆå€¼æ¯”ä¾‹ä¸º0.4ï¼Œç†”æ–­æ—¶é•¿ä¸º5s\n1ï¼‰è®¾ç½®å¼‚å¸¸è¯·æ±‚ é¦–å…ˆï¼Œä¿®æ”¹user-serviceä¸­çš„/user/{id}è¿™ä¸ªæ¥å£çš„ä¸šåŠ¡ã€‚æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸ï¼Œä»¥è§¦å‘å¼‚å¸¸æ¯”ä¾‹çš„ç†”æ–­ï¼š\nä¹Ÿå°±æ˜¯è¯´ï¼Œid ä¸º 2æ—¶ï¼Œå°±ä¼šè§¦å‘å¼‚å¸¸\n2ï¼‰è®¾ç½®ç†”æ–­è§„åˆ™ ä¸‹é¢ï¼Œç»™feignæ¥å£è®¾ç½®é™çº§è§„åˆ™ï¼š\nè§„åˆ™ï¼š\nåœ¨5æ¬¡è¯·æ±‚ä¸­ï¼Œåªè¦å¼‚å¸¸æ¯”ä¾‹è¶…è¿‡0.4ï¼Œä¹Ÿå°±æ˜¯æœ‰2æ¬¡ä»¥ä¸Šçš„å¼‚å¸¸ï¼Œå°±ä¼šè§¦å‘ç†”æ–­ã€‚\n3ï¼‰æµ‹è¯• åœ¨æµè§ˆå™¨å¿«é€Ÿè®¿é—®ï¼šhttp://localhost:8088/order/102ï¼Œå¿«é€Ÿåˆ·æ–°5æ¬¡ï¼Œè§¦å‘ç†”æ–­ï¼š\næ­¤æ—¶ï¼Œæˆ‘ä»¬å»è®¿é—®æœ¬æ¥åº”è¯¥æ­£å¸¸çš„103ï¼š\n4.æˆæƒè§„åˆ™ æˆæƒè§„åˆ™å¯ä»¥å¯¹è¯·æ±‚æ–¹æ¥æºåšåˆ¤æ–­å’Œæ§åˆ¶ã€‚\n4.1.æˆæƒè§„åˆ™ 4.1.1.åŸºæœ¬è§„åˆ™ æˆæƒè§„åˆ™å¯ä»¥å¯¹è°ƒç”¨æ–¹çš„æ¥æºåšæ§åˆ¶ï¼Œæœ‰ç™½åå•å’Œé»‘åå•ä¸¤ç§æ–¹å¼ã€‚\nç™½åå•ï¼šæ¥æºï¼ˆoriginï¼‰åœ¨ç™½åå•å†…çš„è°ƒç”¨è€…å…è®¸è®¿é—®\né»‘åå•ï¼šæ¥æºï¼ˆoriginï¼‰åœ¨é»‘åå•å†…çš„è°ƒç”¨è€…ä¸å…è®¸è®¿é—®\nç‚¹å‡»å·¦ä¾§èœå•çš„æˆæƒï¼Œå¯ä»¥çœ‹åˆ°æˆæƒè§„åˆ™ï¼š\nèµ„æºåï¼šå°±æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚/order/{orderId}\næµæ§åº”ç”¨ï¼šæ˜¯æ¥æºè€…çš„åå•ï¼Œ\nå¦‚æœæ˜¯å‹¾é€‰ç™½åå•ï¼Œåˆ™åå•ä¸­çš„æ¥æºè¢«è®¸å¯è®¿é—®ã€‚ å¦‚æœæ˜¯å‹¾é€‰é»‘åå•ï¼Œåˆ™åå•ä¸­çš„æ¥æºè¢«ç¦æ­¢è®¿é—®ã€‚ æ¯”å¦‚ï¼š\næˆ‘ä»¬å…è®¸è¯·æ±‚ä»gatewayåˆ°order-serviceï¼Œä¸å…è®¸æµè§ˆå™¨è®¿é—®order-serviceï¼Œé‚£ä¹ˆç™½åå•ä¸­å°±è¦å¡«å†™ç½‘å…³çš„æ¥æºåç§°ï¼ˆoriginï¼‰ã€‚\n4.1.2.å¦‚ä½•è·å–origin Sentinelæ˜¯é€šè¿‡RequestOriginParserè¿™ä¸ªæ¥å£çš„parseOriginæ¥è·å–è¯·æ±‚çš„æ¥æºçš„ã€‚\npublic interface RequestOriginParser { /** * ä»è¯·æ±‚requestå¯¹è±¡ä¸­è·å–originï¼Œè·å–æ–¹å¼è‡ªå®šä¹‰ */ String parseOrigin(HttpServletRequest request); } è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨å°±æ˜¯ä»requestå¯¹è±¡ä¸­ï¼Œè·å–è¯·æ±‚è€…çš„originå€¼å¹¶è¿”å›ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼Œsentinelä¸ç®¡è¯·æ±‚è€…ä»å“ªé‡Œæ¥ï¼Œè¿”å›å€¼æ°¸è¿œæ˜¯defaultï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€åˆ‡è¯·æ±‚çš„æ¥æºéƒ½è¢«è®¤ä¸ºæ˜¯ä¸€æ ·çš„å€¼defaultã€‚\nå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰è¿™ä¸ªæ¥å£çš„å®ç°ï¼Œè®©ä¸åŒçš„è¯·æ±‚ï¼Œè¿”å›ä¸åŒçš„originã€‚\nä¾‹å¦‚order-serviceæœåŠ¡ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªRequestOriginParserçš„å®ç°ç±»ï¼š\npackage cn.itcast.order.sentinel; import com.alibaba.csp.sentinel.adapter.spring.webmvc.callback.RequestOriginParser; import org.springframework.stereotype.Component; import org.springframework.util.StringUtils; import javax.servlet.http.HttpServletRequest; @Component public class HeaderOriginParser implements RequestOriginParser { @Override public String parseOrigin(HttpServletRequest request) { // 1.è·å–è¯·æ±‚å¤´ String origin = request.getHeader(\u0026#34;origin\u0026#34;); // 2.éç©ºåˆ¤æ–­ if (StringUtils.isEmpty(origin)) { origin = \u0026#34;blank\u0026#34;; } return origin; } } æˆ‘ä»¬ä¼šå°è¯•ä»request-headerä¸­è·å–originå€¼ã€‚\n4.1.3.ç»™ç½‘å…³æ·»åŠ è¯·æ±‚å¤´ æ—¢ç„¶è·å–è¯·æ±‚originçš„æ–¹å¼æ˜¯ä»reques-headerä¸­è·å–originå€¼ï¼Œæˆ‘ä»¬å¿…é¡»è®©æ‰€æœ‰ä»gatewayè·¯ç”±åˆ°å¾®æœåŠ¡çš„è¯·æ±‚éƒ½å¸¦ä¸Šoriginå¤´ã€‚\nè¿™ä¸ªéœ€è¦åˆ©ç”¨ä¹‹å‰å­¦ä¹ çš„ä¸€ä¸ªGatewayFilteræ¥å®ç°ï¼ŒAddRequestHeaderGatewayFilterã€‚\nä¿®æ”¹gatewayæœåŠ¡ä¸­çš„application.ymlï¼Œæ·»åŠ ä¸€ä¸ªdefaultFilterï¼š\nspring: cloud: gateway: default-filters: - AddRequestHeader=origin,gateway routes: # ...ç•¥ è¿™æ ·ï¼Œä»gatewayè·¯ç”±çš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šå¸¦ä¸Šoriginå¤´ï¼Œå€¼ä¸ºgatewayã€‚è€Œä»å…¶å®ƒåœ°æ–¹åˆ°è¾¾å¾®æœåŠ¡çš„è¯·æ±‚åˆ™æ²¡æœ‰è¿™ä¸ªå¤´ã€‚\n4.1.4.é…ç½®æˆæƒè§„åˆ™ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæˆæƒè§„åˆ™ï¼Œæ”¾è¡Œoriginå€¼ä¸ºgatewayçš„è¯·æ±‚ã€‚\né…ç½®å¦‚ä¸‹ï¼š\nç°åœ¨ï¼Œæˆ‘ä»¬ç›´æ¥è·³è¿‡ç½‘å…³ï¼Œè®¿é—®order-serviceæœåŠ¡ï¼š\né€šè¿‡ç½‘å…³è®¿é—®ï¼š\n4.2.è‡ªå®šä¹‰å¼‚å¸¸ç»“æœ é»˜è®¤æƒ…å†µä¸‹ï¼Œå‘ç”Ÿé™æµã€é™çº§ã€æˆæƒæ‹¦æˆªæ—¶ï¼Œéƒ½ä¼šæŠ›å‡ºå¼‚å¸¸åˆ°è°ƒç”¨æ–¹ã€‚å¼‚å¸¸ç»“æœéƒ½æ˜¯flow limmitingï¼ˆé™æµï¼‰ã€‚è¿™æ ·ä¸å¤Ÿå‹å¥½ï¼Œæ— æ³•å¾—çŸ¥æ˜¯é™æµè¿˜æ˜¯é™çº§è¿˜æ˜¯æˆæƒæ‹¦æˆªã€‚\n4.2.1.å¼‚å¸¸ç±»å‹ è€Œå¦‚æœè¦è‡ªå®šä¹‰å¼‚å¸¸æ—¶çš„è¿”å›ç»“æœï¼Œéœ€è¦å®ç°BlockExceptionHandleræ¥å£ï¼š\npublic interface BlockExceptionHandler { /** * å¤„ç†è¯·æ±‚è¢«é™æµã€é™çº§ã€æˆæƒæ‹¦æˆªæ—¶æŠ›å‡ºçš„å¼‚å¸¸ï¼šBlockException */ void handle(HttpServletRequest request, HttpServletResponse response, BlockException e) throws Exception; } è¿™ä¸ªæ–¹æ³•æœ‰ä¸‰ä¸ªå‚æ•°ï¼š\nHttpServletRequest requestï¼šrequestå¯¹è±¡ HttpServletResponse responseï¼šresponseå¯¹è±¡ BlockException eï¼šè¢«sentinelæ‹¦æˆªæ—¶æŠ›å‡ºçš„å¼‚å¸¸ è¿™é‡Œçš„BlockExceptionåŒ…å«å¤šä¸ªä¸åŒçš„å­ç±»ï¼š\nå¼‚å¸¸ è¯´æ˜ FlowException é™æµå¼‚å¸¸ ParamFlowException çƒ­ç‚¹å‚æ•°é™æµçš„å¼‚å¸¸ DegradeException é™çº§å¼‚å¸¸ AuthorityException æˆæƒè§„åˆ™å¼‚å¸¸ SystemBlockException ç³»ç»Ÿè§„åˆ™å¼‚å¸¸ 4.2.2.è‡ªå®šä¹‰å¼‚å¸¸å¤„ç† ä¸‹é¢ï¼Œæˆ‘ä»¬å°±åœ¨order-serviceå®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰å¼‚å¸¸å¤„ç†ç±»ï¼š\npackage cn.itcast.order.sentinel; import com.alibaba.csp.sentinel.adapter.spring.webmvc.callback.BlockExceptionHandler; import com.alibaba.csp.sentinel.slots.block.BlockException; import com.alibaba.csp.sentinel.slots.block.authority.AuthorityException; import com.alibaba.csp.sentinel.slots.block.degrade.DegradeException; import com.alibaba.csp.sentinel.slots.block.flow.FlowException; import com.alibaba.csp.sentinel.slots.block.flow.param.ParamFlowException; import org.springframework.stereotype.Component; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; @Component public class SentinelExceptionHandler implements BlockExceptionHandler { @Override public void handle(HttpServletRequest request, HttpServletResponse response, BlockException e) throws Exception { String msg = \u0026#34;æœªçŸ¥å¼‚å¸¸\u0026#34;; int status = 429; if (e instanceof FlowException) { msg = \u0026#34;è¯·æ±‚è¢«é™æµäº†\u0026#34;; } else if (e instanceof ParamFlowException) { msg = \u0026#34;è¯·æ±‚è¢«çƒ­ç‚¹å‚æ•°é™æµ\u0026#34;; } else if (e instanceof DegradeException) { msg = \u0026#34;è¯·æ±‚è¢«é™çº§äº†\u0026#34;; } else if (e instanceof AuthorityException) { msg = \u0026#34;æ²¡æœ‰æƒé™è®¿é—®\u0026#34;; status = 401; } response.setContentType(\u0026#34;application/json;charset=utf-8\u0026#34;); response.setStatus(status); response.getWriter().println(\u0026#34;{\\\u0026#34;msg\\\u0026#34;: \u0026#34; + msg + \u0026#34;, \\\u0026#34;status\\\u0026#34;: \u0026#34; + status + \u0026#34;}\u0026#34;); } } é‡å¯æµ‹è¯•ï¼Œåœ¨ä¸åŒåœºæ™¯ä¸‹ï¼Œä¼šè¿”å›ä¸åŒçš„å¼‚å¸¸æ¶ˆæ¯.\né™æµï¼š\næˆæƒæ‹¦æˆªæ—¶ï¼š\n5.è§„åˆ™æŒä¹…åŒ– ç°åœ¨ï¼Œsentinelçš„æ‰€æœ‰è§„åˆ™éƒ½æ˜¯å†…å­˜å­˜å‚¨ï¼Œé‡å¯åæ‰€æœ‰è§„åˆ™éƒ½ä¼šä¸¢å¤±ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿è¿™äº›è§„åˆ™çš„æŒä¹…åŒ–ï¼Œé¿å…ä¸¢å¤±ã€‚\n5.1.è§„åˆ™ç®¡ç†æ¨¡å¼ è§„åˆ™æ˜¯å¦èƒ½æŒä¹…åŒ–ï¼Œå–å†³äºè§„åˆ™ç®¡ç†æ¨¡å¼ï¼Œsentinelæ”¯æŒä¸‰ç§è§„åˆ™ç®¡ç†æ¨¡å¼ï¼š\nåŸå§‹æ¨¡å¼ï¼šSentinelçš„é»˜è®¤æ¨¡å¼ï¼Œå°†è§„åˆ™ä¿å­˜åœ¨å†…å­˜ï¼Œé‡å¯æœåŠ¡ä¼šä¸¢å¤±ã€‚ pullæ¨¡å¼ pushæ¨¡å¼ 5.1.1.pullæ¨¡å¼ pullæ¨¡å¼ï¼šæ§åˆ¶å°å°†é…ç½®çš„è§„åˆ™æ¨é€åˆ°Sentinelå®¢æˆ·ç«¯ï¼Œè€Œå®¢æˆ·ç«¯ä¼šå°†é…ç½®è§„åˆ™ä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶æˆ–æ•°æ®åº“ä¸­ã€‚ä»¥åä¼šå®šæ—¶å»æœ¬åœ°æ–‡ä»¶æˆ–æ•°æ®åº“ä¸­æŸ¥è¯¢ï¼Œæ›´æ–°æœ¬åœ°è§„åˆ™ã€‚\n5.1.2.pushæ¨¡å¼ pushæ¨¡å¼ï¼šæ§åˆ¶å°å°†é…ç½®è§„åˆ™æ¨é€åˆ°è¿œç¨‹é…ç½®ä¸­å¿ƒï¼Œä¾‹å¦‚Nacosã€‚Sentinelå®¢æˆ·ç«¯ç›‘å¬Nacosï¼Œè·å–é…ç½®å˜æ›´çš„æ¨é€æ¶ˆæ¯ï¼Œå®Œæˆæœ¬åœ°é…ç½®æ›´æ–°ã€‚\n5.2.å®ç°pushæ¨¡å¼ è¯¦ç»†æ­¥éª¤å¯ä»¥å‚è€ƒè¯¾å‰èµ„æ–™çš„ã€Šsentinelè§„åˆ™æŒä¹…åŒ–ã€‹ï¼š\n","permalink":"https://XianCH.github.io/posts/tech/distributed/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%BF%9D%E6%8A%A4/","summary":"\u003ch1 id=\"å¾®æœåŠ¡ä¿æŠ¤\"\u003eå¾®æœåŠ¡ä¿æŠ¤\u003c/h1\u003e\n\u003ch1 id=\"1åˆè¯†sentinel\"\u003e1.åˆè¯†Sentinel\u003c/h1\u003e\n\u003ch2 id=\"11é›ªå´©é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ\"\u003e1.1.é›ªå´©é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ\u003c/h2\u003e\n\u003ch3 id=\"111é›ªå´©é—®é¢˜\"\u003e1.1.1.é›ªå´©é—®é¢˜\u003c/h3\u003e\n\u003cp\u003eå¾®æœåŠ¡ä¸­ï¼ŒæœåŠ¡é—´è°ƒç”¨å…³ç³»é”™ç»¼å¤æ‚ï¼Œä¸€ä¸ªå¾®æœåŠ¡å¾€å¾€ä¾èµ–äºå¤šä¸ªå…¶å®ƒå¾®æœåŠ¡ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"assets/1533829099748.png\" alt=\"1533829099748\"  /\u003e\n\u003c/p\u003e\n\u003cp\u003eå¦‚å›¾ï¼Œå¦‚æœæœåŠ¡æä¾›è€…Iå‘ç”Ÿäº†æ•…éšœï¼Œå½“å‰çš„åº”ç”¨çš„éƒ¨åˆ†ä¸šåŠ¡å› ä¸ºä¾èµ–äºæœåŠ¡Iï¼Œå› æ­¤ä¹Ÿä¼šè¢«é˜»å¡ã€‚æ­¤æ—¶ï¼Œå…¶å®ƒä¸ä¾èµ–äºæœåŠ¡Içš„ä¸šåŠ¡ä¼¼ä¹ä¸å—å½±å“ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"assets/1533829198240.png\" alt=\"1533829198240\"  /\u003e\n\u003c/p\u003e\n\u003cp\u003eä½†æ˜¯ï¼Œä¾èµ–æœåŠ¡Içš„ä¸šåŠ¡è¯·æ±‚è¢«é˜»å¡ï¼Œç”¨æˆ·ä¸ä¼šå¾—åˆ°å“åº”ï¼Œåˆ™tomcatçš„è¿™ä¸ªçº¿ç¨‹ä¸ä¼šé‡Šæ”¾ï¼Œäºæ˜¯è¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·è¯·æ±‚åˆ°æ¥ï¼Œè¶Šæ¥è¶Šå¤šçš„çº¿ç¨‹ä¼šé˜»å¡ï¼š\u003c/p\u003e","title":"å¾®æœåŠ¡ä¿æŠ¤"},{"content":"1.ä»€ä¹ˆæ˜¯å¤šçº§ç¼“å­˜ ä¼ ç»Ÿçš„ç¼“å­˜ç­–ç•¥ä¸€èˆ¬æ˜¯è¯·æ±‚åˆ°è¾¾Tomcatåï¼Œå…ˆæŸ¥è¯¢Redisï¼Œå¦‚æœæœªå‘½ä¸­åˆ™æŸ¥è¯¢æ•°æ®åº“ï¼Œå¦‚å›¾ï¼š\nå­˜åœ¨ä¸‹é¢çš„é—®é¢˜ï¼š\nâ€¢è¯·æ±‚è¦ç»è¿‡Tomcatå¤„ç†ï¼ŒTomcatçš„æ€§èƒ½æˆä¸ºæ•´ä¸ªç³»ç»Ÿçš„ç“¶é¢ˆ\nâ€¢Redisç¼“å­˜å¤±æ•ˆæ—¶ï¼Œä¼šå¯¹æ•°æ®åº“äº§ç”Ÿå†²å‡»\nå¤šçº§ç¼“å­˜å°±æ˜¯å……åˆ†åˆ©ç”¨è¯·æ±‚å¤„ç†çš„æ¯ä¸ªç¯èŠ‚ï¼Œåˆ†åˆ«æ·»åŠ ç¼“å­˜ï¼Œå‡è½»Tomcatå‹åŠ›ï¼Œæå‡æœåŠ¡æ€§èƒ½ï¼š\næµè§ˆå™¨è®¿é—®é™æ€èµ„æºæ—¶ï¼Œä¼˜å…ˆè¯»å–æµè§ˆå™¨æœ¬åœ°ç¼“å­˜ è®¿é—®éé™æ€èµ„æºï¼ˆajaxæŸ¥è¯¢æ•°æ®ï¼‰æ—¶ï¼Œè®¿é—®æœåŠ¡ç«¯ è¯·æ±‚åˆ°è¾¾Nginxåï¼Œä¼˜å…ˆè¯»å–Nginxæœ¬åœ°ç¼“å­˜ å¦‚æœNginxæœ¬åœ°ç¼“å­˜æœªå‘½ä¸­ï¼Œåˆ™å»ç›´æ¥æŸ¥è¯¢Redisï¼ˆä¸ç»è¿‡Tomcatï¼‰ å¦‚æœRedisæŸ¥è¯¢æœªå‘½ä¸­ï¼Œåˆ™æŸ¥è¯¢Tomcat è¯·æ±‚è¿›å…¥Tomcatåï¼Œä¼˜å…ˆæŸ¥è¯¢JVMè¿›ç¨‹ç¼“å­˜ å¦‚æœJVMè¿›ç¨‹ç¼“å­˜æœªå‘½ä¸­ï¼Œåˆ™æŸ¥è¯¢æ•°æ®åº“ åœ¨å¤šçº§ç¼“å­˜æ¶æ„ä¸­ï¼ŒNginxå†…éƒ¨éœ€è¦ç¼–å†™æœ¬åœ°ç¼“å­˜æŸ¥è¯¢ã€RedisæŸ¥è¯¢ã€TomcatæŸ¥è¯¢çš„ä¸šåŠ¡é€»è¾‘ï¼Œå› æ­¤è¿™æ ·çš„nginxæœåŠ¡ä¸å†æ˜¯ä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ï¼Œè€Œæ˜¯ä¸€ä¸ªç¼–å†™ä¸šåŠ¡çš„WebæœåŠ¡å™¨äº†ã€‚\nå› æ­¤è¿™æ ·çš„ä¸šåŠ¡NginxæœåŠ¡ä¹Ÿéœ€è¦æ­å»ºé›†ç¾¤æ¥æé«˜å¹¶å‘ï¼Œå†æœ‰ä¸“é—¨çš„nginxæœåŠ¡æ¥åšåå‘ä»£ç†ï¼Œå¦‚å›¾ï¼š\nå¦å¤–ï¼Œæˆ‘ä»¬çš„TomcatæœåŠ¡å°†æ¥ä¹Ÿä¼šéƒ¨ç½²ä¸ºé›†ç¾¤æ¨¡å¼ï¼š\nå¯è§ï¼Œå¤šçº§ç¼“å­˜çš„å…³é”®æœ‰ä¸¤ä¸ªï¼š\nä¸€ä¸ªæ˜¯åœ¨nginxä¸­ç¼–å†™ä¸šåŠ¡ï¼Œå®ç°nginxæœ¬åœ°ç¼“å­˜ã€Redisã€Tomcatçš„æŸ¥è¯¢\nå¦ä¸€ä¸ªå°±æ˜¯åœ¨Tomcatä¸­å®ç°JVMè¿›ç¨‹ç¼“å­˜\nå…¶ä¸­Nginxç¼–ç¨‹åˆ™ä¼šç”¨åˆ°OpenRestyæ¡†æ¶ç»“åˆLuaè¿™æ ·çš„è¯­è¨€ã€‚\nè¿™ä¹Ÿæ˜¯ä»Šå¤©è¯¾ç¨‹çš„éš¾ç‚¹å’Œé‡ç‚¹ã€‚\n2.JVMè¿›ç¨‹ç¼“å­˜ ä¸ºäº†æ¼”ç¤ºå¤šçº§ç¼“å­˜çš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å…ˆå‡†å¤‡ä¸€ä¸ªå•†å“æŸ¥è¯¢çš„ä¸šåŠ¡ã€‚\n2.1.å¯¼å…¥æ¡ˆä¾‹ å‚è€ƒè¯¾å‰èµ„æ–™çš„ï¼šã€Šæ¡ˆä¾‹å¯¼å…¥è¯´æ˜.mdã€‹\n2.2.åˆè¯†Caffeine ç¼“å­˜åœ¨æ—¥å¸¸å¼€å‘ä¸­å¯åŠ¨è‡³å…³é‡è¦çš„ä½œç”¨ï¼Œç”±äºæ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œæ•°æ®çš„è¯»å–é€Ÿåº¦æ˜¯éå¸¸å¿«çš„ï¼Œèƒ½å¤§é‡å‡å°‘å¯¹æ•°æ®åº“çš„è®¿é—®ï¼Œå‡å°‘æ•°æ®åº“çš„å‹åŠ›ã€‚æˆ‘ä»¬æŠŠç¼“å­˜åˆ†ä¸ºä¸¤ç±»ï¼š\nåˆ†å¸ƒå¼ç¼“å­˜ï¼Œä¾‹å¦‚Redisï¼š ä¼˜ç‚¹ï¼šå­˜å‚¨å®¹é‡æ›´å¤§ã€å¯é æ€§æ›´å¥½ã€å¯ä»¥åœ¨é›†ç¾¤é—´å…±äº« ç¼ºç‚¹ï¼šè®¿é—®ç¼“å­˜æœ‰ç½‘ç»œå¼€é”€ åœºæ™¯ï¼šç¼“å­˜æ•°æ®é‡è¾ƒå¤§ã€å¯é æ€§è¦æ±‚è¾ƒé«˜ã€éœ€è¦åœ¨é›†ç¾¤é—´å…±äº« è¿›ç¨‹æœ¬åœ°ç¼“å­˜ï¼Œä¾‹å¦‚HashMapã€GuavaCacheï¼š ä¼˜ç‚¹ï¼šè¯»å–æœ¬åœ°å†…å­˜ï¼Œæ²¡æœ‰ç½‘ç»œå¼€é”€ï¼Œé€Ÿåº¦æ›´å¿« ç¼ºç‚¹ï¼šå­˜å‚¨å®¹é‡æœ‰é™ã€å¯é æ€§è¾ƒä½ã€æ— æ³•å…±äº« åœºæ™¯ï¼šæ€§èƒ½è¦æ±‚è¾ƒé«˜ï¼Œç¼“å­˜æ•°æ®é‡è¾ƒå° æˆ‘ä»¬ä»Šå¤©ä¼šåˆ©ç”¨Caffeineæ¡†æ¶æ¥å®ç°JVMè¿›ç¨‹ç¼“å­˜ã€‚\nCaffeineæ˜¯ä¸€ä¸ªåŸºäºJava8å¼€å‘çš„ï¼Œæä¾›äº†è¿‘ä¹æœ€ä½³å‘½ä¸­ç‡çš„é«˜æ€§èƒ½çš„æœ¬åœ°ç¼“å­˜åº“ã€‚ç›®å‰Springå†…éƒ¨çš„ç¼“å­˜ä½¿ç”¨çš„å°±æ˜¯Caffeineã€‚GitHubåœ°å€ï¼šhttps://github.com/ben-manes/caffeine\nCaffeineçš„æ€§èƒ½éå¸¸å¥½ï¼Œä¸‹å›¾æ˜¯å®˜æ–¹ç»™å‡ºçš„æ€§èƒ½å¯¹æ¯”ï¼š\nå¯ä»¥çœ‹åˆ°Caffeineçš„æ€§èƒ½é¥é¥é¢†å…ˆï¼\nç¼“å­˜ä½¿ç”¨çš„åŸºæœ¬APIï¼š\n@Test void testBasicOps() { // æ„å»ºcacheå¯¹è±¡ Cache\u0026lt;String, String\u0026gt; cache = Caffeine.newBuilder().build(); // å­˜æ•°æ® cache.put(\u0026#34;gf\u0026#34;, \u0026#34;è¿ªä¸½çƒ­å·´\u0026#34;); // å–æ•°æ® String gf = cache.getIfPresent(\u0026#34;gf\u0026#34;); System.out.println(\u0026#34;gf = \u0026#34; + gf); // å–æ•°æ®ï¼ŒåŒ…å«ä¸¤ä¸ªå‚æ•°ï¼š // å‚æ•°ä¸€ï¼šç¼“å­˜çš„key // å‚æ•°äºŒï¼šLambdaè¡¨è¾¾å¼ï¼Œè¡¨è¾¾å¼å‚æ•°å°±æ˜¯ç¼“å­˜çš„keyï¼Œæ–¹æ³•ä½“æ˜¯æŸ¥è¯¢æ•°æ®åº“çš„é€»è¾‘ // ä¼˜å…ˆæ ¹æ®keyæŸ¥è¯¢JVMç¼“å­˜ï¼Œå¦‚æœæœªå‘½ä¸­ï¼Œåˆ™æ‰§è¡Œå‚æ•°äºŒçš„Lambdaè¡¨è¾¾å¼ String defaultGF = cache.get(\u0026#34;defaultGF\u0026#34;, key -\u0026gt; { // æ ¹æ®keyå»æ•°æ®åº“æŸ¥è¯¢æ•°æ® return \u0026#34;æŸ³å²©\u0026#34;; }); System.out.println(\u0026#34;defaultGF = \u0026#34; + defaultGF); } Caffeineæ—¢ç„¶æ˜¯ç¼“å­˜çš„ä¸€ç§ï¼Œè‚¯å®šéœ€è¦æœ‰ç¼“å­˜çš„æ¸…é™¤ç­–ç•¥ï¼Œä¸ç„¶çš„è¯å†…å­˜æ€»ä¼šæœ‰è€—å°½çš„æ—¶å€™ã€‚\nCaffeineæä¾›äº†ä¸‰ç§ç¼“å­˜é©±é€ç­–ç•¥ï¼š\nåŸºäºå®¹é‡ï¼šè®¾ç½®ç¼“å­˜çš„æ•°é‡ä¸Šé™\n// åˆ›å»ºç¼“å­˜å¯¹è±¡ Cache\u0026lt;String, String\u0026gt; cache = Caffeine.newBuilder() .maximumSize(1) // è®¾ç½®ç¼“å­˜å¤§å°ä¸Šé™ä¸º 1 .build(); åŸºäºæ—¶é—´ï¼šè®¾ç½®ç¼“å­˜çš„æœ‰æ•ˆæ—¶é—´\n// åˆ›å»ºç¼“å­˜å¯¹è±¡ Cache\u0026lt;String, String\u0026gt; cache = Caffeine.newBuilder() // è®¾ç½®ç¼“å­˜æœ‰æ•ˆæœŸä¸º 10 ç§’ï¼Œä»æœ€åä¸€æ¬¡å†™å…¥å¼€å§‹è®¡æ—¶ .expireAfterWrite(Duration.ofSeconds(10)) .build(); åŸºäºå¼•ç”¨ï¼šè®¾ç½®ç¼“å­˜ä¸ºè½¯å¼•ç”¨æˆ–å¼±å¼•ç”¨ï¼Œåˆ©ç”¨GCæ¥å›æ”¶ç¼“å­˜æ•°æ®ã€‚æ€§èƒ½è¾ƒå·®ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚\næ³¨æ„ï¼šåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ä¸€ä¸ªç¼“å­˜å…ƒç´ è¿‡æœŸçš„æ—¶å€™ï¼ŒCaffeineä¸ä¼šè‡ªåŠ¨ç«‹å³å°†å…¶æ¸…ç†å’Œé©±é€ã€‚è€Œæ˜¯åœ¨ä¸€æ¬¡è¯»æˆ–å†™æ“ä½œåï¼Œæˆ–è€…åœ¨ç©ºé—²æ—¶é—´å®Œæˆå¯¹å¤±æ•ˆæ•°æ®çš„é©±é€ã€‚\n2.3.å®ç°JVMè¿›ç¨‹ç¼“å­˜ 2.3.1.éœ€æ±‚ åˆ©ç”¨Caffeineå®ç°ä¸‹åˆ—éœ€æ±‚ï¼š\nç»™æ ¹æ®idæŸ¥è¯¢å•†å“çš„ä¸šåŠ¡æ·»åŠ ç¼“å­˜ï¼Œç¼“å­˜æœªå‘½ä¸­æ—¶æŸ¥è¯¢æ•°æ®åº“ ç»™æ ¹æ®idæŸ¥è¯¢å•†å“åº“å­˜çš„ä¸šåŠ¡æ·»åŠ ç¼“å­˜ï¼Œç¼“å­˜æœªå‘½ä¸­æ—¶æŸ¥è¯¢æ•°æ®åº“ ç¼“å­˜åˆå§‹å¤§å°ä¸º100 ç¼“å­˜ä¸Šé™ä¸º10000 2.3.2.å®ç° é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸¤ä¸ªCaffeineçš„ç¼“å­˜å¯¹è±¡ï¼Œåˆ†åˆ«ä¿å­˜å•†å“ã€åº“å­˜çš„ç¼“å­˜æ•°æ®ã€‚\nåœ¨item-serviceçš„com.heima.item.configåŒ…ä¸‹å®šä¹‰CaffeineConfigç±»ï¼š\npackage com.heima.item.config; import com.github.benmanes.caffeine.cache.Cache; import com.github.benmanes.caffeine.cache.Caffeine; import com.heima.item.pojo.Item; import com.heima.item.pojo.ItemStock; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; @Configuration public class CaffeineConfig { @Bean public Cache\u0026lt;Long, Item\u0026gt; itemCache(){ return Caffeine.newBuilder() .initialCapacity(100) .maximumSize(10_000) .build(); } @Bean public Cache\u0026lt;Long, ItemStock\u0026gt; stockCache(){ return Caffeine.newBuilder() .initialCapacity(100) .maximumSize(10_000) .build(); } } ç„¶åï¼Œä¿®æ”¹item-serviceä¸­çš„com.heima.item.webåŒ…ä¸‹çš„ItemControllerç±»ï¼Œæ·»åŠ ç¼“å­˜é€»è¾‘ï¼š\n@RestController @RequestMapping(\u0026#34;item\u0026#34;) public class ItemController { @Autowired private IItemService itemService; @Autowired private IItemStockService stockService; @Autowired private Cache\u0026lt;Long, Item\u0026gt; itemCache; @Autowired private Cache\u0026lt;Long, ItemStock\u0026gt; stockCache; // ...å…¶å®ƒç•¥ @GetMapping(\u0026#34;/{id}\u0026#34;) public Item findById(@PathVariable(\u0026#34;id\u0026#34;) Long id) { return itemCache.get(id, key -\u0026gt; itemService.query() .ne(\u0026#34;status\u0026#34;, 3).eq(\u0026#34;id\u0026#34;, key) .one() ); } @GetMapping(\u0026#34;/stock/{id}\u0026#34;) public ItemStock findStockById(@PathVariable(\u0026#34;id\u0026#34;) Long id) { return stockCache.get(id, key -\u0026gt; stockService.getById(key)); } } 3.Luaè¯­æ³•å…¥é—¨ Nginxç¼–ç¨‹éœ€è¦ç”¨åˆ°Luaè¯­è¨€ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»å…ˆå…¥é—¨Luaçš„åŸºæœ¬è¯­æ³•ã€‚\n3.1.åˆè¯†Lua Lua æ˜¯ä¸€ç§è½»é‡å°å·§çš„è„šæœ¬è¯­è¨€ï¼Œç”¨æ ‡å‡†Cè¯­è¨€ç¼–å†™å¹¶ä»¥æºä»£ç å½¢å¼å¼€æ”¾ï¼Œ å…¶è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†åµŒå…¥åº”ç”¨ç¨‹åºä¸­ï¼Œä»è€Œä¸ºåº”ç”¨ç¨‹åºæä¾›çµæ´»çš„æ‰©å±•å’Œå®šåˆ¶åŠŸèƒ½ã€‚å®˜ç½‘ï¼šhttps://www.lua.org/\nLuaç»å¸¸åµŒå…¥åˆ°Cè¯­è¨€å¼€å‘çš„ç¨‹åºä¸­ï¼Œä¾‹å¦‚æ¸¸æˆå¼€å‘ã€æ¸¸æˆæ’ä»¶ç­‰ã€‚\nNginxæœ¬èº«ä¹Ÿæ˜¯Cè¯­è¨€å¼€å‘ï¼Œå› æ­¤ä¹Ÿå…è®¸åŸºäºLuaåšæ‹“å±•ã€‚\n3.1.HelloWorld CentOS7é»˜è®¤å·²ç»å®‰è£…äº†Luaè¯­è¨€ç¯å¢ƒï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¿è¡ŒLuaä»£ç ã€‚\n1ï¼‰åœ¨Linuxè™šæ‹Ÿæœºçš„ä»»æ„ç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªhello.luaæ–‡ä»¶\n2ï¼‰æ·»åŠ ä¸‹é¢çš„å†…å®¹\nprint(\u0026#34;Hello World!\u0026#34;) 3ï¼‰è¿è¡Œ\n3.2.å˜é‡å’Œå¾ªç¯ å­¦ä¹ ä»»ä½•è¯­è¨€å¿…ç„¶ç¦»ä¸å¼€å˜é‡ï¼Œè€Œå˜é‡çš„å£°æ˜å¿…é¡»å…ˆçŸ¥é“æ•°æ®çš„ç±»å‹ã€‚\n3.2.1.Luaçš„æ•°æ®ç±»å‹ Luaä¸­æ”¯æŒçš„å¸¸è§æ•°æ®ç±»å‹åŒ…æ‹¬ï¼š\nå¦å¤–ï¼ŒLuaæä¾›äº†type()å‡½æ•°æ¥åˆ¤æ–­ä¸€ä¸ªå˜é‡çš„æ•°æ®ç±»å‹ï¼š\n3.2.2.å£°æ˜å˜é‡ Luaå£°æ˜å˜é‡çš„æ—¶å€™æ— éœ€æŒ‡å®šæ•°æ®ç±»å‹ï¼Œè€Œæ˜¯ç”¨localæ¥å£°æ˜å˜é‡ä¸ºå±€éƒ¨å˜é‡ï¼š\n-- å£°æ˜å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç”¨å•å¼•å·æˆ–åŒå¼•å·ï¼Œ local str = \u0026#39;hello\u0026#39; -- å­—ç¬¦ä¸²æ‹¼æ¥å¯ä»¥ä½¿ç”¨ .. local str2 = \u0026#39;hello\u0026#39; .. \u0026#39;world\u0026#39; -- å£°æ˜æ•°å­— local num = 21 -- å£°æ˜å¸ƒå°”ç±»å‹ local flag = true Luaä¸­çš„tableç±»å‹æ—¢å¯ä»¥ä½œä¸ºæ•°ç»„ï¼Œåˆå¯ä»¥ä½œä¸ºJavaä¸­çš„mapæ¥ä½¿ç”¨ã€‚æ•°ç»„å°±æ˜¯ç‰¹æ®Šçš„tableï¼Œkeyæ˜¯æ•°ç»„è§’æ ‡è€Œå·²ï¼š\n-- å£°æ˜æ•°ç»„ ï¼Œkeyä¸ºè§’æ ‡çš„ table local arr = {\u0026#39;java\u0026#39;, \u0026#39;python\u0026#39;, \u0026#39;lua\u0026#39;} -- å£°æ˜tableï¼Œç±»ä¼¼javaçš„map local map = {name=\u0026#39;Jack\u0026#39;, age=21} Luaä¸­çš„æ•°ç»„è§’æ ‡æ˜¯ä»1å¼€å§‹ï¼Œè®¿é—®çš„æ—¶å€™ä¸Javaä¸­ç±»ä¼¼ï¼š\n-- è®¿é—®æ•°ç»„ï¼Œluaæ•°ç»„çš„è§’æ ‡ä»1å¼€å§‹ print(arr[1]) Luaä¸­çš„tableå¯ä»¥ç”¨keyæ¥è®¿é—®ï¼š\n-- è®¿é—®table print(map[\u0026#39;name\u0026#39;]) print(map.name) 3.2.3.å¾ªç¯ å¯¹äºtableï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨forå¾ªç¯æ¥éå†ã€‚ä¸è¿‡æ•°ç»„å’Œæ™®é€štableéå†ç•¥æœ‰å·®å¼‚ã€‚\néå†æ•°ç»„ï¼š\n-- å£°æ˜æ•°ç»„ keyä¸ºç´¢å¼•çš„ table local arr = {\u0026#39;java\u0026#39;, \u0026#39;python\u0026#39;, \u0026#39;lua\u0026#39;} -- éå†æ•°ç»„ for index,value in ipairs(arr) do print(index, value) end éå†æ™®é€štable\n-- å£°æ˜mapï¼Œä¹Ÿå°±æ˜¯table local map = {name=\u0026#39;Jack\u0026#39;, age=21} -- éå†table for key,value in pairs(map) do print(key, value) end 3.3.æ¡ä»¶æ§åˆ¶ã€å‡½æ•° Luaä¸­çš„æ¡ä»¶æ§åˆ¶å’Œå‡½æ•°å£°æ˜ä¸Javaç±»ä¼¼ã€‚\n3.3.1.å‡½æ•° å®šä¹‰å‡½æ•°çš„è¯­æ³•ï¼š\nfunction å‡½æ•°å( argument1, argument2..., argumentn) -- å‡½æ•°ä½“ return è¿”å›å€¼ end ä¾‹å¦‚ï¼Œå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥æ‰“å°æ•°ç»„ï¼š\nfunction printArr(arr) for index, value in ipairs(arr) do print(value) end end 3.3.2.æ¡ä»¶æ§åˆ¶ ç±»ä¼¼Javaçš„æ¡ä»¶æ§åˆ¶ï¼Œä¾‹å¦‚ifã€elseè¯­æ³•ï¼š\nif(å¸ƒå°”è¡¨è¾¾å¼) then --[ å¸ƒå°”è¡¨è¾¾å¼ä¸º true æ—¶æ‰§è¡Œè¯¥è¯­å¥å— --] else --[ å¸ƒå°”è¡¨è¾¾å¼ä¸º false æ—¶æ‰§è¡Œè¯¥è¯­å¥å— --] end ä¸javaä¸åŒï¼Œå¸ƒå°”è¡¨è¾¾å¼ä¸­çš„é€»è¾‘è¿ç®—æ˜¯åŸºäºè‹±æ–‡å•è¯ï¼š\n3.3.3.æ¡ˆä¾‹ éœ€æ±‚ï¼šè‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥æ‰“å°tableï¼Œå½“å‚æ•°ä¸ºnilæ—¶ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯\nfunction printArr(arr) if not arr then print(\u0026#39;æ•°ç»„ä¸èƒ½ä¸ºç©ºï¼\u0026#39;) end for index, value in ipairs(arr) do print(value) end end 4.å®ç°å¤šçº§ç¼“å­˜ å¤šçº§ç¼“å­˜çš„å®ç°ç¦»ä¸å¼€Nginxç¼–ç¨‹ï¼Œè€ŒNginxç¼–ç¨‹åˆç¦»ä¸å¼€OpenRestyã€‚\n4.1.å®‰è£…OpenResty OpenRestyÂ® æ˜¯ä¸€ä¸ªåŸºäº Nginxçš„é«˜æ€§èƒ½ Web å¹³å°ï¼Œç”¨äºæ–¹ä¾¿åœ°æ­å»ºèƒ½å¤Ÿå¤„ç†è¶…é«˜å¹¶å‘ã€æ‰©å±•æ€§æé«˜çš„åŠ¨æ€ Web åº”ç”¨ã€Web æœåŠ¡å’ŒåŠ¨æ€ç½‘å…³ã€‚å…·å¤‡ä¸‹åˆ—ç‰¹ç‚¹ï¼š\nå…·å¤‡Nginxçš„å®Œæ•´åŠŸèƒ½ åŸºäºLuaè¯­è¨€è¿›è¡Œæ‰©å±•ï¼Œé›†æˆäº†å¤§é‡ç²¾è‰¯çš„ Lua åº“ã€ç¬¬ä¸‰æ–¹æ¨¡å— å…è®¸ä½¿ç”¨Luaè‡ªå®šä¹‰ä¸šåŠ¡é€»è¾‘ã€è‡ªå®šä¹‰åº“ å®˜æ–¹ç½‘ç«™ï¼š https://openresty.org/cn/\nå®‰è£…Luaå¯ä»¥å‚è€ƒè¯¾å‰èµ„æ–™æä¾›çš„ã€Šå®‰è£…OpenResty.mdã€‹ï¼š\n4.2.OpenRestyå¿«é€Ÿå…¥é—¨ æˆ‘ä»¬å¸Œæœ›è¾¾åˆ°çš„å¤šçº§ç¼“å­˜æ¶æ„å¦‚å›¾ï¼š\nå…¶ä¸­ï¼š\nwindowsä¸Šçš„nginxç”¨æ¥åšåå‘ä»£ç†æœåŠ¡ï¼Œå°†å‰ç«¯çš„æŸ¥è¯¢å•†å“çš„ajaxè¯·æ±‚ä»£ç†åˆ°OpenRestyé›†ç¾¤\nOpenRestyé›†ç¾¤ç”¨æ¥ç¼–å†™å¤šçº§ç¼“å­˜ä¸šåŠ¡\n4.2.1.åå‘ä»£ç†æµç¨‹ ç°åœ¨ï¼Œå•†å“è¯¦æƒ…é¡µä½¿ç”¨çš„æ˜¯å‡çš„å•†å“æ•°æ®ã€‚ä¸è¿‡åœ¨æµè§ˆå™¨ä¸­ï¼Œå¯ä»¥çœ‹åˆ°é¡µé¢æœ‰å‘èµ·ajaxè¯·æ±‚æŸ¥è¯¢çœŸå®å•†å“æ•°æ®ã€‚\nè¿™ä¸ªè¯·æ±‚å¦‚ä¸‹ï¼š\nè¯·æ±‚åœ°å€æ˜¯localhostï¼Œç«¯å£æ˜¯80ï¼Œå°±è¢«windowsä¸Šå®‰è£…çš„NginxæœåŠ¡ç»™æ¥æ”¶åˆ°äº†ã€‚ç„¶åä»£ç†ç»™äº†OpenRestyé›†ç¾¤ï¼š\næˆ‘ä»¬éœ€è¦åœ¨OpenRestyä¸­ç¼–å†™ä¸šåŠ¡ï¼ŒæŸ¥è¯¢å•†å“æ•°æ®å¹¶è¿”å›åˆ°æµè§ˆå™¨ã€‚\nä½†æ˜¯è¿™æ¬¡ï¼Œæˆ‘ä»¬å…ˆåœ¨OpenRestyæ¥æ”¶è¯·æ±‚ï¼Œè¿”å›å‡çš„å•†å“æ•°æ®ã€‚\n4.2.2.OpenRestyç›‘å¬è¯·æ±‚ OpenRestyçš„å¾ˆå¤šåŠŸèƒ½éƒ½ä¾èµ–äºå…¶ç›®å½•ä¸‹çš„Luaåº“ï¼Œéœ€è¦åœ¨nginx.confä¸­æŒ‡å®šä¾èµ–åº“çš„ç›®å½•ï¼Œå¹¶å¯¼å…¥ä¾èµ–ï¼š\n1ï¼‰æ·»åŠ å¯¹OpenRestyçš„Luaæ¨¡å—çš„åŠ è½½\nä¿®æ”¹/usr/local/openresty/nginx/conf/nginx.confæ–‡ä»¶ï¼Œåœ¨å…¶ä¸­çš„httpä¸‹é¢ï¼Œæ·»åŠ ä¸‹é¢ä»£ç ï¼š\n#lua æ¨¡å— lua_package_path \u0026#34;/usr/local/openresty/lualib/?.lua;;\u0026#34;; #cæ¨¡å— lua_package_cpath \u0026#34;/usr/local/openresty/lualib/?.so;;\u0026#34;; 2ï¼‰ç›‘å¬/api/itemè·¯å¾„\nä¿®æ”¹/usr/local/openresty/nginx/conf/nginx.confæ–‡ä»¶ï¼Œåœ¨nginx.confçš„serverä¸‹é¢ï¼Œæ·»åŠ å¯¹/api/itemè¿™ä¸ªè·¯å¾„çš„ç›‘å¬ï¼š\nlocation /api/item { # é»˜è®¤çš„å“åº”ç±»å‹ default_type application/json; # å“åº”ç»“æœç”±lua/item.luaæ–‡ä»¶æ¥å†³å®š content_by_lua_file lua/item.lua; } è¿™ä¸ªç›‘å¬ï¼Œå°±ç±»ä¼¼äºSpringMVCä¸­çš„@GetMapping(\u0026quot;/api/item\u0026quot;)åšè·¯å¾„æ˜ å°„ã€‚\nè€Œcontent_by_lua_file lua/item.luaåˆ™ç›¸å½“äºè°ƒç”¨item.luaè¿™ä¸ªæ–‡ä»¶ï¼Œæ‰§è¡Œå…¶ä¸­çš„ä¸šåŠ¡ï¼ŒæŠŠç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚ç›¸å½“äºjavaä¸­è°ƒç”¨serviceã€‚\n4.2.3.ç¼–å†™item.lua 1ï¼‰åœ¨/usr/loca/openresty/nginxç›®å½•åˆ›å»ºæ–‡ä»¶å¤¹ï¼šlua\n2ï¼‰åœ¨/usr/loca/openresty/nginx/luaæ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»ºæ–‡ä»¶ï¼šitem.lua\n3ï¼‰ç¼–å†™item.luaï¼Œè¿”å›å‡æ•°æ®\nitem.luaä¸­ï¼Œåˆ©ç”¨ngx.say()å‡½æ•°è¿”å›æ•°æ®åˆ°Responseä¸­\nngx.say(\u0026#39;{\u0026#34;id\u0026#34;:10001,\u0026#34;name\u0026#34;:\u0026#34;SALSA AIR\u0026#34;,\u0026#34;title\u0026#34;:\u0026#34;RIMOWA 21å¯¸æ‰˜è¿ç®±æ‹‰æ†ç®± SALSA AIRç³»åˆ—æœç»¿è‰² 820.70.36.4\u0026#34;,\u0026#34;price\u0026#34;:17900,\u0026#34;image\u0026#34;:\u0026#34;https://m.360buyimg.com/mobilecms/s720x720_jfs/t6934/364/1195375010/84676/e9f2c55f/597ece38N0ddcbc77.jpg!q70.jpg.webp\u0026#34;,\u0026#34;category\u0026#34;:\u0026#34;æ‹‰æ†ç®±\u0026#34;,\u0026#34;brand\u0026#34;:\u0026#34;RIMOWA\u0026#34;,\u0026#34;spec\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;status\u0026#34;:1,\u0026#34;createTime\u0026#34;:\u0026#34;2019-04-30T16:00:00.000+00:00\u0026#34;,\u0026#34;updateTime\u0026#34;:\u0026#34;2019-04-30T16:00:00.000+00:00\u0026#34;,\u0026#34;stock\u0026#34;:2999,\u0026#34;sold\u0026#34;:31290}\u0026#39;) 4ï¼‰é‡æ–°åŠ è½½é…ç½®\nnginx -s reload åˆ·æ–°å•†å“é¡µé¢ï¼šhttp://localhost/item.html?id=1001ï¼Œå³å¯çœ‹åˆ°æ•ˆæœï¼š\n4.3.è¯·æ±‚å‚æ•°å¤„ç† ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬åœ¨OpenRestyæ¥æ”¶å‰ç«¯è¯·æ±‚ï¼Œä½†æ˜¯è¿”å›çš„æ˜¯å‡æ•°æ®ã€‚\nè¦è¿”å›çœŸå®æ•°æ®ï¼Œå¿…é¡»æ ¹æ®å‰ç«¯ä¼ é€’æ¥çš„å•†å“idï¼ŒæŸ¥è¯¢å•†å“ä¿¡æ¯æ‰å¯ä»¥ã€‚\né‚£ä¹ˆå¦‚ä½•è·å–å‰ç«¯ä¼ é€’çš„å•†å“å‚æ•°å‘¢ï¼Ÿ\n4.3.1.è·å–å‚æ•°çš„API OpenRestyä¸­æä¾›äº†ä¸€äº›APIç”¨æ¥è·å–ä¸åŒç±»å‹çš„å‰ç«¯è¯·æ±‚å‚æ•°ï¼š\n4.3.2.è·å–å‚æ•°å¹¶è¿”å› åœ¨å‰ç«¯å‘èµ·çš„ajaxè¯·æ±‚å¦‚å›¾ï¼š\nå¯ä»¥çœ‹åˆ°å•†å“idæ˜¯ä»¥è·¯å¾„å ä½ç¬¦æ–¹å¼ä¼ é€’çš„ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ–¹å¼æ¥è·å–ID\n1ï¼‰è·å–å•†å“id\nä¿®æ”¹/usr/loca/openresty/nginx/nginx.confæ–‡ä»¶ä¸­ç›‘å¬/api/itemçš„ä»£ç ï¼Œåˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼è·å–IDï¼š\nlocation ~ /api/item/(\\d+) { # é»˜è®¤çš„å“åº”ç±»å‹ default_type application/json; # å“åº”ç»“æœç”±lua/item.luaæ–‡ä»¶æ¥å†³å®š content_by_lua_file lua/item.lua; } 2ï¼‰æ‹¼æ¥IDå¹¶è¿”å›\nä¿®æ”¹/usr/loca/openresty/nginx/lua/item.luaæ–‡ä»¶ï¼Œè·å–idå¹¶æ‹¼æ¥åˆ°ç»“æœä¸­è¿”å›ï¼š\n-- è·å–å•†å“id local id = ngx.var[1] -- æ‹¼æ¥å¹¶è¿”å› ngx.say(\u0026#39;{\u0026#34;id\u0026#34;:\u0026#39; .. id .. \u0026#39;,\u0026#34;name\u0026#34;:\u0026#34;SALSA AIR\u0026#34;,\u0026#34;title\u0026#34;:\u0026#34;RIMOWA 21å¯¸æ‰˜è¿ç®±æ‹‰æ†ç®± SALSA AIRç³»åˆ—æœç»¿è‰² 820.70.36.4\u0026#34;,\u0026#34;price\u0026#34;:17900,\u0026#34;image\u0026#34;:\u0026#34;https://m.360buyimg.com/mobilecms/s720x720_jfs/t6934/364/1195375010/84676/e9f2c55f/597ece38N0ddcbc77.jpg!q70.jpg.webp\u0026#34;,\u0026#34;category\u0026#34;:\u0026#34;æ‹‰æ†ç®±\u0026#34;,\u0026#34;brand\u0026#34;:\u0026#34;RIMOWA\u0026#34;,\u0026#34;spec\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;status\u0026#34;:1,\u0026#34;createTime\u0026#34;:\u0026#34;2019-04-30T16:00:00.000+00:00\u0026#34;,\u0026#34;updateTime\u0026#34;:\u0026#34;2019-04-30T16:00:00.000+00:00\u0026#34;,\u0026#34;stock\u0026#34;:2999,\u0026#34;sold\u0026#34;:31290}\u0026#39;) 3ï¼‰é‡æ–°åŠ è½½å¹¶æµ‹è¯•\nè¿è¡Œå‘½ä»¤ä»¥é‡æ–°åŠ è½½OpenRestyé…ç½®ï¼š\nnginx -s reload åˆ·æ–°é¡µé¢å¯ä»¥çœ‹åˆ°ç»“æœä¸­å·²ç»å¸¦ä¸Šäº†IDï¼š\n4.4.æŸ¥è¯¢Tomcat æ‹¿åˆ°å•†å“IDåï¼Œæœ¬åº”å»ç¼“å­˜ä¸­æŸ¥è¯¢å•†å“ä¿¡æ¯ï¼Œä¸è¿‡ç›®å‰æˆ‘ä»¬è¿˜æœªå»ºç«‹nginxã€redisç¼“å­˜ã€‚å› æ­¤ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆæ ¹æ®å•†å“idå»tomcatæŸ¥è¯¢å•†å“ä¿¡æ¯ã€‚æˆ‘ä»¬å®ç°å¦‚å›¾éƒ¨åˆ†ï¼š\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬çš„OpenRestyæ˜¯åœ¨è™šæ‹Ÿæœºï¼ŒTomcatæ˜¯åœ¨Windowsç”µè„‘ä¸Šã€‚ä¸¤è€…IPä¸€å®šä¸è¦æé”™äº†ã€‚\n4.4.1.å‘é€httpè¯·æ±‚çš„API nginxæä¾›äº†å†…éƒ¨APIç”¨ä»¥å‘é€httpè¯·æ±‚ï¼š\nlocal resp = ngx.location.capture(\u0026#34;/path\u0026#34;,{ method = ngx.HTTP_GET, -- è¯·æ±‚æ–¹å¼ args = {a=1,b=2}, -- getæ–¹å¼ä¼ å‚æ•° }) è¿”å›çš„å“åº”å†…å®¹åŒ…æ‹¬ï¼š\nresp.statusï¼šå“åº”çŠ¶æ€ç  resp.headerï¼šå“åº”å¤´ï¼Œæ˜¯ä¸€ä¸ªtable resp.bodyï¼šå“åº”ä½“ï¼Œå°±æ˜¯å“åº”æ•°æ® æ³¨æ„ï¼šè¿™é‡Œçš„pathæ˜¯è·¯å¾„ï¼Œå¹¶ä¸åŒ…å«IPå’Œç«¯å£ã€‚è¿™ä¸ªè¯·æ±‚ä¼šè¢«nginxå†…éƒ¨çš„serverç›‘å¬å¹¶å¤„ç†ã€‚\nä½†æ˜¯æˆ‘ä»¬å¸Œæœ›è¿™ä¸ªè¯·æ±‚å‘é€åˆ°TomcatæœåŠ¡å™¨ï¼Œæ‰€ä»¥è¿˜éœ€è¦ç¼–å†™ä¸€ä¸ªserveræ¥å¯¹è¿™ä¸ªè·¯å¾„åšåå‘ä»£ç†ï¼š\nlocation /path { # è¿™é‡Œæ˜¯windowsç”µè„‘çš„ipå’ŒJavaæœåŠ¡ç«¯å£ï¼Œéœ€è¦ç¡®ä¿windowsé˜²ç«å¢™å¤„äºå…³é—­çŠ¶æ€ proxy_pass http://192.168.150.1:8081; } åŸç†å¦‚å›¾ï¼š\n4.4.2.å°è£…httpå·¥å…· ä¸‹é¢ï¼Œæˆ‘ä»¬å°è£…ä¸€ä¸ªå‘é€Httpè¯·æ±‚çš„å·¥å…·ï¼ŒåŸºäºngx.location.captureæ¥å®ç°æŸ¥è¯¢tomcatã€‚\n1ï¼‰æ·»åŠ åå‘ä»£ç†ï¼Œåˆ°windowsçš„JavaæœåŠ¡\nå› ä¸ºitem-serviceä¸­çš„æ¥å£éƒ½æ˜¯/itemå¼€å¤´ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›‘å¬/itemè·¯å¾„ï¼Œä»£ç†åˆ°windowsä¸Šçš„tomcatæœåŠ¡ã€‚\nä¿®æ”¹ /usr/local/openresty/nginx/conf/nginx.confæ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸ªlocationï¼š\nlocation /item { proxy_pass http://192.168.150.1:8081; } ä»¥åï¼Œåªè¦æˆ‘ä»¬è°ƒç”¨ngx.location.capture(\u0026quot;/item\u0026quot;)ï¼Œå°±ä¸€å®šèƒ½å‘é€è¯·æ±‚åˆ°windowsçš„tomcatæœåŠ¡ã€‚\n2ï¼‰å°è£…å·¥å…·ç±»\nä¹‹å‰æˆ‘ä»¬è¯´è¿‡ï¼ŒOpenRestyå¯åŠ¨æ—¶ä¼šåŠ è½½ä»¥ä¸‹ä¸¤ä¸ªç›®å½•ä¸­çš„å·¥å…·æ–‡ä»¶ï¼š\næ‰€ä»¥ï¼Œè‡ªå®šä¹‰çš„httpå·¥å…·ä¹Ÿéœ€è¦æ”¾åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚\nåœ¨/usr/local/openresty/lualibç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªcommon.luaæ–‡ä»¶ï¼š\nvi /usr/local/openresty/lualib/common.lua å†…å®¹å¦‚ä¸‹:\n-- å°è£…å‡½æ•°ï¼Œå‘é€httpè¯·æ±‚ï¼Œå¹¶è§£æå“åº” local function read_http(path, params) local resp = ngx.location.capture(path,{ method = ngx.HTTP_GET, args = params, }) if not resp then -- è®°å½•é”™è¯¯ä¿¡æ¯ï¼Œè¿”å›404 ngx.log(ngx.ERR, \u0026#34;httpè¯·æ±‚æŸ¥è¯¢å¤±è´¥, path: \u0026#34;, path , \u0026#34;, args: \u0026#34;, args) ngx.exit(404) end return resp.body end -- å°†æ–¹æ³•å¯¼å‡º local _M = { read_http = read_http } return _M è¿™ä¸ªå·¥å…·å°†read_httpå‡½æ•°å°è£…åˆ°_Mè¿™ä¸ªtableç±»å‹çš„å˜é‡ä¸­ï¼Œå¹¶ä¸”è¿”å›ï¼Œè¿™ç±»ä¼¼äºå¯¼å‡ºã€‚\nä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥åˆ©ç”¨require('common')æ¥å¯¼å…¥è¯¥å‡½æ•°åº“ï¼Œè¿™é‡Œçš„commonæ˜¯å‡½æ•°åº“çš„æ–‡ä»¶åã€‚\n3ï¼‰å®ç°å•†å“æŸ¥è¯¢\næœ€åï¼Œæˆ‘ä»¬ä¿®æ”¹/usr/local/openresty/lua/item.luaæ–‡ä»¶ï¼Œåˆ©ç”¨åˆšåˆšå°è£…çš„å‡½æ•°åº“å®ç°å¯¹tomcatçš„æŸ¥è¯¢ï¼š\n-- å¼•å…¥è‡ªå®šä¹‰commonå·¥å…·æ¨¡å—ï¼Œè¿”å›å€¼æ˜¯commonä¸­è¿”å›çš„ _M local common = require(\u0026#34;common\u0026#34;) -- ä» commonä¸­è·å–read_httpè¿™ä¸ªå‡½æ•° local read_http = common.read_http -- è·å–è·¯å¾„å‚æ•° local id = ngx.var[1] -- æ ¹æ®idæŸ¥è¯¢å•†å“ local itemJSON = read_http(\u0026#34;/item/\u0026#34;.. id, nil) -- æ ¹æ®idæŸ¥è¯¢å•†å“åº“å­˜ local itemStockJSON = read_http(\u0026#34;/item/stock/\u0026#34;.. id, nil) è¿™é‡ŒæŸ¥è¯¢åˆ°çš„ç»“æœæ˜¯jsonå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”åŒ…å«å•†å“ã€åº“å­˜ä¸¤ä¸ªjsonå­—ç¬¦ä¸²ï¼Œé¡µé¢æœ€ç»ˆéœ€è¦çš„æ˜¯æŠŠä¸¤ä¸ªjsonæ‹¼æ¥ä¸ºä¸€ä¸ªjsonï¼š\nè¿™å°±éœ€è¦æˆ‘ä»¬å…ˆæŠŠJSONå˜ä¸ºluaçš„tableï¼Œå®Œæˆæ•°æ®æ•´åˆåï¼Œå†è½¬ä¸ºJSONã€‚\n4.4.3.CJSONå·¥å…·ç±» OpenRestyæä¾›äº†ä¸€ä¸ªcjsonçš„æ¨¡å—ç”¨æ¥å¤„ç†JSONçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚\nå®˜æ–¹åœ°å€ï¼š https://github.com/openresty/lua-cjson/\n1ï¼‰å¼•å…¥cjsonæ¨¡å—ï¼š\nlocal cjson = require \u0026#34;cjson\u0026#34; 2ï¼‰åºåˆ—åŒ–ï¼š\nlocal obj = { name = \u0026#39;jack\u0026#39;, age = 21 } -- æŠŠ table åºåˆ—åŒ–ä¸º json local json = cjson.encode(obj) 3ï¼‰ååºåˆ—åŒ–ï¼š\nlocal json = \u0026#39;{\u0026#34;name\u0026#34;: \u0026#34;jack\u0026#34;, \u0026#34;age\u0026#34;: 21}\u0026#39; -- ååºåˆ—åŒ– jsonä¸º table local obj = cjson.decode(json); print(obj.name) 4.4.4.å®ç°TomcatæŸ¥è¯¢ ä¸‹é¢ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¹‹å‰çš„item.luaä¸­çš„ä¸šåŠ¡ï¼Œæ·»åŠ jsonå¤„ç†åŠŸèƒ½ï¼š\n-- å¯¼å…¥commonå‡½æ•°åº“ local common = require(\u0026#39;common\u0026#39;) local read_http = common.read_http -- å¯¼å…¥cjsonåº“ local cjson = require(\u0026#39;cjson\u0026#39;) -- è·å–è·¯å¾„å‚æ•° local id = ngx.var[1] -- æ ¹æ®idæŸ¥è¯¢å•†å“ local itemJSON = read_http(\u0026#34;/item/\u0026#34;.. id, nil) -- æ ¹æ®idæŸ¥è¯¢å•†å“åº“å­˜ local itemStockJSON = read_http(\u0026#34;/item/stock/\u0026#34;.. id, nil) -- JSONè½¬åŒ–ä¸ºluaçš„table local item = cjson.decode(itemJSON) local stock = cjson.decode(stockJSON) -- ç»„åˆæ•°æ® item.stock = stock.stock item.sold = stock.sold -- æŠŠitemåºåˆ—åŒ–ä¸ºjson è¿”å›ç»“æœ ngx.say(cjson.encode(item)) 4.4.5.åŸºäºIDè´Ÿè½½å‡è¡¡ åˆšæ‰çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬çš„tomcatæ˜¯å•æœºéƒ¨ç½²ã€‚è€Œå®é™…å¼€å‘ä¸­ï¼Œtomcatä¸€å®šæ˜¯é›†ç¾¤æ¨¡å¼ï¼š\nå› æ­¤ï¼ŒOpenRestyéœ€è¦å¯¹tomcaté›†ç¾¤åšè´Ÿè½½å‡è¡¡ã€‚\nè€Œé»˜è®¤çš„è´Ÿè½½å‡è¡¡è§„åˆ™æ˜¯è½®è¯¢æ¨¡å¼ï¼Œå½“æˆ‘ä»¬æŸ¥è¯¢/item/10001æ—¶ï¼š\nç¬¬ä¸€æ¬¡ä¼šè®¿é—®8081ç«¯å£çš„tomcatæœåŠ¡ï¼Œåœ¨è¯¥æœåŠ¡å†…éƒ¨å°±å½¢æˆäº†JVMè¿›ç¨‹ç¼“å­˜ ç¬¬äºŒæ¬¡ä¼šè®¿é—®8082ç«¯å£çš„tomcatæœåŠ¡ï¼Œè¯¥æœåŠ¡å†…éƒ¨æ²¡æœ‰JVMç¼“å­˜ï¼ˆå› ä¸ºJVMç¼“å­˜æ— æ³•å…±äº«ï¼‰ï¼Œä¼šæŸ¥è¯¢æ•°æ®åº“ \u0026hellip; ä½ çœ‹ï¼Œå› ä¸ºè½®è¯¢çš„åŸå› ï¼Œç¬¬ä¸€æ¬¡æŸ¥è¯¢8081å½¢æˆçš„JVMç¼“å­˜å¹¶æœªç”Ÿæ•ˆï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡å†æ¬¡è®¿é—®åˆ°8081æ—¶æ‰å¯ä»¥ç”Ÿæ•ˆï¼Œç¼“å­˜å‘½ä¸­ç‡å¤ªä½äº†ã€‚\næ€ä¹ˆåŠï¼Ÿ\nå¦‚æœèƒ½è®©åŒä¸€ä¸ªå•†å“ï¼Œæ¯æ¬¡æŸ¥è¯¢æ—¶éƒ½è®¿é—®åŒä¸€ä¸ªtomcatæœåŠ¡ï¼Œé‚£ä¹ˆJVMç¼“å­˜å°±ä¸€å®šèƒ½ç”Ÿæ•ˆäº†ã€‚\nä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å•†å“idåšè´Ÿè½½å‡è¡¡ï¼Œè€Œä¸æ˜¯è½®è¯¢ã€‚\n1ï¼‰åŸç† nginxæä¾›äº†åŸºäºè¯·æ±‚è·¯å¾„åšè´Ÿè½½å‡è¡¡çš„ç®—æ³•ï¼š\nnginxæ ¹æ®è¯·æ±‚è·¯å¾„åšhashè¿ç®—ï¼ŒæŠŠå¾—åˆ°çš„æ•°å€¼å¯¹tomcatæœåŠ¡çš„æ•°é‡å–ä½™ï¼Œä½™æ•°æ˜¯å‡ ï¼Œå°±è®¿é—®ç¬¬å‡ ä¸ªæœåŠ¡ï¼Œå®ç°è´Ÿè½½å‡è¡¡ã€‚\nä¾‹å¦‚ï¼š\næˆ‘ä»¬çš„è¯·æ±‚è·¯å¾„æ˜¯ /item/10001 tomcatæ€»æ•°ä¸º2å°ï¼ˆ8081ã€8082ï¼‰ å¯¹è¯·æ±‚è·¯å¾„/item/1001åšhashè¿ç®—æ±‚ä½™çš„ç»“æœä¸º1 åˆ™è®¿é—®ç¬¬ä¸€ä¸ªtomcatæœåŠ¡ï¼Œä¹Ÿå°±æ˜¯8081 åªè¦idä¸å˜ï¼Œæ¯æ¬¡hashè¿ç®—ç»“æœä¹Ÿä¸ä¼šå˜ï¼Œé‚£å°±å¯ä»¥ä¿è¯åŒä¸€ä¸ªå•†å“ï¼Œä¸€ç›´è®¿é—®åŒä¸€ä¸ªtomcatæœåŠ¡ï¼Œç¡®ä¿JVMç¼“å­˜ç”Ÿæ•ˆã€‚\n2ï¼‰å®ç° ä¿®æ”¹/usr/local/openresty/nginx/conf/nginx.confæ–‡ä»¶ï¼Œå®ç°åŸºäºIDåšè´Ÿè½½å‡è¡¡ã€‚\né¦–å…ˆï¼Œå®šä¹‰tomcaté›†ç¾¤ï¼Œå¹¶è®¾ç½®åŸºäºè·¯å¾„åšè´Ÿè½½å‡è¡¡ï¼š\nupstream tomcat-cluster { hash $request_uri; server 192.168.150.1:8081; server 192.168.150.1:8082; } ç„¶åï¼Œä¿®æ”¹å¯¹tomcatæœåŠ¡çš„åå‘ä»£ç†ï¼Œç›®æ ‡æŒ‡å‘tomcaté›†ç¾¤ï¼š\nlocation /item { proxy_pass http://tomcat-cluster; } é‡æ–°åŠ è½½OpenResty\nnginx -s reload 3ï¼‰æµ‹è¯• å¯åŠ¨ä¸¤å°tomcatæœåŠ¡ï¼š\nåŒæ—¶å¯åŠ¨ï¼š\næ¸…ç©ºæ—¥å¿—åï¼Œå†æ¬¡è®¿é—®é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°ä¸åŒidçš„å•†å“ï¼Œè®¿é—®åˆ°äº†ä¸åŒçš„tomcatæœåŠ¡ï¼š\n4.5.Redisç¼“å­˜é¢„çƒ­ Redisç¼“å­˜ä¼šé¢ä¸´å†·å¯åŠ¨é—®é¢˜ï¼š\nå†·å¯åŠ¨ï¼šæœåŠ¡åˆšåˆšå¯åŠ¨æ—¶ï¼ŒRedisä¸­å¹¶æ²¡æœ‰ç¼“å­˜ï¼Œå¦‚æœæ‰€æœ‰å•†å“æ•°æ®éƒ½åœ¨ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ—¶æ·»åŠ ç¼“å­˜ï¼Œå¯èƒ½ä¼šç»™æ•°æ®åº“å¸¦æ¥è¾ƒå¤§å‹åŠ›ã€‚\nç¼“å­˜é¢„çƒ­ï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¤§æ•°æ®ç»Ÿè®¡ç”¨æˆ·è®¿é—®çš„çƒ­ç‚¹æ•°æ®ï¼Œåœ¨é¡¹ç›®å¯åŠ¨æ—¶å°†è¿™äº›çƒ­ç‚¹æ•°æ®æå‰æŸ¥è¯¢å¹¶ä¿å­˜åˆ°Redisä¸­ã€‚\næˆ‘ä»¬æ•°æ®é‡è¾ƒå°‘ï¼Œå¹¶ä¸”æ²¡æœ‰æ•°æ®ç»Ÿè®¡ç›¸å…³åŠŸèƒ½ï¼Œç›®å‰å¯ä»¥åœ¨å¯åŠ¨æ—¶å°†æ‰€æœ‰æ•°æ®éƒ½æ”¾å…¥ç¼“å­˜ä¸­ã€‚\n1ï¼‰åˆ©ç”¨Dockerå®‰è£…Redis\ndocker run --name redis -p 6379:6379 -d redis redis-server --appendonly yes 2ï¼‰åœ¨item-serviceæœåŠ¡ä¸­å¼•å…¥Redisä¾èµ–\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-data-redis\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; 3ï¼‰é…ç½®Redisåœ°å€\nspring: redis: host: 192.168.150.101 4ï¼‰ç¼–å†™åˆå§‹åŒ–ç±»\nç¼“å­˜é¢„çƒ­éœ€è¦åœ¨é¡¹ç›®å¯åŠ¨æ—¶å®Œæˆï¼Œå¹¶ä¸”å¿…é¡»æ˜¯æ‹¿åˆ°RedisTemplateä¹‹åã€‚\nè¿™é‡Œæˆ‘ä»¬åˆ©ç”¨InitializingBeanæ¥å£æ¥å®ç°ï¼Œå› ä¸ºInitializingBeanå¯ä»¥åœ¨å¯¹è±¡è¢«Springåˆ›å»ºå¹¶ä¸”æˆå‘˜å˜é‡å…¨éƒ¨æ³¨å…¥åæ‰§è¡Œã€‚\npackage com.heima.item.config; import com.fasterxml.jackson.core.JsonProcessingException; import com.fasterxml.jackson.databind.ObjectMapper; import com.heima.item.pojo.Item; import com.heima.item.pojo.ItemStock; import com.heima.item.service.IItemService; import com.heima.item.service.IItemStockService; import org.springframework.beans.factory.InitializingBean; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.data.redis.core.StringRedisTemplate; import org.springframework.stereotype.Component; import java.util.List; @Component public class RedisHandler implements InitializingBean { @Autowired private StringRedisTemplate redisTemplate; @Autowired private IItemService itemService; @Autowired private IItemStockService stockService; private static final ObjectMapper MAPPER = new ObjectMapper(); @Override public void afterPropertiesSet() throws Exception { // åˆå§‹åŒ–ç¼“å­˜ // 1.æŸ¥è¯¢å•†å“ä¿¡æ¯ List\u0026lt;Item\u0026gt; itemList = itemService.list(); // 2.æ”¾å…¥ç¼“å­˜ for (Item item : itemList) { // 2.1.itemåºåˆ—åŒ–ä¸ºJSON String json = MAPPER.writeValueAsString(item); // 2.2.å­˜å…¥redis redisTemplate.opsForValue().set(\u0026#34;item:id:\u0026#34; + item.getId(), json); } // 3.æŸ¥è¯¢å•†å“åº“å­˜ä¿¡æ¯ List\u0026lt;ItemStock\u0026gt; stockList = stockService.list(); // 4.æ”¾å…¥ç¼“å­˜ for (ItemStock stock : stockList) { // 2.1.itemåºåˆ—åŒ–ä¸ºJSON String json = MAPPER.writeValueAsString(stock); // 2.2.å­˜å…¥redis redisTemplate.opsForValue().set(\u0026#34;item:stock:id:\u0026#34; + stock.getId(), json); } } } 4.6.æŸ¥è¯¢Redisç¼“å­˜ ç°åœ¨ï¼ŒRedisç¼“å­˜å·²ç»å‡†å¤‡å°±ç»ªï¼Œæˆ‘ä»¬å¯ä»¥å†OpenRestyä¸­å®ç°æŸ¥è¯¢Redisçš„é€»è¾‘äº†ã€‚å¦‚ä¸‹å›¾çº¢æ¡†æ‰€ç¤ºï¼š\nå½“è¯·æ±‚è¿›å…¥OpenRestyä¹‹åï¼š\nä¼˜å…ˆæŸ¥è¯¢Redisç¼“å­˜ å¦‚æœRedisç¼“å­˜æœªå‘½ä¸­ï¼Œå†æŸ¥è¯¢Tomcat 4.6.1.å°è£…Rediså·¥å…· OpenRestyæä¾›äº†æ“ä½œRedisçš„æ¨¡å—ï¼Œæˆ‘ä»¬åªè¦å¼•å…¥è¯¥æ¨¡å—å°±èƒ½ç›´æ¥ä½¿ç”¨ã€‚ä½†æ˜¯ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å°†Redisæ“ä½œå°è£…åˆ°ä¹‹å‰çš„common.luaå·¥å…·åº“ä¸­ã€‚\nä¿®æ”¹/usr/local/openresty/lualib/common.luaæ–‡ä»¶ï¼š\n1ï¼‰å¼•å…¥Redisæ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–Rediså¯¹è±¡\n-- å¯¼å…¥redis local redis = require(\u0026#39;resty.redis\u0026#39;) -- åˆå§‹åŒ–redis local red = redis:new() red:set_timeouts(1000, 1000, 1000) 2ï¼‰å°è£…å‡½æ•°ï¼Œç”¨æ¥é‡Šæ”¾Redisè¿æ¥ï¼Œå…¶å®æ˜¯æ”¾å…¥è¿æ¥æ± \nlocal function close_redis(red) local pool_max_idle_time = 10000 local pool_size = 100 local ok, err = red:set_keepalive(pool_max_idle_time, pool_size) if not ok then ngx.log(ngx.ERR, \u0026#34;æ”¾å…¥redisè¿æ¥æ± å¤±è´¥: \u0026#34;, err) end end 3ï¼‰å°è£…å‡½æ•°ï¼Œæ ¹æ®keyæŸ¥è¯¢Redisæ•°æ®\nlocal function read_redis(ip, port, key) local ok, err = red:connect(ip, port) if not ok then ngx.log(ngx.ERR, \u0026#34;è¿æ¥rediså¤±è´¥ : \u0026#34;, err) return nil end local resp, err = red:get(key) if not resp then ngx.log(ngx.ERR, \u0026#34;æŸ¥è¯¢Rediså¤±è´¥: \u0026#34;, err, \u0026#34;, key = \u0026#34; , key) end if resp == ngx.null then resp = nil ngx.log(ngx.ERR, \u0026#34;æŸ¥è¯¢Redisæ•°æ®ä¸ºç©º, key = \u0026#34;, key) end close_redis(red) return resp end 4ï¼‰å¯¼å‡º\n-- å°†æ–¹æ³•å¯¼å‡º local _M = { read_http = read_http, read_redis = read_redis } return _M å®Œæ•´çš„common.luaï¼š\n-- å¯¼å…¥redis local redis = require(\u0026#39;resty.redis\u0026#39;) -- åˆå§‹åŒ–redis local red = redis:new() red:set_timeouts(1000, 1000, 1000) -- å…³é—­redisè¿æ¥çš„å·¥å…·æ–¹æ³•ï¼Œå…¶å®æ˜¯æ”¾å…¥è¿æ¥æ±  local function close_redis(red) local pool_max_idle_time = 10000 -- è¿æ¥çš„ç©ºé—²æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ local pool_size = 100 --è¿æ¥æ± å¤§å° local ok, err = red:set_keepalive(pool_max_idle_time, pool_size) if not ok then ngx.log(ngx.ERR, \u0026#34;æ”¾å…¥redisè¿æ¥æ± å¤±è´¥: \u0026#34;, err) end end -- æŸ¥è¯¢redisçš„æ–¹æ³• ipå’Œportæ˜¯redisåœ°å€ï¼Œkeyæ˜¯æŸ¥è¯¢çš„key local function read_redis(ip, port, key) -- è·å–ä¸€ä¸ªè¿æ¥ local ok, err = red:connect(ip, port) if not ok then ngx.log(ngx.ERR, \u0026#34;è¿æ¥rediså¤±è´¥ : \u0026#34;, err) return nil end -- æŸ¥è¯¢redis local resp, err = red:get(key) -- æŸ¥è¯¢å¤±è´¥å¤„ç† if not resp then ngx.log(ngx.ERR, \u0026#34;æŸ¥è¯¢Rediså¤±è´¥: \u0026#34;, err, \u0026#34;, key = \u0026#34; , key) end --å¾—åˆ°çš„æ•°æ®ä¸ºç©ºå¤„ç† if resp == ngx.null then resp = nil ngx.log(ngx.ERR, \u0026#34;æŸ¥è¯¢Redisæ•°æ®ä¸ºç©º, key = \u0026#34;, key) end close_redis(red) return resp end -- å°è£…å‡½æ•°ï¼Œå‘é€httpè¯·æ±‚ï¼Œå¹¶è§£æå“åº” local function read_http(path, params) local resp = ngx.location.capture(path,{ method = ngx.HTTP_GET, args = params, }) if not resp then -- è®°å½•é”™è¯¯ä¿¡æ¯ï¼Œè¿”å›404 ngx.log(ngx.ERR, \u0026#34;httpæŸ¥è¯¢å¤±è´¥, path: \u0026#34;, path , \u0026#34;, args: \u0026#34;, args) ngx.exit(404) end return resp.body end -- å°†æ–¹æ³•å¯¼å‡º local _M = { read_http = read_http, read_redis = read_redis } return _M 4.6.2.å®ç°RedisæŸ¥è¯¢ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å»ä¿®æ”¹item.luaæ–‡ä»¶ï¼Œå®ç°å¯¹Redisçš„æŸ¥è¯¢äº†ã€‚\næŸ¥è¯¢é€»è¾‘æ˜¯ï¼š\næ ¹æ®idæŸ¥è¯¢Redis å¦‚æœæŸ¥è¯¢å¤±è´¥åˆ™ç»§ç»­æŸ¥è¯¢Tomcat å°†æŸ¥è¯¢ç»“æœè¿”å› 1ï¼‰ä¿®æ”¹/usr/local/openresty/lua/item.luaæ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸ªæŸ¥è¯¢å‡½æ•°ï¼š\n-- å¯¼å…¥commonå‡½æ•°åº“ local common = require(\u0026#39;common\u0026#39;) local read_http = common.read_http local read_redis = common.read_redis -- å°è£…æŸ¥è¯¢å‡½æ•° function read_data(key, path, params) local val = read_redis(\u0026#34;127.0.0.1\u0026#34;, 6379, key) if not val then ngx.log(ngx.ERR, \u0026#34;redisæŸ¥è¯¢å¤±è´¥ï¼Œå°è¯•æŸ¥è¯¢httpï¼Œ key: \u0026#34;, key) val = read_http(path, params) end return val end 2ï¼‰è€Œåä¿®æ”¹å•†å“æŸ¥è¯¢ã€åº“å­˜æŸ¥è¯¢çš„ä¸šåŠ¡ï¼š\n3ï¼‰å®Œæ•´çš„item.luaä»£ç ï¼š\n-- å¯¼å…¥commonå‡½æ•°åº“ local common = require(\u0026#39;common\u0026#39;) local read_http = common.read_http local read_redis = common.read_redis -- å¯¼å…¥cjsonåº“ local cjson = require(\u0026#39;cjson\u0026#39;) -- å°è£…æŸ¥è¯¢å‡½æ•° function read_data(key, path, params) -- æŸ¥è¯¢æœ¬åœ°ç¼“å­˜ local val = read_redis(\u0026#34;127.0.0.1\u0026#34;, 6379, key) -- åˆ¤æ–­æŸ¥è¯¢ç»“æœ if not val then ngx.log(ngx.ERR, \u0026#34;redisæŸ¥è¯¢å¤±è´¥ï¼Œå°è¯•æŸ¥è¯¢httpï¼Œ key: \u0026#34;, key) -- redisæŸ¥è¯¢å¤±è´¥ï¼Œå»æŸ¥è¯¢http val = read_http(path, params) end -- è¿”å›æ•°æ® return val end -- è·å–è·¯å¾„å‚æ•° local id = ngx.var[1] local itemJSON = read_data(\u0026#34;item:id:\u0026#34; .. id, \u0026#34;/item/\u0026#34; .. id, nil) local stockJSON = read_data(\u0026#34;item:stock:id:\u0026#34; .. id, \u0026#34;/item/stock/\u0026#34; .. id, nil) -- JSONè½¬åŒ–ä¸ºluaçš„table local item = cjson.decode(itemJSON) local stock = cjson.decode(stockJSON) -- ç»„åˆæ•°æ® item.stock = stock.stock item.sold = stock.sold -- æŠŠitemåºåˆ—åŒ–ä¸ºjson è¿”å›ç»“æœ ngx.say(cjson.encode(item)) 4.7.Nginxæœ¬åœ°ç¼“å­˜ ç°åœ¨ï¼Œæ•´ä¸ªå¤šçº§ç¼“å­˜ä¸­åªå·®æœ€åä¸€ç¯ï¼Œä¹Ÿå°±æ˜¯nginxçš„æœ¬åœ°ç¼“å­˜äº†ã€‚å¦‚å›¾ï¼š\n4.7.1.æœ¬åœ°ç¼“å­˜API OpenRestyä¸ºNginxæä¾›äº†shard dictçš„åŠŸèƒ½ï¼Œå¯ä»¥åœ¨nginxçš„å¤šä¸ªworkerä¹‹é—´å…±äº«æ•°æ®ï¼Œå®ç°ç¼“å­˜åŠŸèƒ½ã€‚\n1ï¼‰å¼€å¯å…±äº«å­—å…¸ï¼Œåœ¨nginx.confçš„httpä¸‹æ·»åŠ é…ç½®ï¼š\n# å…±äº«å­—å…¸ï¼Œä¹Ÿå°±æ˜¯æœ¬åœ°ç¼“å­˜ï¼Œåç§°å«åšï¼šitem_cacheï¼Œå¤§å°150m lua_shared_dict item_cache 150m; 2ï¼‰æ“ä½œå…±äº«å­—å…¸ï¼š\n-- è·å–æœ¬åœ°ç¼“å­˜å¯¹è±¡ local item_cache = ngx.shared.item_cache -- å­˜å‚¨, æŒ‡å®škeyã€valueã€è¿‡æœŸæ—¶é—´ï¼Œå•ä½sï¼Œé»˜è®¤ä¸º0ä»£è¡¨æ°¸ä¸è¿‡æœŸ item_cache:set(\u0026#39;key\u0026#39;, \u0026#39;value\u0026#39;, 1000) -- è¯»å– local val = item_cache:get(\u0026#39;key\u0026#39;) 4.7.2.å®ç°æœ¬åœ°ç¼“å­˜æŸ¥è¯¢ 1ï¼‰ä¿®æ”¹/usr/local/openresty/lua/item.luaæ–‡ä»¶ï¼Œä¿®æ”¹read_dataæŸ¥è¯¢å‡½æ•°ï¼Œæ·»åŠ æœ¬åœ°ç¼“å­˜é€»è¾‘ï¼š\n-- å¯¼å…¥å…±äº«è¯å…¸ï¼Œæœ¬åœ°ç¼“å­˜ local item_cache = ngx.shared.item_cache -- å°è£…æŸ¥è¯¢å‡½æ•° function read_data(key, expire, path, params) -- æŸ¥è¯¢æœ¬åœ°ç¼“å­˜ local val = item_cache:get(key) if not val then ngx.log(ngx.ERR, \u0026#34;æœ¬åœ°ç¼“å­˜æŸ¥è¯¢å¤±è´¥ï¼Œå°è¯•æŸ¥è¯¢Redisï¼Œ key: \u0026#34;, key) -- æŸ¥è¯¢redis val = read_redis(\u0026#34;127.0.0.1\u0026#34;, 6379, key) -- åˆ¤æ–­æŸ¥è¯¢ç»“æœ if not val then ngx.log(ngx.ERR, \u0026#34;redisæŸ¥è¯¢å¤±è´¥ï¼Œå°è¯•æŸ¥è¯¢httpï¼Œ key: \u0026#34;, key) -- redisæŸ¥è¯¢å¤±è´¥ï¼Œå»æŸ¥è¯¢http val = read_http(path, params) end end -- æŸ¥è¯¢æˆåŠŸï¼ŒæŠŠæ•°æ®å†™å…¥æœ¬åœ°ç¼“å­˜ item_cache:set(key, val, expire) -- è¿”å›æ•°æ® return val end 2ï¼‰ä¿®æ”¹item.luaä¸­æŸ¥è¯¢å•†å“å’Œåº“å­˜çš„ä¸šåŠ¡ï¼Œå®ç°æœ€æ–°çš„read_dataå‡½æ•°ï¼š\nå…¶å®å°±æ˜¯å¤šäº†ç¼“å­˜æ—¶é—´å‚æ•°ï¼Œè¿‡æœŸånginxç¼“å­˜ä¼šè‡ªåŠ¨åˆ é™¤ï¼Œä¸‹æ¬¡è®¿é—®å³å¯æ›´æ–°ç¼“å­˜ã€‚\nè¿™é‡Œç»™å•†å“åŸºæœ¬ä¿¡æ¯è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º30åˆ†é’Ÿï¼Œåº“å­˜ä¸º1åˆ†é’Ÿã€‚\nå› ä¸ºåº“å­˜æ›´æ–°é¢‘ç‡è¾ƒé«˜ï¼Œå¦‚æœç¼“å­˜æ—¶é—´è¿‡é•¿ï¼Œå¯èƒ½ä¸æ•°æ®åº“å·®å¼‚è¾ƒå¤§ã€‚\n3ï¼‰å®Œæ•´çš„item.luaæ–‡ä»¶ï¼š\n-- å¯¼å…¥commonå‡½æ•°åº“ local common = require(\u0026#39;common\u0026#39;) local read_http = common.read_http local read_redis = common.read_redis -- å¯¼å…¥cjsonåº“ local cjson = require(\u0026#39;cjson\u0026#39;) -- å¯¼å…¥å…±äº«è¯å…¸ï¼Œæœ¬åœ°ç¼“å­˜ local item_cache = ngx.shared.item_cache -- å°è£…æŸ¥è¯¢å‡½æ•° function read_data(key, expire, path, params) -- æŸ¥è¯¢æœ¬åœ°ç¼“å­˜ local val = item_cache:get(key) if not val then ngx.log(ngx.ERR, \u0026#34;æœ¬åœ°ç¼“å­˜æŸ¥è¯¢å¤±è´¥ï¼Œå°è¯•æŸ¥è¯¢Redisï¼Œ key: \u0026#34;, key) -- æŸ¥è¯¢redis val = read_redis(\u0026#34;127.0.0.1\u0026#34;, 6379, key) -- åˆ¤æ–­æŸ¥è¯¢ç»“æœ if not val then ngx.log(ngx.ERR, \u0026#34;redisæŸ¥è¯¢å¤±è´¥ï¼Œå°è¯•æŸ¥è¯¢httpï¼Œ key: \u0026#34;, key) -- redisæŸ¥è¯¢å¤±è´¥ï¼Œå»æŸ¥è¯¢http val = read_http(path, params) end end -- æŸ¥è¯¢æˆåŠŸï¼ŒæŠŠæ•°æ®å†™å…¥æœ¬åœ°ç¼“å­˜ item_cache:set(key, val, expire) -- è¿”å›æ•°æ® return val end -- è·å–è·¯å¾„å‚æ•° local id = ngx.var[1] -- æŸ¥è¯¢å•†å“ä¿¡æ¯ local itemJSON = read_data(\u0026#34;item:id:\u0026#34; .. id, 1800, \u0026#34;/item/\u0026#34; .. id, nil) -- æŸ¥è¯¢åº“å­˜ä¿¡æ¯ local stockJSON = read_data(\u0026#34;item:stock:id:\u0026#34; .. id, 60, \u0026#34;/item/stock/\u0026#34; .. id, nil) -- JSONè½¬åŒ–ä¸ºluaçš„table local item = cjson.decode(itemJSON) local stock = cjson.decode(stockJSON) -- ç»„åˆæ•°æ® item.stock = stock.stock item.sold = stock.sold -- æŠŠitemåºåˆ—åŒ–ä¸ºjson è¿”å›ç»“æœ ngx.say(cjson.encode(item)) 5.ç¼“å­˜åŒæ­¥ å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨æŸ¥è¯¢åˆ°çš„éƒ½æ˜¯ç¼“å­˜æ•°æ®ï¼Œå¦‚æœç¼“å­˜æ•°æ®ä¸æ•°æ®åº“æ•°æ®å­˜åœ¨è¾ƒå¤§å·®å¼‚ï¼Œå¯èƒ½ä¼šäº§ç”Ÿæ¯”è¾ƒä¸¥é‡çš„åæœã€‚\næ‰€ä»¥æˆ‘ä»¬å¿…é¡»ä¿è¯æ•°æ®åº“æ•°æ®ã€ç¼“å­˜æ•°æ®çš„ä¸€è‡´æ€§ï¼Œè¿™å°±æ˜¯ç¼“å­˜ä¸æ•°æ®åº“çš„åŒæ­¥ã€‚\n5.1.æ•°æ®åŒæ­¥ç­–ç•¥ ç¼“å­˜æ•°æ®åŒæ­¥çš„å¸¸è§æ–¹å¼æœ‰ä¸‰ç§ï¼š\nè®¾ç½®æœ‰æ•ˆæœŸï¼šç»™ç¼“å­˜è®¾ç½®æœ‰æ•ˆæœŸï¼Œåˆ°æœŸåè‡ªåŠ¨åˆ é™¤ã€‚å†æ¬¡æŸ¥è¯¢æ—¶æ›´æ–°\nä¼˜åŠ¿ï¼šç®€å•ã€æ–¹ä¾¿ ç¼ºç‚¹ï¼šæ—¶æ•ˆæ€§å·®ï¼Œç¼“å­˜è¿‡æœŸä¹‹å‰å¯èƒ½ä¸ä¸€è‡´ åœºæ™¯ï¼šæ›´æ–°é¢‘ç‡è¾ƒä½ï¼Œæ—¶æ•ˆæ€§è¦æ±‚ä½çš„ä¸šåŠ¡ åŒæ­¥åŒå†™ï¼šåœ¨ä¿®æ”¹æ•°æ®åº“çš„åŒæ—¶ï¼Œç›´æ¥ä¿®æ”¹ç¼“å­˜\nä¼˜åŠ¿ï¼šæ—¶æ•ˆæ€§å¼ºï¼Œç¼“å­˜ä¸æ•°æ®åº“å¼ºä¸€è‡´ ç¼ºç‚¹ï¼šæœ‰ä»£ç ä¾µå…¥ï¼Œè€¦åˆåº¦é«˜ï¼› åœºæ™¯ï¼šå¯¹ä¸€è‡´æ€§ã€æ—¶æ•ˆæ€§è¦æ±‚è¾ƒé«˜çš„ç¼“å­˜æ•°æ® **å¼‚æ­¥é€šçŸ¥ï¼š**ä¿®æ”¹æ•°æ®åº“æ—¶å‘é€äº‹ä»¶é€šçŸ¥ï¼Œç›¸å…³æœåŠ¡ç›‘å¬åˆ°é€šçŸ¥åä¿®æ”¹ç¼“å­˜æ•°æ®\nä¼˜åŠ¿ï¼šä½è€¦åˆï¼Œå¯ä»¥åŒæ—¶é€šçŸ¥å¤šä¸ªç¼“å­˜æœåŠ¡ ç¼ºç‚¹ï¼šæ—¶æ•ˆæ€§ä¸€èˆ¬ï¼Œå¯èƒ½å­˜åœ¨ä¸­é—´ä¸ä¸€è‡´çŠ¶æ€ åœºæ™¯ï¼šæ—¶æ•ˆæ€§è¦æ±‚ä¸€èˆ¬ï¼Œæœ‰å¤šä¸ªæœåŠ¡éœ€è¦åŒæ­¥ è€Œå¼‚æ­¥å®ç°åˆå¯ä»¥åŸºäºMQæˆ–è€…Canalæ¥å®ç°ï¼š\n1ï¼‰åŸºäºMQçš„å¼‚æ­¥é€šçŸ¥ï¼š\nè§£è¯»ï¼š\nå•†å“æœåŠ¡å®Œæˆå¯¹æ•°æ®çš„ä¿®æ”¹åï¼Œåªéœ€è¦å‘é€ä¸€æ¡æ¶ˆæ¯åˆ°MQä¸­ã€‚ ç¼“å­˜æœåŠ¡ç›‘å¬MQæ¶ˆæ¯ï¼Œç„¶åå®Œæˆå¯¹ç¼“å­˜çš„æ›´æ–° ä¾ç„¶æœ‰å°‘é‡çš„ä»£ç ä¾µå…¥ã€‚\n2ï¼‰åŸºäºCanalçš„é€šçŸ¥\nè§£è¯»ï¼š\nå•†å“æœåŠ¡å®Œæˆå•†å“ä¿®æ”¹åï¼Œä¸šåŠ¡ç›´æ¥ç»“æŸï¼Œæ²¡æœ‰ä»»ä½•ä»£ç ä¾µå…¥ Canalç›‘å¬MySQLå˜åŒ–ï¼Œå½“å‘ç°å˜åŒ–åï¼Œç«‹å³é€šçŸ¥ç¼“å­˜æœåŠ¡ ç¼“å­˜æœåŠ¡æ¥æ”¶åˆ°canalé€šçŸ¥ï¼Œæ›´æ–°ç¼“å­˜ ä»£ç é›¶ä¾µå…¥\n5.2.å®‰è£…Canal 5.2.1.è®¤è¯†Canal Canal [kÉ™\u0026rsquo;nÃ¦l]ï¼Œè¯‘æ„ä¸ºæ°´é“/ç®¡é“/æ²Ÿæ¸ ï¼Œcanalæ˜¯é˜¿é‡Œå·´å·´æ——ä¸‹çš„ä¸€æ¬¾å¼€æºé¡¹ç›®ï¼ŒåŸºäºJavaå¼€å‘ã€‚åŸºäºæ•°æ®åº“å¢é‡æ—¥å¿—è§£æï¼Œæä¾›å¢é‡æ•°æ®è®¢é˜…\u0026amp;æ¶ˆè´¹ã€‚GitHubçš„åœ°å€ï¼šhttps://github.com/alibaba/canal\nCanalæ˜¯åŸºäºmysqlçš„ä¸»ä»åŒæ­¥æ¥å®ç°çš„ï¼ŒMySQLä¸»ä»åŒæ­¥çš„åŸç†å¦‚ä¸‹ï¼š\n1ï¼‰MySQL master å°†æ•°æ®å˜æ›´å†™å…¥äºŒè¿›åˆ¶æ—¥å¿—( binary logï¼‰ï¼Œå…¶ä¸­è®°å½•çš„æ•°æ®å«åšbinary log events 2ï¼‰MySQL slave å°† master çš„ binary log eventsæ‹·è´åˆ°å®ƒçš„ä¸­ç»§æ—¥å¿—(relay log) 3ï¼‰MySQL slave é‡æ”¾ relay log ä¸­äº‹ä»¶ï¼Œå°†æ•°æ®å˜æ›´åæ˜ å®ƒè‡ªå·±çš„æ•°æ® è€ŒCanalå°±æ˜¯æŠŠè‡ªå·±ä¼ªè£…æˆMySQLçš„ä¸€ä¸ªslaveèŠ‚ç‚¹ï¼Œä»è€Œç›‘å¬masterçš„binary logå˜åŒ–ã€‚å†æŠŠå¾—åˆ°çš„å˜åŒ–ä¿¡æ¯é€šçŸ¥ç»™Canalçš„å®¢æˆ·ç«¯ï¼Œè¿›è€Œå®Œæˆå¯¹å…¶å®ƒæ•°æ®åº“çš„åŒæ­¥ã€‚\n5.2.2.å®‰è£…Canal å®‰è£…å’Œé…ç½®Canalå‚è€ƒè¯¾å‰èµ„æ–™æ–‡æ¡£ï¼š\n5.3.ç›‘å¬Canal Canalæä¾›äº†å„ç§è¯­è¨€çš„å®¢æˆ·ç«¯ï¼Œå½“Canalç›‘å¬åˆ°binlogå˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥Canalçš„å®¢æˆ·ç«¯ã€‚\næˆ‘ä»¬å¯ä»¥åˆ©ç”¨Canalæä¾›çš„Javaå®¢æˆ·ç«¯ï¼Œç›‘å¬Canalé€šçŸ¥æ¶ˆæ¯ã€‚å½“æ”¶åˆ°å˜åŒ–çš„æ¶ˆæ¯æ—¶ï¼Œå®Œæˆå¯¹ç¼“å­˜çš„æ›´æ–°ã€‚\nä¸è¿‡è¿™é‡Œæˆ‘ä»¬ä¼šä½¿ç”¨GitHubä¸Šçš„ç¬¬ä¸‰æ–¹å¼€æºçš„canal-starterå®¢æˆ·ç«¯ã€‚åœ°å€ï¼šhttps://github.com/NormanGyllenhaal/canal-client\nä¸SpringBootå®Œç¾æ•´åˆï¼Œè‡ªåŠ¨è£…é…ï¼Œæ¯”å®˜æ–¹å®¢æˆ·ç«¯è¦ç®€å•å¥½ç”¨å¾ˆå¤šã€‚\n5.3.1.å¼•å…¥ä¾èµ–ï¼š \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;top.javatool\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;canal-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.1-RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; 5.3.2.ç¼–å†™é…ç½®ï¼š canal: destination: heima # canalçš„é›†ç¾¤åå­—ï¼Œè¦ä¸å®‰è£…canalæ—¶è®¾ç½®çš„åç§°ä¸€è‡´ server: 192.168.150.101:11111 # canalæœåŠ¡åœ°å€ 5.3.3.ä¿®æ”¹Itemå®ä½“ç±» é€šè¿‡@Idã€@Columnã€ç­‰æ³¨è§£å®ŒæˆItemä¸æ•°æ®åº“è¡¨å­—æ®µçš„æ˜ å°„ï¼š\npackage com.heima.item.pojo; import com.baomidou.mybatisplus.annotation.IdType; import com.baomidou.mybatisplus.annotation.TableField; import com.baomidou.mybatisplus.annotation.TableId; import com.baomidou.mybatisplus.annotation.TableName; import lombok.Data; import org.springframework.data.annotation.Id; import org.springframework.data.annotation.Transient; import javax.persistence.Column; import java.util.Date; @Data @TableName(\u0026#34;tb_item\u0026#34;) public class Item { @TableId(type = IdType.AUTO) @Id private Long id;//å•†å“id @Column(name = \u0026#34;name\u0026#34;) private String name;//å•†å“åç§° private String title;//å•†å“æ ‡é¢˜ private Long price;//ä»·æ ¼ï¼ˆåˆ†ï¼‰ private String image;//å•†å“å›¾ç‰‡ private String category;//åˆ†ç±»åç§° private String brand;//å“ç‰Œåç§° private String spec;//è§„æ ¼ private Integer status;//å•†å“çŠ¶æ€ 1-æ­£å¸¸ï¼Œ2-ä¸‹æ¶ private Date createTime;//åˆ›å»ºæ—¶é—´ private Date updateTime;//æ›´æ–°æ—¶é—´ @TableField(exist = false) @Transient private Integer stock; @TableField(exist = false) @Transient private Integer sold; } 5.3.4.ç¼–å†™ç›‘å¬å™¨ é€šè¿‡å®ç°EntryHandler\u0026lt;T\u0026gt;æ¥å£ç¼–å†™ç›‘å¬å™¨ï¼Œç›‘å¬Canalæ¶ˆæ¯ã€‚æ³¨æ„ä¸¤ç‚¹ï¼š\nå®ç°ç±»é€šè¿‡@CanalTable(\u0026quot;tb_item\u0026quot;)æŒ‡å®šç›‘å¬çš„è¡¨ä¿¡æ¯ EntryHandlerçš„æ³›å‹æ˜¯ä¸è¡¨å¯¹åº”çš„å®ä½“ç±» package com.heima.item.canal; import com.github.benmanes.caffeine.cache.Cache; import com.heima.item.config.RedisHandler; import com.heima.item.pojo.Item; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.stereotype.Component; import top.javatool.canal.client.annotation.CanalTable; import top.javatool.canal.client.handler.EntryHandler; @CanalTable(\u0026#34;tb_item\u0026#34;) @Component public class ItemHandler implements EntryHandler\u0026lt;Item\u0026gt; { @Autowired private RedisHandler redisHandler; @Autowired private Cache\u0026lt;Long, Item\u0026gt; itemCache; @Override public void insert(Item item) { // å†™æ•°æ®åˆ°JVMè¿›ç¨‹ç¼“å­˜ itemCache.put(item.getId(), item); // å†™æ•°æ®åˆ°redis redisHandler.saveItem(item); } @Override public void update(Item before, Item after) { // å†™æ•°æ®åˆ°JVMè¿›ç¨‹ç¼“å­˜ itemCache.put(after.getId(), after); // å†™æ•°æ®åˆ°redis redisHandler.saveItem(after); } @Override public void delete(Item item) { // åˆ é™¤æ•°æ®åˆ°JVMè¿›ç¨‹ç¼“å­˜ itemCache.invalidate(item.getId()); // åˆ é™¤æ•°æ®åˆ°redis redisHandler.deleteItemById(item.getId()); } } åœ¨è¿™é‡Œå¯¹Redisçš„æ“ä½œéƒ½å°è£…åˆ°äº†RedisHandlerè¿™ä¸ªå¯¹è±¡ä¸­ï¼Œæ˜¯æˆ‘ä»¬ä¹‹å‰åšç¼“å­˜é¢„çƒ­æ—¶ç¼–å†™çš„ä¸€ä¸ªç±»ï¼Œå†…å®¹å¦‚ä¸‹ï¼š\npackage com.heima.item.config; import com.fasterxml.jackson.core.JsonProcessingException; import com.fasterxml.jackson.databind.ObjectMapper; import com.heima.item.pojo.Item; import com.heima.item.pojo.ItemStock; import com.heima.item.service.IItemService; import com.heima.item.service.IItemStockService; import org.springframework.beans.factory.InitializingBean; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.data.redis.core.StringRedisTemplate; import org.springframework.stereotype.Component; import java.util.List; @Component public class RedisHandler implements InitializingBean { @Autowired private StringRedisTemplate redisTemplate; @Autowired private IItemService itemService; @Autowired private IItemStockService stockService; private static final ObjectMapper MAPPER = new ObjectMapper(); @Override public void afterPropertiesSet() throws Exception { // åˆå§‹åŒ–ç¼“å­˜ // 1.æŸ¥è¯¢å•†å“ä¿¡æ¯ List\u0026lt;Item\u0026gt; itemList = itemService.list(); // 2.æ”¾å…¥ç¼“å­˜ for (Item item : itemList) { // 2.1.itemåºåˆ—åŒ–ä¸ºJSON String json = MAPPER.writeValueAsString(item); // 2.2.å­˜å…¥redis redisTemplate.opsForValue().set(\u0026#34;item:id:\u0026#34; + item.getId(), json); } // 3.æŸ¥è¯¢å•†å“åº“å­˜ä¿¡æ¯ List\u0026lt;ItemStock\u0026gt; stockList = stockService.list(); // 4.æ”¾å…¥ç¼“å­˜ for (ItemStock stock : stockList) { // 2.1.itemåºåˆ—åŒ–ä¸ºJSON String json = MAPPER.writeValueAsString(stock); // 2.2.å­˜å…¥redis redisTemplate.opsForValue().set(\u0026#34;item:stock:id:\u0026#34; + stock.getId(), json); } } public void saveItem(Item item) { try { String json = MAPPER.writeValueAsString(item); redisTemplate.opsForValue().set(\u0026#34;item:id:\u0026#34; + item.getId(), json); } catch (JsonProcessingException e) { throw new RuntimeException(e); } } public void deleteItemById(Long id) { redisTemplate.delete(\u0026#34;item:id:\u0026#34; + id); } } ","permalink":"https://XianCH.github.io/posts/tech/distributed/%E5%A4%9A%E7%BA%A7%E7%BC%93%E5%AD%98/","summary":"\u003ch1 id=\"1ä»€ä¹ˆæ˜¯å¤šçº§ç¼“å­˜\"\u003e1.ä»€ä¹ˆæ˜¯å¤šçº§ç¼“å­˜\u003c/h1\u003e\n\u003cp\u003eä¼ ç»Ÿçš„ç¼“å­˜ç­–ç•¥ä¸€èˆ¬æ˜¯è¯·æ±‚åˆ°è¾¾Tomcatåï¼Œå…ˆæŸ¥è¯¢Redisï¼Œå¦‚æœæœªå‘½ä¸­åˆ™æŸ¥è¯¢æ•°æ®åº“ï¼Œå¦‚å›¾ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"./assets/image-20210821075259137.png\" alt=\"image-20210821075259137\"  /\u003e\n\u003c/p\u003e\n\u003cp\u003eå­˜åœ¨ä¸‹é¢çš„é—®é¢˜ï¼š\u003c/p\u003e\n\u003cp\u003eâ€¢è¯·æ±‚è¦ç»è¿‡Tomcatå¤„ç†ï¼ŒTomcatçš„æ€§èƒ½æˆä¸ºæ•´ä¸ªç³»ç»Ÿçš„ç“¶é¢ˆ\u003c/p\u003e\n\u003cp\u003eâ€¢Redisç¼“å­˜å¤±æ•ˆæ—¶ï¼Œä¼šå¯¹æ•°æ®åº“äº§ç”Ÿå†²å‡»\u003c/p\u003e\n\u003cp\u003eå¤šçº§ç¼“å­˜å°±æ˜¯å……åˆ†åˆ©ç”¨è¯·æ±‚å¤„ç†çš„æ¯ä¸ªç¯èŠ‚ï¼Œåˆ†åˆ«æ·»åŠ ç¼“å­˜ï¼Œå‡è½»Tomcatå‹åŠ›ï¼Œæå‡æœåŠ¡æ€§èƒ½ï¼š\u003c/p\u003e","title":"å¤šçº§ç¼“å­˜"},{"content":"1.Nacosé…ç½®ç®¡ç† Nacosé™¤äº†å¯ä»¥åšæ³¨å†Œä¸­å¿ƒï¼ŒåŒæ ·å¯ä»¥åšé…ç½®ç®¡ç†æ¥ä½¿ç”¨ã€‚\n1.1.ç»Ÿä¸€é…ç½®ç®¡ç† å½“å¾®æœåŠ¡éƒ¨ç½²çš„å®ä¾‹è¶Šæ¥è¶Šå¤šï¼Œè¾¾åˆ°æ•°åã€æ•°ç™¾æ—¶ï¼Œé€ä¸ªä¿®æ”¹å¾®æœåŠ¡é…ç½®å°±ä¼šè®©äººæŠ“ç‹‚ï¼Œè€Œä¸”å¾ˆå®¹æ˜“å‡ºé”™ã€‚æˆ‘ä»¬éœ€è¦ä¸€ç§ç»Ÿä¸€é…ç½®ç®¡ç†æ–¹æ¡ˆï¼Œå¯ä»¥é›†ä¸­ç®¡ç†æ‰€æœ‰å®ä¾‹çš„é…ç½®ã€‚\nNacosä¸€æ–¹é¢å¯ä»¥å°†é…ç½®é›†ä¸­ç®¡ç†ï¼Œå¦ä¸€æ–¹å¯ä»¥åœ¨é…ç½®å˜æ›´æ—¶ï¼ŒåŠæ—¶é€šçŸ¥å¾®æœåŠ¡ï¼Œå®ç°é…ç½®çš„çƒ­æ›´æ–°ã€‚\n1.1.1.åœ¨nacosä¸­æ·»åŠ é…ç½®æ–‡ä»¶ å¦‚ä½•åœ¨nacosä¸­ç®¡ç†é…ç½®å‘¢ï¼Ÿ\nç„¶ååœ¨å¼¹å‡ºçš„è¡¨å•ä¸­ï¼Œå¡«å†™é…ç½®ä¿¡æ¯ï¼š\næ³¨æ„ï¼šé¡¹ç›®çš„æ ¸å¿ƒé…ç½®ï¼Œéœ€è¦çƒ­æ›´æ–°çš„é…ç½®æ‰æœ‰æ”¾åˆ°nacosç®¡ç†çš„å¿…è¦ã€‚åŸºæœ¬ä¸ä¼šå˜æ›´çš„ä¸€äº›é…ç½®è¿˜æ˜¯ä¿å­˜åœ¨å¾®æœåŠ¡æœ¬åœ°æ¯”è¾ƒå¥½ã€‚\n1.1.2.ä»å¾®æœåŠ¡æ‹‰å–é…ç½® å¾®æœåŠ¡è¦æ‹‰å–nacosä¸­ç®¡ç†çš„é…ç½®ï¼Œå¹¶ä¸”ä¸æœ¬åœ°çš„application.ymlé…ç½®åˆå¹¶ï¼Œæ‰èƒ½å®Œæˆé¡¹ç›®å¯åŠ¨ã€‚\nä½†å¦‚æœå°šæœªè¯»å–application.ymlï¼Œåˆå¦‚ä½•å¾—çŸ¥nacosåœ°å€å‘¢ï¼Ÿ\nå› æ­¤springå¼•å…¥äº†ä¸€ç§æ–°çš„é…ç½®æ–‡ä»¶ï¼šbootstrap.yamlæ–‡ä»¶ï¼Œä¼šåœ¨application.ymlä¹‹å‰è¢«è¯»å–ï¼Œæµç¨‹å¦‚ä¸‹ï¼š\n1ï¼‰å¼•å…¥nacos-configä¾èµ–\né¦–å…ˆï¼Œåœ¨user-serviceæœåŠ¡ä¸­ï¼Œå¼•å…¥nacos-configçš„å®¢æˆ·ç«¯ä¾èµ–ï¼š\n\u0026lt;!--nacosé…ç½®ç®¡ç†ä¾èµ–--\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-alibaba-nacos-config\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; 2ï¼‰æ·»åŠ bootstrap.yaml\nç„¶åï¼Œåœ¨user-serviceä¸­æ·»åŠ ä¸€ä¸ªbootstrap.yamlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š\nspring: application: name: userservice # æœåŠ¡åç§° profiles: active: dev #å¼€å‘ç¯å¢ƒï¼Œè¿™é‡Œæ˜¯dev cloud: nacos: server-addr: localhost:8848 # Nacosåœ°å€ config: file-extension: yaml # æ–‡ä»¶åç¼€å è¿™é‡Œä¼šæ ¹æ®spring.cloud.nacos.server-addrè·å–nacosåœ°å€ï¼Œå†æ ¹æ®\n${spring.application.name}-${spring.profiles.active}.${spring.cloud.nacos.config.file-extension}ä½œä¸ºæ–‡ä»¶idï¼Œæ¥è¯»å–é…ç½®ã€‚\næœ¬ä¾‹ä¸­ï¼Œå°±æ˜¯å»è¯»å–userservice-dev.yamlï¼š\n3ï¼‰è¯»å–nacosé…ç½®\nåœ¨user-serviceä¸­çš„UserControllerä¸­æ·»åŠ ä¸šåŠ¡é€»è¾‘ï¼Œè¯»å–pattern.dateformaté…ç½®ï¼š\nå®Œæ•´ä»£ç ï¼š\npackage cn.itcast.user.web; import cn.itcast.user.pojo.User; import cn.itcast.user.service.UserService; import lombok.extern.slf4j.Slf4j; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.beans.factory.annotation.Value; import org.springframework.web.bind.annotation.*; import java.time.LocalDateTime; import java.time.format.DateTimeFormatter; @Slf4j @RestController @RequestMapping(\u0026#34;/user\u0026#34;) public class UserController { @Autowired private UserService userService; @Value(\u0026#34;${pattern.dateformat}\u0026#34;) private String dateformat; @GetMapping(\u0026#34;now\u0026#34;) public String now(){ return LocalDateTime.now().format(DateTimeFormatter.ofPattern(dateformat)); } // ...ç•¥ } åœ¨é¡µé¢è®¿é—®ï¼Œå¯ä»¥çœ‹åˆ°æ•ˆæœï¼š\n1.2.é…ç½®çƒ­æ›´æ–° æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„ï¼Œæ˜¯ä¿®æ”¹nacosä¸­çš„é…ç½®åï¼Œå¾®æœåŠ¡ä¸­æ— éœ€é‡å¯å³å¯è®©é…ç½®ç”Ÿæ•ˆï¼Œä¹Ÿå°±æ˜¯é…ç½®çƒ­æ›´æ–°ã€‚\nè¦å®ç°é…ç½®çƒ­æ›´æ–°ï¼Œå¯ä»¥ä½¿ç”¨ä¸¤ç§æ–¹å¼ï¼š\n1.2.1.æ–¹å¼ä¸€ åœ¨@Valueæ³¨å…¥çš„å˜é‡æ‰€åœ¨ç±»ä¸Šæ·»åŠ æ³¨è§£@RefreshScopeï¼š\n1.2.2.æ–¹å¼äºŒ ä½¿ç”¨@ConfigurationPropertiesæ³¨è§£ä»£æ›¿@Valueæ³¨è§£ã€‚\nåœ¨user-serviceæœåŠ¡ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªç±»ï¼Œè¯»å–patterrn.dateformatå±æ€§ï¼š\npackage cn.itcast.user.config; import lombok.Data; import org.springframework.boot.context.properties.ConfigurationProperties; import org.springframework.stereotype.Component; @Component @Data @ConfigurationProperties(prefix = \u0026#34;pattern\u0026#34;) public class PatternProperties { private String dateformat; } åœ¨UserControllerä¸­ä½¿ç”¨è¿™ä¸ªç±»ä»£æ›¿@Valueï¼š\nå®Œæ•´ä»£ç ï¼š\npackage cn.itcast.user.web; import cn.itcast.user.config.PatternProperties; import cn.itcast.user.pojo.User; import cn.itcast.user.service.UserService; import lombok.extern.slf4j.Slf4j; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.PathVariable; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RestController; import java.time.LocalDateTime; import java.time.format.DateTimeFormatter; @Slf4j @RestController @RequestMapping(\u0026#34;/user\u0026#34;) public class UserController { @Autowired private UserService userService; @Autowired private PatternProperties patternProperties; @GetMapping(\u0026#34;now\u0026#34;) public String now(){ return LocalDateTime.now().format(DateTimeFormatter.ofPattern(patternProperties.getDateformat())); } // ç•¥ } 1.3.é…ç½®å…±äº« å…¶å®å¾®æœåŠ¡å¯åŠ¨æ—¶ï¼Œä¼šå»nacosè¯»å–å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š\n[spring.application.name]-[spring.profiles.active].yamlï¼Œä¾‹å¦‚ï¼šuserservice-dev.yaml\n[spring.application.name].yamlï¼Œä¾‹å¦‚ï¼šuserservice.yaml\nè€Œ[spring.application.name].yamlä¸åŒ…å«ç¯å¢ƒï¼Œå› æ­¤å¯ä»¥è¢«å¤šä¸ªç¯å¢ƒå…±äº«ã€‚\nä¸‹é¢æˆ‘ä»¬é€šè¿‡æ¡ˆä¾‹æ¥æµ‹è¯•é…ç½®å…±äº«\n1ï¼‰æ·»åŠ ä¸€ä¸ªç¯å¢ƒå…±äº«é…ç½® æˆ‘ä»¬åœ¨nacosä¸­æ·»åŠ ä¸€ä¸ªuserservice.yamlæ–‡ä»¶ï¼š\n2ï¼‰åœ¨user-serviceä¸­è¯»å–å…±äº«é…ç½® åœ¨user-serviceæœåŠ¡ä¸­ï¼Œä¿®æ”¹PatternPropertiesç±»ï¼Œè¯»å–æ–°æ·»åŠ çš„å±æ€§ï¼š\nåœ¨user-serviceæœåŠ¡ä¸­ï¼Œä¿®æ”¹UserControllerï¼Œæ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼š\n3ï¼‰è¿è¡Œä¸¤ä¸ªUserApplicationï¼Œä½¿ç”¨ä¸åŒçš„profile ä¿®æ”¹UserApplication2è¿™ä¸ªå¯åŠ¨é¡¹ï¼Œæ”¹å˜å…¶profileå€¼ï¼š\nè¿™æ ·ï¼ŒUserApplication(8081)ä½¿ç”¨çš„profileæ˜¯devï¼ŒUserApplication2(8082)ä½¿ç”¨çš„profileæ˜¯testã€‚\nå¯åŠ¨UserApplicationå’ŒUserApplication2\nè®¿é—®http://localhost:8081/user/propï¼Œç»“æœï¼š\nè®¿é—®http://localhost:8082/user/propï¼Œç»“æœï¼š\nå¯ä»¥çœ‹å‡ºæ¥ï¼Œä¸ç®¡æ˜¯devï¼Œè¿˜æ˜¯testç¯å¢ƒï¼Œéƒ½è¯»å–åˆ°äº†envSharedValueè¿™ä¸ªå±æ€§çš„å€¼ã€‚\n4ï¼‰é…ç½®å…±äº«çš„ä¼˜å…ˆçº§ å½“nacosã€æœåŠ¡æœ¬åœ°åŒæ—¶å‡ºç°ç›¸åŒå±æ€§æ—¶ï¼Œä¼˜å…ˆçº§æœ‰é«˜ä½ä¹‹åˆ†ï¼š\n1.4.æ­å»ºNacosé›†ç¾¤ Nacosç”Ÿäº§ç¯å¢ƒä¸‹ä¸€å®šè¦éƒ¨ç½²ä¸ºé›†ç¾¤çŠ¶æ€ï¼Œéƒ¨ç½²æ–¹å¼å‚è€ƒè¯¾å‰èµ„æ–™ä¸­çš„æ–‡æ¡£ï¼š\n2.Feignè¿œç¨‹è°ƒç”¨ å…ˆæ¥çœ‹æˆ‘ä»¬ä»¥å‰åˆ©ç”¨RestTemplateå‘èµ·è¿œç¨‹è°ƒç”¨çš„ä»£ç ï¼š\nå­˜åœ¨ä¸‹é¢çš„é—®é¢˜ï¼š\nâ€¢ä»£ç å¯è¯»æ€§å·®ï¼Œç¼–ç¨‹ä½“éªŒä¸ç»Ÿä¸€\nâ€¢å‚æ•°å¤æ‚URLéš¾ä»¥ç»´æŠ¤\nFeignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„httpå®¢æˆ·ç«¯ï¼Œå®˜æ–¹åœ°å€ï¼šhttps://github.com/OpenFeign/feign\nå…¶ä½œç”¨å°±æ˜¯å¸®åŠ©æˆ‘ä»¬ä¼˜é›…çš„å®ç°httpè¯·æ±‚çš„å‘é€ï¼Œè§£å†³ä¸Šé¢æåˆ°çš„é—®é¢˜ã€‚\n2.1.Feignæ›¿ä»£RestTemplate Feginçš„ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š\n1ï¼‰å¼•å…¥ä¾èµ– æˆ‘ä»¬åœ¨order-serviceæœåŠ¡çš„pomæ–‡ä»¶ä¸­å¼•å…¥feignçš„ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-openfeign\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; 2ï¼‰æ·»åŠ æ³¨è§£ åœ¨order-serviceçš„å¯åŠ¨ç±»æ·»åŠ æ³¨è§£å¼€å¯Feignçš„åŠŸèƒ½ï¼š\n3ï¼‰ç¼–å†™Feignçš„å®¢æˆ·ç«¯ åœ¨order-serviceä¸­æ–°å»ºä¸€ä¸ªæ¥å£ï¼Œå†…å®¹å¦‚ä¸‹ï¼š\npackage cn.itcast.order.client; import cn.itcast.order.pojo.User; import org.springframework.cloud.openfeign.FeignClient; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.PathVariable; @FeignClient(\u0026#34;userservice\u0026#34;) public interface UserClient { @GetMapping(\u0026#34;/user/{id}\u0026#34;) User findById(@PathVariable(\u0026#34;id\u0026#34;) Long id); } è¿™ä¸ªå®¢æˆ·ç«¯ä¸»è¦æ˜¯åŸºäºSpringMVCçš„æ³¨è§£æ¥å£°æ˜è¿œç¨‹è°ƒç”¨çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š\næœåŠ¡åç§°ï¼šuserservice è¯·æ±‚æ–¹å¼ï¼šGET è¯·æ±‚è·¯å¾„ï¼š/user/{id} è¯·æ±‚å‚æ•°ï¼šLong id è¿”å›å€¼ç±»å‹ï¼šUser è¿™æ ·ï¼ŒFeignå°±å¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘é€httpè¯·æ±‚ï¼Œæ— éœ€è‡ªå·±ä½¿ç”¨RestTemplateæ¥å‘é€äº†ã€‚\n4ï¼‰æµ‹è¯• ä¿®æ”¹order-serviceä¸­çš„OrderServiceç±»ä¸­çš„queryOrderByIdæ–¹æ³•ï¼Œä½¿ç”¨Feignå®¢æˆ·ç«¯ä»£æ›¿RestTemplateï¼š\næ˜¯ä¸æ˜¯çœ‹èµ·æ¥ä¼˜é›…å¤šäº†ã€‚\n5ï¼‰æ€»ç»“ ä½¿ç”¨Feignçš„æ­¥éª¤ï¼š\nâ‘  å¼•å…¥ä¾èµ–\nâ‘¡ æ·»åŠ @EnableFeignClientsæ³¨è§£\nâ‘¢ ç¼–å†™FeignClientæ¥å£\nâ‘£ ä½¿ç”¨FeignClientä¸­å®šä¹‰çš„æ–¹æ³•ä»£æ›¿RestTemplate\n2.2.è‡ªå®šä¹‰é…ç½® Feignå¯ä»¥æ”¯æŒå¾ˆå¤šçš„è‡ªå®šä¹‰é…ç½®ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š\nç±»å‹ ä½œç”¨ è¯´æ˜ feign.Logger.Level ä¿®æ”¹æ—¥å¿—çº§åˆ« åŒ…å«å››ç§ä¸åŒçš„çº§åˆ«ï¼šNONEã€BASICã€HEADERSã€FULL feign.codec.Decoder å“åº”ç»“æœçš„è§£æå™¨ httpè¿œç¨‹è°ƒç”¨çš„ç»“æœåšè§£æï¼Œä¾‹å¦‚è§£æjsonå­—ç¬¦ä¸²ä¸ºjavaå¯¹è±¡ feign.codec.Encoder è¯·æ±‚å‚æ•°ç¼–ç  å°†è¯·æ±‚å‚æ•°ç¼–ç ï¼Œä¾¿äºé€šè¿‡httpè¯·æ±‚å‘é€ feign. Contract æ”¯æŒçš„æ³¨è§£æ ¼å¼ é»˜è®¤æ˜¯SpringMVCçš„æ³¨è§£ feign. Retryer å¤±è´¥é‡è¯•æœºåˆ¶ è¯·æ±‚å¤±è´¥çš„é‡è¯•æœºåˆ¶ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰ï¼Œä¸è¿‡ä¼šä½¿ç”¨Ribbonçš„é‡è¯• ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé»˜è®¤å€¼å°±èƒ½æ»¡è¶³æˆ‘ä»¬ä½¿ç”¨ï¼Œå¦‚æœè¦è‡ªå®šä¹‰æ—¶ï¼Œåªéœ€è¦åˆ›å»ºè‡ªå®šä¹‰çš„@Beanè¦†ç›–é»˜è®¤Beanå³å¯ã€‚\nä¸‹é¢ä»¥æ—¥å¿—ä¸ºä¾‹æ¥æ¼”ç¤ºå¦‚ä½•è‡ªå®šä¹‰é…ç½®ã€‚\n2.2.1.é…ç½®æ–‡ä»¶æ–¹å¼ åŸºäºé…ç½®æ–‡ä»¶ä¿®æ”¹feignçš„æ—¥å¿—çº§åˆ«å¯ä»¥é’ˆå¯¹å•ä¸ªæœåŠ¡ï¼š\nfeign: client: config: userservice: # é’ˆå¯¹æŸä¸ªå¾®æœåŠ¡çš„é…ç½® loggerLevel: FULL # æ—¥å¿—çº§åˆ« ä¹Ÿå¯ä»¥é’ˆå¯¹æ‰€æœ‰æœåŠ¡ï¼š\nfeign: client: config: default: # è¿™é‡Œç”¨defaultå°±æ˜¯å…¨å±€é…ç½®ï¼Œå¦‚æœæ˜¯å†™æœåŠ¡åç§°ï¼Œåˆ™æ˜¯é’ˆå¯¹æŸä¸ªå¾®æœåŠ¡çš„é…ç½® loggerLevel: FULL # æ—¥å¿—çº§åˆ« è€Œæ—¥å¿—çš„çº§åˆ«åˆ†ä¸ºå››ç§ï¼š\nNONEï¼šä¸è®°å½•ä»»ä½•æ—¥å¿—ä¿¡æ¯ï¼Œè¿™æ˜¯é»˜è®¤å€¼ã€‚ BASICï¼šä»…è®°å½•è¯·æ±‚çš„æ–¹æ³•ï¼ŒURLä»¥åŠå“åº”çŠ¶æ€ç å’Œæ‰§è¡Œæ—¶é—´ HEADERSï¼šåœ¨BASICçš„åŸºç¡€ä¸Šï¼Œé¢å¤–è®°å½•äº†è¯·æ±‚å’Œå“åº”çš„å¤´ä¿¡æ¯ FULLï¼šè®°å½•æ‰€æœ‰è¯·æ±‚å’Œå“åº”çš„æ˜ç»†ï¼ŒåŒ…æ‹¬å¤´ä¿¡æ¯ã€è¯·æ±‚ä½“ã€å…ƒæ•°æ®ã€‚ 2.2.2.Javaä»£ç æ–¹å¼ ä¹Ÿå¯ä»¥åŸºäºJavaä»£ç æ¥ä¿®æ”¹æ—¥å¿—çº§åˆ«ï¼Œå…ˆå£°æ˜ä¸€ä¸ªç±»ï¼Œç„¶åå£°æ˜ä¸€ä¸ªLogger.Levelçš„å¯¹è±¡ï¼š\npublic class DefaultFeignConfiguration { @Bean public Logger.Level feignLogLevel(){ return Logger.Level.BASIC; // æ—¥å¿—çº§åˆ«ä¸ºBASIC } } å¦‚æœè¦å…¨å±€ç”Ÿæ•ˆï¼Œå°†å…¶æ”¾åˆ°å¯åŠ¨ç±»çš„@EnableFeignClientsè¿™ä¸ªæ³¨è§£ä¸­ï¼š\n@EnableFeignClients(defaultConfiguration = DefaultFeignConfiguration .class) å¦‚æœæ˜¯å±€éƒ¨ç”Ÿæ•ˆï¼Œåˆ™æŠŠå®ƒæ”¾åˆ°å¯¹åº”çš„@FeignClientè¿™ä¸ªæ³¨è§£ä¸­ï¼š\n@FeignClient(value = \u0026#34;userservice\u0026#34;, configuration = DefaultFeignConfiguration .class) 2.3.Feignä½¿ç”¨ä¼˜åŒ– Feignåº•å±‚å‘èµ·httpè¯·æ±‚ï¼Œä¾èµ–äºå…¶å®ƒçš„æ¡†æ¶ã€‚å…¶åº•å±‚å®¢æˆ·ç«¯å®ç°åŒ…æ‹¬ï¼š\nâ€¢URLConnectionï¼šé»˜è®¤å®ç°ï¼Œä¸æ”¯æŒè¿æ¥æ± \nâ€¢Apache HttpClient ï¼šæ”¯æŒè¿æ¥æ± \nâ€¢OKHttpï¼šæ”¯æŒè¿æ¥æ± \nå› æ­¤æé«˜Feignçš„æ€§èƒ½ä¸»è¦æ‰‹æ®µå°±æ˜¯ä½¿ç”¨è¿æ¥æ± ä»£æ›¿é»˜è®¤çš„URLConnectionã€‚\nè¿™é‡Œæˆ‘ä»¬ç”¨Apacheçš„HttpClientæ¥æ¼”ç¤ºã€‚\n1ï¼‰å¼•å…¥ä¾èµ–\nåœ¨order-serviceçš„pomæ–‡ä»¶ä¸­å¼•å…¥Apacheçš„HttpClientä¾èµ–ï¼š\n\u0026lt;!--httpClientçš„ä¾èµ– --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.github.openfeign\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;feign-httpclient\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; 2ï¼‰é…ç½®è¿æ¥æ± \nåœ¨order-serviceçš„application.ymlä¸­æ·»åŠ é…ç½®ï¼š\nfeign: client: config: default: # defaultå…¨å±€çš„é…ç½® loggerLevel: BASIC # æ—¥å¿—çº§åˆ«ï¼ŒBASICå°±æ˜¯åŸºæœ¬çš„è¯·æ±‚å’Œå“åº”ä¿¡æ¯ httpclient: enabled: true # å¼€å¯feignå¯¹HttpClientçš„æ”¯æŒ max-connections: 200 # æœ€å¤§çš„è¿æ¥æ•° max-connections-per-route: 50 # æ¯ä¸ªè·¯å¾„çš„æœ€å¤§è¿æ¥æ•° æ¥ä¸‹æ¥ï¼Œåœ¨FeignClientFactoryBeanä¸­çš„loadBalanceæ–¹æ³•ä¸­æ‰“æ–­ç‚¹ï¼š\nDebugæ–¹å¼å¯åŠ¨order-serviceæœåŠ¡ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œçš„clientï¼Œåº•å±‚å°±æ˜¯Apache HttpClientï¼š\næ€»ç»“ï¼ŒFeignçš„ä¼˜åŒ–ï¼š\n1.æ—¥å¿—çº§åˆ«å°½é‡ç”¨basic\n2.ä½¿ç”¨HttpClientæˆ–OKHttpä»£æ›¿URLConnection\nâ‘  å¼•å…¥feign-httpClientä¾èµ–\nâ‘¡ é…ç½®æ–‡ä»¶å¼€å¯httpClientåŠŸèƒ½ï¼Œè®¾ç½®è¿æ¥æ± å‚æ•°\n2.4.æœ€ä½³å®è·µ æ‰€è°“æœ€è¿‘å®è·µï¼Œå°±æ˜¯ä½¿ç”¨è¿‡ç¨‹ä¸­æ€»ç»“çš„ç»éªŒï¼Œæœ€å¥½çš„ä¸€ç§ä½¿ç”¨æ–¹å¼ã€‚\nè‡ªä¹ è§‚å¯Ÿå¯ä»¥å‘ç°ï¼ŒFeignçš„å®¢æˆ·ç«¯ä¸æœåŠ¡æä¾›è€…çš„controllerä»£ç éå¸¸ç›¸ä¼¼ï¼š\nfeignå®¢æˆ·ç«¯ï¼š\nUserControllerï¼š\næœ‰æ²¡æœ‰ä¸€ç§åŠæ³•ç®€åŒ–è¿™ç§é‡å¤çš„ä»£ç ç¼–å†™å‘¢ï¼Ÿ\n2.4.1.ç»§æ‰¿æ–¹å¼ ä¸€æ ·çš„ä»£ç å¯ä»¥é€šè¿‡ç»§æ‰¿æ¥å…±äº«ï¼š\n1ï¼‰å®šä¹‰ä¸€ä¸ªAPIæ¥å£ï¼Œåˆ©ç”¨å®šä¹‰æ–¹æ³•ï¼Œå¹¶åŸºäºSpringMVCæ³¨è§£åšå£°æ˜ã€‚\n2ï¼‰Feignå®¢æˆ·ç«¯å’ŒControlleréƒ½é›†æˆæ”¹æ¥å£\nä¼˜ç‚¹ï¼š\nç®€å• å®ç°äº†ä»£ç å…±äº« ç¼ºç‚¹ï¼š\næœåŠ¡æä¾›æ–¹ã€æœåŠ¡æ¶ˆè´¹æ–¹ç´§è€¦åˆ\nå‚æ•°åˆ—è¡¨ä¸­çš„æ³¨è§£æ˜ å°„å¹¶ä¸ä¼šç»§æ‰¿ï¼Œå› æ­¤Controllerä¸­å¿…é¡»å†æ¬¡å£°æ˜æ–¹æ³•ã€å‚æ•°åˆ—è¡¨ã€æ³¨è§£\n2.4.2.æŠ½å–æ–¹å¼ å°†Feignçš„ClientæŠ½å–ä¸ºç‹¬ç«‹æ¨¡å—ï¼Œå¹¶ä¸”æŠŠæ¥å£æœ‰å…³çš„POJOã€é»˜è®¤çš„Feigné…ç½®éƒ½æ”¾åˆ°è¿™ä¸ªæ¨¡å—ä¸­ï¼Œæä¾›ç»™æ‰€æœ‰æ¶ˆè´¹è€…ä½¿ç”¨ã€‚\nä¾‹å¦‚ï¼Œå°†UserClientã€Userã€Feignçš„é»˜è®¤é…ç½®éƒ½æŠ½å–åˆ°ä¸€ä¸ªfeign-apiåŒ…ä¸­ï¼Œæ‰€æœ‰å¾®æœåŠ¡å¼•ç”¨è¯¥ä¾èµ–åŒ…ï¼Œå³å¯ç›´æ¥ä½¿ç”¨ã€‚\n2.4.3.å®ç°åŸºäºæŠ½å–çš„æœ€ä½³å®è·µ 1ï¼‰æŠ½å– é¦–å…ˆåˆ›å»ºä¸€ä¸ªmoduleï¼Œå‘½åä¸ºfeign-apiï¼š\né¡¹ç›®ç»“æ„ï¼š\nåœ¨feign-apiä¸­ç„¶åå¼•å…¥feignçš„starterä¾èµ–\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-openfeign\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; ç„¶åï¼Œorder-serviceä¸­ç¼–å†™çš„UserClientã€Userã€DefaultFeignConfigurationéƒ½å¤åˆ¶åˆ°feign-apié¡¹ç›®ä¸­\n2ï¼‰åœ¨order-serviceä¸­ä½¿ç”¨feign-api é¦–å…ˆï¼Œåˆ é™¤order-serviceä¸­çš„UserClientã€Userã€DefaultFeignConfigurationç­‰ç±»æˆ–æ¥å£ã€‚\nåœ¨order-serviceçš„pomæ–‡ä»¶ä¸­ä¸­å¼•å…¥feign-apiçš„ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;cn.itcast.demo\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;feign-api\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; ä¿®æ”¹order-serviceä¸­çš„æ‰€æœ‰ä¸ä¸Šè¿°ä¸‰ä¸ªç»„ä»¶æœ‰å…³çš„å¯¼åŒ…éƒ¨åˆ†ï¼Œæ”¹æˆå¯¼å…¥feign-apiä¸­çš„åŒ…\n3ï¼‰é‡å¯æµ‹è¯• é‡å¯åï¼Œå‘ç°æœåŠ¡æŠ¥é”™äº†ï¼š\nè¿™æ˜¯å› ä¸ºUserClientç°åœ¨åœ¨cn.itcast.feign.clientsåŒ…ä¸‹ï¼Œ\nè€Œorder-serviceçš„@EnableFeignClientsæ³¨è§£æ˜¯åœ¨cn.itcast.orderåŒ…ä¸‹ï¼Œä¸åœ¨åŒä¸€ä¸ªåŒ…ï¼Œæ— æ³•æ‰«æåˆ°UserClientã€‚\n4ï¼‰è§£å†³æ‰«æåŒ…é—®é¢˜ æ–¹å¼ä¸€ï¼š\næŒ‡å®šFeignåº”è¯¥æ‰«æçš„åŒ…ï¼š\n@EnableFeignClients(basePackages = \u0026#34;cn.itcast.feign.clients\u0026#34;) æ–¹å¼äºŒï¼š\næŒ‡å®šéœ€è¦åŠ è½½çš„Clientæ¥å£ï¼š\n@EnableFeignClients(clients = {UserClient.class}) 3.GatewayæœåŠ¡ç½‘å…³ Spring Cloud Gateway æ˜¯ Spring Cloud çš„ä¸€ä¸ªå…¨æ–°é¡¹ç›®ï¼Œè¯¥é¡¹ç›®æ˜¯åŸºäº Spring 5.0ï¼ŒSpring Boot 2.0 å’Œ Project Reactor ç­‰å“åº”å¼ç¼–ç¨‹å’Œäº‹ä»¶æµæŠ€æœ¯å¼€å‘çš„ç½‘å…³ï¼Œå®ƒæ—¨åœ¨ä¸ºå¾®æœåŠ¡æ¶æ„æä¾›ä¸€ç§ç®€å•æœ‰æ•ˆçš„ç»Ÿä¸€çš„ API è·¯ç”±ç®¡ç†æ–¹å¼ã€‚\n3.1.ä¸ºä»€ä¹ˆéœ€è¦ç½‘å…³ Gatewayç½‘å…³æ˜¯æˆ‘ä»¬æœåŠ¡çš„å®ˆé—¨ç¥ï¼Œæ‰€æœ‰å¾®æœåŠ¡çš„ç»Ÿä¸€å…¥å£ã€‚\nç½‘å…³çš„æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§ï¼š\nè¯·æ±‚è·¯ç”± æƒé™æ§åˆ¶ é™æµ æ¶æ„å›¾ï¼š\næƒé™æ§åˆ¶ï¼šç½‘å…³ä½œä¸ºå¾®æœåŠ¡å…¥å£ï¼Œéœ€è¦æ ¡éªŒç”¨æˆ·æ˜¯æ˜¯å¦æœ‰è¯·æ±‚èµ„æ ¼ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿›è¡Œæ‹¦æˆªã€‚\nè·¯ç”±å’Œè´Ÿè½½å‡è¡¡ï¼šä¸€åˆ‡è¯·æ±‚éƒ½å¿…é¡»å…ˆç»è¿‡gatewayï¼Œä½†ç½‘å…³ä¸å¤„ç†ä¸šåŠ¡ï¼Œè€Œæ˜¯æ ¹æ®æŸç§è§„åˆ™ï¼ŒæŠŠè¯·æ±‚è½¬å‘åˆ°æŸä¸ªå¾®æœåŠ¡ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšè·¯ç”±ã€‚å½“ç„¶è·¯ç”±çš„ç›®æ ‡æœåŠ¡æœ‰å¤šä¸ªæ—¶ï¼Œè¿˜éœ€è¦åšè´Ÿè½½å‡è¡¡ã€‚\né™æµï¼šå½“è¯·æ±‚æµé‡è¿‡é«˜æ—¶ï¼Œåœ¨ç½‘å…³ä¸­æŒ‰ç…§ä¸‹æµçš„å¾®æœåŠ¡èƒ½å¤Ÿæ¥å—çš„é€Ÿåº¦æ¥æ”¾è¡Œè¯·æ±‚ï¼Œé¿å…æœåŠ¡å‹åŠ›è¿‡å¤§ã€‚\nåœ¨SpringCloudä¸­ç½‘å…³çš„å®ç°åŒ…æ‹¬ä¸¤ç§ï¼š\ngateway zuul Zuulæ˜¯åŸºäºServletçš„å®ç°ï¼Œå±äºé˜»å¡å¼ç¼–ç¨‹ã€‚è€ŒSpringCloudGatewayåˆ™æ˜¯åŸºäºSpring5ä¸­æä¾›çš„WebFluxï¼Œå±äºå“åº”å¼ç¼–ç¨‹çš„å®ç°ï¼Œå…·å¤‡æ›´å¥½çš„æ€§èƒ½ã€‚\n3.2.gatewayå¿«é€Ÿå…¥é—¨ ä¸‹é¢ï¼Œæˆ‘ä»¬å°±æ¼”ç¤ºä¸‹ç½‘å…³çš„åŸºæœ¬è·¯ç”±åŠŸèƒ½ã€‚åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š\nåˆ›å»ºSpringBootå·¥ç¨‹gatewayï¼Œå¼•å…¥ç½‘å…³ä¾èµ– ç¼–å†™å¯åŠ¨ç±» ç¼–å†™åŸºç¡€é…ç½®å’Œè·¯ç”±è§„åˆ™ å¯åŠ¨ç½‘å…³æœåŠ¡è¿›è¡Œæµ‹è¯• 1ï¼‰åˆ›å»ºgatewayæœåŠ¡ï¼Œå¼•å…¥ä¾èµ– åˆ›å»ºæœåŠ¡ï¼š\nå¼•å…¥ä¾èµ–ï¼š\n\u0026lt;!--ç½‘å…³--\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-gateway\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!--nacosæœåŠ¡å‘ç°ä¾èµ–--\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-alibaba-nacos-discovery\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; 2ï¼‰ç¼–å†™å¯åŠ¨ç±» package cn.itcast.gateway; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; @SpringBootApplication public class GatewayApplication { public static void main(String[] args) { SpringApplication.run(GatewayApplication.class, args); } } 3ï¼‰ç¼–å†™åŸºç¡€é…ç½®å’Œè·¯ç”±è§„åˆ™ åˆ›å»ºapplication.ymlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š\nserver: port: 10010 # ç½‘å…³ç«¯å£ spring: application: name: gateway # æœåŠ¡åç§° cloud: nacos: server-addr: localhost:8848 # nacosåœ°å€ gateway: routes: # ç½‘å…³è·¯ç”±é…ç½® - id: user-service # è·¯ç”±idï¼Œè‡ªå®šä¹‰ï¼Œåªè¦å”¯ä¸€å³å¯ # uri: http://127.0.0.1:8081 # è·¯ç”±çš„ç›®æ ‡åœ°å€ httpå°±æ˜¯å›ºå®šåœ°å€ uri: lb://userservice # è·¯ç”±çš„ç›®æ ‡åœ°å€ lbå°±æ˜¯è´Ÿè½½å‡è¡¡ï¼Œåé¢è·ŸæœåŠ¡åç§° predicates: # è·¯ç”±æ–­è¨€ï¼Œä¹Ÿå°±æ˜¯åˆ¤æ–­è¯·æ±‚æ˜¯å¦ç¬¦åˆè·¯ç”±è§„åˆ™çš„æ¡ä»¶ - Path=/user/** # è¿™ä¸ªæ˜¯æŒ‰ç…§è·¯å¾„åŒ¹é…ï¼Œåªè¦ä»¥/user/å¼€å¤´å°±ç¬¦åˆè¦æ±‚ æˆ‘ä»¬å°†ç¬¦åˆPath è§„åˆ™çš„ä¸€åˆ‡è¯·æ±‚ï¼Œéƒ½ä»£ç†åˆ° uriå‚æ•°æŒ‡å®šçš„åœ°å€ã€‚\næœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°† /user/**å¼€å¤´çš„è¯·æ±‚ï¼Œä»£ç†åˆ°lb://userserviceï¼Œlbæ˜¯è´Ÿè½½å‡è¡¡ï¼Œæ ¹æ®æœåŠ¡åæ‹‰å–æœåŠ¡åˆ—è¡¨ï¼Œå®ç°è´Ÿè½½å‡è¡¡ã€‚\n4ï¼‰é‡å¯æµ‹è¯• é‡å¯ç½‘å…³ï¼Œè®¿é—®http://localhost:10010/user/1æ—¶ï¼Œç¬¦åˆ/user/**è§„åˆ™ï¼Œè¯·æ±‚è½¬å‘åˆ°uriï¼šhttp://userservice/user/1ï¼Œå¾—åˆ°äº†ç»“æœï¼š\n5ï¼‰ç½‘å…³è·¯ç”±çš„æµç¨‹å›¾ æ•´ä¸ªè®¿é—®çš„æµç¨‹å¦‚ä¸‹ï¼š\næ€»ç»“ï¼š\nç½‘å…³æ­å»ºæ­¥éª¤ï¼š\nåˆ›å»ºé¡¹ç›®ï¼Œå¼•å…¥nacosæœåŠ¡å‘ç°å’Œgatewayä¾èµ–\né…ç½®application.ymlï¼ŒåŒ…æ‹¬æœåŠ¡åŸºæœ¬ä¿¡æ¯ã€nacosåœ°å€ã€è·¯ç”±\nè·¯ç”±é…ç½®åŒ…æ‹¬ï¼š\nè·¯ç”±idï¼šè·¯ç”±çš„å”¯ä¸€æ ‡ç¤º\nè·¯ç”±ç›®æ ‡ï¼ˆuriï¼‰ï¼šè·¯ç”±çš„ç›®æ ‡åœ°å€ï¼Œhttpä»£è¡¨å›ºå®šåœ°å€ï¼Œlbä»£è¡¨æ ¹æ®æœåŠ¡åè´Ÿè½½å‡è¡¡\nè·¯ç”±æ–­è¨€ï¼ˆpredicatesï¼‰ï¼šåˆ¤æ–­è·¯ç”±çš„è§„åˆ™ï¼Œ\nè·¯ç”±è¿‡æ»¤å™¨ï¼ˆfiltersï¼‰ï¼šå¯¹è¯·æ±‚æˆ–å“åº”åšå¤„ç†\næ¥ä¸‹æ¥ï¼Œå°±é‡ç‚¹æ¥å­¦ä¹ è·¯ç”±æ–­è¨€å’Œè·¯ç”±è¿‡æ»¤å™¨çš„è¯¦ç»†çŸ¥è¯†\n3.3.æ–­è¨€å·¥å‚ æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­å†™çš„æ–­è¨€è§„åˆ™åªæ˜¯å­—ç¬¦ä¸²ï¼Œè¿™äº›å­—ç¬¦ä¸²ä¼šè¢«Predicate Factoryè¯»å–å¹¶å¤„ç†ï¼Œè½¬å˜ä¸ºè·¯ç”±åˆ¤æ–­çš„æ¡ä»¶\nä¾‹å¦‚Path=/user/**æ˜¯æŒ‰ç…§è·¯å¾„åŒ¹é…ï¼Œè¿™ä¸ªè§„åˆ™æ˜¯ç”±\norg.springframework.cloud.gateway.handler.predicate.PathRoutePredicateFactoryç±»æ¥\nå¤„ç†çš„ï¼Œåƒè¿™æ ·çš„æ–­è¨€å·¥å‚åœ¨SpringCloudGatewayè¿˜æœ‰åå‡ ä¸ª:\nåç§° è¯´æ˜ ç¤ºä¾‹ After æ˜¯æŸä¸ªæ—¶é—´ç‚¹åçš„è¯·æ±‚ - After=2037-01-20T17:42:47.789-07:00[America/Denver] Before æ˜¯æŸä¸ªæ—¶é—´ç‚¹ä¹‹å‰çš„è¯·æ±‚ - Before=2031-04-13T15:14:47.433+08:00[Asia/Shanghai] Between æ˜¯æŸä¸¤ä¸ªæ—¶é—´ç‚¹ä¹‹å‰çš„è¯·æ±‚ - Between=2037-01-20T17:42:47.789-07:00[America/Denver], 2037-01-21T17:42:47.789-07:00[America/Denver] Cookie è¯·æ±‚å¿…é¡»åŒ…å«æŸäº›cookie - Cookie=chocolate, ch.p Header è¯·æ±‚å¿…é¡»åŒ…å«æŸäº›header - Header=X-Request-Id, \\d+ Host è¯·æ±‚å¿…é¡»æ˜¯è®¿é—®æŸä¸ªhostï¼ˆåŸŸåï¼‰ - Host=.somehost.org,.anotherhost.org Method è¯·æ±‚æ–¹å¼å¿…é¡»æ˜¯æŒ‡å®šæ–¹å¼ - Method=GET,POST Path è¯·æ±‚è·¯å¾„å¿…é¡»ç¬¦åˆæŒ‡å®šè§„åˆ™ - Path=/red/{segment},/blue/** Query è¯·æ±‚å‚æ•°å¿…é¡»åŒ…å«æŒ‡å®šå‚æ•° - Query=name, Jackæˆ–è€…- Query=name RemoteAddr è¯·æ±‚è€…çš„ipå¿…é¡»æ˜¯æŒ‡å®šèŒƒå›´ - RemoteAddr=192.168.1.1/24 Weight æƒé‡å¤„ç† æˆ‘ä»¬åªéœ€è¦æŒæ¡Pathè¿™ç§è·¯ç”±å·¥ç¨‹å°±å¯ä»¥äº†ã€‚\n3.4.è¿‡æ»¤å™¨å·¥å‚ GatewayFilteræ˜¯ç½‘å…³ä¸­æä¾›çš„ä¸€ç§è¿‡æ»¤å™¨ï¼Œå¯ä»¥å¯¹è¿›å…¥ç½‘å…³çš„è¯·æ±‚å’Œå¾®æœåŠ¡è¿”å›çš„å“åº”åšå¤„ç†ï¼š\n3.4.1.è·¯ç”±è¿‡æ»¤å™¨çš„ç§ç±» Springæä¾›äº†31ç§ä¸åŒçš„è·¯ç”±è¿‡æ»¤å™¨å·¥å‚ã€‚ä¾‹å¦‚ï¼š\nåç§° è¯´æ˜ AddRequestHeader ç»™å½“å‰è¯·æ±‚æ·»åŠ ä¸€ä¸ªè¯·æ±‚å¤´ RemoveRequestHeader ç§»é™¤è¯·æ±‚ä¸­çš„ä¸€ä¸ªè¯·æ±‚å¤´ AddResponseHeader ç»™å“åº”ç»“æœä¸­æ·»åŠ ä¸€ä¸ªå“åº”å¤´ RemoveResponseHeader ä»å“åº”ç»“æœä¸­ç§»é™¤æœ‰ä¸€ä¸ªå“åº”å¤´ RequestRateLimiter é™åˆ¶è¯·æ±‚çš„æµé‡ 3.4.2.è¯·æ±‚å¤´è¿‡æ»¤å™¨ ä¸‹é¢æˆ‘ä»¬ä»¥AddRequestHeader ä¸ºä¾‹æ¥è®²è§£ã€‚\néœ€æ±‚ï¼šç»™æ‰€æœ‰è¿›å…¥userserviceçš„è¯·æ±‚æ·»åŠ ä¸€ä¸ªè¯·æ±‚å¤´ï¼šTruth=itcast is freaking awesome!\nåªéœ€è¦ä¿®æ”¹gatewayæœåŠ¡çš„application.ymlæ–‡ä»¶ï¼Œæ·»åŠ è·¯ç”±è¿‡æ»¤å³å¯ï¼š\nspring: cloud: gateway: routes: - id: user-service uri: lb://userservice predicates: - Path=/user/** filters: # è¿‡æ»¤å™¨ - AddRequestHeader=Truth, Itcast is freaking awesome! # æ·»åŠ è¯·æ±‚å¤´ å½“å‰è¿‡æ»¤å™¨å†™åœ¨userserviceè·¯ç”±ä¸‹ï¼Œå› æ­¤ä»…ä»…å¯¹è®¿é—®userserviceçš„è¯·æ±‚æœ‰æ•ˆã€‚\n3.4.3.é»˜è®¤è¿‡æ»¤å™¨ å¦‚æœè¦å¯¹æ‰€æœ‰çš„è·¯ç”±éƒ½ç”Ÿæ•ˆï¼Œåˆ™å¯ä»¥å°†è¿‡æ»¤å™¨å·¥å‚å†™åˆ°defaultä¸‹ã€‚æ ¼å¼å¦‚ä¸‹ï¼š\nspring: cloud: gateway: routes: - id: user-service uri: lb://userservice predicates: - Path=/user/** default-filters: # é»˜è®¤è¿‡æ»¤é¡¹ - AddRequestHeader=Truth, Itcast is freaking awesome! 3.4.4.æ€»ç»“ è¿‡æ»¤å™¨çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\nâ‘  å¯¹è·¯ç”±çš„è¯·æ±‚æˆ–å“åº”åšåŠ å·¥å¤„ç†ï¼Œæ¯”å¦‚æ·»åŠ è¯·æ±‚å¤´\nâ‘¡ é…ç½®åœ¨è·¯ç”±ä¸‹çš„è¿‡æ»¤å™¨åªå¯¹å½“å‰è·¯ç”±çš„è¯·æ±‚ç”Ÿæ•ˆ\ndefaultFiltersçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\nâ‘  å¯¹æ‰€æœ‰è·¯ç”±éƒ½ç”Ÿæ•ˆçš„è¿‡æ»¤å™¨\n3.5.å…¨å±€è¿‡æ»¤å™¨ ä¸Šä¸€èŠ‚å­¦ä¹ çš„è¿‡æ»¤å™¨ï¼Œç½‘å…³æä¾›äº†31ç§ï¼Œä½†æ¯ä¸€ç§è¿‡æ»¤å™¨çš„ä½œç”¨éƒ½æ˜¯å›ºå®šçš„ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›æ‹¦æˆªè¯·æ±‚ï¼Œåšè‡ªå·±çš„ä¸šåŠ¡é€»è¾‘åˆ™æ²¡åŠæ³•å®ç°ã€‚\n3.5.1.å…¨å±€è¿‡æ»¤å™¨ä½œç”¨ å…¨å±€è¿‡æ»¤å™¨çš„ä½œç”¨ä¹Ÿæ˜¯å¤„ç†ä¸€åˆ‡è¿›å…¥ç½‘å…³çš„è¯·æ±‚å’Œå¾®æœåŠ¡å“åº”ï¼Œä¸GatewayFilterçš„ä½œç”¨ä¸€æ ·ã€‚åŒºåˆ«åœ¨äºGatewayFilteré€šè¿‡é…ç½®å®šä¹‰ï¼Œå¤„ç†é€»è¾‘æ˜¯å›ºå®šçš„ï¼›è€ŒGlobalFilterçš„é€»è¾‘éœ€è¦è‡ªå·±å†™ä»£ç å®ç°ã€‚\nå®šä¹‰æ–¹å¼æ˜¯å®ç°GlobalFilteræ¥å£ã€‚\npublic interface GlobalFilter { /** * å¤„ç†å½“å‰è¯·æ±‚ï¼Œæœ‰å¿…è¦çš„è¯é€šè¿‡{@link GatewayFilterChain}å°†è¯·æ±‚äº¤ç»™ä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨å¤„ç† * * @param exchange è¯·æ±‚ä¸Šä¸‹æ–‡ï¼Œé‡Œé¢å¯ä»¥è·å–Requestã€Responseç­‰ä¿¡æ¯ * @param chain ç”¨æ¥æŠŠè¯·æ±‚å§”æ‰˜ç»™ä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨ * @return {@code Mono\u0026lt;Void\u0026gt;} è¿”å›æ ‡ç¤ºå½“å‰è¿‡æ»¤å™¨ä¸šåŠ¡ç»“æŸ */ Mono\u0026lt;Void\u0026gt; filter(ServerWebExchange exchange, GatewayFilterChain chain); } åœ¨filterä¸­ç¼–å†™è‡ªå®šä¹‰é€»è¾‘ï¼Œå¯ä»¥å®ç°ä¸‹åˆ—åŠŸèƒ½ï¼š\nç™»å½•çŠ¶æ€åˆ¤æ–­ æƒé™æ ¡éªŒ è¯·æ±‚é™æµç­‰ 3.5.2.è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨ éœ€æ±‚ï¼šå®šä¹‰å…¨å±€è¿‡æ»¤å™¨ï¼Œæ‹¦æˆªè¯·æ±‚ï¼Œåˆ¤æ–­è¯·æ±‚çš„å‚æ•°æ˜¯å¦æ»¡è¶³ä¸‹é¢æ¡ä»¶ï¼š\nå‚æ•°ä¸­æ˜¯å¦æœ‰authorizationï¼Œ\nauthorizationå‚æ•°å€¼æ˜¯å¦ä¸ºadmin\nå¦‚æœåŒæ—¶æ»¡è¶³åˆ™æ”¾è¡Œï¼Œå¦åˆ™æ‹¦æˆª\nå®ç°ï¼š\nåœ¨gatewayä¸­å®šä¹‰ä¸€ä¸ªè¿‡æ»¤å™¨ï¼š\npackage cn.itcast.gateway.filters; import org.springframework.cloud.gateway.filter.GatewayFilterChain; import org.springframework.cloud.gateway.filter.GlobalFilter; import org.springframework.core.annotation.Order; import org.springframework.http.HttpStatus; import org.springframework.stereotype.Component; import org.springframework.web.server.ServerWebExchange; import reactor.core.publisher.Mono; @Order(-1) @Component public class AuthorizeFilter implements GlobalFilter { @Override public Mono\u0026lt;Void\u0026gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) { // 1.è·å–è¯·æ±‚å‚æ•° MultiValueMap\u0026lt;String, String\u0026gt; params = exchange.getRequest().getQueryParams(); // 2.è·å–authorizationå‚æ•° String auth = params.getFirst(\u0026#34;authorization\u0026#34;); // 3.æ ¡éªŒ if (\u0026#34;admin\u0026#34;.equals(auth)) { // æ”¾è¡Œ return chain.filter(exchange); } // 4.æ‹¦æˆª // 4.1.ç¦æ­¢è®¿é—®ï¼Œè®¾ç½®çŠ¶æ€ç  exchange.getResponse().setStatusCode(HttpStatus.FORBIDDEN); // 4.2.ç»“æŸå¤„ç† return exchange.getResponse().setComplete(); } } 3.5.3.è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº è¯·æ±‚è¿›å…¥ç½‘å…³ä¼šç¢°åˆ°ä¸‰ç±»è¿‡æ»¤å™¨ï¼šå½“å‰è·¯ç”±çš„è¿‡æ»¤å™¨ã€DefaultFilterã€GlobalFilter\nè¯·æ±‚è·¯ç”±åï¼Œä¼šå°†å½“å‰è·¯ç”±è¿‡æ»¤å™¨å’ŒDefaultFilterã€GlobalFilterï¼Œåˆå¹¶åˆ°ä¸€ä¸ªè¿‡æ»¤å™¨é“¾ï¼ˆé›†åˆï¼‰ä¸­ï¼Œæ’åºåä¾æ¬¡æ‰§è¡Œæ¯ä¸ªè¿‡æ»¤å™¨ï¼š\næ’åºçš„è§„åˆ™æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ\næ¯ä¸€ä¸ªè¿‡æ»¤å™¨éƒ½å¿…é¡»æŒ‡å®šä¸€ä¸ªintç±»å‹çš„orderå€¼ï¼Œorderå€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œæ‰§è¡Œé¡ºåºè¶Šé å‰ã€‚ GlobalFilteré€šè¿‡å®ç°Orderedæ¥å£ï¼Œæˆ–è€…æ·»åŠ @Orderæ³¨è§£æ¥æŒ‡å®šorderå€¼ï¼Œç”±æˆ‘ä»¬è‡ªå·±æŒ‡å®š è·¯ç”±è¿‡æ»¤å™¨å’ŒdefaultFilterçš„orderç”±SpringæŒ‡å®šï¼Œé»˜è®¤æ˜¯æŒ‰ç…§å£°æ˜é¡ºåºä»1é€’å¢ã€‚ å½“è¿‡æ»¤å™¨çš„orderå€¼ä¸€æ ·æ—¶ï¼Œä¼šæŒ‰ç…§ defaultFilter \u0026gt; è·¯ç”±è¿‡æ»¤å™¨ \u0026gt; GlobalFilterçš„é¡ºåºæ‰§è¡Œã€‚ è¯¦ç»†å†…å®¹ï¼Œå¯ä»¥æŸ¥çœ‹æºç ï¼š\norg.springframework.cloud.gateway.route.RouteDefinitionRouteLocator#getFilters()æ–¹æ³•æ˜¯å…ˆåŠ è½½defaultFiltersï¼Œç„¶åå†åŠ è½½æŸä¸ªrouteçš„filtersï¼Œç„¶ååˆå¹¶ã€‚\norg.springframework.cloud.gateway.handler.FilteringWebHandler#handle()æ–¹æ³•ä¼šåŠ è½½å…¨å±€è¿‡æ»¤å™¨ï¼Œä¸å‰é¢çš„è¿‡æ»¤å™¨åˆå¹¶åæ ¹æ®orderæ’åºï¼Œç»„ç»‡è¿‡æ»¤å™¨é“¾\n3.6.è·¨åŸŸé—®é¢˜ 3.6.1.ä»€ä¹ˆæ˜¯è·¨åŸŸé—®é¢˜ è·¨åŸŸï¼šåŸŸåä¸ä¸€è‡´å°±æ˜¯è·¨åŸŸï¼Œä¸»è¦åŒ…æ‹¬ï¼š\nåŸŸåä¸åŒï¼š www.taobao.com å’Œ www.taobao.org å’Œ www.jd.com å’Œ miaosha.jd.com\nåŸŸåç›¸åŒï¼Œç«¯å£ä¸åŒï¼šlocalhost:8080å’Œlocalhost8081\nè·¨åŸŸé—®é¢˜ï¼šæµè§ˆå™¨ç¦æ­¢è¯·æ±‚çš„å‘èµ·è€…ä¸æœåŠ¡ç«¯å‘ç”Ÿè·¨åŸŸajaxè¯·æ±‚ï¼Œè¯·æ±‚è¢«æµè§ˆå™¨æ‹¦æˆªçš„é—®é¢˜\nè§£å†³æ–¹æ¡ˆï¼šCORSï¼Œè¿™ä¸ªä»¥å‰åº”è¯¥å­¦ä¹ è¿‡ï¼Œè¿™é‡Œä¸å†èµ˜è¿°äº†ã€‚ä¸çŸ¥é“çš„å°ä¼™ä¼´å¯ä»¥æŸ¥çœ‹https://www.ruanyifeng.com/blog/2016/04/cors.html\n3.6.2.æ¨¡æ‹Ÿè·¨åŸŸé—®é¢˜ æ‰¾åˆ°è¯¾å‰èµ„æ–™çš„é¡µé¢æ–‡ä»¶ï¼š\næ”¾å…¥tomcatæˆ–è€…nginxè¿™æ ·çš„webæœåŠ¡å™¨ä¸­ï¼Œå¯åŠ¨å¹¶è®¿é—®ã€‚\nå¯ä»¥åœ¨æµè§ˆå™¨æ§åˆ¶å°çœ‹åˆ°ä¸‹é¢çš„é”™è¯¯ï¼š\nä»localhost:8090è®¿é—®localhost:10010ï¼Œç«¯å£ä¸åŒï¼Œæ˜¾ç„¶æ˜¯è·¨åŸŸçš„è¯·æ±‚ã€‚\n3.6.3.è§£å†³è·¨åŸŸé—®é¢˜ åœ¨gatewayæœåŠ¡çš„application.ymlæ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä¸‹é¢çš„é…ç½®ï¼š\nspring: cloud: gateway: # ã€‚ã€‚ã€‚ globalcors: # å…¨å±€çš„è·¨åŸŸå¤„ç† add-to-simple-url-handler-mapping: true # è§£å†³optionsè¯·æ±‚è¢«æ‹¦æˆªé—®é¢˜ corsConfigurations: \u0026#39;[/**]\u0026#39;: allowedOrigins: # å…è®¸å“ªäº›ç½‘ç«™çš„è·¨åŸŸè¯·æ±‚ - \u0026#34;http://localhost:8090\u0026#34; allowedMethods: # å…è®¸çš„è·¨åŸŸajaxçš„è¯·æ±‚æ–¹å¼ - \u0026#34;GET\u0026#34; - \u0026#34;POST\u0026#34; - \u0026#34;DELETE\u0026#34; - \u0026#34;PUT\u0026#34; - \u0026#34;OPTIONS\u0026#34; allowedHeaders: \u0026#34;*\u0026#34; # å…è®¸åœ¨è¯·æ±‚ä¸­æºå¸¦çš„å¤´ä¿¡æ¯ allowCredentials: true # æ˜¯å¦å…è®¸æºå¸¦cookie maxAge: 360000 # è¿™æ¬¡è·¨åŸŸæ£€æµ‹çš„æœ‰æ•ˆæœŸ ","permalink":"https://XianCH.github.io/posts/tech/distributed/springcloud/","summary":"\u003ch1 id=\"1nacosé…ç½®ç®¡ç†\"\u003e1.Nacosé…ç½®ç®¡ç†\u003c/h1\u003e\n\u003cp\u003eNacosé™¤äº†å¯ä»¥åšæ³¨å†Œä¸­å¿ƒï¼ŒåŒæ ·å¯ä»¥åšé…ç½®ç®¡ç†æ¥ä½¿ç”¨ã€‚\u003c/p\u003e\n\u003ch2 id=\"11ç»Ÿä¸€é…ç½®ç®¡ç†\"\u003e1.1.ç»Ÿä¸€é…ç½®ç®¡ç†\u003c/h2\u003e\n\u003cp\u003eå½“å¾®æœåŠ¡éƒ¨ç½²çš„å®ä¾‹è¶Šæ¥è¶Šå¤šï¼Œè¾¾åˆ°æ•°åã€æ•°ç™¾æ—¶ï¼Œé€ä¸ªä¿®æ”¹å¾®æœåŠ¡é…ç½®å°±ä¼šè®©äººæŠ“ç‹‚ï¼Œè€Œä¸”å¾ˆå®¹æ˜“å‡ºé”™ã€‚æˆ‘ä»¬éœ€è¦ä¸€ç§ç»Ÿä¸€é…ç½®ç®¡ç†æ–¹æ¡ˆï¼Œå¯ä»¥é›†ä¸­ç®¡ç†æ‰€æœ‰å®ä¾‹çš„é…ç½®ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"assets/image-20210714164426792.png\" alt=\"image-20210714164426792\"  /\u003e\n\u003c/p\u003e\n\u003cp\u003eNacosä¸€æ–¹é¢å¯ä»¥å°†é…ç½®é›†ä¸­ç®¡ç†ï¼Œå¦ä¸€æ–¹å¯ä»¥åœ¨é…ç½®å˜æ›´æ—¶ï¼ŒåŠæ—¶é€šçŸ¥å¾®æœåŠ¡ï¼Œå®ç°é…ç½®çš„çƒ­æ›´æ–°ã€‚\u003c/p\u003e","title":"springcloud"},{"content":"1.å•æœºéƒ¨ç½² æˆ‘ä»¬åœ¨Centos7è™šæ‹Ÿæœºä¸­ä½¿ç”¨Dockeræ¥å®‰è£…ã€‚\n1.1.ä¸‹è½½é•œåƒ æ–¹å¼ä¸€ï¼šåœ¨çº¿æ‹‰å–\ndocker pull rabbitmq:3.8-management æ–¹å¼äºŒï¼šä»æœ¬åœ°åŠ è½½\nåœ¨è¯¾å‰èµ„æ–™å·²ç»æä¾›äº†é•œåƒåŒ…ï¼š\nä¸Šä¼ åˆ°è™šæ‹Ÿæœºä¸­åï¼Œä½¿ç”¨å‘½ä»¤åŠ è½½é•œåƒå³å¯ï¼š\ndocker load -i mq.tar 1.2.å®‰è£…MQ æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¥è¿è¡ŒMQå®¹å™¨ï¼š\ndocker run \\ -e RABBITMQ_DEFAULT_USER=itcast \\ -e RABBITMQ_DEFAULT_PASS=123321 \\ -v mq-plugins:/plugins \\ --name mq \\ --hostname mq1 \\ -p 15672:15672 \\ -p 5672:5672 \\ -d \\ rabbitmq:3.8-management 2.å®‰è£…DelayExchangeæ’ä»¶ å®˜æ–¹çš„å®‰è£…æŒ‡å—åœ°å€ä¸ºï¼šhttps://blog.rabbitmq.com/posts/2015/04/scheduling-messages-with-rabbitmq\nä¸Šè¿°æ–‡æ¡£æ˜¯åŸºäºlinuxåŸç”Ÿå®‰è£…RabbitMQï¼Œç„¶åå®‰è£…æ’ä»¶ã€‚\nå› ä¸ºæˆ‘ä»¬ä¹‹å‰æ˜¯åŸºäºDockerå®‰è£…RabbitMQï¼Œæ‰€ä»¥ä¸‹é¢æˆ‘ä»¬ä¼šè®²è§£åŸºäºDockeræ¥å®‰è£…RabbitMQæ’ä»¶ã€‚\n2.1.ä¸‹è½½æ’ä»¶ RabbitMQæœ‰ä¸€ä¸ªå®˜æ–¹çš„æ’ä»¶ç¤¾åŒºï¼Œåœ°å€ä¸ºï¼šhttps://www.rabbitmq.com/community-plugins.html\nå…¶ä¸­åŒ…å«å„ç§å„æ ·çš„æ’ä»¶ï¼ŒåŒ…æ‹¬æˆ‘ä»¬è¦ä½¿ç”¨çš„DelayExchangeæ’ä»¶ï¼š\nå¤§å®¶å¯ä»¥å»å¯¹åº”çš„GitHubé¡µé¢ä¸‹è½½3.8.9ç‰ˆæœ¬çš„æ’ä»¶ï¼Œåœ°å€ä¸ºhttps://github.com/rabbitmq/rabbitmq-delayed-message-exchange/releases/tag/3.8.9è¿™ä¸ªå¯¹åº”RabbitMQçš„3.8.5ä»¥ä¸Šç‰ˆæœ¬ã€‚\nè¯¾å‰èµ„æ–™ä¹Ÿæä¾›äº†ä¸‹è½½å¥½çš„æ’ä»¶ï¼š\n2.2.ä¸Šä¼ æ’ä»¶ å› ä¸ºæˆ‘ä»¬æ˜¯åŸºäºDockerå®‰è£…ï¼Œæ‰€ä»¥éœ€è¦å…ˆæŸ¥çœ‹RabbitMQçš„æ’ä»¶ç›®å½•å¯¹åº”çš„æ•°æ®å·ã€‚å¦‚æœä¸æ˜¯åŸºäºDockerçš„åŒå­¦ï¼Œè¯·å‚è€ƒç¬¬ä¸€ç« éƒ¨åˆ†ï¼Œé‡æ–°åˆ›å»ºDockerå®¹å™¨ã€‚\næˆ‘ä»¬ä¹‹å‰è®¾å®šçš„RabbitMQçš„æ•°æ®å·åç§°ä¸ºmq-pluginsï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢å‘½ä»¤æŸ¥çœ‹æ•°æ®å·ï¼š\ndocker volume inspect mq-plugins å¯ä»¥å¾—åˆ°ä¸‹é¢ç»“æœï¼š\næ¥ä¸‹æ¥ï¼Œå°†æ’ä»¶ä¸Šä¼ åˆ°è¿™ä¸ªç›®å½•å³å¯ï¼š\n2.3.å®‰è£…æ’ä»¶ æœ€åå°±æ˜¯å®‰è£…äº†ï¼Œéœ€è¦è¿›å…¥MQå®¹å™¨å†…éƒ¨æ¥æ‰§è¡Œå®‰è£…ã€‚æˆ‘çš„å®¹å™¨åä¸ºmqï¼Œæ‰€ä»¥æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š\ndocker exec -it mq bash æ‰§è¡Œæ—¶ï¼Œè¯·å°†å…¶ä¸­çš„ -it åé¢çš„mqæ›¿æ¢ä¸ºä½ è‡ªå·±çš„å®¹å™¨å.\nè¿›å…¥å®¹å™¨å†…éƒ¨åï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤å¼€å¯æ’ä»¶ï¼š\nrabbitmq-plugins enable rabbitmq_delayed_message_exchange ç»“æœå¦‚ä¸‹ï¼š\n3.é›†ç¾¤éƒ¨ç½² æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å®‰è£…RabbitMQçš„é›†ç¾¤ã€‚\n2.1.é›†ç¾¤åˆ†ç±» åœ¨RabbitMQçš„å®˜æ–¹æ–‡æ¡£ä¸­ï¼Œè®²è¿°äº†ä¸¤ç§é›†ç¾¤çš„é…ç½®æ–¹å¼ï¼š\næ™®é€šæ¨¡å¼ï¼šæ™®é€šæ¨¡å¼é›†ç¾¤ä¸è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œæ¯ä¸ªMQéƒ½æœ‰è‡ªå·±çš„é˜Ÿåˆ—ã€æ•°æ®ä¿¡æ¯ï¼ˆå…¶å®ƒå…ƒæ•°æ®ä¿¡æ¯å¦‚äº¤æ¢æœºç­‰ä¼šåŒæ­¥ï¼‰ã€‚ä¾‹å¦‚æˆ‘ä»¬æœ‰2ä¸ªMQï¼šmq1ï¼Œå’Œmq2ï¼Œå¦‚æœä½ çš„æ¶ˆæ¯åœ¨mq1ï¼Œè€Œä½ è¿æ¥åˆ°äº†mq2ï¼Œé‚£ä¹ˆmq2ä¼šå»mq1æ‹‰å–æ¶ˆæ¯ï¼Œç„¶åè¿”å›ç»™ä½ ã€‚å¦‚æœmq1å®•æœºï¼Œæ¶ˆæ¯å°±ä¼šä¸¢å¤±ã€‚ é•œåƒæ¨¡å¼ï¼šä¸æ™®é€šæ¨¡å¼ä¸åŒï¼Œé˜Ÿåˆ—ä¼šåœ¨å„ä¸ªmqçš„é•œåƒèŠ‚ç‚¹ä¹‹é—´åŒæ­¥ï¼Œå› æ­¤ä½ è¿æ¥åˆ°ä»»ä½•ä¸€ä¸ªé•œåƒèŠ‚ç‚¹ï¼Œå‡å¯è·å–åˆ°æ¶ˆæ¯ã€‚è€Œä¸”å¦‚æœä¸€ä¸ªèŠ‚ç‚¹å®•æœºï¼Œå¹¶ä¸ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚ä¸è¿‡ï¼Œè¿™ç§æ–¹å¼å¢åŠ äº†æ•°æ®åŒæ­¥çš„å¸¦å®½æ¶ˆè€—ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹æ™®é€šæ¨¡å¼é›†ç¾¤ï¼Œæˆ‘ä»¬çš„è®¡åˆ’éƒ¨ç½²3èŠ‚ç‚¹çš„mqé›†ç¾¤ï¼š\nä¸»æœºå æ§åˆ¶å°ç«¯å£ amqpé€šä¿¡ç«¯å£ mq1 8081 \u0026mdash;\u0026gt; 15672 8071 \u0026mdash;\u0026gt; 5672 mq2 8082 \u0026mdash;\u0026gt; 15672 8072 \u0026mdash;\u0026gt; 5672 mq3 8083 \u0026mdash;\u0026gt; 15672 8073 \u0026mdash;\u0026gt; 5672 é›†ç¾¤ä¸­çš„èŠ‚ç‚¹æ ‡ç¤ºé»˜è®¤éƒ½æ˜¯ï¼šrabbit@[hostname]ï¼Œå› æ­¤ä»¥ä¸Šä¸‰ä¸ªèŠ‚ç‚¹çš„åç§°åˆ†åˆ«ä¸ºï¼š\nrabbit@mq1 rabbit@mq2 rabbit@mq3 2.2.è·å–cookie RabbitMQåº•å±‚ä¾èµ–äºErlangï¼Œè€ŒErlangè™šæ‹Ÿæœºå°±æ˜¯ä¸€ä¸ªé¢å‘åˆ†å¸ƒå¼çš„è¯­è¨€ï¼Œé»˜è®¤å°±æ”¯æŒé›†ç¾¤æ¨¡å¼ã€‚é›†ç¾¤æ¨¡å¼ä¸­çš„æ¯ä¸ªRabbitMQ èŠ‚ç‚¹ä½¿ç”¨ cookie æ¥ç¡®å®šå®ƒä»¬æ˜¯å¦è¢«å…è®¸ç›¸äº’é€šä¿¡ã€‚\nè¦ä½¿ä¸¤ä¸ªèŠ‚ç‚¹èƒ½å¤Ÿé€šä¿¡ï¼Œå®ƒä»¬å¿…é¡»å…·æœ‰ç›¸åŒçš„å…±äº«ç§˜å¯†ï¼Œç§°ä¸ºErlang cookieã€‚cookie åªæ˜¯ä¸€ä¸²æœ€å¤š 255 ä¸ªå­—ç¬¦çš„å­—æ¯æ•°å­—å­—ç¬¦ã€‚\næ¯ä¸ªé›†ç¾¤èŠ‚ç‚¹å¿…é¡»å…·æœ‰ç›¸åŒçš„ cookieã€‚å®ä¾‹ä¹‹é—´ä¹Ÿéœ€è¦å®ƒæ¥ç›¸äº’é€šä¿¡ã€‚\næˆ‘ä»¬å…ˆåœ¨ä¹‹å‰å¯åŠ¨çš„mqå®¹å™¨ä¸­è·å–ä¸€ä¸ªcookieå€¼ï¼Œä½œä¸ºé›†ç¾¤çš„cookieã€‚æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š\ndocker exec -it mq cat /var/lib/rabbitmq/.erlang.cookie å¯ä»¥çœ‹åˆ°cookieå€¼å¦‚ä¸‹ï¼š\nFXZMCVGLBIXZCDEMMVZQ æ¥ä¸‹æ¥ï¼Œåœæ­¢å¹¶åˆ é™¤å½“å‰çš„mqå®¹å™¨ï¼Œæˆ‘ä»¬é‡æ–°æ­å»ºé›†ç¾¤ã€‚\ndocker rm -f mq 2.3.å‡†å¤‡é›†ç¾¤é…ç½® åœ¨/tmpç›®å½•æ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ rabbitmq.confï¼š\ncd /tmp # åˆ›å»ºæ–‡ä»¶ touch rabbitmq.conf æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š\nloopback_users.guest = false listeners.tcp.default = 5672 cluster_formation.peer_discovery_backend = rabbit_peer_discovery_classic_config cluster_formation.classic_config.nodes.1 = rabbit@mq1 cluster_formation.classic_config.nodes.2 = rabbit@mq2 cluster_formation.classic_config.nodes.3 = rabbit@mq3 å†åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œè®°å½•cookie\ncd /tmp # åˆ›å»ºcookieæ–‡ä»¶ touch .erlang.cookie # å†™å…¥cookie echo \u0026#34;FXZMCVGLBIXZCDEMMVZQ\u0026#34; \u0026gt; .erlang.cookie # ä¿®æ”¹cookieæ–‡ä»¶çš„æƒé™ chmod 600 .erlang.cookie å‡†å¤‡ä¸‰ä¸ªç›®å½•,mq1ã€mq2ã€mq3ï¼š\ncd /tmp # åˆ›å»ºç›®å½• mkdir mq1 mq2 mq3 ç„¶åæ‹·è´rabbitmq.confã€cookieæ–‡ä»¶åˆ°mq1ã€mq2ã€mq3ï¼š\n# è¿›å…¥/tmp cd /tmp # æ‹·è´ cp rabbitmq.conf mq1 cp rabbitmq.conf mq2 cp rabbitmq.conf mq3 cp .erlang.cookie mq1 cp .erlang.cookie mq2 cp .erlang.cookie mq3 2.4.å¯åŠ¨é›†ç¾¤ åˆ›å»ºä¸€ä¸ªç½‘ç»œï¼š\ndocker network create mq-net docker volume create\nè¿è¡Œå‘½ä»¤\ndocker run -d --net mq-net \\ -v ${PWD}/mq1/rabbitmq.conf:/etc/rabbitmq/rabbitmq.conf \\ -v ${PWD}/.erlang.cookie:/var/lib/rabbitmq/.erlang.cookie \\ -e RABBITMQ_DEFAULT_USER=itcast \\ -e RABBITMQ_DEFAULT_PASS=123321 \\ --name mq1 \\ --hostname mq1 \\ -p 8071:5672 \\ -p 8081:15672 \\ rabbitmq:3.8-management docker run -d --net mq-net \\ -v ${PWD}/mq2/rabbitmq.conf:/etc/rabbitmq/rabbitmq.conf \\ -v ${PWD}/.erlang.cookie:/var/lib/rabbitmq/.erlang.cookie \\ -e RABBITMQ_DEFAULT_USER=itcast \\ -e RABBITMQ_DEFAULT_PASS=123321 \\ --name mq2 \\ --hostname mq2 \\ -p 8072:5672 \\ -p 8082:15672 \\ rabbitmq:3.8-management docker run -d --net mq-net \\ -v ${PWD}/mq3/rabbitmq.conf:/etc/rabbitmq/rabbitmq.conf \\ -v ${PWD}/.erlang.cookie:/var/lib/rabbitmq/.erlang.cookie \\ -e RABBITMQ_DEFAULT_USER=itcast \\ -e RABBITMQ_DEFAULT_PASS=123321 \\ --name mq3 \\ --hostname mq3 \\ -p 8073:5672 \\ -p 8083:15672 \\ rabbitmq:3.8-management 2.5.æµ‹è¯• åœ¨mq1è¿™ä¸ªèŠ‚ç‚¹ä¸Šæ·»åŠ ä¸€ä¸ªé˜Ÿåˆ—ï¼š\nå¦‚å›¾ï¼Œåœ¨mq2å’Œmq3ä¸¤ä¸ªæ§åˆ¶å°ä¹Ÿéƒ½èƒ½çœ‹åˆ°ï¼š\n2.5.1.æ•°æ®å…±äº«æµ‹è¯• ç‚¹å‡»è¿™ä¸ªé˜Ÿåˆ—ï¼Œè¿›å…¥ç®¡ç†é¡µé¢ï¼š\nç„¶ååˆ©ç”¨æ§åˆ¶å°å‘é€ä¸€æ¡æ¶ˆæ¯åˆ°è¿™ä¸ªé˜Ÿåˆ—ï¼š\nç»“æœåœ¨mq2ã€mq3ä¸Šéƒ½èƒ½çœ‹åˆ°è¿™æ¡æ¶ˆæ¯ï¼š\n2.5.2.å¯ç”¨æ€§æµ‹è¯• æˆ‘ä»¬è®©å…¶ä¸­ä¸€å°èŠ‚ç‚¹mq1å®•æœºï¼š\ndocker stop mq1 ç„¶åç™»å½•mq2æˆ–mq3çš„æ§åˆ¶å°ï¼Œå‘ç°simple.queueä¹Ÿä¸å¯ç”¨äº†ï¼š\nè¯´æ˜æ•°æ®å¹¶æ²¡æœ‰æ‹·è´åˆ°mq2å’Œmq3ã€‚\n4.é•œåƒæ¨¡å¼ åœ¨åˆšåˆšçš„æ¡ˆä¾‹ä¸­ï¼Œä¸€æ—¦åˆ›å»ºé˜Ÿåˆ—çš„ä¸»æœºå®•æœºï¼Œé˜Ÿåˆ—å°±ä¼šä¸å¯ç”¨ã€‚ä¸å…·å¤‡é«˜å¯ç”¨èƒ½åŠ›ã€‚å¦‚æœè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¿…é¡»ä½¿ç”¨å®˜æ–¹æä¾›çš„é•œåƒé›†ç¾¤æ–¹æ¡ˆã€‚\nå®˜æ–¹æ–‡æ¡£åœ°å€ï¼šhttps://www.rabbitmq.com/ha.html\n4.1.é•œåƒæ¨¡å¼çš„ç‰¹å¾ é»˜è®¤æƒ…å†µä¸‹ï¼Œé˜Ÿåˆ—åªä¿å­˜åœ¨åˆ›å»ºè¯¥é˜Ÿåˆ—çš„èŠ‚ç‚¹ä¸Šã€‚è€Œé•œåƒæ¨¡å¼ä¸‹ï¼Œåˆ›å»ºé˜Ÿåˆ—çš„èŠ‚ç‚¹è¢«ç§°ä¸ºè¯¥é˜Ÿåˆ—çš„ä¸»èŠ‚ç‚¹ï¼Œé˜Ÿåˆ—è¿˜ä¼šæ‹·è´åˆ°é›†ç¾¤ä¸­çš„å…¶å®ƒèŠ‚ç‚¹ï¼Œä¹Ÿå«åšè¯¥é˜Ÿåˆ—çš„é•œåƒèŠ‚ç‚¹ã€‚\nä½†æ˜¯ï¼Œä¸åŒé˜Ÿåˆ—å¯ä»¥åœ¨é›†ç¾¤ä¸­çš„ä»»æ„èŠ‚ç‚¹ä¸Šåˆ›å»ºï¼Œå› æ­¤ä¸åŒé˜Ÿåˆ—çš„ä¸»èŠ‚ç‚¹å¯ä»¥ä¸åŒã€‚ç”šè‡³ï¼Œä¸€ä¸ªé˜Ÿåˆ—çš„ä¸»èŠ‚ç‚¹å¯èƒ½æ˜¯å¦ä¸€ä¸ªé˜Ÿåˆ—çš„é•œåƒèŠ‚ç‚¹ã€‚\nç”¨æˆ·å‘é€ç»™é˜Ÿåˆ—çš„ä¸€åˆ‡è¯·æ±‚ï¼Œä¾‹å¦‚å‘é€æ¶ˆæ¯ã€æ¶ˆæ¯å›æ‰§é»˜è®¤éƒ½ä¼šåœ¨ä¸»èŠ‚ç‚¹å®Œæˆï¼Œå¦‚æœæ˜¯ä»èŠ‚ç‚¹æ¥æ”¶åˆ°è¯·æ±‚ï¼Œä¹Ÿä¼šè·¯ç”±åˆ°ä¸»èŠ‚ç‚¹å»å®Œæˆã€‚é•œåƒèŠ‚ç‚¹ä»…ä»…èµ·åˆ°å¤‡ä»½æ•°æ®ä½œç”¨ã€‚\nå½“ä¸»èŠ‚ç‚¹æ¥æ”¶åˆ°æ¶ˆè´¹è€…çš„ACKæ—¶ï¼Œæ‰€æœ‰é•œåƒéƒ½ä¼šåˆ é™¤èŠ‚ç‚¹ä¸­çš„æ•°æ®ã€‚\næ€»ç»“å¦‚ä¸‹ï¼š\né•œåƒé˜Ÿåˆ—ç»“æ„æ˜¯ä¸€ä¸»å¤šä»ï¼ˆä»å°±æ˜¯é•œåƒï¼‰ æ‰€æœ‰æ“ä½œéƒ½æ˜¯ä¸»èŠ‚ç‚¹å®Œæˆï¼Œç„¶ååŒæ­¥ç»™é•œåƒèŠ‚ç‚¹ ä¸»å®•æœºåï¼Œé•œåƒèŠ‚ç‚¹ä¼šæ›¿ä»£æˆæ–°çš„ä¸»ï¼ˆå¦‚æœåœ¨ä¸»ä»åŒæ­¥å®Œæˆå‰ï¼Œä¸»å°±å·²ç»å®•æœºï¼Œå¯èƒ½å‡ºç°æ•°æ®ä¸¢å¤±ï¼‰ ä¸å…·å¤‡è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œå› ä¸ºæ‰€æœ‰æ“ä½œéƒ½ä¼šæœ‰ä¸»èŠ‚ç‚¹å®Œæˆï¼ˆä½†æ˜¯ä¸åŒé˜Ÿåˆ—ï¼Œå…¶ä¸»èŠ‚ç‚¹å¯ä»¥ä¸åŒï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªæé«˜ååé‡ï¼‰ 4.2.é•œåƒæ¨¡å¼çš„é…ç½® é•œåƒæ¨¡å¼çš„é…ç½®æœ‰3ç§æ¨¡å¼ï¼š\nha-mode ha-params æ•ˆæœ å‡†ç¡®æ¨¡å¼exactly é˜Ÿåˆ—çš„å‰¯æœ¬é‡count é›†ç¾¤ä¸­é˜Ÿåˆ—å‰¯æœ¬ï¼ˆä¸»æœåŠ¡å™¨å’Œé•œåƒæœåŠ¡å™¨ä¹‹å’Œï¼‰çš„æ•°é‡ã€‚countå¦‚æœä¸º1æ„å‘³ç€å•ä¸ªå‰¯æœ¬ï¼šå³é˜Ÿåˆ—ä¸»èŠ‚ç‚¹ã€‚countå€¼ä¸º2è¡¨ç¤º2ä¸ªå‰¯æœ¬ï¼š1ä¸ªé˜Ÿåˆ—ä¸»å’Œ1ä¸ªé˜Ÿåˆ—é•œåƒã€‚æ¢å¥è¯è¯´ï¼šcount = é•œåƒæ•°é‡ + 1ã€‚å¦‚æœç¾¤é›†ä¸­çš„èŠ‚ç‚¹æ•°å°‘äºcountï¼Œåˆ™è¯¥é˜Ÿåˆ—å°†é•œåƒåˆ°æ‰€æœ‰èŠ‚ç‚¹ã€‚å¦‚æœæœ‰é›†ç¾¤æ€»æ•°å¤§äºcount+1ï¼Œå¹¶ä¸”åŒ…å«é•œåƒçš„èŠ‚ç‚¹å‡ºç°æ•…éšœï¼Œåˆ™å°†åœ¨å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒã€‚ all (none) é˜Ÿåˆ—åœ¨ç¾¤é›†ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ä¹‹é—´è¿›è¡Œé•œåƒã€‚é˜Ÿåˆ—å°†é•œåƒåˆ°ä»»ä½•æ–°åŠ å…¥çš„èŠ‚ç‚¹ã€‚é•œåƒåˆ°æ‰€æœ‰èŠ‚ç‚¹å°†å¯¹æ‰€æœ‰ç¾¤é›†èŠ‚ç‚¹æ–½åŠ é¢å¤–çš„å‹åŠ›ï¼ŒåŒ…æ‹¬ç½‘ç»œI / Oï¼Œç£ç›˜I / Oå’Œç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚æ¨èä½¿ç”¨exactlyï¼Œè®¾ç½®å‰¯æœ¬æ•°ä¸ºï¼ˆN / 2 +1ï¼‰ã€‚ nodes node names æŒ‡å®šé˜Ÿåˆ—åˆ›å»ºåˆ°å“ªäº›èŠ‚ç‚¹ï¼Œå¦‚æœæŒ‡å®šçš„èŠ‚ç‚¹å…¨éƒ¨ä¸å­˜åœ¨ï¼Œåˆ™ä¼šå‡ºç°å¼‚å¸¸ã€‚å¦‚æœæŒ‡å®šçš„èŠ‚ç‚¹åœ¨é›†ç¾¤ä¸­å­˜åœ¨ï¼Œä½†æ˜¯æš‚æ—¶ä¸å¯ç”¨ï¼Œä¼šåˆ›å»ºèŠ‚ç‚¹åˆ°å½“å‰å®¢æˆ·ç«¯è¿æ¥åˆ°çš„èŠ‚ç‚¹ã€‚ è¿™é‡Œæˆ‘ä»¬ä»¥rabbitmqctlå‘½ä»¤ä½œä¸ºæ¡ˆä¾‹æ¥è®²è§£é…ç½®è¯­æ³•ã€‚\nè¯­æ³•ç¤ºä¾‹ï¼š\n4.2.1.exactlyæ¨¡å¼ rabbitmqctl set_policy ha-two \u0026#34;^two\\.\u0026#34; \u0026#39;{\u0026#34;ha-mode\u0026#34;:\u0026#34;exactly\u0026#34;,\u0026#34;ha-params\u0026#34;:2,\u0026#34;ha-sync-mode\u0026#34;:\u0026#34;automatic\u0026#34;}\u0026#39; rabbitmqctl set_policyï¼šå›ºå®šå†™æ³• ha-twoï¼šç­–ç•¥åç§°ï¼Œè‡ªå®šä¹‰ \u0026quot;^two\\.\u0026quot;ï¼šåŒ¹é…é˜Ÿåˆ—çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œç¬¦åˆå‘½åè§„åˆ™çš„é˜Ÿåˆ—æ‰ç”Ÿæ•ˆï¼Œè¿™é‡Œæ˜¯ä»»ä½•ä»¥two.å¼€å¤´çš„é˜Ÿåˆ—åç§° '{\u0026quot;ha-mode\u0026quot;:\u0026quot;exactly\u0026quot;,\u0026quot;ha-params\u0026quot;:2,\u0026quot;ha-sync-mode\u0026quot;:\u0026quot;automatic\u0026quot;}': ç­–ç•¥å†…å®¹ \u0026quot;ha-mode\u0026quot;:\u0026quot;exactly\u0026quot;ï¼šç­–ç•¥æ¨¡å¼ï¼Œæ­¤å¤„æ˜¯exactlyæ¨¡å¼ï¼ŒæŒ‡å®šå‰¯æœ¬æ•°é‡ \u0026quot;ha-params\u0026quot;:2ï¼šç­–ç•¥å‚æ•°ï¼Œè¿™é‡Œæ˜¯2ï¼Œå°±æ˜¯å‰¯æœ¬æ•°é‡ä¸º2ï¼Œ1ä¸»1é•œåƒ \u0026quot;ha-sync-mode\u0026quot;:\u0026quot;automatic\u0026quot;ï¼šåŒæ­¥ç­–ç•¥ï¼Œé»˜è®¤æ˜¯manualï¼Œå³æ–°åŠ å…¥çš„é•œåƒèŠ‚ç‚¹ä¸ä¼šåŒæ­¥æ—§çš„æ¶ˆæ¯ã€‚å¦‚æœè®¾ç½®ä¸ºautomaticï¼Œåˆ™æ–°åŠ å…¥çš„é•œåƒèŠ‚ç‚¹ä¼šæŠŠä¸»èŠ‚ç‚¹ä¸­æ‰€æœ‰æ¶ˆæ¯éƒ½åŒæ­¥ï¼Œä¼šå¸¦æ¥é¢å¤–çš„ç½‘ç»œå¼€é”€ 4.2.2.allæ¨¡å¼ rabbitmqctl set_policy ha-all \u0026#34;^all\\.\u0026#34; \u0026#39;{\u0026#34;ha-mode\u0026#34;:\u0026#34;all\u0026#34;}\u0026#39; ha-allï¼šç­–ç•¥åç§°ï¼Œè‡ªå®šä¹‰ \u0026quot;^all\\.\u0026quot;ï¼šåŒ¹é…æ‰€æœ‰ä»¥all.å¼€å¤´çš„é˜Ÿåˆ—å '{\u0026quot;ha-mode\u0026quot;:\u0026quot;all\u0026quot;}'ï¼šç­–ç•¥å†…å®¹ \u0026quot;ha-mode\u0026quot;:\u0026quot;all\u0026quot;ï¼šç­–ç•¥æ¨¡å¼ï¼Œæ­¤å¤„æ˜¯allæ¨¡å¼ï¼Œå³æ‰€æœ‰èŠ‚ç‚¹éƒ½ä¼šç§°ä¸ºé•œåƒèŠ‚ç‚¹ 4.2.3.nodesæ¨¡å¼ rabbitmqctl set_policy ha-nodes \u0026#34;^nodes\\.\u0026#34; \u0026#39;{\u0026#34;ha-mode\u0026#34;:\u0026#34;nodes\u0026#34;,\u0026#34;ha-params\u0026#34;:[\u0026#34;rabbit@nodeA\u0026#34;, \u0026#34;rabbit@nodeB\u0026#34;]}\u0026#39; rabbitmqctl set_policyï¼šå›ºå®šå†™æ³• ha-nodesï¼šç­–ç•¥åç§°ï¼Œè‡ªå®šä¹‰ \u0026quot;^nodes\\.\u0026quot;ï¼šåŒ¹é…é˜Ÿåˆ—çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œç¬¦åˆå‘½åè§„åˆ™çš„é˜Ÿåˆ—æ‰ç”Ÿæ•ˆï¼Œè¿™é‡Œæ˜¯ä»»ä½•ä»¥nodes.å¼€å¤´çš„é˜Ÿåˆ—åç§° '{\u0026quot;ha-mode\u0026quot;:\u0026quot;nodes\u0026quot;,\u0026quot;ha-params\u0026quot;:[\u0026quot;rabbit@nodeA\u0026quot;, \u0026quot;rabbit@nodeB\u0026quot;]}': ç­–ç•¥å†…å®¹ \u0026quot;ha-mode\u0026quot;:\u0026quot;nodes\u0026quot;ï¼šç­–ç•¥æ¨¡å¼ï¼Œæ­¤å¤„æ˜¯nodesæ¨¡å¼ \u0026quot;ha-params\u0026quot;:[\u0026quot;rabbit@mq1\u0026quot;, \u0026quot;rabbit@mq2\u0026quot;]ï¼šç­–ç•¥å‚æ•°ï¼Œè¿™é‡ŒæŒ‡å®šå‰¯æœ¬æ‰€åœ¨èŠ‚ç‚¹åç§° 4.3.æµ‹è¯• æˆ‘ä»¬ä½¿ç”¨exactlyæ¨¡å¼çš„é•œåƒï¼Œå› ä¸ºé›†ç¾¤èŠ‚ç‚¹æ•°é‡ä¸º3ï¼Œå› æ­¤é•œåƒæ•°é‡å°±è®¾ç½®ä¸º2.\nè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š\ndocker exec -it mq1 rabbitmqctl set_policy ha-two \u0026#34;^two\\.\u0026#34; \u0026#39;{\u0026#34;ha-mode\u0026#34;:\u0026#34;exactly\u0026#34;,\u0026#34;ha-params\u0026#34;:2,\u0026#34;ha-sync-mode\u0026#34;:\u0026#34;automatic\u0026#34;}\u0026#39; ä¸‹é¢ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„é˜Ÿåˆ—ï¼š\nåœ¨ä»»æ„ä¸€ä¸ªmqæ§åˆ¶å°æŸ¥çœ‹é˜Ÿåˆ—ï¼š\n4.3.1.æµ‹è¯•æ•°æ®å…±äº« ç»™two.queueå‘é€ä¸€æ¡æ¶ˆæ¯ï¼š\nç„¶ååœ¨mq1ã€mq2ã€mq3çš„ä»»æ„æ§åˆ¶å°æŸ¥çœ‹æ¶ˆæ¯ï¼š\n4.3.2.æµ‹è¯•é«˜å¯ç”¨ ç°åœ¨ï¼Œæˆ‘ä»¬è®©two.queueçš„ä¸»èŠ‚ç‚¹mq1å®•æœºï¼š\ndocker stop mq1 æŸ¥çœ‹é›†ç¾¤çŠ¶æ€ï¼š\næŸ¥çœ‹é˜Ÿåˆ—çŠ¶æ€ï¼š\nå‘ç°ä¾ç„¶æ˜¯å¥åº·çš„ï¼å¹¶ä¸”å…¶ä¸»èŠ‚ç‚¹åˆ‡æ¢åˆ°äº†rabbit@mq2ä¸Š\n5.ä»²è£é˜Ÿåˆ— ä»RabbitMQ 3.8ç‰ˆæœ¬å¼€å§‹ï¼Œå¼•å…¥äº†æ–°çš„ä»²è£é˜Ÿåˆ—ï¼Œä»–å…·å¤‡ä¸é•œåƒé˜Ÿé‡Œç±»ä¼¼çš„åŠŸèƒ½ï¼Œä½†ä½¿ç”¨æ›´åŠ æ–¹ä¾¿ã€‚\n5.1.æ·»åŠ ä»²è£é˜Ÿåˆ— åœ¨ä»»æ„æ§åˆ¶å°æ·»åŠ ä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¸€å®šè¦é€‰æ‹©é˜Ÿåˆ—ç±»å‹ä¸ºQuorumç±»å‹ã€‚\nåœ¨ä»»æ„æ§åˆ¶å°æŸ¥çœ‹é˜Ÿåˆ—ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œä»²è£é˜Ÿåˆ—çš„ + 2å­—æ ·ã€‚ä»£è¡¨è¿™ä¸ªé˜Ÿåˆ—æœ‰2ä¸ªé•œåƒèŠ‚ç‚¹ã€‚\nå› ä¸ºä»²è£é˜Ÿåˆ—é»˜è®¤çš„é•œåƒæ•°ä¸º5ã€‚å¦‚æœä½ çš„é›†ç¾¤æœ‰7ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆé•œåƒæ•°è‚¯å®šæ˜¯5ï¼›è€Œæˆ‘ä»¬é›†ç¾¤åªæœ‰3ä¸ªèŠ‚ç‚¹ï¼Œå› æ­¤é•œåƒæ•°é‡å°±æ˜¯3.\n5.2.æµ‹è¯• å¯ä»¥å‚è€ƒå¯¹é•œåƒé›†ç¾¤çš„æµ‹è¯•ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚\n5.3.é›†ç¾¤æ‰©å®¹ 5.3.1.åŠ å…¥é›†ç¾¤ 1ï¼‰å¯åŠ¨ä¸€ä¸ªæ–°çš„MQå®¹å™¨ï¼š\ndocker run -d --net mq-net \\ -v ${PWD}/.erlang.cookie:/var/lib/rabbitmq/.erlang.cookie \\ -e RABBITMQ_DEFAULT_USER=itcast \\ -e RABBITMQ_DEFAULT_PASS=123321 \\ --name mq4 \\ --hostname mq5 \\ -p 8074:15672 \\ -p 8084:15672 \\ rabbitmq:3.8-management 2ï¼‰è¿›å…¥å®¹å™¨æ§åˆ¶å°ï¼š\ndocker exec -it mq4 bash 3ï¼‰åœæ­¢mqè¿›ç¨‹\nrabbitmqctl stop_app 4ï¼‰é‡ç½®RabbitMQä¸­çš„æ•°æ®ï¼š\nrabbitmqctl reset 5ï¼‰åŠ å…¥mq1ï¼š\nrabbitmqctl join_cluster rabbit@mq1 6ï¼‰å†æ¬¡å¯åŠ¨mqè¿›ç¨‹\nrabbitmqctl start_app 5.3.2.å¢åŠ ä»²è£é˜Ÿåˆ—å‰¯æœ¬ æˆ‘ä»¬å…ˆæŸ¥çœ‹ä¸‹quorum.queueè¿™ä¸ªé˜Ÿåˆ—ç›®å‰çš„å‰¯æœ¬æƒ…å†µï¼Œè¿›å…¥mq1å®¹å™¨ï¼š\ndocker exec -it mq1 bash æ‰§è¡Œå‘½ä»¤ï¼š\nrabbitmq-queues quorum_status \u0026#34;quorum.queue\u0026#34; ç»“æœï¼š\nç°åœ¨ï¼Œæˆ‘ä»¬è®©mq4ä¹ŸåŠ å…¥è¿›æ¥ï¼š\nrabbitmq-queues add_member \u0026#34;quorum.queue\u0026#34; \u0026#34;rabbit@mq4\u0026#34; ç»“æœï¼š\nå†æ¬¡æŸ¥çœ‹ï¼š\nrabbitmq-queues quorum_status \u0026#34;quorum.queue\u0026#34; æŸ¥çœ‹æ§åˆ¶å°ï¼Œå‘ç°quorum.queueçš„é•œåƒæ•°é‡ä¹Ÿä»åŸæ¥çš„ +2 å˜æˆäº† +3ï¼š\n","permalink":"https://XianCH.github.io/posts/tech/distributed/rabbitmq%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97/","summary":"\u003ch1 id=\"1å•æœºéƒ¨ç½²\"\u003e1.å•æœºéƒ¨ç½²\u003c/h1\u003e\n\u003cp\u003eæˆ‘ä»¬åœ¨Centos7è™šæ‹Ÿæœºä¸­ä½¿ç”¨Dockeræ¥å®‰è£…ã€‚\u003c/p\u003e\n\u003ch2 id=\"11ä¸‹è½½é•œåƒ\"\u003e1.1.ä¸‹è½½é•œåƒ\u003c/h2\u003e\n\u003cp\u003eæ–¹å¼ä¸€ï¼šåœ¨çº¿æ‹‰å–\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker pull rabbitmq:3.8-management\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæ–¹å¼äºŒï¼šä»æœ¬åœ°åŠ è½½\u003c/p\u003e\n\u003cp\u003eåœ¨è¯¾å‰èµ„æ–™å·²ç»æä¾›äº†é•œåƒåŒ…ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"assets/image-20210423191210349.png\" alt=\"image-20210423191210349\"  /\u003e\n\u003c/p\u003e\n\u003cp\u003eä¸Šä¼ åˆ°è™šæ‹Ÿæœºä¸­åï¼Œä½¿ç”¨å‘½ä»¤åŠ è½½é•œåƒå³å¯ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker load -i mq.tar\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"12å®‰è£…mq\"\u003e1.2.å®‰è£…MQ\u003c/h2\u003e\n\u003cp\u003eæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¥è¿è¡ŒMQå®¹å™¨ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker run \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e -e RABBITMQ_DEFAULT_USER\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eitcast \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e -e RABBITMQ_DEFAULT_PASS\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e123321\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e -v mq-plugins:/plugins \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e --name mq \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e --hostname mq1 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e -p 15672:15672 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e -p 5672:5672 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e -d \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#ae81ff\"\u003e\u003c/span\u003e rabbitmq:3.8-management\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch1 id=\"2å®‰è£…delayexchangeæ’ä»¶\"\u003e2.å®‰è£…DelayExchangeæ’ä»¶\u003c/h1\u003e\n\u003cp\u003eå®˜æ–¹çš„å®‰è£…æŒ‡å—åœ°å€ä¸ºï¼šhttps://blog.rabbitmq.com/posts/2015/04/scheduling-messages-with-rabbitmq\u003c/p\u003e","title":"RabbitMqéƒ¨ç½²æŒ‡å—"},{"content":"æœåŠ¡å¼‚æ­¥é€šä¿¡-é«˜çº§ç¯‡ æ¶ˆæ¯é˜Ÿåˆ—åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œé¢ä¸´ç€å¾ˆå¤šå®é™…é—®é¢˜éœ€è¦æ€è€ƒï¼š\n1.æ¶ˆæ¯å¯é æ€§ æ¶ˆæ¯ä»å‘é€ï¼Œåˆ°æ¶ˆè´¹è€…æ¥æ”¶ï¼Œä¼šç»ç†å¤šä¸ªè¿‡ç¨‹ï¼š\nå…¶ä¸­çš„æ¯ä¸€æ­¥éƒ½å¯èƒ½å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ï¼Œå¸¸è§çš„ä¸¢å¤±åŸå› åŒ…æ‹¬ï¼š\nå‘é€æ—¶ä¸¢å¤±ï¼š ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯æœªé€è¾¾exchange æ¶ˆæ¯åˆ°è¾¾exchangeåæœªåˆ°è¾¾queue MQå®•æœºï¼Œqueueå°†æ¶ˆæ¯ä¸¢å¤± consumeræ¥æ”¶åˆ°æ¶ˆæ¯åæœªæ¶ˆè´¹å°±å®•æœº é’ˆå¯¹è¿™äº›é—®é¢˜ï¼ŒRabbitMQåˆ†åˆ«ç»™å‡ºäº†è§£å†³æ–¹æ¡ˆï¼š\nç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶ mqæŒä¹…åŒ– æ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶ å¤±è´¥é‡è¯•æœºåˆ¶ ä¸‹é¢æˆ‘ä»¬å°±é€šè¿‡æ¡ˆä¾‹æ¥æ¼”ç¤ºæ¯ä¸€ä¸ªæ­¥éª¤ã€‚\né¦–å…ˆï¼Œå¯¼å…¥è¯¾å‰èµ„æ–™æä¾›çš„demoå·¥ç¨‹ï¼š\né¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š\n1.1.ç”Ÿäº§è€…æ¶ˆæ¯ç¡®è®¤ RabbitMQæä¾›äº†publisher confirmæœºåˆ¶æ¥é¿å…æ¶ˆæ¯å‘é€åˆ°MQè¿‡ç¨‹ä¸­ä¸¢å¤±ã€‚è¿™ç§æœºåˆ¶å¿…é¡»ç»™æ¯ä¸ªæ¶ˆæ¯æŒ‡å®šä¸€ä¸ªå”¯ä¸€IDã€‚æ¶ˆæ¯å‘é€åˆ°MQä»¥åï¼Œä¼šè¿”å›ä¸€ä¸ªç»“æœç»™å‘é€è€…ï¼Œè¡¨ç¤ºæ¶ˆæ¯æ˜¯å¦å¤„ç†æˆåŠŸã€‚\nè¿”å›ç»“æœæœ‰ä¸¤ç§æ–¹å¼ï¼š\npublisher-confirmï¼Œå‘é€è€…ç¡®è®¤ æ¶ˆæ¯æˆåŠŸæŠ•é€’åˆ°äº¤æ¢æœºï¼Œè¿”å›ack æ¶ˆæ¯æœªæŠ•é€’åˆ°äº¤æ¢æœºï¼Œè¿”å›nack publisher-returnï¼Œå‘é€è€…å›æ‰§ æ¶ˆæ¯æŠ•é€’åˆ°äº¤æ¢æœºäº†ï¼Œä½†æ˜¯æ²¡æœ‰è·¯ç”±åˆ°é˜Ÿåˆ—ã€‚è¿”å›ACKï¼ŒåŠè·¯ç”±å¤±è´¥åŸå› ã€‚ æ³¨æ„ï¼š\n1.1.1.ä¿®æ”¹é…ç½® é¦–å…ˆï¼Œä¿®æ”¹publisheræœåŠ¡ä¸­çš„application.ymlæ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢çš„å†…å®¹ï¼š\nspring: rabbitmq: publisher-confirm-type: correlated publisher-returns: true template: mandatory: true è¯´æ˜ï¼š\npublish-confirm-typeï¼šå¼€å¯publisher-confirmï¼Œè¿™é‡Œæ”¯æŒä¸¤ç§ç±»å‹ï¼š simpleï¼šåŒæ­¥ç­‰å¾…confirmç»“æœï¼Œç›´åˆ°è¶…æ—¶ correlatedï¼šå¼‚æ­¥å›è°ƒï¼Œå®šä¹‰ConfirmCallbackï¼ŒMQè¿”å›ç»“æœæ—¶ä¼šå›è°ƒè¿™ä¸ªConfirmCallback publish-returnsï¼šå¼€å¯publish-returnåŠŸèƒ½ï¼ŒåŒæ ·æ˜¯åŸºäºcallbackæœºåˆ¶ï¼Œä¸è¿‡æ˜¯å®šä¹‰ReturnCallback template.mandatoryï¼šå®šä¹‰æ¶ˆæ¯è·¯ç”±å¤±è´¥æ—¶çš„ç­–ç•¥ã€‚trueï¼Œåˆ™è°ƒç”¨ReturnCallbackï¼›falseï¼šåˆ™ç›´æ¥ä¸¢å¼ƒæ¶ˆæ¯ 1.1.2.å®šä¹‰Returnå›è°ƒ æ¯ä¸ªRabbitTemplateåªèƒ½é…ç½®ä¸€ä¸ªReturnCallbackï¼Œå› æ­¤éœ€è¦åœ¨é¡¹ç›®åŠ è½½æ—¶é…ç½®ï¼š\nä¿®æ”¹publisheræœåŠ¡ï¼Œæ·»åŠ ä¸€ä¸ªï¼š\npackage cn.itcast.mq.config; import lombok.extern.slf4j.Slf4j; import org.springframework.amqp.rabbit.core.RabbitTemplate; import org.springframework.beans.BeansException; import org.springframework.context.ApplicationContext; import org.springframework.context.ApplicationContextAware; import org.springframework.context.annotation.Configuration; @Slf4j @Configuration public class CommonConfig implements ApplicationContextAware { @Override public void setApplicationContext(ApplicationContext applicationContext) throws BeansException { // è·å–RabbitTemplate RabbitTemplate rabbitTemplate = applicationContext.getBean(RabbitTemplate.class); // è®¾ç½®ReturnCallback rabbitTemplate.setReturnCallback((message, replyCode, replyText, exchange, routingKey) -\u0026gt; { // æŠ•é€’å¤±è´¥ï¼Œè®°å½•æ—¥å¿— log.info(\u0026#34;æ¶ˆæ¯å‘é€å¤±è´¥ï¼Œåº”ç­”ç {}ï¼ŒåŸå› {}ï¼Œäº¤æ¢æœº{}ï¼Œè·¯ç”±é”®{},æ¶ˆæ¯{}\u0026#34;, replyCode, replyText, exchange, routingKey, message.toString()); // å¦‚æœæœ‰ä¸šåŠ¡éœ€è¦ï¼Œå¯ä»¥é‡å‘æ¶ˆæ¯ }); } } 1.1.3.å®šä¹‰ConfirmCallback ConfirmCallbackå¯ä»¥åœ¨å‘é€æ¶ˆæ¯æ—¶æŒ‡å®šï¼Œå› ä¸ºæ¯ä¸ªä¸šåŠ¡å¤„ç†confirmæˆåŠŸæˆ–å¤±è´¥çš„é€»è¾‘ä¸ä¸€å®šç›¸åŒã€‚\nåœ¨publisheræœåŠ¡çš„cn.itcast.mq.spring.SpringAmqpTestç±»ä¸­ï¼Œå®šä¹‰ä¸€ä¸ªå•å…ƒæµ‹è¯•æ–¹æ³•ï¼š\npublic void testSendMessage2SimpleQueue() throws InterruptedException { // 1.æ¶ˆæ¯ä½“ String message = \u0026#34;hello, spring amqp!\u0026#34;; // 2.å…¨å±€å”¯ä¸€çš„æ¶ˆæ¯IDï¼Œéœ€è¦å°è£…åˆ°CorrelationDataä¸­ CorrelationData correlationData = new CorrelationData(UUID.randomUUID().toString()); // 3.æ·»åŠ callback correlationData.getFuture().addCallback( result -\u0026gt; { if(result.isAck()){ // 3.1.ackï¼Œæ¶ˆæ¯æˆåŠŸ log.debug(\u0026#34;æ¶ˆæ¯å‘é€æˆåŠŸ, ID:{}\u0026#34;, correlationData.getId()); }else{ // 3.2.nackï¼Œæ¶ˆæ¯å¤±è´¥ log.error(\u0026#34;æ¶ˆæ¯å‘é€å¤±è´¥, ID:{}, åŸå› {}\u0026#34;,correlationData.getId(), result.getReason()); } }, ex -\u0026gt; log.error(\u0026#34;æ¶ˆæ¯å‘é€å¼‚å¸¸, ID:{}, åŸå› {}\u0026#34;,correlationData.getId(),ex.getMessage()) ); // 4.å‘é€æ¶ˆæ¯ rabbitTemplate.convertAndSend(\u0026#34;task.direct\u0026#34;, \u0026#34;task\u0026#34;, message, correlationData); // ä¼‘çœ ä¸€ä¼šå„¿ï¼Œç­‰å¾…ackå›æ‰§ Thread.sleep(2000); } 1.2.æ¶ˆæ¯æŒä¹…åŒ– ç”Ÿäº§è€…ç¡®è®¤å¯ä»¥ç¡®ä¿æ¶ˆæ¯æŠ•é€’åˆ°RabbitMQçš„é˜Ÿåˆ—ä¸­ï¼Œä½†æ˜¯æ¶ˆæ¯å‘é€åˆ°RabbitMQä»¥åï¼Œå¦‚æœçªç„¶å®•æœºï¼Œä¹Ÿå¯èƒ½å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ã€‚\nè¦æƒ³ç¡®ä¿æ¶ˆæ¯åœ¨RabbitMQä¸­å®‰å…¨ä¿å­˜ï¼Œå¿…é¡»å¼€å¯æ¶ˆæ¯æŒä¹…åŒ–æœºåˆ¶ã€‚\näº¤æ¢æœºæŒä¹…åŒ– é˜Ÿåˆ—æŒä¹…åŒ– æ¶ˆæ¯æŒä¹…åŒ– 1.2.1.äº¤æ¢æœºæŒä¹…åŒ– RabbitMQä¸­äº¤æ¢æœºé»˜è®¤æ˜¯éæŒä¹…åŒ–çš„ï¼Œmqé‡å¯åå°±ä¸¢å¤±ã€‚\nSpringAMQPä¸­å¯ä»¥é€šè¿‡ä»£ç æŒ‡å®šäº¤æ¢æœºæŒä¹…åŒ–ï¼š\n@Bean public DirectExchange simpleExchange(){ // ä¸‰ä¸ªå‚æ•°ï¼šäº¤æ¢æœºåç§°ã€æ˜¯å¦æŒä¹…åŒ–ã€å½“æ²¡æœ‰queueä¸å…¶ç»‘å®šæ—¶æ˜¯å¦è‡ªåŠ¨åˆ é™¤ return new DirectExchange(\u0026#34;simple.direct\u0026#34;, true, false); } äº‹å®ä¸Šï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œç”±SpringAMQPå£°æ˜çš„äº¤æ¢æœºéƒ½æ˜¯æŒä¹…åŒ–çš„ã€‚\nå¯ä»¥åœ¨RabbitMQæ§åˆ¶å°çœ‹åˆ°æŒä¹…åŒ–çš„äº¤æ¢æœºéƒ½ä¼šå¸¦ä¸ŠDçš„æ ‡ç¤ºï¼š\n1.2.2.é˜Ÿåˆ—æŒä¹…åŒ– RabbitMQä¸­é˜Ÿåˆ—é»˜è®¤æ˜¯éæŒä¹…åŒ–çš„ï¼Œmqé‡å¯åå°±ä¸¢å¤±ã€‚\nSpringAMQPä¸­å¯ä»¥é€šè¿‡ä»£ç æŒ‡å®šäº¤æ¢æœºæŒä¹…åŒ–ï¼š\n@Bean public Queue simpleQueue(){ // ä½¿ç”¨QueueBuilderæ„å»ºé˜Ÿåˆ—ï¼Œdurableå°±æ˜¯æŒä¹…åŒ–çš„ return QueueBuilder.durable(\u0026#34;simple.queue\u0026#34;).build(); } äº‹å®ä¸Šï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œç”±SpringAMQPå£°æ˜çš„é˜Ÿåˆ—éƒ½æ˜¯æŒä¹…åŒ–çš„ã€‚\nå¯ä»¥åœ¨RabbitMQæ§åˆ¶å°çœ‹åˆ°æŒä¹…åŒ–çš„é˜Ÿåˆ—éƒ½ä¼šå¸¦ä¸ŠDçš„æ ‡ç¤ºï¼š\n1.2.3.æ¶ˆæ¯æŒä¹…åŒ– åˆ©ç”¨SpringAMQPå‘é€æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥è®¾ç½®æ¶ˆæ¯çš„å±æ€§ï¼ˆMessagePropertiesï¼‰ï¼ŒæŒ‡å®šdelivery-modeï¼š\n1ï¼šéæŒä¹…åŒ– 2ï¼šæŒä¹…åŒ– ç”¨javaä»£ç æŒ‡å®šï¼š\né»˜è®¤æƒ…å†µä¸‹ï¼ŒSpringAMQPå‘å‡ºçš„ä»»ä½•æ¶ˆæ¯éƒ½æ˜¯æŒä¹…åŒ–çš„ï¼Œä¸ç”¨ç‰¹æ„æŒ‡å®šã€‚\n1.3.æ¶ˆè´¹è€…æ¶ˆæ¯ç¡®è®¤ RabbitMQæ˜¯é˜…åå³ç„šæœºåˆ¶ï¼ŒRabbitMQç¡®è®¤æ¶ˆæ¯è¢«æ¶ˆè´¹è€…æ¶ˆè´¹åä¼šç«‹åˆ»åˆ é™¤ã€‚\nè€ŒRabbitMQæ˜¯é€šè¿‡æ¶ˆè´¹è€…å›æ‰§æ¥ç¡®è®¤æ¶ˆè´¹è€…æ˜¯å¦æˆåŠŸå¤„ç†æ¶ˆæ¯çš„ï¼šæ¶ˆè´¹è€…è·å–æ¶ˆæ¯åï¼Œåº”è¯¥å‘RabbitMQå‘é€ACKå›æ‰§ï¼Œè¡¨æ˜è‡ªå·±å·²ç»å¤„ç†æ¶ˆæ¯ã€‚\nè®¾æƒ³è¿™æ ·çš„åœºæ™¯ï¼š\n1ï¼‰RabbitMQæŠ•é€’æ¶ˆæ¯ç»™æ¶ˆè´¹è€… 2ï¼‰æ¶ˆè´¹è€…è·å–æ¶ˆæ¯åï¼Œè¿”å›ACKç»™RabbitMQ 3ï¼‰RabbitMQåˆ é™¤æ¶ˆæ¯ 4ï¼‰æ¶ˆè´¹è€…å®•æœºï¼Œæ¶ˆæ¯å°šæœªå¤„ç† è¿™æ ·ï¼Œæ¶ˆæ¯å°±ä¸¢å¤±äº†ã€‚å› æ­¤æ¶ˆè´¹è€…è¿”å›ACKçš„æ—¶æœºéå¸¸é‡è¦ã€‚\nè€ŒSpringAMQPåˆ™å…è®¸é…ç½®ä¸‰ç§ç¡®è®¤æ¨¡å¼ï¼š\nâ€¢manualï¼šæ‰‹åŠ¨ackï¼Œéœ€è¦åœ¨ä¸šåŠ¡ä»£ç ç»“æŸåï¼Œè°ƒç”¨apiå‘é€ackã€‚\nâ€¢autoï¼šè‡ªåŠ¨ackï¼Œç”±springç›‘æµ‹listenerä»£ç æ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œæ²¡æœ‰å¼‚å¸¸åˆ™è¿”å›ackï¼›æŠ›å‡ºå¼‚å¸¸åˆ™è¿”å›nack\nâ€¢noneï¼šå…³é—­ackï¼ŒMQå‡å®šæ¶ˆè´¹è€…è·å–æ¶ˆæ¯åä¼šæˆåŠŸå¤„ç†ï¼Œå› æ­¤æ¶ˆæ¯æŠ•é€’åç«‹å³è¢«åˆ é™¤\nç”±æ­¤å¯çŸ¥ï¼š\nnoneæ¨¡å¼ä¸‹ï¼Œæ¶ˆæ¯æŠ•é€’æ˜¯ä¸å¯é çš„ï¼Œå¯èƒ½ä¸¢å¤± autoæ¨¡å¼ç±»ä¼¼äº‹åŠ¡æœºåˆ¶ï¼Œå‡ºç°å¼‚å¸¸æ—¶è¿”å›nackï¼Œæ¶ˆæ¯å›æ»šåˆ°mqï¼›æ²¡æœ‰å¼‚å¸¸ï¼Œè¿”å›ack manualï¼šè‡ªå·±æ ¹æ®ä¸šåŠ¡æƒ…å†µï¼Œåˆ¤æ–­ä»€ä¹ˆæ—¶å€™è¯¥ack ä¸€èˆ¬ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨é»˜è®¤çš„autoå³å¯ã€‚\n1.3.1.æ¼”ç¤ºnoneæ¨¡å¼ ä¿®æ”¹consumeræœåŠ¡çš„application.ymlæ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢å†…å®¹ï¼š\nspring: rabbitmq: listener: simple: acknowledge-mode: none # å…³é—­ack ä¿®æ”¹consumeræœåŠ¡çš„SpringRabbitListenerç±»ä¸­çš„æ–¹æ³•ï¼Œæ¨¡æ‹Ÿä¸€ä¸ªæ¶ˆæ¯å¤„ç†å¼‚å¸¸ï¼š\n@RabbitListener(queues = \u0026#34;simple.queue\u0026#34;) public void listenSimpleQueue(String msg) { log.info(\u0026#34;æ¶ˆè´¹è€…æ¥æ”¶åˆ°simple.queueçš„æ¶ˆæ¯ï¼šã€{}ã€‘\u0026#34;, msg); // æ¨¡æ‹Ÿå¼‚å¸¸ System.out.println(1 / 0); log.debug(\u0026#34;æ¶ˆæ¯å¤„ç†å®Œæˆï¼\u0026#34;); } æµ‹è¯•å¯ä»¥å‘ç°ï¼Œå½“æ¶ˆæ¯å¤„ç†æŠ›å¼‚å¸¸æ—¶ï¼Œæ¶ˆæ¯ä¾ç„¶è¢«RabbitMQåˆ é™¤äº†ã€‚\n1.3.2.æ¼”ç¤ºautoæ¨¡å¼ å†æ¬¡æŠŠç¡®è®¤æœºåˆ¶ä¿®æ”¹ä¸ºauto:\nspring: rabbitmq: listener: simple: acknowledge-mode: auto # å…³é—­ack åœ¨å¼‚å¸¸ä½ç½®æ‰“æ–­ç‚¹ï¼Œå†æ¬¡å‘é€æ¶ˆæ¯ï¼Œç¨‹åºå¡åœ¨æ–­ç‚¹æ—¶ï¼Œå¯ä»¥å‘ç°æ­¤æ—¶æ¶ˆæ¯çŠ¶æ€ä¸ºunackï¼ˆæœªç¡®å®šçŠ¶æ€ï¼‰ï¼š\næŠ›å‡ºå¼‚å¸¸åï¼Œå› ä¸ºSpringä¼šè‡ªåŠ¨è¿”å›nackï¼Œæ‰€ä»¥æ¶ˆæ¯æ¢å¤è‡³ReadyçŠ¶æ€ï¼Œå¹¶ä¸”æ²¡æœ‰è¢«RabbitMQåˆ é™¤ï¼š\n1.4.æ¶ˆè´¹å¤±è´¥é‡è¯•æœºåˆ¶ å½“æ¶ˆè´¹è€…å‡ºç°å¼‚å¸¸åï¼Œæ¶ˆæ¯ä¼šä¸æ–­requeueï¼ˆé‡å…¥é˜Ÿï¼‰åˆ°é˜Ÿåˆ—ï¼Œå†é‡æ–°å‘é€ç»™æ¶ˆè´¹è€…ï¼Œç„¶åå†æ¬¡å¼‚å¸¸ï¼Œå†æ¬¡requeueï¼Œæ— é™å¾ªç¯ï¼Œå¯¼è‡´mqçš„æ¶ˆæ¯å¤„ç†é£™å‡ï¼Œå¸¦æ¥ä¸å¿…è¦çš„å‹åŠ›ï¼š\næ€ä¹ˆåŠå‘¢ï¼Ÿ\n1.4.1.æœ¬åœ°é‡è¯• æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Springçš„retryæœºåˆ¶ï¼Œåœ¨æ¶ˆè´¹è€…å‡ºç°å¼‚å¸¸æ—¶åˆ©ç”¨æœ¬åœ°é‡è¯•ï¼Œè€Œä¸æ˜¯æ— é™åˆ¶çš„requeueåˆ°mqé˜Ÿåˆ—ã€‚\nä¿®æ”¹consumeræœåŠ¡çš„application.ymlæ–‡ä»¶ï¼Œæ·»åŠ å†…å®¹ï¼š\nspring: rabbitmq: listener: simple: retry: enabled: true # å¼€å¯æ¶ˆè´¹è€…å¤±è´¥é‡è¯• initial-interval: 1000 # åˆè¯†çš„å¤±è´¥ç­‰å¾…æ—¶é•¿ä¸º1ç§’ multiplier: 1 # å¤±è´¥çš„ç­‰å¾…æ—¶é•¿å€æ•°ï¼Œä¸‹æ¬¡ç­‰å¾…æ—¶é•¿ = multiplier * last-interval max-attempts: 3 # æœ€å¤§é‡è¯•æ¬¡æ•° stateless: true # trueæ— çŠ¶æ€ï¼›falseæœ‰çŠ¶æ€ã€‚å¦‚æœä¸šåŠ¡ä¸­åŒ…å«äº‹åŠ¡ï¼Œè¿™é‡Œæ”¹ä¸ºfalse é‡å¯consumeræœåŠ¡ï¼Œé‡å¤ä¹‹å‰çš„æµ‹è¯•ã€‚å¯ä»¥å‘ç°ï¼š\nåœ¨é‡è¯•3æ¬¡åï¼ŒSpringAMQPä¼šæŠ›å‡ºå¼‚å¸¸AmqpRejectAndDontRequeueExceptionï¼Œè¯´æ˜æœ¬åœ°é‡è¯•è§¦å‘äº† æŸ¥çœ‹RabbitMQæ§åˆ¶å°ï¼Œå‘ç°æ¶ˆæ¯è¢«åˆ é™¤äº†ï¼Œè¯´æ˜æœ€åSpringAMQPè¿”å›çš„æ˜¯ackï¼Œmqåˆ é™¤æ¶ˆæ¯äº† ç»“è®ºï¼š\nå¼€å¯æœ¬åœ°é‡è¯•æ—¶ï¼Œæ¶ˆæ¯å¤„ç†è¿‡ç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œä¸ä¼šrequeueåˆ°é˜Ÿåˆ—ï¼Œè€Œæ˜¯åœ¨æ¶ˆè´¹è€…æœ¬åœ°é‡è¯• é‡è¯•è¾¾åˆ°æœ€å¤§æ¬¡æ•°åï¼ŒSpringä¼šè¿”å›ackï¼Œæ¶ˆæ¯ä¼šè¢«ä¸¢å¼ƒ 1.4.2.å¤±è´¥ç­–ç•¥ åœ¨ä¹‹å‰çš„æµ‹è¯•ä¸­ï¼Œè¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°åï¼Œæ¶ˆæ¯ä¼šè¢«ä¸¢å¼ƒï¼Œè¿™æ˜¯ç”±Springå†…éƒ¨æœºåˆ¶å†³å®šçš„ã€‚\nåœ¨å¼€å¯é‡è¯•æ¨¡å¼åï¼Œé‡è¯•æ¬¡æ•°è€—å°½ï¼Œå¦‚æœæ¶ˆæ¯ä¾ç„¶å¤±è´¥ï¼Œåˆ™éœ€è¦æœ‰MessageRecoveryæ¥å£æ¥å¤„ç†ï¼Œå®ƒåŒ…å«ä¸‰ç§ä¸åŒçš„å®ç°ï¼š\nRejectAndDontRequeueRecovererï¼šé‡è¯•è€—å°½åï¼Œç›´æ¥rejectï¼Œä¸¢å¼ƒæ¶ˆæ¯ã€‚é»˜è®¤å°±æ˜¯è¿™ç§æ–¹å¼\nImmediateRequeueMessageRecovererï¼šé‡è¯•è€—å°½åï¼Œè¿”å›nackï¼Œæ¶ˆæ¯é‡æ–°å…¥é˜Ÿ\nRepublishMessageRecovererï¼šé‡è¯•è€—å°½åï¼Œå°†å¤±è´¥æ¶ˆæ¯æŠ•é€’åˆ°æŒ‡å®šçš„äº¤æ¢æœº\næ¯”è¾ƒä¼˜é›…çš„ä¸€ç§å¤„ç†æ–¹æ¡ˆæ˜¯RepublishMessageRecovererï¼Œå¤±è´¥åå°†æ¶ˆæ¯æŠ•é€’åˆ°ä¸€ä¸ªæŒ‡å®šçš„ï¼Œä¸“é—¨å­˜æ”¾å¼‚å¸¸æ¶ˆæ¯çš„é˜Ÿåˆ—ï¼Œåç»­ç”±äººå·¥é›†ä¸­å¤„ç†ã€‚\n1ï¼‰åœ¨consumeræœåŠ¡ä¸­å®šä¹‰å¤„ç†å¤±è´¥æ¶ˆæ¯çš„äº¤æ¢æœºå’Œé˜Ÿåˆ—\n@Bean public DirectExchange errorMessageExchange(){ return new DirectExchange(\u0026#34;error.direct\u0026#34;); } @Bean public Queue errorQueue(){ return new Queue(\u0026#34;error.queue\u0026#34;, true); } @Bean public Binding errorBinding(Queue errorQueue, DirectExchange errorMessageExchange){ return BindingBuilder.bind(errorQueue).to(errorMessageExchange).with(\u0026#34;error\u0026#34;); } 2ï¼‰å®šä¹‰ä¸€ä¸ªRepublishMessageRecovererï¼Œå…³è”é˜Ÿåˆ—å’Œäº¤æ¢æœº\n@Bean public MessageRecoverer republishMessageRecoverer(RabbitTemplate rabbitTemplate){ return new RepublishMessageRecoverer(rabbitTemplate, \u0026#34;error.direct\u0026#34;, \u0026#34;error\u0026#34;); } å®Œæ•´ä»£ç ï¼š\npackage cn.itcast.mq.config; import org.springframework.amqp.core.Binding; import org.springframework.amqp.core.BindingBuilder; import org.springframework.amqp.core.DirectExchange; import org.springframework.amqp.core.Queue; import org.springframework.amqp.rabbit.core.RabbitTemplate; import org.springframework.amqp.rabbit.retry.MessageRecoverer; import org.springframework.amqp.rabbit.retry.RepublishMessageRecoverer; import org.springframework.context.annotation.Bean; @Configuration public class ErrorMessageConfig { @Bean public DirectExchange errorMessageExchange(){ return new DirectExchange(\u0026#34;error.direct\u0026#34;); } @Bean public Queue errorQueue(){ return new Queue(\u0026#34;error.queue\u0026#34;, true); } @Bean public Binding errorBinding(Queue errorQueue, DirectExchange errorMessageExchange){ return BindingBuilder.bind(errorQueue).to(errorMessageExchange).with(\u0026#34;error\u0026#34;); } @Bean public MessageRecoverer republishMessageRecoverer(RabbitTemplate rabbitTemplate){ return new RepublishMessageRecoverer(rabbitTemplate, \u0026#34;error.direct\u0026#34;, \u0026#34;error\u0026#34;); } } 1.5.æ€»ç»“ å¦‚ä½•ç¡®ä¿RabbitMQæ¶ˆæ¯çš„å¯é æ€§ï¼Ÿ\nå¼€å¯ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶ï¼Œç¡®ä¿ç”Ÿäº§è€…çš„æ¶ˆæ¯èƒ½åˆ°è¾¾é˜Ÿåˆ— å¼€å¯æŒä¹…åŒ–åŠŸèƒ½ï¼Œç¡®ä¿æ¶ˆæ¯æœªæ¶ˆè´¹å‰åœ¨é˜Ÿåˆ—ä¸­ä¸ä¼šä¸¢å¤± å¼€å¯æ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶ä¸ºautoï¼Œç”±springç¡®è®¤æ¶ˆæ¯å¤„ç†æˆåŠŸåå®Œæˆack å¼€å¯æ¶ˆè´¹è€…å¤±è´¥é‡è¯•æœºåˆ¶ï¼Œå¹¶è®¾ç½®MessageRecovererï¼Œå¤šæ¬¡é‡è¯•å¤±è´¥åå°†æ¶ˆæ¯æŠ•é€’åˆ°å¼‚å¸¸äº¤æ¢æœºï¼Œäº¤ç”±äººå·¥å¤„ç† 2.æ­»ä¿¡äº¤æ¢æœº 2.1.åˆè¯†æ­»ä¿¡äº¤æ¢æœº 2.1.1.ä»€ä¹ˆæ˜¯æ­»ä¿¡äº¤æ¢æœº ä»€ä¹ˆæ˜¯æ­»ä¿¡ï¼Ÿ\nå½“ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æ»¡è¶³ä¸‹åˆ—æƒ…å†µä¹‹ä¸€æ—¶ï¼Œå¯ä»¥æˆä¸ºæ­»ä¿¡ï¼ˆdead letterï¼‰ï¼š\næ¶ˆè´¹è€…ä½¿ç”¨basic.rejectæˆ– basic.nackå£°æ˜æ¶ˆè´¹å¤±è´¥ï¼Œå¹¶ä¸”æ¶ˆæ¯çš„requeueå‚æ•°è®¾ç½®ä¸ºfalse æ¶ˆæ¯æ˜¯ä¸€ä¸ªè¿‡æœŸæ¶ˆæ¯ï¼Œè¶…æ—¶æ— äººæ¶ˆè´¹ è¦æŠ•é€’çš„é˜Ÿåˆ—æ¶ˆæ¯æ»¡äº†ï¼Œæ— æ³•æŠ•é€’ å¦‚æœè¿™ä¸ªåŒ…å«æ­»ä¿¡çš„é˜Ÿåˆ—é…ç½®äº†dead-letter-exchangeå±æ€§ï¼ŒæŒ‡å®šäº†ä¸€ä¸ªäº¤æ¢æœºï¼Œé‚£ä¹ˆé˜Ÿåˆ—ä¸­çš„æ­»ä¿¡å°±ä¼šæŠ•é€’åˆ°è¿™ä¸ªäº¤æ¢æœºä¸­ï¼Œè€Œè¿™ä¸ªäº¤æ¢æœºç§°ä¸ºæ­»ä¿¡äº¤æ¢æœºï¼ˆDead Letter Exchangeï¼Œæ£€æŸ¥DLXï¼‰ã€‚\nå¦‚å›¾ï¼Œä¸€ä¸ªæ¶ˆæ¯è¢«æ¶ˆè´¹è€…æ‹’ç»äº†ï¼Œå˜æˆäº†æ­»ä¿¡ï¼š\nå› ä¸ºsimple.queueç»‘å®šäº†æ­»ä¿¡äº¤æ¢æœº dl.directï¼Œå› æ­¤æ­»ä¿¡ä¼šæŠ•é€’ç»™è¿™ä¸ªäº¤æ¢æœºï¼š\nå¦‚æœè¿™ä¸ªæ­»ä¿¡äº¤æ¢æœºä¹Ÿç»‘å®šäº†ä¸€ä¸ªé˜Ÿåˆ—ï¼Œåˆ™æ¶ˆæ¯æœ€ç»ˆä¼šè¿›å…¥è¿™ä¸ªå­˜æ”¾æ­»ä¿¡çš„é˜Ÿåˆ—ï¼š\nå¦å¤–ï¼Œé˜Ÿåˆ—å°†æ­»ä¿¡æŠ•é€’ç»™æ­»ä¿¡äº¤æ¢æœºæ—¶ï¼Œå¿…é¡»çŸ¥é“ä¸¤ä¸ªä¿¡æ¯ï¼š\næ­»ä¿¡äº¤æ¢æœºåç§° æ­»ä¿¡äº¤æ¢æœºä¸æ­»ä¿¡é˜Ÿåˆ—ç»‘å®šçš„RoutingKey è¿™æ ·æ‰èƒ½ç¡®ä¿æŠ•é€’çš„æ¶ˆæ¯èƒ½åˆ°è¾¾æ­»ä¿¡äº¤æ¢æœºï¼Œå¹¶ä¸”æ­£ç¡®çš„è·¯ç”±åˆ°æ­»ä¿¡é˜Ÿåˆ—ã€‚\n2.1.2.åˆ©ç”¨æ­»ä¿¡äº¤æ¢æœºæ¥æ”¶æ­»ä¿¡ï¼ˆæ‹“å±•ï¼‰ åœ¨å¤±è´¥é‡è¯•ç­–ç•¥ä¸­ï¼Œé»˜è®¤çš„RejectAndDontRequeueRecovererä¼šåœ¨æœ¬åœ°é‡è¯•æ¬¡æ•°è€—å°½åï¼Œå‘é€rejectç»™RabbitMQï¼Œæ¶ˆæ¯å˜æˆæ­»ä¿¡ï¼Œè¢«ä¸¢å¼ƒã€‚\næˆ‘ä»¬å¯ä»¥ç»™simple.queueæ·»åŠ ä¸€ä¸ªæ­»ä¿¡äº¤æ¢æœºï¼Œç»™æ­»ä¿¡äº¤æ¢æœºç»‘å®šä¸€ä¸ªé˜Ÿåˆ—ã€‚è¿™æ ·æ¶ˆæ¯å˜æˆæ­»ä¿¡åä¹Ÿä¸ä¼šä¸¢å¼ƒï¼Œè€Œæ˜¯æœ€ç»ˆæŠ•é€’åˆ°æ­»ä¿¡äº¤æ¢æœºï¼Œè·¯ç”±åˆ°ä¸æ­»ä¿¡äº¤æ¢æœºç»‘å®šçš„é˜Ÿåˆ—ã€‚\næˆ‘ä»¬åœ¨consumeræœåŠ¡ä¸­ï¼Œå®šä¹‰ä¸€ç»„æ­»ä¿¡äº¤æ¢æœºã€æ­»ä¿¡é˜Ÿåˆ—ï¼š\n// å£°æ˜æ™®é€šçš„ simple.queueé˜Ÿåˆ—ï¼Œå¹¶ä¸”ä¸ºå…¶æŒ‡å®šæ­»ä¿¡äº¤æ¢æœºï¼šdl.direct @Bean public Queue simpleQueue2(){ return QueueBuilder.durable(\u0026#34;simple.queue\u0026#34;) // æŒ‡å®šé˜Ÿåˆ—åç§°ï¼Œå¹¶æŒä¹…åŒ– .deadLetterExchange(\u0026#34;dl.direct\u0026#34;) // æŒ‡å®šæ­»ä¿¡äº¤æ¢æœº .build(); } // å£°æ˜æ­»ä¿¡äº¤æ¢æœº dl.direct @Bean public DirectExchange dlExchange(){ return new DirectExchange(\u0026#34;dl.direct\u0026#34;, true, false); } // å£°æ˜å­˜å‚¨æ­»ä¿¡çš„é˜Ÿåˆ— dl.queue @Bean public Queue dlQueue(){ return new Queue(\u0026#34;dl.queue\u0026#34;, true); } // å°†æ­»ä¿¡é˜Ÿåˆ— ä¸ æ­»ä¿¡äº¤æ¢æœºç»‘å®š @Bean public Binding dlBinding(){ return BindingBuilder.bind(dlQueue()).to(dlExchange()).with(\u0026#34;simple\u0026#34;); } 2.1.3.æ€»ç»“ ä»€ä¹ˆæ ·çš„æ¶ˆæ¯ä¼šæˆä¸ºæ­»ä¿¡ï¼Ÿ\næ¶ˆæ¯è¢«æ¶ˆè´¹è€…rejectæˆ–è€…è¿”å›nack æ¶ˆæ¯è¶…æ—¶æœªæ¶ˆè´¹ é˜Ÿåˆ—æ»¡äº† æ­»ä¿¡äº¤æ¢æœºçš„ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ\nå¦‚æœé˜Ÿåˆ—ç»‘å®šäº†æ­»ä¿¡äº¤æ¢æœºï¼Œæ­»ä¿¡ä¼šæŠ•é€’åˆ°æ­»ä¿¡äº¤æ¢æœºï¼› å¯ä»¥åˆ©ç”¨æ­»ä¿¡äº¤æ¢æœºæ”¶é›†æ‰€æœ‰æ¶ˆè´¹è€…å¤„ç†å¤±è´¥çš„æ¶ˆæ¯ï¼ˆæ­»ä¿¡ï¼‰ï¼Œäº¤ç”±äººå·¥å¤„ç†ï¼Œè¿›ä¸€æ­¥æé«˜æ¶ˆæ¯é˜Ÿåˆ—çš„å¯é æ€§ã€‚ 2.2.TTL ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å¦‚æœè¶…æ—¶æœªæ¶ˆè´¹ï¼Œåˆ™ä¼šå˜ä¸ºæ­»ä¿¡ï¼Œè¶…æ—¶åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š\næ¶ˆæ¯æ‰€åœ¨çš„é˜Ÿåˆ—è®¾ç½®äº†è¶…æ—¶æ—¶é—´ æ¶ˆæ¯æœ¬èº«è®¾ç½®äº†è¶…æ—¶æ—¶é—´ 2.2.1.æ¥æ”¶è¶…æ—¶æ­»ä¿¡çš„æ­»ä¿¡äº¤æ¢æœº åœ¨consumeræœåŠ¡çš„SpringRabbitListenerä¸­ï¼Œå®šä¹‰ä¸€ä¸ªæ–°çš„æ¶ˆè´¹è€…ï¼Œå¹¶ä¸”å£°æ˜ æ­»ä¿¡äº¤æ¢æœºã€æ­»ä¿¡é˜Ÿåˆ—ï¼š\n@RabbitListener(bindings = @QueueBinding( value = @Queue(name = \u0026#34;dl.ttl.queue\u0026#34;, durable = \u0026#34;true\u0026#34;), exchange = @Exchange(name = \u0026#34;dl.ttl.direct\u0026#34;), key = \u0026#34;ttl\u0026#34; )) public void listenDlQueue(String msg){ log.info(\u0026#34;æ¥æ”¶åˆ° dl.ttl.queueçš„å»¶è¿Ÿæ¶ˆæ¯ï¼š{}\u0026#34;, msg); } 2.2.2.å£°æ˜ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¹¶ä¸”æŒ‡å®šTTL è¦ç»™é˜Ÿåˆ—è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œéœ€è¦åœ¨å£°æ˜é˜Ÿåˆ—æ—¶é…ç½®x-message-ttlå±æ€§ï¼š\n@Bean public Queue ttlQueue(){ return QueueBuilder.durable(\u0026#34;ttl.queue\u0026#34;) // æŒ‡å®šé˜Ÿåˆ—åç§°ï¼Œå¹¶æŒä¹…åŒ– .ttl(10000) // è®¾ç½®é˜Ÿåˆ—çš„è¶…æ—¶æ—¶é—´ï¼Œ10ç§’ .deadLetterExchange(\u0026#34;dl.ttl.direct\u0026#34;) // æŒ‡å®šæ­»ä¿¡äº¤æ¢æœº .build(); } æ³¨æ„ï¼Œè¿™ä¸ªé˜Ÿåˆ—è®¾å®šäº†æ­»ä¿¡äº¤æ¢æœºä¸ºdl.ttl.direct\nå£°æ˜äº¤æ¢æœºï¼Œå°†ttlä¸äº¤æ¢æœºç»‘å®šï¼š\n@Bean public DirectExchange ttlExchange(){ return new DirectExchange(\u0026#34;ttl.direct\u0026#34;); } @Bean public Binding ttlBinding(){ return BindingBuilder.bind(ttlQueue()).to(ttlExchange()).with(\u0026#34;ttl\u0026#34;); } å‘é€æ¶ˆæ¯ï¼Œä½†æ˜¯ä¸è¦æŒ‡å®šTTLï¼š\n@Test public void testTTLQueue() { // åˆ›å»ºæ¶ˆæ¯ String message = \u0026#34;hello, ttl queue\u0026#34;; // æ¶ˆæ¯IDï¼Œéœ€è¦å°è£…åˆ°CorrelationDataä¸­ CorrelationData correlationData = new CorrelationData(UUID.randomUUID().toString()); // å‘é€æ¶ˆæ¯ rabbitTemplate.convertAndSend(\u0026#34;ttl.direct\u0026#34;, \u0026#34;ttl\u0026#34;, message, correlationData); // è®°å½•æ—¥å¿— log.debug(\u0026#34;å‘é€æ¶ˆæ¯æˆåŠŸ\u0026#34;); } å‘é€æ¶ˆæ¯çš„æ—¥å¿—ï¼š\næŸ¥çœ‹ä¸‹æ¥æ”¶æ¶ˆæ¯çš„æ—¥å¿—ï¼š\nå› ä¸ºé˜Ÿåˆ—çš„TTLå€¼æ˜¯10000msï¼Œä¹Ÿå°±æ˜¯10ç§’ã€‚å¯ä»¥çœ‹åˆ°æ¶ˆæ¯å‘é€ä¸æ¥æ”¶ä¹‹é—´çš„æ—¶å·®åˆšå¥½æ˜¯10ç§’ã€‚\n2.2.3.å‘é€æ¶ˆæ¯æ—¶ï¼Œè®¾å®šTTL åœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šTTLï¼š\n@Test public void testTTLMsg() { // åˆ›å»ºæ¶ˆæ¯ Message message = MessageBuilder .withBody(\u0026#34;hello, ttl message\u0026#34;.getBytes(StandardCharsets.UTF_8)) .setExpiration(\u0026#34;5000\u0026#34;) .build(); // æ¶ˆæ¯IDï¼Œéœ€è¦å°è£…åˆ°CorrelationDataä¸­ CorrelationData correlationData = new CorrelationData(UUID.randomUUID().toString()); // å‘é€æ¶ˆæ¯ rabbitTemplate.convertAndSend(\u0026#34;ttl.direct\u0026#34;, \u0026#34;ttl\u0026#34;, message, correlationData); log.debug(\u0026#34;å‘é€æ¶ˆæ¯æˆåŠŸ\u0026#34;); } æŸ¥çœ‹å‘é€æ¶ˆæ¯æ—¥å¿—ï¼š\næ¥æ”¶æ¶ˆæ¯æ—¥å¿—ï¼š\nè¿™æ¬¡ï¼Œå‘é€ä¸æ¥æ”¶çš„å»¶è¿Ÿåªæœ‰5ç§’ã€‚è¯´æ˜å½“é˜Ÿåˆ—ã€æ¶ˆæ¯éƒ½è®¾ç½®äº†TTLæ—¶ï¼Œä»»æ„ä¸€ä¸ªåˆ°æœŸå°±ä¼šæˆä¸ºæ­»ä¿¡ã€‚\n2.2.4.æ€»ç»“ æ¶ˆæ¯è¶…æ—¶çš„ä¸¤ç§æ–¹å¼æ˜¯ï¼Ÿ\nç»™é˜Ÿåˆ—è®¾ç½®ttlå±æ€§ï¼Œè¿›å…¥é˜Ÿåˆ—åè¶…è¿‡ttlæ—¶é—´çš„æ¶ˆæ¯å˜ä¸ºæ­»ä¿¡ ç»™æ¶ˆæ¯è®¾ç½®ttlå±æ€§ï¼Œé˜Ÿåˆ—æ¥æ”¶åˆ°æ¶ˆæ¯è¶…è¿‡ttlæ—¶é—´åå˜ä¸ºæ­»ä¿¡ å¦‚ä½•å®ç°å‘é€ä¸€ä¸ªæ¶ˆæ¯20ç§’åæ¶ˆè´¹è€…æ‰æ”¶åˆ°æ¶ˆæ¯ï¼Ÿ\nç»™æ¶ˆæ¯çš„ç›®æ ‡é˜Ÿåˆ—æŒ‡å®šæ­»ä¿¡äº¤æ¢æœº å°†æ¶ˆè´¹è€…ç›‘å¬çš„é˜Ÿåˆ—ç»‘å®šåˆ°æ­»ä¿¡äº¤æ¢æœº å‘é€æ¶ˆæ¯æ—¶ç»™æ¶ˆæ¯è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º20ç§’ 2.3.å»¶è¿Ÿé˜Ÿåˆ— åˆ©ç”¨TTLç»“åˆæ­»ä¿¡äº¤æ¢æœºï¼Œæˆ‘ä»¬å®ç°äº†æ¶ˆæ¯å‘å‡ºåï¼Œæ¶ˆè´¹è€…å»¶è¿Ÿæ”¶åˆ°æ¶ˆæ¯çš„æ•ˆæœã€‚è¿™ç§æ¶ˆæ¯æ¨¡å¼å°±ç§°ä¸ºå»¶è¿Ÿé˜Ÿåˆ—ï¼ˆDelay Queueï¼‰æ¨¡å¼ã€‚\nå»¶è¿Ÿé˜Ÿåˆ—çš„ä½¿ç”¨åœºæ™¯åŒ…æ‹¬ï¼š\nå»¶è¿Ÿå‘é€çŸ­ä¿¡ ç”¨æˆ·ä¸‹å•ï¼Œå¦‚æœç”¨æˆ·åœ¨15 åˆ†é’Ÿå†…æœªæ”¯ä»˜ï¼Œåˆ™è‡ªåŠ¨å–æ¶ˆ é¢„çº¦å·¥ä½œä¼šè®®ï¼Œ20åˆ†é’Ÿåè‡ªåŠ¨é€šçŸ¥æ‰€æœ‰å‚ä¼šäººå‘˜ å› ä¸ºå»¶è¿Ÿé˜Ÿåˆ—çš„éœ€æ±‚éå¸¸å¤šï¼Œæ‰€ä»¥RabbitMQçš„å®˜æ–¹ä¹Ÿæ¨å‡ºäº†ä¸€ä¸ªæ’ä»¶ï¼ŒåŸç”Ÿæ”¯æŒå»¶è¿Ÿé˜Ÿåˆ—æ•ˆæœã€‚\nè¿™ä¸ªæ’ä»¶å°±æ˜¯DelayExchangeæ’ä»¶ã€‚å‚è€ƒRabbitMQçš„æ’ä»¶åˆ—è¡¨é¡µé¢ï¼šhttps://www.rabbitmq.com/community-plugins.html\nä½¿ç”¨æ–¹å¼å¯ä»¥å‚è€ƒå®˜ç½‘åœ°å€ï¼šhttps://blog.rabbitmq.com/posts/2015/04/scheduling-messages-with-rabbitmq\n2.3.1.å®‰è£…DelayExchangeæ’ä»¶ å‚è€ƒè¯¾å‰èµ„æ–™ï¼š\n2.3.2.DelayExchangeåŸç† DelayExchangeéœ€è¦å°†ä¸€ä¸ªäº¤æ¢æœºå£°æ˜ä¸ºdelayedç±»å‹ã€‚å½“æˆ‘ä»¬å‘é€æ¶ˆæ¯åˆ°delayExchangeæ—¶ï¼Œæµç¨‹å¦‚ä¸‹ï¼š\næ¥æ”¶æ¶ˆæ¯ åˆ¤æ–­æ¶ˆæ¯æ˜¯å¦å…·å¤‡x-delayå±æ€§ å¦‚æœæœ‰x-delayå±æ€§ï¼Œè¯´æ˜æ˜¯å»¶è¿Ÿæ¶ˆæ¯ï¼ŒæŒä¹…åŒ–åˆ°ç¡¬ç›˜ï¼Œè¯»å–x-delayå€¼ï¼Œä½œä¸ºå»¶è¿Ÿæ—¶é—´ è¿”å›routing not foundç»“æœç»™æ¶ˆæ¯å‘é€è€… x-delayæ—¶é—´åˆ°æœŸåï¼Œé‡æ–°æŠ•é€’æ¶ˆæ¯åˆ°æŒ‡å®šé˜Ÿåˆ— 2.3.3.ä½¿ç”¨DelayExchange æ’ä»¶çš„ä½¿ç”¨ä¹Ÿéå¸¸ç®€å•ï¼šå£°æ˜ä¸€ä¸ªäº¤æ¢æœºï¼Œäº¤æ¢æœºçš„ç±»å‹å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œåªéœ€è¦è®¾å®šdelayedå±æ€§ä¸ºtrueå³å¯ï¼Œç„¶åå£°æ˜é˜Ÿåˆ—ä¸å…¶ç»‘å®šå³å¯ã€‚\n1ï¼‰å£°æ˜DelayExchangeäº¤æ¢æœº åŸºäºæ³¨è§£æ–¹å¼ï¼ˆæ¨èï¼‰ï¼š\nä¹Ÿå¯ä»¥åŸºäº@Beançš„æ–¹å¼ï¼š\n2ï¼‰å‘é€æ¶ˆæ¯ å‘é€æ¶ˆæ¯æ—¶ï¼Œä¸€å®šè¦æºå¸¦x-delayå±æ€§ï¼ŒæŒ‡å®šå»¶è¿Ÿçš„æ—¶é—´ï¼š\n2.3.4.æ€»ç»“ å»¶è¿Ÿé˜Ÿåˆ—æ’ä»¶çš„ä½¿ç”¨æ­¥éª¤åŒ…æ‹¬å“ªäº›ï¼Ÿ\nâ€¢å£°æ˜ä¸€ä¸ªäº¤æ¢æœºï¼Œæ·»åŠ delayedå±æ€§ä¸ºtrue\nâ€¢å‘é€æ¶ˆæ¯æ—¶ï¼Œæ·»åŠ x-delayå¤´ï¼Œå€¼ä¸ºè¶…æ—¶æ—¶é—´\n3.æƒ°æ€§é˜Ÿåˆ— 3.1.æ¶ˆæ¯å †ç§¯é—®é¢˜ å½“ç”Ÿäº§è€…å‘é€æ¶ˆæ¯çš„é€Ÿåº¦è¶…è¿‡äº†æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯çš„é€Ÿåº¦ï¼Œå°±ä¼šå¯¼è‡´é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å †ç§¯ï¼Œç›´åˆ°é˜Ÿåˆ—å­˜å‚¨æ¶ˆæ¯è¾¾åˆ°ä¸Šé™ã€‚ä¹‹åå‘é€çš„æ¶ˆæ¯å°±ä¼šæˆä¸ºæ­»ä¿¡ï¼Œå¯èƒ½ä¼šè¢«ä¸¢å¼ƒï¼Œè¿™å°±æ˜¯æ¶ˆæ¯å †ç§¯é—®é¢˜ã€‚\nè§£å†³æ¶ˆæ¯å †ç§¯æœ‰ä¸¤ç§æ€è·¯ï¼š\nå¢åŠ æ›´å¤šæ¶ˆè´¹è€…ï¼Œæé«˜æ¶ˆè´¹é€Ÿåº¦ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰è¯´çš„work queueæ¨¡å¼ æ‰©å¤§é˜Ÿåˆ—å®¹ç§¯ï¼Œæé«˜å †ç§¯ä¸Šé™ è¦æå‡é˜Ÿåˆ—å®¹ç§¯ï¼ŒæŠŠæ¶ˆæ¯ä¿å­˜åœ¨å†…å­˜ä¸­æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ã€‚\n3.2.æƒ°æ€§é˜Ÿåˆ— ä»RabbitMQçš„3.6.0ç‰ˆæœ¬å¼€å§‹ï¼Œå°±å¢åŠ äº†Lazy Queuesçš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯æƒ°æ€§é˜Ÿåˆ—ã€‚æƒ°æ€§é˜Ÿåˆ—çš„ç‰¹å¾å¦‚ä¸‹ï¼š\næ¥æ”¶åˆ°æ¶ˆæ¯åç›´æ¥å­˜å…¥ç£ç›˜è€Œéå†…å­˜ æ¶ˆè´¹è€…è¦æ¶ˆè´¹æ¶ˆæ¯æ—¶æ‰ä¼šä»ç£ç›˜ä¸­è¯»å–å¹¶åŠ è½½åˆ°å†…å­˜ æ”¯æŒæ•°ç™¾ä¸‡æ¡çš„æ¶ˆæ¯å­˜å‚¨ 3.2.1.åŸºäºå‘½ä»¤è¡Œè®¾ç½®lazy-queue è€Œè¦è®¾ç½®ä¸€ä¸ªé˜Ÿåˆ—ä¸ºæƒ°æ€§é˜Ÿåˆ—ï¼Œåªéœ€è¦åœ¨å£°æ˜é˜Ÿåˆ—æ—¶ï¼ŒæŒ‡å®šx-queue-modeå±æ€§ä¸ºlazyå³å¯ã€‚å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå°†ä¸€ä¸ªè¿è¡Œä¸­çš„é˜Ÿåˆ—ä¿®æ”¹ä¸ºæƒ°æ€§é˜Ÿåˆ—ï¼š\nrabbitmqctl set_policy Lazy \u0026#34;^lazy-queue$\u0026#34; \u0026#39;{\u0026#34;queue-mode\u0026#34;:\u0026#34;lazy\u0026#34;}\u0026#39; --apply-to queues å‘½ä»¤è§£è¯»ï¼š\nrabbitmqctl ï¼šRabbitMQçš„å‘½ä»¤è¡Œå·¥å…· set_policy ï¼šæ·»åŠ ä¸€ä¸ªç­–ç•¥ Lazy ï¼šç­–ç•¥åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰ \u0026quot;^lazy-queue$\u0026quot; ï¼šç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…é˜Ÿåˆ—çš„åå­— '{\u0026quot;queue-mode\u0026quot;:\u0026quot;lazy\u0026quot;}' ï¼šè®¾ç½®é˜Ÿåˆ—æ¨¡å¼ä¸ºlazyæ¨¡å¼ --apply-to queues ï¼šç­–ç•¥çš„ä½œç”¨å¯¹è±¡ï¼Œæ˜¯æ‰€æœ‰çš„é˜Ÿåˆ— 3.2.2.åŸºäº@Beanå£°æ˜lazy-queue 3.2.3.åŸºäº@RabbitListenerå£°æ˜LazyQueue 3.3.æ€»ç»“ æ¶ˆæ¯å †ç§¯é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Ÿ\né˜Ÿåˆ—ä¸Šç»‘å®šå¤šä¸ªæ¶ˆè´¹è€…ï¼Œæé«˜æ¶ˆè´¹é€Ÿåº¦ ä½¿ç”¨æƒ°æ€§é˜Ÿåˆ—ï¼Œå¯ä»¥å†mqä¸­ä¿å­˜æ›´å¤šæ¶ˆæ¯ æƒ°æ€§é˜Ÿåˆ—çš„ä¼˜ç‚¹æœ‰å“ªäº›ï¼Ÿ\nåŸºäºç£ç›˜å­˜å‚¨ï¼Œæ¶ˆæ¯ä¸Šé™é«˜ æ²¡æœ‰é—´æ­‡æ€§çš„page-outï¼Œæ€§èƒ½æ¯”è¾ƒç¨³å®š æƒ°æ€§é˜Ÿåˆ—çš„ç¼ºç‚¹æœ‰å“ªäº›ï¼Ÿ\nåŸºäºç£ç›˜å­˜å‚¨ï¼Œæ¶ˆæ¯æ—¶æ•ˆæ€§ä¼šé™ä½ æ€§èƒ½å—é™äºç£ç›˜çš„IO 4.MQé›†ç¾¤ 4.1.é›†ç¾¤åˆ†ç±» RabbitMQçš„æ˜¯åŸºäºErlangè¯­è¨€ç¼–å†™ï¼Œè€ŒErlangåˆæ˜¯ä¸€ä¸ªé¢å‘å¹¶å‘çš„è¯­è¨€ï¼Œå¤©ç„¶æ”¯æŒé›†ç¾¤æ¨¡å¼ã€‚RabbitMQçš„é›†ç¾¤æœ‰ä¸¤ç§æ¨¡å¼ï¼š\nâ€¢æ™®é€šé›†ç¾¤ï¼šæ˜¯ä¸€ç§åˆ†å¸ƒå¼é›†ç¾¤ï¼Œå°†é˜Ÿåˆ—åˆ†æ•£åˆ°é›†ç¾¤çš„å„ä¸ªèŠ‚ç‚¹ï¼Œä»è€Œæé«˜æ•´ä¸ªé›†ç¾¤çš„å¹¶å‘èƒ½åŠ›ã€‚\nâ€¢é•œåƒé›†ç¾¤ï¼šæ˜¯ä¸€ç§ä¸»ä»é›†ç¾¤ï¼Œæ™®é€šé›†ç¾¤çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ äº†ä¸»ä»å¤‡ä»½åŠŸèƒ½ï¼Œæé«˜é›†ç¾¤çš„æ•°æ®å¯ç”¨æ€§ã€‚\né•œåƒé›†ç¾¤è™½ç„¶æ”¯æŒä¸»ä»ï¼Œä½†ä¸»ä»åŒæ­¥å¹¶ä¸æ˜¯å¼ºä¸€è‡´çš„ï¼ŒæŸäº›æƒ…å†µä¸‹å¯èƒ½æœ‰æ•°æ®ä¸¢å¤±çš„é£é™©ã€‚å› æ­¤åœ¨RabbitMQçš„3.8ç‰ˆæœ¬ä»¥åï¼Œæ¨å‡ºäº†æ–°çš„åŠŸèƒ½ï¼šä»²è£é˜Ÿåˆ—æ¥ä»£æ›¿é•œåƒé›†ç¾¤ï¼Œåº•å±‚é‡‡ç”¨Raftåè®®ç¡®ä¿ä¸»ä»çš„æ•°æ®ä¸€è‡´æ€§ã€‚\n4.2.æ™®é€šé›†ç¾¤ 4.2.1.é›†ç¾¤ç»“æ„å’Œç‰¹å¾ æ™®é€šé›†ç¾¤ï¼Œæˆ–è€…å«æ ‡å‡†é›†ç¾¤ï¼ˆclassic clusterï¼‰ï¼Œå…·å¤‡ä¸‹åˆ—ç‰¹å¾ï¼š\nä¼šåœ¨é›†ç¾¤çš„å„ä¸ªèŠ‚ç‚¹é—´å…±äº«éƒ¨åˆ†æ•°æ®ï¼ŒåŒ…æ‹¬ï¼šäº¤æ¢æœºã€é˜Ÿåˆ—å…ƒä¿¡æ¯ã€‚ä¸åŒ…å«é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ã€‚ å½“è®¿é—®é›†ç¾¤æŸèŠ‚ç‚¹æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—ä¸åœ¨è¯¥èŠ‚ç‚¹ï¼Œä¼šä»æ•°æ®æ‰€åœ¨èŠ‚ç‚¹ä¼ é€’åˆ°å½“å‰èŠ‚ç‚¹å¹¶è¿”å› é˜Ÿåˆ—æ‰€åœ¨èŠ‚ç‚¹å®•æœºï¼Œé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å°±ä¼šä¸¢å¤± ç»“æ„å¦‚å›¾ï¼š\n4.2.2.éƒ¨ç½² å‚è€ƒè¯¾å‰èµ„æ–™ï¼šã€ŠRabbitMQéƒ¨ç½²æŒ‡å—.mdã€‹\n4.3.é•œåƒé›†ç¾¤ 4.3.1.é›†ç¾¤ç»“æ„å’Œç‰¹å¾ é•œåƒé›†ç¾¤ï¼šæœ¬è´¨æ˜¯ä¸»ä»æ¨¡å¼ï¼Œå…·å¤‡ä¸‹é¢çš„ç‰¹å¾ï¼š\näº¤æ¢æœºã€é˜Ÿåˆ—ã€é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ä¼šåœ¨å„ä¸ªmqçš„é•œåƒèŠ‚ç‚¹ä¹‹é—´åŒæ­¥å¤‡ä»½ã€‚ åˆ›å»ºé˜Ÿåˆ—çš„èŠ‚ç‚¹è¢«ç§°ä¸ºè¯¥é˜Ÿåˆ—çš„ä¸»èŠ‚ç‚¹ï¼Œå¤‡ä»½åˆ°çš„å…¶å®ƒèŠ‚ç‚¹å«åšè¯¥é˜Ÿåˆ—çš„é•œåƒèŠ‚ç‚¹ã€‚ ä¸€ä¸ªé˜Ÿåˆ—çš„ä¸»èŠ‚ç‚¹å¯èƒ½æ˜¯å¦ä¸€ä¸ªé˜Ÿåˆ—çš„é•œåƒèŠ‚ç‚¹ æ‰€æœ‰æ“ä½œéƒ½æ˜¯ä¸»èŠ‚ç‚¹å®Œæˆï¼Œç„¶ååŒæ­¥ç»™é•œåƒèŠ‚ç‚¹ ä¸»å®•æœºåï¼Œé•œåƒèŠ‚ç‚¹ä¼šæ›¿ä»£æˆæ–°çš„ä¸» ç»“æ„å¦‚å›¾ï¼š\n4.3.2.éƒ¨ç½² å‚è€ƒè¯¾å‰èµ„æ–™ï¼šã€ŠRabbitMQéƒ¨ç½²æŒ‡å—.mdã€‹\n4.4.ä»²è£é˜Ÿåˆ— 4.4.1.é›†ç¾¤ç‰¹å¾ ä»²è£é˜Ÿåˆ—ï¼šä»²è£é˜Ÿåˆ—æ˜¯3.8ç‰ˆæœ¬ä»¥åæ‰æœ‰çš„æ–°åŠŸèƒ½ï¼Œç”¨æ¥æ›¿ä»£é•œåƒé˜Ÿåˆ—ï¼Œå…·å¤‡ä¸‹åˆ—ç‰¹å¾ï¼š\nä¸é•œåƒé˜Ÿåˆ—ä¸€æ ·ï¼Œéƒ½æ˜¯ä¸»ä»æ¨¡å¼ï¼Œæ”¯æŒä¸»ä»æ•°æ®åŒæ­¥ ä½¿ç”¨éå¸¸ç®€å•ï¼Œæ²¡æœ‰å¤æ‚çš„é…ç½® ä¸»ä»åŒæ­¥åŸºäºRaftåè®®ï¼Œå¼ºä¸€è‡´ 4.4.2.éƒ¨ç½² å‚è€ƒè¯¾å‰èµ„æ–™ï¼šã€ŠRabbitMQéƒ¨ç½²æŒ‡å—.mdã€‹\n4.4.3.Javaä»£ç åˆ›å»ºä»²è£é˜Ÿåˆ— @Bean public Queue quorumQueue() { return QueueBuilder .durable(\u0026#34;quorum.queue\u0026#34;) // æŒä¹…åŒ– .quorum() // ä»²è£é˜Ÿåˆ— .build(); } 4.4.4.SpringAMQPè¿æ¥MQé›†ç¾¤ æ³¨æ„ï¼Œè¿™é‡Œç”¨addressæ¥ä»£æ›¿hostã€portæ–¹å¼\nspring: rabbitmq: addresses: 192.168.150.105:8071, 192.168.150.105:8072, 192.168.150.105:8073 username: itcast password: 123321 virtual-host: / ","permalink":"https://XianCH.github.io/posts/tech/distributed/rabbitmq-2/","summary":"\u003ch1 id=\"æœåŠ¡å¼‚æ­¥é€šä¿¡-é«˜çº§ç¯‡\"\u003eæœåŠ¡å¼‚æ­¥é€šä¿¡-é«˜çº§ç¯‡\u003c/h1\u003e\n\u003cp\u003eæ¶ˆæ¯é˜Ÿåˆ—åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œé¢ä¸´ç€å¾ˆå¤šå®é™…é—®é¢˜éœ€è¦æ€è€ƒï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"assets/image-20210718155003157.png\" alt=\"image-20210718155003157\"  /\u003e\n\u003c/p\u003e\n\u003ch1 id=\"1æ¶ˆæ¯å¯é æ€§\"\u003e1.æ¶ˆæ¯å¯é æ€§\u003c/h1\u003e\n\u003cp\u003eæ¶ˆæ¯ä»å‘é€ï¼Œåˆ°æ¶ˆè´¹è€…æ¥æ”¶ï¼Œä¼šç»ç†å¤šä¸ªè¿‡ç¨‹ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"assets/image-20210718155059371.png\" alt=\"image-20210718155059371\"  /\u003e\n\u003c/p\u003e\n\u003cp\u003eå…¶ä¸­çš„æ¯ä¸€æ­¥éƒ½å¯èƒ½å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ï¼Œå¸¸è§çš„ä¸¢å¤±åŸå› åŒ…æ‹¬ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå‘é€æ—¶ä¸¢å¤±ï¼š\n\u003cul\u003e\n\u003cli\u003eç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯æœªé€è¾¾exchange\u003c/li\u003e\n\u003cli\u003eæ¶ˆæ¯åˆ°è¾¾exchangeåæœªåˆ°è¾¾queue\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eMQå®•æœºï¼Œqueueå°†æ¶ˆæ¯ä¸¢å¤±\u003c/li\u003e\n\u003cli\u003econsumeræ¥æ”¶åˆ°æ¶ˆæ¯åæœªæ¶ˆè´¹å°±å®•æœº\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eé’ˆå¯¹è¿™äº›é—®é¢˜ï¼ŒRabbitMQåˆ†åˆ«ç»™å‡ºäº†è§£å†³æ–¹æ¡ˆï¼š\u003c/p\u003e","title":"RabbitMq-2"},{"content":"RabbitMQ 1.åˆè¯†MQ 1.1.åŒæ­¥å’Œå¼‚æ­¥é€šè®¯ å¾®æœåŠ¡é—´é€šè®¯æœ‰åŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§æ–¹å¼ï¼š\nåŒæ­¥é€šè®¯ï¼šå°±åƒæ‰“ç”µè¯ï¼Œéœ€è¦å®æ—¶å“åº”ã€‚\nå¼‚æ­¥é€šè®¯ï¼šå°±åƒå‘é‚®ä»¶ï¼Œä¸éœ€è¦é©¬ä¸Šå›å¤ã€‚\nä¸¤ç§æ–¹å¼å„æœ‰ä¼˜åŠ£ï¼Œæ‰“ç”µè¯å¯ä»¥ç«‹å³å¾—åˆ°å“åº”ï¼Œä½†æ˜¯ä½ å´ä¸èƒ½è·Ÿå¤šä¸ªäººåŒæ—¶é€šè¯ã€‚å‘é€é‚®ä»¶å¯ä»¥åŒæ—¶ä¸å¤šä¸ªäººæ”¶å‘é‚®ä»¶ï¼Œä½†æ˜¯å¾€å¾€å“åº”ä¼šæœ‰å»¶è¿Ÿã€‚\n1.1.1.åŒæ­¥é€šè®¯ æˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„Feignè°ƒç”¨å°±å±äºåŒæ­¥æ–¹å¼ï¼Œè™½ç„¶è°ƒç”¨å¯ä»¥å®æ—¶å¾—åˆ°ç»“æœï¼Œä½†å­˜åœ¨ä¸‹é¢çš„é—®é¢˜ï¼š\næ€»ç»“ï¼š\nåŒæ­¥è°ƒç”¨çš„ä¼˜ç‚¹ï¼š\næ—¶æ•ˆæ€§è¾ƒå¼ºï¼Œå¯ä»¥ç«‹å³å¾—åˆ°ç»“æœ åŒæ­¥è°ƒç”¨çš„é—®é¢˜ï¼š\nè€¦åˆåº¦é«˜ æ€§èƒ½å’Œååèƒ½åŠ›ä¸‹é™ æœ‰é¢å¤–çš„èµ„æºæ¶ˆè€— æœ‰çº§è”å¤±è´¥é—®é¢˜ 1.1.2.å¼‚æ­¥é€šè®¯ å¼‚æ­¥è°ƒç”¨åˆ™å¯ä»¥é¿å…ä¸Šè¿°é—®é¢˜ï¼š\næˆ‘ä»¬ä»¥è´­ä¹°å•†å“ä¸ºä¾‹ï¼Œç”¨æˆ·æ”¯ä»˜åéœ€è¦è°ƒç”¨è®¢å•æœåŠ¡å®Œæˆè®¢å•çŠ¶æ€ä¿®æ”¹ï¼Œè°ƒç”¨ç‰©æµæœåŠ¡ï¼Œä»ä»“åº“åˆ†é…å“åº”çš„åº“å­˜å¹¶å‡†å¤‡å‘è´§ã€‚\nåœ¨äº‹ä»¶æ¨¡å¼ä¸­ï¼Œæ”¯ä»˜æœåŠ¡æ˜¯äº‹ä»¶å‘å¸ƒè€…ï¼ˆpublisherï¼‰ï¼Œåœ¨æ”¯ä»˜å®Œæˆååªéœ€è¦å‘å¸ƒä¸€ä¸ªæ”¯ä»˜æˆåŠŸçš„äº‹ä»¶ï¼ˆeventï¼‰ï¼Œäº‹ä»¶ä¸­å¸¦ä¸Šè®¢å•idã€‚\nè®¢å•æœåŠ¡å’Œç‰©æµæœåŠ¡æ˜¯äº‹ä»¶è®¢é˜…è€…ï¼ˆConsumerï¼‰ï¼Œè®¢é˜…æ”¯ä»˜æˆåŠŸçš„äº‹ä»¶ï¼Œç›‘å¬åˆ°äº‹ä»¶åå®Œæˆè‡ªå·±ä¸šåŠ¡å³å¯ã€‚\nä¸ºäº†è§£é™¤äº‹ä»¶å‘å¸ƒè€…ä¸è®¢é˜…è€…ä¹‹é—´çš„è€¦åˆï¼Œä¸¤è€…å¹¶ä¸æ˜¯ç›´æ¥é€šä¿¡ï¼Œè€Œæ˜¯æœ‰ä¸€ä¸ªä¸­é—´äººï¼ˆBrokerï¼‰ã€‚å‘å¸ƒè€…å‘å¸ƒäº‹ä»¶åˆ°Brokerï¼Œä¸å…³å¿ƒè°æ¥è®¢é˜…äº‹ä»¶ã€‚è®¢é˜…è€…ä»Brokerè®¢é˜…äº‹ä»¶ï¼Œä¸å…³å¿ƒè°å‘æ¥çš„æ¶ˆæ¯ã€‚\nBroker æ˜¯ä¸€ä¸ªåƒæ•°æ®æ€»çº¿ä¸€æ ·çš„ä¸œè¥¿ï¼Œæ‰€æœ‰çš„æœåŠ¡è¦æ¥æ”¶æ•°æ®å’Œå‘é€æ•°æ®éƒ½å‘åˆ°è¿™ä¸ªæ€»çº¿ä¸Šï¼Œè¿™ä¸ªæ€»çº¿å°±åƒåè®®ä¸€æ ·ï¼Œè®©æœåŠ¡é—´çš„é€šè®¯å˜å¾—æ ‡å‡†å’Œå¯æ§ã€‚\nå¥½å¤„ï¼š\nååé‡æå‡ï¼šæ— éœ€ç­‰å¾…è®¢é˜…è€…å¤„ç†å®Œæˆï¼Œå“åº”æ›´å¿«é€Ÿ\næ•…éšœéš”ç¦»ï¼šæœåŠ¡æ²¡æœ‰ç›´æ¥è°ƒç”¨ï¼Œä¸å­˜åœ¨çº§è”å¤±è´¥é—®é¢˜\nè°ƒç”¨é—´æ²¡æœ‰é˜»å¡ï¼Œä¸ä¼šé€ æˆæ— æ•ˆçš„èµ„æºå ç”¨\nè€¦åˆåº¦æä½ï¼Œæ¯ä¸ªæœåŠ¡éƒ½å¯ä»¥çµæ´»æ’æ‹”ï¼Œå¯æ›¿æ¢\næµé‡å‰Šå³°ï¼šä¸ç®¡å‘å¸ƒäº‹ä»¶çš„æµé‡æ³¢åŠ¨å¤šå¤§ï¼Œéƒ½ç”±Brokeræ¥æ”¶ï¼Œè®¢é˜…è€…å¯ä»¥æŒ‰ç…§è‡ªå·±çš„é€Ÿåº¦å»å¤„ç†äº‹ä»¶\nç¼ºç‚¹ï¼š\næ¶æ„å¤æ‚äº†ï¼Œä¸šåŠ¡æ²¡æœ‰æ˜æ˜¾çš„æµç¨‹çº¿ï¼Œä¸å¥½ç®¡ç† éœ€è¦ä¾èµ–äºBrokerçš„å¯é ã€å®‰å…¨ã€æ€§èƒ½ å¥½åœ¨ç°åœ¨å¼€æºè½¯ä»¶æˆ–äº‘å¹³å°ä¸Š Broker çš„è½¯ä»¶æ˜¯éå¸¸æˆç†Ÿçš„ï¼Œæ¯”è¾ƒå¸¸è§çš„ä¸€ç§å°±æ˜¯æˆ‘ä»¬ä»Šå¤©è¦å­¦ä¹ çš„MQæŠ€æœ¯ã€‚\n1.2.æŠ€æœ¯å¯¹æ¯”ï¼š MQï¼Œä¸­æ–‡æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessageQueueï¼‰ï¼Œå­—é¢æ¥çœ‹å°±æ˜¯å­˜æ”¾æ¶ˆæ¯çš„é˜Ÿåˆ—ã€‚ä¹Ÿå°±æ˜¯äº‹ä»¶é©±åŠ¨æ¶æ„ä¸­çš„Brokerã€‚\næ¯”è¾ƒå¸¸è§çš„MQå®ç°ï¼š\nActiveMQ RabbitMQ RocketMQ Kafka å‡ ç§å¸¸è§MQçš„å¯¹æ¯”ï¼š\nRabbitMQ ActiveMQ RocketMQ Kafka å…¬å¸/ç¤¾åŒº Rabbit Apache é˜¿é‡Œ Apache å¼€å‘è¯­è¨€ Erlang Java Java Scala\u0026amp;Java åè®®æ”¯æŒ AMQPï¼ŒXMPPï¼ŒSMTPï¼ŒSTOMP OpenWire,STOMPï¼ŒREST,XMPP,AMQP è‡ªå®šä¹‰åè®® è‡ªå®šä¹‰åè®® å¯ç”¨æ€§ é«˜ ä¸€èˆ¬ é«˜ é«˜ å•æœºååé‡ ä¸€èˆ¬ å·® é«˜ éå¸¸é«˜ æ¶ˆæ¯å»¶è¿Ÿ å¾®ç§’çº§ æ¯«ç§’çº§ æ¯«ç§’çº§ æ¯«ç§’ä»¥å†… æ¶ˆæ¯å¯é æ€§ é«˜ ä¸€èˆ¬ é«˜ ä¸€èˆ¬ è¿½æ±‚å¯ç”¨æ€§ï¼šKafkaã€ RocketMQ ã€RabbitMQ\nè¿½æ±‚å¯é æ€§ï¼šRabbitMQã€RocketMQ\nè¿½æ±‚ååèƒ½åŠ›ï¼šRocketMQã€Kafka\nè¿½æ±‚æ¶ˆæ¯ä½å»¶è¿Ÿï¼šRabbitMQã€Kafka\n2.å¿«é€Ÿå…¥é—¨ 2.1.å®‰è£…RabbitMQ å®‰è£…RabbitMQï¼Œå‚è€ƒè¯¾å‰èµ„æ–™ï¼š\nMQçš„åŸºæœ¬ç»“æ„ï¼š\nRabbitMQä¸­çš„ä¸€äº›è§’è‰²ï¼š\npublisherï¼šç”Ÿäº§è€… consumerï¼šæ¶ˆè´¹è€… exchangeä¸ªï¼šäº¤æ¢æœºï¼Œè´Ÿè´£æ¶ˆæ¯è·¯ç”± queueï¼šé˜Ÿåˆ—ï¼Œå­˜å‚¨æ¶ˆæ¯ virtualHostï¼šè™šæ‹Ÿä¸»æœºï¼Œéš”ç¦»ä¸åŒç§Ÿæˆ·çš„exchangeã€queueã€æ¶ˆæ¯çš„éš”ç¦» 2.2.RabbitMQæ¶ˆæ¯æ¨¡å‹ RabbitMQå®˜æ–¹æä¾›äº†5ä¸ªä¸åŒçš„Demoç¤ºä¾‹ï¼Œå¯¹åº”äº†ä¸åŒçš„æ¶ˆæ¯æ¨¡å‹ï¼š\n2.3.å¯¼å…¥Demoå·¥ç¨‹ è¯¾å‰èµ„æ–™æä¾›äº†ä¸€ä¸ªDemoå·¥ç¨‹ï¼Œmq-demo:\nå¯¼å…¥åå¯ä»¥çœ‹åˆ°ç»“æ„å¦‚ä¸‹ï¼š\nåŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼š\nmq-demoï¼šçˆ¶å·¥ç¨‹ï¼Œç®¡ç†é¡¹ç›®ä¾èµ– publisherï¼šæ¶ˆæ¯çš„å‘é€è€… consumerï¼šæ¶ˆæ¯çš„æ¶ˆè´¹è€… 2.4.å…¥é—¨æ¡ˆä¾‹ ç®€å•é˜Ÿåˆ—æ¨¡å¼çš„æ¨¡å‹å›¾ï¼š\nå®˜æ–¹çš„HelloWorldæ˜¯åŸºäºæœ€åŸºç¡€çš„æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å‹æ¥å®ç°çš„ï¼ŒåªåŒ…æ‹¬ä¸‰ä¸ªè§’è‰²ï¼š\npublisherï¼šæ¶ˆæ¯å‘å¸ƒè€…ï¼Œå°†æ¶ˆæ¯å‘é€åˆ°é˜Ÿåˆ—queue queueï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼Œè´Ÿè´£æ¥å—å¹¶ç¼“å­˜æ¶ˆæ¯ consumerï¼šè®¢é˜…é˜Ÿåˆ—ï¼Œå¤„ç†é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ 2.4.1.publisherå®ç° æ€è·¯ï¼š\nå»ºç«‹è¿æ¥ åˆ›å»ºChannel å£°æ˜é˜Ÿåˆ— å‘é€æ¶ˆæ¯ å…³é—­è¿æ¥å’Œchannel ä»£ç å®ç°ï¼š\npackage cn.itcast.mq.helloworld; import com.rabbitmq.client.Channel; import com.rabbitmq.client.Connection; import com.rabbitmq.client.ConnectionFactory; import org.junit.Test; import java.io.IOException; import java.util.concurrent.TimeoutException; public class PublisherTest { @Test public void testSendMessage() throws IOException, TimeoutException { // 1.å»ºç«‹è¿æ¥ ConnectionFactory factory = new ConnectionFactory(); // 1.1.è®¾ç½®è¿æ¥å‚æ•°ï¼Œåˆ†åˆ«æ˜¯ï¼šä¸»æœºåã€ç«¯å£å·ã€vhostã€ç”¨æˆ·åã€å¯†ç  factory.setHost(\u0026#34;192.168.150.101\u0026#34;); factory.setPort(5672); factory.setVirtualHost(\u0026#34;/\u0026#34;); factory.setUsername(\u0026#34;itcast\u0026#34;); factory.setPassword(\u0026#34;123321\u0026#34;); // 1.2.å»ºç«‹è¿æ¥ Connection connection = factory.newConnection(); // 2.åˆ›å»ºé€šé“Channel Channel channel = connection.createChannel(); // 3.åˆ›å»ºé˜Ÿåˆ— String queueName = \u0026#34;simple.queue\u0026#34;; channel.queueDeclare(queueName, false, false, false, null); // 4.å‘é€æ¶ˆæ¯ String message = \u0026#34;hello, rabbitmq!\u0026#34;; channel.basicPublish(\u0026#34;\u0026#34;, queueName, null, message.getBytes()); System.out.println(\u0026#34;å‘é€æ¶ˆæ¯æˆåŠŸï¼šã€\u0026#34; + message + \u0026#34;ã€‘\u0026#34;); // 5.å…³é—­é€šé“å’Œè¿æ¥ channel.close(); connection.close(); } } 2.4.2.consumerå®ç° ä»£ç æ€è·¯ï¼š\nå»ºç«‹è¿æ¥ åˆ›å»ºChannel å£°æ˜é˜Ÿåˆ— è®¢é˜…æ¶ˆæ¯ ä»£ç å®ç°ï¼š\npackage cn.itcast.mq.helloworld; import com.rabbitmq.client.*; import java.io.IOException; import java.util.concurrent.TimeoutException; public class ConsumerTest { public static void main(String[] args) throws IOException, TimeoutException { // 1.å»ºç«‹è¿æ¥ ConnectionFactory factory = new ConnectionFactory(); // 1.1.è®¾ç½®è¿æ¥å‚æ•°ï¼Œåˆ†åˆ«æ˜¯ï¼šä¸»æœºåã€ç«¯å£å·ã€vhostã€ç”¨æˆ·åã€å¯†ç  factory.setHost(\u0026#34;192.168.150.101\u0026#34;); factory.setPort(5672); factory.setVirtualHost(\u0026#34;/\u0026#34;); factory.setUsername(\u0026#34;itcast\u0026#34;); factory.setPassword(\u0026#34;123321\u0026#34;); // 1.2.å»ºç«‹è¿æ¥ Connection connection = factory.newConnection(); // 2.åˆ›å»ºé€šé“Channel Channel channel = connection.createChannel(); // 3.åˆ›å»ºé˜Ÿåˆ— String queueName = \u0026#34;simple.queue\u0026#34;; channel.queueDeclare(queueName, false, false, false, null); // 4.è®¢é˜…æ¶ˆæ¯ channel.basicConsume(queueName, true, new DefaultConsumer(channel){ @Override public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, byte[] body) throws IOException { // 5.å¤„ç†æ¶ˆæ¯ String message = new String(body); System.out.println(\u0026#34;æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€\u0026#34; + message + \u0026#34;ã€‘\u0026#34;); } }); System.out.println(\u0026#34;ç­‰å¾…æ¥æ”¶æ¶ˆæ¯ã€‚ã€‚ã€‚ã€‚\u0026#34;); } } 2.5.æ€»ç»“ åŸºæœ¬æ¶ˆæ¯é˜Ÿåˆ—çš„æ¶ˆæ¯å‘é€æµç¨‹ï¼š\nå»ºç«‹connection\nåˆ›å»ºchannel\nåˆ©ç”¨channelå£°æ˜é˜Ÿåˆ—\nåˆ©ç”¨channelå‘é˜Ÿåˆ—å‘é€æ¶ˆæ¯\nåŸºæœ¬æ¶ˆæ¯é˜Ÿåˆ—çš„æ¶ˆæ¯æ¥æ”¶æµç¨‹ï¼š\nå»ºç«‹connection\nåˆ›å»ºchannel\nåˆ©ç”¨channelå£°æ˜é˜Ÿåˆ—\nå®šä¹‰consumerçš„æ¶ˆè´¹è¡Œä¸ºhandleDelivery()\nåˆ©ç”¨channelå°†æ¶ˆè´¹è€…ä¸é˜Ÿåˆ—ç»‘å®š\n3.SpringAMQP SpringAMQPæ˜¯åŸºäºRabbitMQå°è£…çš„ä¸€å¥—æ¨¡æ¿ï¼Œå¹¶ä¸”è¿˜åˆ©ç”¨SpringBootå¯¹å…¶å®ç°äº†è‡ªåŠ¨è£…é…ï¼Œä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚\nSpringAmqpçš„å®˜æ–¹åœ°å€ï¼šhttps://spring.io/projects/spring-amqp\nSpringAMQPæä¾›äº†ä¸‰ä¸ªåŠŸèƒ½ï¼š\nè‡ªåŠ¨å£°æ˜é˜Ÿåˆ—ã€äº¤æ¢æœºåŠå…¶ç»‘å®šå…³ç³» åŸºäºæ³¨è§£çš„ç›‘å¬å™¨æ¨¡å¼ï¼Œå¼‚æ­¥æ¥æ”¶æ¶ˆæ¯ å°è£…äº†RabbitTemplateå·¥å…·ï¼Œç”¨äºå‘é€æ¶ˆæ¯ 3.1.Basic Queue ç®€å•é˜Ÿåˆ—æ¨¡å‹ åœ¨çˆ¶å·¥ç¨‹mq-demoä¸­å¼•å…¥ä¾èµ–\n\u0026lt;!--AMQPä¾èµ–ï¼ŒåŒ…å«RabbitMQ--\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-amqp\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; 3.1.1.æ¶ˆæ¯å‘é€ é¦–å…ˆé…ç½®MQåœ°å€ï¼Œåœ¨publisheræœåŠ¡çš„application.ymlä¸­æ·»åŠ é…ç½®ï¼š\nspring: rabbitmq: host: 192.168.150.101 # ä¸»æœºå port: 5672 # ç«¯å£ virtual-host: / # è™šæ‹Ÿä¸»æœº username: itcast # ç”¨æˆ·å password: 123321 # å¯†ç  ç„¶ååœ¨publisheræœåŠ¡ä¸­ç¼–å†™æµ‹è¯•ç±»SpringAmqpTestï¼Œå¹¶åˆ©ç”¨RabbitTemplateå®ç°æ¶ˆæ¯å‘é€ï¼š\npackage cn.itcast.mq.spring; import org.junit.Test; import org.junit.runner.RunWith; import org.springframework.amqp.rabbit.core.RabbitTemplate; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.boot.test.context.SpringBootTest; import org.springframework.test.context.junit4.SpringRunner; @RunWith(SpringRunner.class) @SpringBootTest public class SpringAmqpTest { @Autowired private RabbitTemplate rabbitTemplate; @Test public void testSimpleQueue() { // é˜Ÿåˆ—åç§° String queueName = \u0026#34;simple.queue\u0026#34;; // æ¶ˆæ¯ String message = \u0026#34;hello, spring amqp!\u0026#34;; // å‘é€æ¶ˆæ¯ rabbitTemplate.convertAndSend(queueName, message); } } 3.1.2.æ¶ˆæ¯æ¥æ”¶ é¦–å…ˆé…ç½®MQåœ°å€ï¼Œåœ¨consumeræœåŠ¡çš„application.ymlä¸­æ·»åŠ é…ç½®ï¼š\nspring: rabbitmq: host: 192.168.150.101 # ä¸»æœºå port: 5672 # ç«¯å£ virtual-host: / # è™šæ‹Ÿä¸»æœº username: itcast # ç”¨æˆ·å password: 123321 # å¯†ç  ç„¶ååœ¨consumeræœåŠ¡çš„cn.itcast.mq.listeneråŒ…ä¸­æ–°å»ºä¸€ä¸ªç±»SpringRabbitListenerï¼Œä»£ç å¦‚ä¸‹ï¼š\npackage cn.itcast.mq.listener; import org.springframework.amqp.rabbit.annotation.RabbitListener; import org.springframework.stereotype.Component; @Component public class SpringRabbitListener { @RabbitListener(queues = \u0026#34;simple.queue\u0026#34;) public void listenSimpleQueueMessage(String msg) throws InterruptedException { System.out.println(\u0026#34;spring æ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€\u0026#34; + msg + \u0026#34;ã€‘\u0026#34;); } } 3.1.3.æµ‹è¯• å¯åŠ¨consumeræœåŠ¡ï¼Œç„¶ååœ¨publisheræœåŠ¡ä¸­è¿è¡Œæµ‹è¯•ä»£ç ï¼Œå‘é€MQæ¶ˆæ¯\n3.2.WorkQueue Work queuesï¼Œä¹Ÿè¢«ç§°ä¸ºï¼ˆTask queuesï¼‰ï¼Œä»»åŠ¡æ¨¡å‹ã€‚ç®€å•æ¥è¯´å°±æ˜¯è®©å¤šä¸ªæ¶ˆè´¹è€…ç»‘å®šåˆ°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå…±åŒæ¶ˆè´¹é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ã€‚\nå½“æ¶ˆæ¯å¤„ç†æ¯”è¾ƒè€—æ—¶çš„æ—¶å€™ï¼Œå¯èƒ½ç”Ÿäº§æ¶ˆæ¯çš„é€Ÿåº¦ä¼šè¿œè¿œå¤§äºæ¶ˆæ¯çš„æ¶ˆè´¹é€Ÿåº¦ã€‚é•¿æ­¤ä»¥å¾€ï¼Œæ¶ˆæ¯å°±ä¼šå †ç§¯è¶Šæ¥è¶Šå¤šï¼Œæ— æ³•åŠæ—¶å¤„ç†ã€‚\næ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨work æ¨¡å‹ï¼Œå¤šä¸ªæ¶ˆè´¹è€…å…±åŒå¤„ç†æ¶ˆæ¯å¤„ç†ï¼Œé€Ÿåº¦å°±èƒ½å¤§å¤§æé«˜äº†ã€‚\n3.2.1.æ¶ˆæ¯å‘é€ è¿™æ¬¡æˆ‘ä»¬å¾ªç¯å‘é€ï¼Œæ¨¡æ‹Ÿå¤§é‡æ¶ˆæ¯å †ç§¯ç°è±¡ã€‚\nåœ¨publisheræœåŠ¡ä¸­çš„SpringAmqpTestç±»ä¸­æ·»åŠ ä¸€ä¸ªæµ‹è¯•æ–¹æ³•ï¼š\n/** * workQueue * å‘é˜Ÿåˆ—ä¸­ä¸åœå‘é€æ¶ˆæ¯ï¼Œæ¨¡æ‹Ÿæ¶ˆæ¯å †ç§¯ã€‚ */ @Test public void testWorkQueue() throws InterruptedException { // é˜Ÿåˆ—åç§° String queueName = \u0026#34;simple.queue\u0026#34;; // æ¶ˆæ¯ String message = \u0026#34;hello, message_\u0026#34;; for (int i = 0; i \u0026lt; 50; i++) { // å‘é€æ¶ˆæ¯ rabbitTemplate.convertAndSend(queueName, message + i); Thread.sleep(20); } } 3.2.2.æ¶ˆæ¯æ¥æ”¶ è¦æ¨¡æ‹Ÿå¤šä¸ªæ¶ˆè´¹è€…ç»‘å®šåŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œæˆ‘ä»¬åœ¨consumeræœåŠ¡çš„SpringRabbitListenerä¸­æ·»åŠ 2ä¸ªæ–°çš„æ–¹æ³•ï¼š\n@RabbitListener(queues = \u0026#34;simple.queue\u0026#34;) public void listenWorkQueue1(String msg) throws InterruptedException { System.out.println(\u0026#34;æ¶ˆè´¹è€…1æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€\u0026#34; + msg + \u0026#34;ã€‘\u0026#34; + LocalTime.now()); Thread.sleep(20); } @RabbitListener(queues = \u0026#34;simple.queue\u0026#34;) public void listenWorkQueue2(String msg) throws InterruptedException { System.err.println(\u0026#34;æ¶ˆè´¹è€…2........æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šã€\u0026#34; + msg + \u0026#34;ã€‘\u0026#34; + LocalTime.now()); Thread.sleep(200); } æ³¨æ„åˆ°è¿™ä¸ªæ¶ˆè´¹è€…sleepäº†1000ç§’ï¼Œæ¨¡æ‹Ÿä»»åŠ¡è€—æ—¶ã€‚\n3.2.3.æµ‹è¯• å¯åŠ¨ConsumerApplicationåï¼Œåœ¨æ‰§è¡ŒpublisheræœåŠ¡ä¸­åˆšåˆšç¼–å†™çš„å‘é€æµ‹è¯•æ–¹æ³•testWorkQueueã€‚\nå¯ä»¥çœ‹åˆ°æ¶ˆè´¹è€…1å¾ˆå¿«å®Œæˆäº†è‡ªå·±çš„25æ¡æ¶ˆæ¯ã€‚æ¶ˆè´¹è€…2å´åœ¨ç¼“æ…¢çš„å¤„ç†è‡ªå·±çš„25æ¡æ¶ˆæ¯ã€‚\nä¹Ÿå°±æ˜¯è¯´æ¶ˆæ¯æ˜¯å¹³å‡åˆ†é…ç»™æ¯ä¸ªæ¶ˆè´¹è€…ï¼Œå¹¶æ²¡æœ‰è€ƒè™‘åˆ°æ¶ˆè´¹è€…çš„å¤„ç†èƒ½åŠ›ã€‚è¿™æ ·æ˜¾ç„¶æ˜¯æœ‰é—®é¢˜çš„ã€‚\n3.2.4.èƒ½è€…å¤šåŠ³ åœ¨springä¸­æœ‰ä¸€ä¸ªç®€å•çš„é…ç½®ï¼Œå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä¿®æ”¹consumeræœåŠ¡çš„application.ymlæ–‡ä»¶ï¼Œæ·»åŠ é…ç½®ï¼š\nspring: rabbitmq: listener: simple: prefetch: 1 # æ¯æ¬¡åªèƒ½è·å–ä¸€æ¡æ¶ˆæ¯ï¼Œå¤„ç†å®Œæˆæ‰èƒ½è·å–ä¸‹ä¸€ä¸ªæ¶ˆæ¯ 3.2.5.æ€»ç»“ Workæ¨¡å‹çš„ä½¿ç”¨ï¼š\nå¤šä¸ªæ¶ˆè´¹è€…ç»‘å®šåˆ°ä¸€ä¸ªé˜Ÿåˆ—ï¼ŒåŒä¸€æ¡æ¶ˆæ¯åªä¼šè¢«ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç† é€šè¿‡è®¾ç½®prefetchæ¥æ§åˆ¶æ¶ˆè´¹è€…é¢„å–çš„æ¶ˆæ¯æ•°é‡ 3.3.å‘å¸ƒ/è®¢é˜… å‘å¸ƒè®¢é˜…çš„æ¨¡å‹å¦‚å›¾ï¼š\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨è®¢é˜…æ¨¡å‹ä¸­ï¼Œå¤šäº†ä¸€ä¸ªexchangeè§’è‰²ï¼Œè€Œä¸”è¿‡ç¨‹ç•¥æœ‰å˜åŒ–ï¼š\nPublisherï¼šç”Ÿäº§è€…ï¼Œä¹Ÿå°±æ˜¯è¦å‘é€æ¶ˆæ¯çš„ç¨‹åºï¼Œä½†æ˜¯ä¸å†å‘é€åˆ°é˜Ÿåˆ—ä¸­ï¼Œè€Œæ˜¯å‘ç»™Xï¼ˆäº¤æ¢æœºï¼‰ Exchangeï¼šäº¤æ¢æœºï¼Œå›¾ä¸­çš„Xã€‚ä¸€æ–¹é¢ï¼Œæ¥æ”¶ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ã€‚å¦ä¸€æ–¹é¢ï¼ŒçŸ¥é“å¦‚ä½•å¤„ç†æ¶ˆæ¯ï¼Œä¾‹å¦‚é€’äº¤ç»™æŸä¸ªç‰¹åˆ«é˜Ÿåˆ—ã€é€’äº¤ç»™æ‰€æœ‰é˜Ÿåˆ—ã€æˆ–æ˜¯å°†æ¶ˆæ¯ä¸¢å¼ƒã€‚åˆ°åº•å¦‚ä½•æ“ä½œï¼Œå–å†³äºExchangeçš„ç±»å‹ã€‚Exchangeæœ‰ä»¥ä¸‹3ç§ç±»å‹ï¼š Fanoutï¼šå¹¿æ’­ï¼Œå°†æ¶ˆæ¯äº¤ç»™æ‰€æœ‰ç»‘å®šåˆ°äº¤æ¢æœºçš„é˜Ÿåˆ— Directï¼šå®šå‘ï¼ŒæŠŠæ¶ˆæ¯äº¤ç»™ç¬¦åˆæŒ‡å®šrouting key çš„é˜Ÿåˆ— Topicï¼šé€šé…ç¬¦ï¼ŒæŠŠæ¶ˆæ¯äº¤ç»™ç¬¦åˆrouting patternï¼ˆè·¯ç”±æ¨¡å¼ï¼‰ çš„é˜Ÿåˆ— Consumerï¼šæ¶ˆè´¹è€…ï¼Œä¸ä»¥å‰ä¸€æ ·ï¼Œè®¢é˜…é˜Ÿåˆ—ï¼Œæ²¡æœ‰å˜åŒ– Queueï¼šæ¶ˆæ¯é˜Ÿåˆ—ä¹Ÿä¸ä»¥å‰ä¸€æ ·ï¼Œæ¥æ”¶æ¶ˆæ¯ã€ç¼“å­˜æ¶ˆæ¯ã€‚ Exchangeï¼ˆäº¤æ¢æœºï¼‰åªè´Ÿè´£è½¬å‘æ¶ˆæ¯ï¼Œä¸å…·å¤‡å­˜å‚¨æ¶ˆæ¯çš„èƒ½åŠ›ï¼Œå› æ­¤å¦‚æœæ²¡æœ‰ä»»ä½•é˜Ÿåˆ—ä¸Exchangeç»‘å®šï¼Œæˆ–è€…æ²¡æœ‰ç¬¦åˆè·¯ç”±è§„åˆ™çš„é˜Ÿåˆ—ï¼Œé‚£ä¹ˆæ¶ˆæ¯ä¼šä¸¢å¤±ï¼\n3.4.Fanout Fanoutï¼Œè‹±æ–‡ç¿»è¯‘æ˜¯æ‰‡å‡ºï¼Œæˆ‘è§‰å¾—åœ¨MQä¸­å«å¹¿æ’­æ›´åˆé€‚ã€‚\nåœ¨å¹¿æ’­æ¨¡å¼ä¸‹ï¼Œæ¶ˆæ¯å‘é€æµç¨‹æ˜¯è¿™æ ·çš„ï¼š\n1ï¼‰ å¯ä»¥æœ‰å¤šä¸ªé˜Ÿåˆ— 2ï¼‰ æ¯ä¸ªé˜Ÿåˆ—éƒ½è¦ç»‘å®šåˆ°Exchangeï¼ˆäº¤æ¢æœºï¼‰ 3ï¼‰ ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ï¼Œåªèƒ½å‘é€åˆ°äº¤æ¢æœºï¼Œäº¤æ¢æœºæ¥å†³å®šè¦å‘ç»™å“ªä¸ªé˜Ÿåˆ—ï¼Œç”Ÿäº§è€…æ— æ³•å†³å®š 4ï¼‰ äº¤æ¢æœºæŠŠæ¶ˆæ¯å‘é€ç»™ç»‘å®šè¿‡çš„æ‰€æœ‰é˜Ÿåˆ— 5ï¼‰ è®¢é˜…é˜Ÿåˆ—çš„æ¶ˆè´¹è€…éƒ½èƒ½æ‹¿åˆ°æ¶ˆæ¯ æˆ‘ä»¬çš„è®¡åˆ’æ˜¯è¿™æ ·çš„ï¼š\nåˆ›å»ºä¸€ä¸ªäº¤æ¢æœº itcast.fanoutï¼Œç±»å‹æ˜¯Fanout åˆ›å»ºä¸¤ä¸ªé˜Ÿåˆ—fanout.queue1å’Œfanout.queue2ï¼Œç»‘å®šåˆ°äº¤æ¢æœºitcast.fanout 3.4.1.å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº Springæä¾›äº†ä¸€ä¸ªæ¥å£Exchangeï¼Œæ¥è¡¨ç¤ºæ‰€æœ‰ä¸åŒç±»å‹çš„äº¤æ¢æœºï¼š\nåœ¨consumerä¸­åˆ›å»ºä¸€ä¸ªç±»ï¼Œå£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœºï¼š\npackage cn.itcast.mq.config; import org.springframework.amqp.core.Binding; import org.springframework.amqp.core.BindingBuilder; import org.springframework.amqp.core.FanoutExchange; import org.springframework.amqp.core.Queue; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; @Configuration public class FanoutConfig { /** * å£°æ˜äº¤æ¢æœº * @return Fanoutç±»å‹äº¤æ¢æœº */ @Bean public FanoutExchange fanoutExchange(){ return new FanoutExchange(\u0026#34;itcast.fanout\u0026#34;); } /** * ç¬¬1ä¸ªé˜Ÿåˆ— */ @Bean public Queue fanoutQueue1(){ return new Queue(\u0026#34;fanout.queue1\u0026#34;); } /** * ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº */ @Bean public Binding bindingQueue1(Queue fanoutQueue1, FanoutExchange fanoutExchange){ return BindingBuilder.bind(fanoutQueue1).to(fanoutExchange); } /** * ç¬¬2ä¸ªé˜Ÿåˆ— */ @Bean public Queue fanoutQueue2(){ return new Queue(\u0026#34;fanout.queue2\u0026#34;); } /** * ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº */ @Bean public Binding bindingQueue2(Queue fanoutQueue2, FanoutExchange fanoutExchange){ return BindingBuilder.bind(fanoutQueue2).to(fanoutExchange); } } 3.4.2.æ¶ˆæ¯å‘é€ åœ¨publisheræœåŠ¡çš„SpringAmqpTestç±»ä¸­æ·»åŠ æµ‹è¯•æ–¹æ³•ï¼š\n@Test public void testFanoutExchange() { // é˜Ÿåˆ—åç§° String exchangeName = \u0026#34;itcast.fanout\u0026#34;; // æ¶ˆæ¯ String message = \u0026#34;hello, everyone!\u0026#34;; rabbitTemplate.convertAndSend(exchangeName, \u0026#34;\u0026#34;, message); } 3.4.3.æ¶ˆæ¯æ¥æ”¶ åœ¨consumeræœåŠ¡çš„SpringRabbitListenerä¸­æ·»åŠ ä¸¤ä¸ªæ–¹æ³•ï¼Œä½œä¸ºæ¶ˆè´¹è€…ï¼š\n@RabbitListener(queues = \u0026#34;fanout.queue1\u0026#34;) public void listenFanoutQueue1(String msg) { System.out.println(\u0026#34;æ¶ˆè´¹è€…1æ¥æ”¶åˆ°Fanoutæ¶ˆæ¯ï¼šã€\u0026#34; + msg + \u0026#34;ã€‘\u0026#34;); } @RabbitListener(queues = \u0026#34;fanout.queue2\u0026#34;) public void listenFanoutQueue2(String msg) { System.out.println(\u0026#34;æ¶ˆè´¹è€…2æ¥æ”¶åˆ°Fanoutæ¶ˆæ¯ï¼šã€\u0026#34; + msg + \u0026#34;ã€‘\u0026#34;); } 3.4.4.æ€»ç»“ äº¤æ¢æœºçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\næ¥æ”¶publisherå‘é€çš„æ¶ˆæ¯ å°†æ¶ˆæ¯æŒ‰ç…§è§„åˆ™è·¯ç”±åˆ°ä¸ä¹‹ç»‘å®šçš„é˜Ÿåˆ— ä¸èƒ½ç¼“å­˜æ¶ˆæ¯ï¼Œè·¯ç”±å¤±è´¥ï¼Œæ¶ˆæ¯ä¸¢å¤± FanoutExchangeçš„ä¼šå°†æ¶ˆæ¯è·¯ç”±åˆ°æ¯ä¸ªç»‘å®šçš„é˜Ÿåˆ— å£°æ˜é˜Ÿåˆ—ã€äº¤æ¢æœºã€ç»‘å®šå…³ç³»çš„Beanæ˜¯ä»€ä¹ˆï¼Ÿ\nQueue FanoutExchange Binding 3.5.Direct åœ¨Fanoutæ¨¡å¼ä¸­ï¼Œä¸€æ¡æ¶ˆæ¯ï¼Œä¼šè¢«æ‰€æœ‰è®¢é˜…çš„é˜Ÿåˆ—éƒ½æ¶ˆè´¹ã€‚ä½†æ˜¯ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸åŒçš„æ¶ˆæ¯è¢«ä¸åŒçš„é˜Ÿåˆ—æ¶ˆè´¹ã€‚è¿™æ—¶å°±è¦ç”¨åˆ°Directç±»å‹çš„Exchangeã€‚\nåœ¨Directæ¨¡å‹ä¸‹ï¼š\né˜Ÿåˆ—ä¸äº¤æ¢æœºçš„ç»‘å®šï¼Œä¸èƒ½æ˜¯ä»»æ„ç»‘å®šäº†ï¼Œè€Œæ˜¯è¦æŒ‡å®šä¸€ä¸ªRoutingKeyï¼ˆè·¯ç”±keyï¼‰ æ¶ˆæ¯çš„å‘é€æ–¹åœ¨ å‘ Exchangeå‘é€æ¶ˆæ¯æ—¶ï¼Œä¹Ÿå¿…é¡»æŒ‡å®šæ¶ˆæ¯çš„ RoutingKeyã€‚ Exchangeä¸å†æŠŠæ¶ˆæ¯äº¤ç»™æ¯ä¸€ä¸ªç»‘å®šçš„é˜Ÿåˆ—ï¼Œè€Œæ˜¯æ ¹æ®æ¶ˆæ¯çš„Routing Keyè¿›è¡Œåˆ¤æ–­ï¼Œåªæœ‰é˜Ÿåˆ—çš„Routingkeyä¸æ¶ˆæ¯çš„ Routing keyå®Œå…¨ä¸€è‡´ï¼Œæ‰ä¼šæ¥æ”¶åˆ°æ¶ˆæ¯ æ¡ˆä¾‹éœ€æ±‚å¦‚ä¸‹ï¼š\nåˆ©ç”¨@RabbitListenerå£°æ˜Exchangeã€Queueã€RoutingKey\nåœ¨consumeræœåŠ¡ä¸­ï¼Œç¼–å†™ä¸¤ä¸ªæ¶ˆè´¹è€…æ–¹æ³•ï¼Œåˆ†åˆ«ç›‘å¬direct.queue1å’Œdirect.queue2\nåœ¨publisherä¸­ç¼–å†™æµ‹è¯•æ–¹æ³•ï¼Œå‘itcast. directå‘é€æ¶ˆæ¯\n3.5.1.åŸºäºæ³¨è§£å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœº åŸºäº@Beançš„æ–¹å¼å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœºæ¯”è¾ƒéº»çƒ¦ï¼ŒSpringè¿˜æä¾›äº†åŸºäºæ³¨è§£æ–¹å¼æ¥å£°æ˜ã€‚\nåœ¨consumerçš„SpringRabbitListenerä¸­æ·»åŠ ä¸¤ä¸ªæ¶ˆè´¹è€…ï¼ŒåŒæ—¶åŸºäºæ³¨è§£æ¥å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœºï¼š\n@RabbitListener(bindings = @QueueBinding( value = @Queue(name = \u0026#34;direct.queue1\u0026#34;), exchange = @Exchange(name = \u0026#34;itcast.direct\u0026#34;, type = ExchangeTypes.DIRECT), key = {\u0026#34;red\u0026#34;, \u0026#34;blue\u0026#34;} )) public void listenDirectQueue1(String msg){ System.out.println(\u0026#34;æ¶ˆè´¹è€…æ¥æ”¶åˆ°direct.queue1çš„æ¶ˆæ¯ï¼šã€\u0026#34; + msg + \u0026#34;ã€‘\u0026#34;); } @RabbitListener(bindings = @QueueBinding( value = @Queue(name = \u0026#34;direct.queue2\u0026#34;), exchange = @Exchange(name = \u0026#34;itcast.direct\u0026#34;, type = ExchangeTypes.DIRECT), key = {\u0026#34;red\u0026#34;, \u0026#34;yellow\u0026#34;} )) public void listenDirectQueue2(String msg){ System.out.println(\u0026#34;æ¶ˆè´¹è€…æ¥æ”¶åˆ°direct.queue2çš„æ¶ˆæ¯ï¼šã€\u0026#34; + msg + \u0026#34;ã€‘\u0026#34;); } 3.5.2.æ¶ˆæ¯å‘é€ åœ¨publisheræœåŠ¡çš„SpringAmqpTestç±»ä¸­æ·»åŠ æµ‹è¯•æ–¹æ³•ï¼š\n@Test public void testSendDirectExchange() { // äº¤æ¢æœºåç§° String exchangeName = \u0026#34;itcast.direct\u0026#34;; // æ¶ˆæ¯ String message = \u0026#34;çº¢è‰²è­¦æŠ¥ï¼æ—¥æœ¬ä¹±æ’æ ¸åºŸæ°´ï¼Œå¯¼è‡´æµ·æ´‹ç”Ÿç‰©å˜å¼‚ï¼ŒæƒŠç°å“¥æ–¯æ‹‰ï¼\u0026#34;; // å‘é€æ¶ˆæ¯ rabbitTemplate.convertAndSend(exchangeName, \u0026#34;red\u0026#34;, message); } 3.5.3.æ€»ç»“ æè¿°ä¸‹Directäº¤æ¢æœºä¸Fanoutäº¤æ¢æœºçš„å·®å¼‚ï¼Ÿ\nFanoutäº¤æ¢æœºå°†æ¶ˆæ¯è·¯ç”±ç»™æ¯ä¸€ä¸ªä¸ä¹‹ç»‘å®šçš„é˜Ÿåˆ— Directäº¤æ¢æœºæ ¹æ®RoutingKeyåˆ¤æ–­è·¯ç”±ç»™å“ªä¸ªé˜Ÿåˆ— å¦‚æœå¤šä¸ªé˜Ÿåˆ—å…·æœ‰ç›¸åŒçš„RoutingKeyï¼Œåˆ™ä¸FanoutåŠŸèƒ½ç±»ä¼¼ åŸºäº@RabbitListeneræ³¨è§£å£°æ˜é˜Ÿåˆ—å’Œäº¤æ¢æœºæœ‰å“ªäº›å¸¸è§æ³¨è§£ï¼Ÿ\n@Queue @Exchange 3.6.Topic 3.6.1.è¯´æ˜ Topicç±»å‹çš„Exchangeä¸Directç›¸æ¯”ï¼Œéƒ½æ˜¯å¯ä»¥æ ¹æ®RoutingKeyæŠŠæ¶ˆæ¯è·¯ç”±åˆ°ä¸åŒçš„é˜Ÿåˆ—ã€‚åªä¸è¿‡Topicç±»å‹Exchangeå¯ä»¥è®©é˜Ÿåˆ—åœ¨ç»‘å®šRouting key çš„æ—¶å€™ä½¿ç”¨é€šé…ç¬¦ï¼\nRoutingkey ä¸€èˆ¬éƒ½æ˜¯æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå•è¯ç»„æˆï¼Œå¤šä¸ªå•è¯ä¹‹é—´ä»¥â€.â€åˆ†å‰²ï¼Œä¾‹å¦‚ï¼š item.insert\né€šé…ç¬¦è§„åˆ™ï¼š\n#ï¼šåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªè¯\n*ï¼šåŒ¹é…ä¸å¤šä¸å°‘æ°å¥½1ä¸ªè¯\nä¸¾ä¾‹ï¼š\nitem.#ï¼šèƒ½å¤ŸåŒ¹é…item.spu.insert æˆ–è€… item.spu\nitem.*ï¼šåªèƒ½åŒ¹é…item.spu\nâ€‹\nå›¾ç¤ºï¼š\nè§£é‡Šï¼š\nQueue1ï¼šç»‘å®šçš„æ˜¯china.# ï¼Œå› æ­¤å‡¡æ˜¯ä»¥ china.å¼€å¤´çš„routing key éƒ½ä¼šè¢«åŒ¹é…åˆ°ã€‚åŒ…æ‹¬china.newså’Œchina.weather Queue2ï¼šç»‘å®šçš„æ˜¯#.news ï¼Œå› æ­¤å‡¡æ˜¯ä»¥ .newsç»“å°¾çš„ routing key éƒ½ä¼šè¢«åŒ¹é…ã€‚åŒ…æ‹¬china.newså’Œjapan.news æ¡ˆä¾‹éœ€æ±‚ï¼š\nå®ç°æ€è·¯å¦‚ä¸‹ï¼š\nå¹¶åˆ©ç”¨@RabbitListenerå£°æ˜Exchangeã€Queueã€RoutingKey\nåœ¨consumeræœåŠ¡ä¸­ï¼Œç¼–å†™ä¸¤ä¸ªæ¶ˆè´¹è€…æ–¹æ³•ï¼Œåˆ†åˆ«ç›‘å¬topic.queue1å’Œtopic.queue2\nåœ¨publisherä¸­ç¼–å†™æµ‹è¯•æ–¹æ³•ï¼Œå‘itcast. topicå‘é€æ¶ˆæ¯\n3.6.2.æ¶ˆæ¯å‘é€ åœ¨publisheræœåŠ¡çš„SpringAmqpTestç±»ä¸­æ·»åŠ æµ‹è¯•æ–¹æ³•ï¼š\n/** * topicExchange */ @Test public void testSendTopicExchange() { // äº¤æ¢æœºåç§° String exchangeName = \u0026#34;itcast.topic\u0026#34;; // æ¶ˆæ¯ String message = \u0026#34;å–œæŠ¥ï¼å­™æ‚Ÿç©ºå¤§æˆ˜å“¥æ–¯æ‹‰ï¼Œèƒœ!\u0026#34;; // å‘é€æ¶ˆæ¯ rabbitTemplate.convertAndSend(exchangeName, \u0026#34;china.news\u0026#34;, message); } 3.6.3.æ¶ˆæ¯æ¥æ”¶ åœ¨consumeræœåŠ¡çš„SpringRabbitListenerä¸­æ·»åŠ æ–¹æ³•ï¼š\n@RabbitListener(bindings = @QueueBinding( value = @Queue(name = \u0026#34;topic.queue1\u0026#34;), exchange = @Exchange(name = \u0026#34;itcast.topic\u0026#34;, type = ExchangeTypes.TOPIC), key = \u0026#34;china.#\u0026#34; )) public void listenTopicQueue1(String msg){ System.out.println(\u0026#34;æ¶ˆè´¹è€…æ¥æ”¶åˆ°topic.queue1çš„æ¶ˆæ¯ï¼šã€\u0026#34; + msg + \u0026#34;ã€‘\u0026#34;); } @RabbitListener(bindings = @QueueBinding( value = @Queue(name = \u0026#34;topic.queue2\u0026#34;), exchange = @Exchange(name = \u0026#34;itcast.topic\u0026#34;, type = ExchangeTypes.TOPIC), key = \u0026#34;#.news\u0026#34; )) public void listenTopicQueue2(String msg){ System.out.println(\u0026#34;æ¶ˆè´¹è€…æ¥æ”¶åˆ°topic.queue2çš„æ¶ˆæ¯ï¼šã€\u0026#34; + msg + \u0026#34;ã€‘\u0026#34;); } 3.6.4.æ€»ç»“ æè¿°ä¸‹Directäº¤æ¢æœºä¸Topicäº¤æ¢æœºçš„å·®å¼‚ï¼Ÿ\nTopicäº¤æ¢æœºæ¥æ”¶çš„æ¶ˆæ¯RoutingKeyå¿…é¡»æ˜¯å¤šä¸ªå•è¯ï¼Œä»¥ **.** åˆ†å‰² Topicäº¤æ¢æœºä¸é˜Ÿåˆ—ç»‘å®šæ—¶çš„bindingKeyå¯ä»¥æŒ‡å®šé€šé…ç¬¦ #ï¼šä»£è¡¨0ä¸ªæˆ–å¤šä¸ªè¯ *ï¼šä»£è¡¨1ä¸ªè¯ 3.7.æ¶ˆæ¯è½¬æ¢å™¨ ä¹‹å‰è¯´è¿‡ï¼ŒSpringä¼šæŠŠä½ å‘é€çš„æ¶ˆæ¯åºåˆ—åŒ–ä¸ºå­—èŠ‚å‘é€ç»™MQï¼Œæ¥æ”¶æ¶ˆæ¯çš„æ—¶å€™ï¼Œè¿˜ä¼šæŠŠå­—èŠ‚ååºåˆ—åŒ–ä¸ºJavaå¯¹è±¡ã€‚\nåªä¸è¿‡ï¼Œé»˜è®¤æƒ…å†µä¸‹Springé‡‡ç”¨çš„åºåˆ—åŒ–æ–¹å¼æ˜¯JDKåºåˆ—åŒ–ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼ŒJDKåºåˆ—åŒ–å­˜åœ¨ä¸‹åˆ—é—®é¢˜ï¼š\næ•°æ®ä½“ç§¯è¿‡å¤§ æœ‰å®‰å…¨æ¼æ´ å¯è¯»æ€§å·® æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ã€‚\n3.7.1.æµ‹è¯•é»˜è®¤è½¬æ¢å™¨ æˆ‘ä»¬ä¿®æ”¹æ¶ˆæ¯å‘é€çš„ä»£ç ï¼Œå‘é€ä¸€ä¸ªMapå¯¹è±¡ï¼š\n@Test public void testSendMap() throws InterruptedException { // å‡†å¤‡æ¶ˆæ¯ Map\u0026lt;String,Object\u0026gt; msg = new HashMap\u0026lt;\u0026gt;(); msg.put(\u0026#34;name\u0026#34;, \u0026#34;Jack\u0026#34;); msg.put(\u0026#34;age\u0026#34;, 21); // å‘é€æ¶ˆæ¯ rabbitTemplate.convertAndSend(\u0026#34;simple.queue\u0026#34;,\u0026#34;\u0026#34;, msg); } åœæ­¢consumeræœåŠ¡\nå‘é€æ¶ˆæ¯åæŸ¥çœ‹æ§åˆ¶å°ï¼š\n3.7.2.é…ç½®JSONè½¬æ¢å™¨ æ˜¾ç„¶ï¼ŒJDKåºåˆ—åŒ–æ–¹å¼å¹¶ä¸åˆé€‚ã€‚æˆ‘ä»¬å¸Œæœ›æ¶ˆæ¯ä½“çš„ä½“ç§¯æ›´å°ã€å¯è¯»æ€§æ›´é«˜ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨JSONæ–¹å¼æ¥åšåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚\nåœ¨publisherå’Œconsumerä¸¤ä¸ªæœåŠ¡ä¸­éƒ½å¼•å…¥ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.fasterxml.jackson.dataformat\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;jackson-dataformat-xml\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.9.10\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; é…ç½®æ¶ˆæ¯è½¬æ¢å™¨ã€‚\nåœ¨å¯åŠ¨ç±»ä¸­æ·»åŠ ä¸€ä¸ªBeanå³å¯ï¼š\n@Bean public MessageConverter jsonMessageConverter(){ return new Jackson2JsonMessageConverter(); } ","permalink":"https://XianCH.github.io/posts/tech/distributed/rabbitmq%E5%AD%A6%E4%B9%A0/","summary":"\u003ch1 id=\"rabbitmq\"\u003eRabbitMQ\u003c/h1\u003e\n\u003ch1 id=\"1åˆè¯†mq\"\u003e1.åˆè¯†MQ\u003c/h1\u003e\n\u003ch2 id=\"11åŒæ­¥å’Œå¼‚æ­¥é€šè®¯\"\u003e1.1.åŒæ­¥å’Œå¼‚æ­¥é€šè®¯\u003c/h2\u003e\n\u003cp\u003eå¾®æœåŠ¡é—´é€šè®¯æœ‰åŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§æ–¹å¼ï¼š\u003c/p\u003e\n\u003cp\u003eåŒæ­¥é€šè®¯ï¼šå°±åƒæ‰“ç”µè¯ï¼Œéœ€è¦å®æ—¶å“åº”ã€‚\u003c/p\u003e\n\u003cp\u003eå¼‚æ­¥é€šè®¯ï¼šå°±åƒå‘é‚®ä»¶ï¼Œä¸éœ€è¦é©¬ä¸Šå›å¤ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"assets/image-20210717161939695.png\" alt=\"image-20210717161939695\"  /\u003e\n\u003c/p\u003e\n\u003cp\u003eä¸¤ç§æ–¹å¼å„æœ‰ä¼˜åŠ£ï¼Œæ‰“ç”µè¯å¯ä»¥ç«‹å³å¾—åˆ°å“åº”ï¼Œä½†æ˜¯ä½ å´ä¸èƒ½è·Ÿå¤šä¸ªäººåŒæ—¶é€šè¯ã€‚å‘é€é‚®ä»¶å¯ä»¥åŒæ—¶ä¸å¤šä¸ªäººæ”¶å‘é‚®ä»¶ï¼Œä½†æ˜¯å¾€å¾€å“åº”ä¼šæœ‰å»¶è¿Ÿã€‚\u003c/p\u003e\n\u003ch3 id=\"111åŒæ­¥é€šè®¯\"\u003e1.1.1.åŒæ­¥é€šè®¯\u003c/h3\u003e\n\u003cp\u003eæˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„Feignè°ƒç”¨å°±å±äºåŒæ­¥æ–¹å¼ï¼Œè™½ç„¶è°ƒç”¨å¯ä»¥å®æ—¶å¾—åˆ°ç»“æœï¼Œä½†å­˜åœ¨ä¸‹é¢çš„é—®é¢˜ï¼š\u003c/p\u003e","title":"RabbitMq"},{"content":"spring boot2å­¦ä¹ ç¬”è®° ä¸€ï¼Œ\tspring boot2æ ¸å¿ƒæŠ€æœ¯åŸºç¡€å…¥é—¨ 1.springèƒ½åšä»€ä¹ˆ 1.1 springçš„èƒ½åŠ› ![image-20220321190444355](spring boot2å­¦ä¹ ç¬”è®°.assets\\image-20220321190444355.png)\näºŒ\tã€ä¸ºä»€ä¹ˆç”¨SpringBoot Spring Boot makes it easy to create stand-alone, production-grade Spring based Applications that you can \u0026ldquo;just run\u0026rdquo;.\nèƒ½å¿«é€Ÿåˆ›å»ºå‡ºç”Ÿäº§çº§åˆ«çš„Springåº”ç”¨\n2.1ã€SpringBootä¼˜ç‚¹ Create stand-alone Spring applications\nåˆ›å»ºç‹¬ç«‹Springåº”ç”¨ Embed Tomcat, Jetty or Undertow directly (no need to deploy WAR files)\nå†…åµŒwebæœåŠ¡å™¨ Provide opinionated \u0026lsquo;starter\u0026rsquo; dependencies to simplify your build configuration\nè‡ªåŠ¨starterä¾èµ–ï¼Œç®€åŒ–æ„å»ºé…ç½® Automatically configure Spring and 3rd party libraries whenever possible\nè‡ªåŠ¨é…ç½®Springä»¥åŠç¬¬ä¸‰æ–¹åŠŸèƒ½ Provide production-ready features such as metrics, health checks, and externalized configuration\næä¾›ç”Ÿäº§çº§åˆ«çš„ç›‘æ§ã€å¥åº·æ£€æŸ¥åŠå¤–éƒ¨åŒ–é…ç½® Absolutely no code generation and no requirement for XML configuration\næ— ä»£ç ç”Ÿæˆã€æ— éœ€ç¼–å†™XML ä¸‰ ï¼Œ spring bootå¼€å‘æ–‡æ¡£ å››ï¼Œspring bootå…¥é—¨ 1ï¼Œhello world å¯¼å…¥ä¾èµ– \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-web\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; ![image-20220324143750246](D:\\6 \u0026ndash; TypoDoc\\springboot2\\spring boot2å­¦ä¹ ç¬”è®°.assets\\image-20220324143750246.png) è¿™ä¸ªä¾èµ–å¯¼å…¥äº†å¼€å‘ä¸­å¤§éƒ¨åˆ†çš„jaråŒ…\n1.1 ç¼–å†™ä¸»ç¨‹åº ![image-20220324143859988](D:\\6 \u0026ndash; TypoDoc\\springboot2\\spring boot2å­¦ä¹ ç¬”è®°.assets\\image-20220324143859988.png)\n@RestController public class HelloController { @RequestMapping(\u0026#34;/hello\u0026#34;) public String handle01(){ return \u0026#34;hello,Spring boot 2!\u0026#34;; } } @SpringBootApplication public class MainApplication { public static void main(String[] args) { SpringApplication.run(MainApplication.class,args); } } æ–‡ä»¶çš„éƒ¨ç½²\nç”¨spring bootçš„æ’ä»¶æŠŠæ•´ä¸ªé¡¹ç›®æ‰“åŒ…æˆjaråŒ…\n\u0026lt;build\u0026gt; \u0026lt;plugins\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-maven-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/plugins\u0026gt; \u0026lt;/build\u0026gt; ![image-20220324144608094](spring boot2å­¦ä¹ ç¬”è®°.assets/image-20220324144608094-16797314654721.png)\näº”ï¼Œ\täº†è§£è‡ªåŠ¨é…ç½®åŸç† 1.0 ä¾èµ–ç®¡ç† \u0026lt;parent\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-parent\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.6.4\u0026lt;/version\u0026gt; \u0026lt;/parent\u0026gt; ä»–çš„çˆ¶é¡¹ç›®\n\u0026lt;parent\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-dependencies\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.6.4\u0026lt;/version\u0026gt; \u0026lt;/parent\u0026gt; å‡ ä¹å£°æ˜äº†æ‰€æœ‰å¼€å‘ä¸­å¸¸ç”¨çš„ä¾èµ–ç‰ˆæœ¬ï¼Œå’Œä¾èµ–æ‰€å¯¹åº”çš„ç‰ˆæœ¬å·\nå¦‚ï¼š\n![image-20220324144411720](.\\spring boot2å­¦ä¹ ç¬”è®°.assets\\image-20220324144411720.png)\nå› æ­¤åœ¨prom.xmlä¸­å¯¼å…¥ä¾èµ–çš„æ—¶å€™ä¸éœ€è¦å†™å¯¹åº”çš„çš„ç‰ˆæœ¬å·\n![image-20220324145112721](D:\\6 \u0026ndash; TypoDoc\\springboot2\\spring boot2å­¦ä¹ ç¬”è®°.assets\\image-20220324145112721.png)\nå¦‚ä½•æƒ³è‡ªè¡Œæ›´æ¢ç‰ˆæœ¬ï¼šå¦‚æ›´æ¢mysqlé©±åŠ¨ â€‹\tä¸Šmvnä»“åº“Maven Repository: Search/Browse/Explore (mvnrepository.com)\n![image-20220324145711405](.\\spring boot2å­¦ä¹ ç¬”è®°.assets\\image-20220324145711405.png)\nâ€‹\tåœ¨pormã€‚xmlä¸­è¾“å…¥\n\u0026lt;properties\u0026gt; \u0026lt;mysql.version\u0026gt;5.1.43\u0026lt;/mysql.version\u0026gt; \u0026lt;/properties\u0026gt; ä¾èµ–æ ‘\n![image-20220324150731469](.\\spring boot2å­¦ä¹ ç¬”è®°.assets\\image-20220324150731469.png)\n2.å®¹å™¨åŠŸèƒ½ 2.1\tç»„ä»¶æ·»åŠ  @Configuration\nåŸºæœ¬ä½¿ç”¨\n#############################Configurationä½¿ç”¨ç¤ºä¾‹###################################################### /** * 1ã€é…ç½®ç±»é‡Œé¢ä½¿ç”¨@Beanæ ‡æ³¨åœ¨æ–¹æ³•ä¸Šç»™å®¹å™¨æ³¨å†Œç»„ä»¶ï¼Œé»˜è®¤ä¹Ÿæ˜¯å•å®ä¾‹çš„ * 2ã€é…ç½®ç±»æœ¬èº«ä¹Ÿæ˜¯ç»„ä»¶ * 3ã€proxyBeanMethodsï¼šä»£ç†beançš„æ–¹æ³• * Full(proxyBeanMethods = true)ã€ã€ä¿è¯æ¯ä¸ª@Beanæ–¹æ³•è¢«è°ƒç”¨å¤šå°‘æ¬¡è¿”å›çš„ç»„ä»¶éƒ½æ˜¯å•å®ä¾‹çš„ã€‘ * Lite(proxyBeanMethods = false)ã€æ¯ä¸ª@Beanæ–¹æ³•è¢«è°ƒç”¨å¤šå°‘æ¬¡è¿”å›çš„ç»„ä»¶éƒ½æ˜¯æ–°åˆ›å»ºçš„ã€‘ * ç»„ä»¶ä¾èµ–å¿…é¡»ä½¿ç”¨Fullæ¨¡å¼é»˜è®¤ã€‚å…¶ä»–é»˜è®¤æ˜¯å¦Liteæ¨¡å¼ * * * */ @Configuration(proxyBeanMethods = false) //å‘Šè¯‰SpringBootè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±» == é…ç½®æ–‡ä»¶ public class MyConfig { /** * Full:å¤–éƒ¨æ— è®ºå¯¹é…ç½®ç±»ä¸­çš„è¿™ä¸ªç»„ä»¶æ³¨å†Œæ–¹æ³•è°ƒç”¨å¤šå°‘æ¬¡è·å–çš„éƒ½æ˜¯ä¹‹å‰æ³¨å†Œå®¹å™¨ä¸­çš„å•å®ä¾‹å¯¹è±¡ * @return */ @Bean //ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ã€‚ä»¥æ–¹æ³•åä½œä¸ºç»„ä»¶çš„idã€‚è¿”å›ç±»å‹å°±æ˜¯ç»„ä»¶ç±»å‹ã€‚è¿”å›çš„å€¼ï¼Œå°±æ˜¯ç»„ä»¶åœ¨å®¹å™¨ä¸­çš„å®ä¾‹ public User user01(){ User zhangsan = new User(\u0026#34;zhangsan\u0026#34;, 18); //userç»„ä»¶ä¾èµ–äº†Petç»„ä»¶ zhangsan.setPet(tomcatPet()); return zhangsan; } @Bean(\u0026#34;tom\u0026#34;) public Pet tomcatPet(){ return new Pet(\u0026#34;tomcat\u0026#34;); } } ################################@Configurationæµ‹è¯•ä»£ç å¦‚ä¸‹######################################## @SpringBootConfiguration @EnableAutoConfiguration @ComponentScan(\u0026#34;com.atguigu.boot\u0026#34;) public class MainApplication { public static void main(String[] args) { //1ã€è¿”å›æˆ‘ä»¬IOCå®¹å™¨ ConfigurableApplicationContext run = SpringApplication.run(MainApplication.class, args); //2ã€æŸ¥çœ‹å®¹å™¨é‡Œé¢çš„ç»„ä»¶ String[] names = run.getBeanDefinitionNames(); for (String name : names) { System.out.println(name); } //3ã€ä»å®¹å™¨ä¸­è·å–ç»„ä»¶ Pet tom01 = run.getBean(\u0026#34;tom\u0026#34;, Pet.class); Pet tom02 = run.getBean(\u0026#34;tom\u0026#34;, Pet.class); System.out.println(\u0026#34;ç»„ä»¶ï¼š\u0026#34;+(tom01 == tom02)); //4ã€com.atguigu.boot.config.MyConfig$$EnhancerBySpringCGLIB$$51f1e1ca@1654a892 MyConfig bean = run.getBean(MyConfig.class); System.out.println(bean); //å¦‚æœ@Configuration(proxyBeanMethods = true)ä»£ç†å¯¹è±¡è°ƒç”¨æ–¹æ³•ã€‚SpringBootæ€»ä¼šæ£€æŸ¥è¿™ä¸ªç»„ä»¶æ˜¯å¦åœ¨å®¹å™¨ä¸­æœ‰ã€‚ //ä¿æŒç»„ä»¶å•å®ä¾‹ User user = bean.user01(); User user1 = bean.user01(); System.out.println(user == user1); User user01 = run.getBean(\u0026#34;user01\u0026#34;, User.class); Pet tom = run.getBean(\u0026#34;tom\u0026#34;, Pet.class); System.out.println(\u0026#34;ç”¨æˆ·çš„å® ç‰©ï¼š\u0026#34;+(user01.getPet() == tom)); } } @Beanã€@Componentã€@Controllerã€@Serviceã€@Repository\n@ComponentScanã€@Import\n* 4ã€@Import({User.class, DBHelper.class}) * ç»™å®¹å™¨ä¸­è‡ªåŠ¨åˆ›å»ºå‡ºè¿™ä¸¤ä¸ªç±»å‹çš„ç»„ä»¶ã€é»˜è®¤ç»„ä»¶çš„åå­—å°±æ˜¯å…¨ç±»å * * * */ @Import({User.class, DBHelper.class}) @Configuration(proxyBeanMethods = false) //å‘Šè¯‰SpringBootè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±» == é…ç½®æ–‡ä»¶ public class MyConfig { } @Conditional\næ¡ä»¶è£…é…ï¼šæ»¡è¶³ConditionalæŒ‡å®šçš„æ¡ä»¶ï¼Œåˆ™è¿›è¡Œç»„ä»¶æ³¨å…¥\n![image-20220324212837038](.\\spring boot2å­¦ä¹ ç¬”è®°.assets\\image-20220324212837038.png)\n=====================æµ‹è¯•æ¡ä»¶è£…é…========================== @Configuration(proxyBeanMethods = false) //å‘Šè¯‰SpringBootè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±» == é…ç½®æ–‡ä»¶ //@ConditionalOnBean(name = \u0026#34;tom\u0026#34;) @ConditionalOnMissingBean(name = \u0026#34;tom\u0026#34;) public class MyConfig { /** * Full:å¤–éƒ¨æ— è®ºå¯¹é…ç½®ç±»ä¸­çš„è¿™ä¸ªç»„ä»¶æ³¨å†Œæ–¹æ³•è°ƒç”¨å¤šå°‘æ¬¡è·å–çš„éƒ½æ˜¯ä¹‹å‰æ³¨å†Œå®¹å™¨ä¸­çš„å•å®ä¾‹å¯¹è±¡ * @return */ @Bean //ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ã€‚ä»¥æ–¹æ³•åä½œä¸ºç»„ä»¶çš„idã€‚è¿”å›ç±»å‹å°±æ˜¯ç»„ä»¶ç±»å‹ã€‚è¿”å›çš„å€¼ï¼Œå°±æ˜¯ç»„ä»¶åœ¨å®¹å™¨ä¸­çš„å®ä¾‹ public User user01(){ User zhangsan = new User(\u0026#34;zhangsan\u0026#34;, 18); //userç»„ä»¶ä¾èµ–äº†Petç»„ä»¶ zhangsan.setPet(tomcatPet()); return zhangsan; } @Bean(\u0026#34;tom22\u0026#34;) public Pet tomcatPet(){ return new Pet(\u0026#34;tomcat\u0026#34;); } } public static void main(String[] args) { //1ã€è¿”å›æˆ‘ä»¬IOCå®¹å™¨ ConfigurableApplicationContext run = SpringApplication.run(MainApplication.class, args); //2ã€æŸ¥çœ‹å®¹å™¨é‡Œé¢çš„ç»„ä»¶ String[] names = run.getBeanDefinitionNames(); for (String name : names) { System.out.println(name); } boolean tom = run.containsBean(\u0026#34;tom\u0026#34;); System.out.println(\u0026#34;å®¹å™¨ä¸­Tomç»„ä»¶ï¼š\u0026#34;+tom); boolean user01 = run.containsBean(\u0026#34;user01\u0026#34;); System.out.println(\u0026#34;å®¹å™¨ä¸­user01ç»„ä»¶ï¼š\u0026#34;+user01); boolean tom22 = run.containsBean(\u0026#34;tom22\u0026#34;); System.out.println(\u0026#34;å®¹å™¨ä¸­tom22ç»„ä»¶ï¼š\u0026#34;+tom22); } 2.2\tåŸç”Ÿé…ç½®æ–‡ä»¶å¼•å…¥ @ImportResource ======================beans.xml========================= \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;beans xmlns=\u0026#34;http://www.springframework.org/schema/beans\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xmlns:context=\u0026#34;http://www.springframework.org/schema/context\u0026#34; xsi:schemaLocation=\u0026#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd\u0026#34;\u0026gt; \u0026lt;bean id=\u0026#34;haha\u0026#34; class=\u0026#34;com.atguigu.boot.bean.User\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;name\u0026#34; value=\u0026#34;zhangsan\u0026#34;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;property name=\u0026#34;age\u0026#34; value=\u0026#34;18\u0026#34;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;bean id=\u0026#34;hehe\u0026#34; class=\u0026#34;com.atguigu.boot.bean.Pet\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;name\u0026#34; value=\u0026#34;tomcat\u0026#34;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;/beans\u0026gt; @ImportResource(\u0026#34;classpath:beans.xml\u0026#34;) public class MyConfig {} ======================æµ‹è¯•================= boolean haha = run.containsBean(\u0026#34;haha\u0026#34;); boolean hehe = run.containsBean(\u0026#34;hehe\u0026#34;); System.out.println(\u0026#34;hahaï¼š\u0026#34;+haha);//true System.out.println(\u0026#34;heheï¼š\u0026#34;+hehe);//true 2.3\té…ç½®ç»‘å®š å¦‚ä½•ä½¿ç”¨Javaè¯»å–åˆ°propertiesæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œå¹¶ä¸”æŠŠå®ƒå°è£…åˆ°JavaBeanä¸­ï¼Œä»¥ä¾›éšæ—¶ä½¿ç”¨ï¼›\npublic class getProperties { public static void main(String[] args) throws FileNotFoundException, IOException { Properties pps = new Properties(); pps.load(new FileInputStream(\u0026#34;a.properties\u0026#34;)); Enumeration enum1 = pps.propertyNames();//å¾—åˆ°é…ç½®æ–‡ä»¶çš„åå­— while(enum1.hasMoreElements()) { String strKey = (String) enum1.nextElement(); String strValue = pps.getProperty(strKey); System.out.println(strKey + \u0026#34;=\u0026#34; + strValue); //å°è£…åˆ°JavaBeanã€‚ } } } 2.3.1\t@ConfigurationProperties /** * åªæœ‰åœ¨å®¹å™¨ä¸­çš„ç»„ä»¶ï¼Œæ‰ä¼šæ‹¥æœ‰SpringBootæä¾›çš„å¼ºå¤§åŠŸèƒ½ */ @Component @ConfigurationProperties(prefix = \u0026#34;mycar\u0026#34;) public class Car { private String brand; private Integer price; public String getBrand() { return brand; } public void setBrand(String brand) { this.brand = brand; } public Integer getPrice() { return price; } public void setPrice(Integer price) { this.price = price; } @Override public String toString() { return \u0026#34;Car{\u0026#34; + \u0026#34;brand=\u0026#39;\u0026#34; + brand + \u0026#39;\\\u0026#39;\u0026#39; + \u0026#34;, price=\u0026#34; + price + \u0026#39;}\u0026#39;; } } 2.3.3\t@EnableConfigurationProperties + @ConfigurationProperties\n2.3.4\t@Component + @ConfigurationProperties\nâ€‹\n@EnableConfigurationProperties(Car.class) //1ã€å¼€å¯Caré…ç½®ç»‘å®šåŠŸèƒ½ //2ã€æŠŠè¿™ä¸ªCarè¿™ä¸ªç»„ä»¶è‡ªåŠ¨æ³¨å†Œåˆ°å®¹å™¨ä¸­ public class MyConfig { } 3.\tè‡ªåŠ¨é…ç½®åŸç†å…¥é—¨ 3.1\tå¼•å¯¼åŠ è½½è‡ªåŠ¨é…ç½®ç±» @SpringBootConfiguration @EnableAutoConfiguration @ComponentScan(excludeFilters = { @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class), @Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) }) public @interface SpringBootApplication{} @SpringBootConfiguration\n@Configuration.ä»£è¡¨å½“å‰æ˜¯ä¸€ä¸ªé…ç½®ç±»\n@ComponentScan\næŒ‡å®šæ‰«æå“ªäº›ç»„ä»¶ï¼ŒSpringæ³¨è§£ã€‚\n@EnableAutoConfiguration\n@AutoConfigurationPackage @Import(AutoConfigurationImportSelector.class) public @interface EnableAutoConfiguration {} @AutoConfigurationPackage\nè‡ªåŠ¨é…ç½®åŒ…ï¼ŒæŒ‡å®šäº†é»˜è®¤çš„åŒ…è§„åˆ™\n@Import(AutoConfigurationPackages.Registrar.class) //ç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶ public @interface AutoConfigurationPackage {} //åˆ©ç”¨Registrarç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€ç³»åˆ—ç»„ä»¶ //å°†æŒ‡å®šçš„ä¸€ä¸ªåŒ…ä¸‹çš„æ‰€æœ‰ç»„ä»¶å¯¼å…¥è¿›æ¥ï¼ŸMainApplication æ‰€åœ¨åŒ…ä¸‹ã€‚ @Import(AutoConfigurationImportSelector.class)\n1ã€åˆ©ç”¨getAutoConfigurationEntry(annotationMetadata);ç»™å®¹å™¨ä¸­æ‰¹é‡å¯¼å…¥ä¸€äº›ç»„ä»¶\r2ã€è°ƒç”¨List\u0026lt;String\u0026gt; configurations = getCandidateConfigurations(annotationMetadata, attributes)è·å–åˆ°æ‰€æœ‰éœ€è¦å¯¼å…¥åˆ°å®¹å™¨ä¸­çš„é…ç½®ç±»\r3ã€åˆ©ç”¨å·¥å‚åŠ è½½ Map\u0026lt;String, List\u0026lt;String\u0026gt;\u0026gt; loadSpringFactories(@Nullable ClassLoader classLoader)ï¼›å¾—åˆ°æ‰€æœ‰çš„ç»„ä»¶\r4ã€ä»META-INF/spring.factoriesä½ç½®æ¥åŠ è½½ä¸€ä¸ªæ–‡ä»¶ã€‚\ré»˜è®¤æ‰«ææˆ‘ä»¬å½“å‰ç³»ç»Ÿé‡Œé¢æ‰€æœ‰META-INF/spring.factoriesä½ç½®çš„æ–‡ä»¶\rspring-boot-autoconfigure-2.3.4.RELEASE.jaråŒ…é‡Œé¢ä¹Ÿæœ‰META-INF/spring.factories ![image-20220324214138887](.\\spring boot2å­¦ä¹ ç¬”è®°.assets\\image-20220324214138887.png)\nspring-boot-autoconfigure-2.3.4.RELEASE.jar/META-INF/spring.factories\r# Auto Configure\rorg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\rorg.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.batch.BatchAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.cache.CacheAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.cassandra.CassandraAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.context.ConfigurationPropertiesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.context.LifecycleAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.context.MessageSourceAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.couchbase.CouchbaseAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.dao.PersistenceExceptionTranslationAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.cassandra.CassandraDataAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveDataAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.cassandra.CassandraRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.couchbase.CouchbaseDataAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveDataAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.couchbase.CouchbaseRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchDataAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.elasticsearch.ReactiveElasticsearchRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.elasticsearch.ReactiveElasticsearchRestClientAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.jdbc.JdbcRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.ldap.LdapRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.mongo.MongoDataAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.mongo.MongoReactiveDataAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.mongo.MongoReactiveRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.mongo.MongoRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.neo4j.Neo4jDataAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.neo4j.Neo4jRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.solr.SolrRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.r2dbc.R2dbcDataAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.r2dbc.R2dbcRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.r2dbc.R2dbcTransactionManagerAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.redis.RedisReactiveAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.rest.RepositoryRestMvcAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.elasticsearch.ElasticsearchRestClientAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.freemarker.FreeMarkerAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.gson.GsonAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.hateoas.HypermediaAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.hazelcast.HazelcastAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.hazelcast.HazelcastJpaDependencyAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.http.HttpMessageConvertersAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.http.codec.CodecsAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.influx.InfluxDbAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.info.ProjectInfoAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jdbc.JndiDataSourceAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jdbc.XADataSourceAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jms.JmsAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jms.JndiConnectionFactoryAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jms.activemq.ActiveMQAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jms.artemis.ArtemisAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jersey.JerseyAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jooq.JooqAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.jsonb.JsonbAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.availability.ApplicationAvailabilityAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.ldap.embedded.EmbeddedLdapAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.ldap.LdapAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.mail.MailSenderAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.mail.MailSenderValidatorAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongoAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.mongo.MongoReactiveAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.mustache.MustacheAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.quartz.QuartzAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.r2dbc.R2dbcAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.rsocket.RSocketMessagingAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.rsocket.RSocketRequesterAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.rsocket.RSocketServerAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.rsocket.RSocketStrategiesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.security.servlet.SecurityFilterAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.security.reactive.ReactiveSecurityAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.security.reactive.ReactiveUserDetailsServiceAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.security.rsocket.RSocketSecurityAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.security.saml2.Saml2RelyingPartyAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.sendgrid.SendGridAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.session.SessionAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.security.oauth2.client.servlet.OAuth2ClientAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.security.oauth2.client.reactive.ReactiveOAuth2ClientAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.security.oauth2.resource.servlet.OAuth2ResourceServerAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.security.oauth2.resource.reactive.ReactiveOAuth2ResourceServerAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.solr.SolrAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.task.TaskSchedulingAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.thymeleaf.ThymeleafAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.transaction.jta.JtaAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.client.RestTemplateAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.embedded.EmbeddedWebServerFactoryCustomizerAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.reactive.HttpHandlerAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.reactive.ReactiveWebServerFactoryAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.reactive.WebFluxAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.reactive.error.ErrorWebFluxAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.reactive.function.client.ClientHttpConnectorAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.reactive.function.client.WebClientAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.servlet.DispatcherServletAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.servlet.MultipartAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.websocket.reactive.WebSocketReactiveAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.websocket.servlet.WebSocketServletAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.websocket.servlet.WebSocketMessagingAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.webservices.WebServicesAutoConfiguration,\\\rorg.springframework.boot.autoconfigure.webservices.client.WebServiceTemplateAutoConfiguration è¿™æ˜¯springbootä¼šè‡ªåŠ¨åŠ è½½çš„ç»„ä»¶\n3.2\tæŒ‰éœ€å¼€å¯è‡ªåŠ¨é…ç½®é¡¹ è™½ç„¶æˆ‘ä»¬127ä¸ªåœºæ™¯çš„æ‰€æœ‰è‡ªåŠ¨é…ç½®å¯åŠ¨çš„æ—¶å€™é»˜è®¤å…¨éƒ¨åŠ è½½ã€‚xxxxAutoConfiguration æŒ‰ç…§æ¡ä»¶è£…é…è§„åˆ™ï¼ˆ@Conditionalï¼‰ï¼Œæœ€ç»ˆä¼šæŒ‰éœ€é…ç½®ã€‚\n3.3ï¼Œä¿®æ”¹é»˜è®¤é…ç½® @Bean @ConditionalOnBean(MultipartResolver.class) //å®¹å™¨ä¸­æœ‰è¿™ä¸ªç±»å‹ç»„ä»¶ @ConditionalOnMissingBean(name = DispatcherServlet.MULTIPART_RESOLVER_BEAN_NAME) //å®¹å™¨ä¸­æ²¡æœ‰è¿™ä¸ªåå­— multipartResolver çš„ç»„ä»¶ public MultipartResolver multipartResolver(MultipartResolver resolver) { //ç»™@Beanæ ‡æ³¨çš„æ–¹æ³•ä¼ å…¥äº†å¯¹è±¡å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°çš„å€¼å°±ä¼šä»å®¹å™¨ä¸­æ‰¾ã€‚ //SpringMVC multipartResolverã€‚é˜²æ­¢æœ‰äº›ç”¨æˆ·é…ç½®çš„æ–‡ä»¶ä¸Šä¼ è§£æå™¨ä¸ç¬¦åˆè§„èŒƒ // Detect if the user has created a MultipartResolver but named it incorrectly return resolver; } ç»™å®¹å™¨ä¸­åŠ å…¥äº†æ–‡ä»¶ä¸Šä¼ è§£æå™¨ï¼› SpringBooté»˜è®¤ä¼šåœ¨åº•å±‚é…å¥½æ‰€æœ‰ç»„ä»¶ã€‚ä½†æ˜¯å¦‚æœç”¨æˆ·è‡ªå·±é…ç½®äº†çš„è¯ ä»¥ç”¨æˆ·é…ç½®çš„ä¼˜å…ˆ\nä¾‹å¦‚ï¼š\n@Bean @ConditionalOnMissingBean public CharacterEncodingFilter characterEncodingFilter() { } 3.4\tæ€»ç»“ SpringBootå¯åŠ¨æ—¶å…ˆåŠ è½½æ‰€æœ‰çš„è‡ªåŠ¨é…ç½®ç±» xxxxAutoConfiguration\næ¯ä¸ªè‡ªåŠ¨é…ç½®ç±»æŒ‰ç…§æ¡ä»¶è¿›è¡Œç”Ÿæ•ˆï¼ˆConditonalxxxxï¼‰ï¼Œé»˜è®¤éƒ½ä¼šç»‘å®šé…ç½®æ–‡ä»¶ä¸­çš„å€¼ï¼ŒxxxxPropertiesé‡Œé¢æ‹¿ã€‚xxxxPropertieså’Œé…ç½®æ–‡ä»¶è¿›è¡Œäº†ç»‘å®š\nç”Ÿæ•ˆäº†çš„é…ç½®ç±»ä¼šç»™å®¹å™¨é…ç½®ç›¸åº”çš„ç»„ä»¶\nåªè¦å®¹å™¨ä¸­æœ‰è¿™äº›ç»„å°†ï¼Œå°±ç›¸å½“äºæœ‰äº†è¿™äº›åŠŸèƒ½\nå®šåˆ¶é…ç½®\na\u0026gt;ç”¨æˆ·è‡ªå·±é…ç½®Beanæ›¿æ¢åº•å±‚çš„ç»„ä»¶\nb\u0026gt;ç”¨æˆ·å»çœ‹è¿™ä¸ªç»„ä»¶æ˜¯è·å–çš„é…ç½®æ–‡ä»¶çš„ä»€ä¹ˆå€¼ï¼Œè‡ªå·±å»é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹\nxxxxAutoConfiguration \u0026mdash;-\u0026gt;å¯¹åº”çš„ç»„ä»¶\u0026mdash;-\u0026gt;xxxxPropertiesé‡Œé¢æ‹¿å€¼\u0026mdash;\u0026ndash;application.properties\n","permalink":"https://XianCH.github.io/posts/tech/java/springboot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","summary":"\u003ch1 id=\"spring-boot2å­¦ä¹ ç¬”è®°\"\u003espring boot2å­¦ä¹ ç¬”è®°\u003c/h1\u003e\n\u003ch2 id=\"ä¸€spring-boot2æ ¸å¿ƒæŠ€æœ¯åŸºç¡€å…¥é—¨\"\u003eä¸€ï¼Œ\tspring boot2æ ¸å¿ƒæŠ€æœ¯åŸºç¡€å…¥é—¨\u003c/h2\u003e\n\u003ch3 id=\"1springèƒ½åšä»€ä¹ˆ\"\u003e1.springèƒ½åšä»€ä¹ˆ\u003c/h3\u003e\n\u003ch4 id=\"11-springçš„èƒ½åŠ›\"\u003e1.1 springçš„èƒ½åŠ›\u003c/h4\u003e\n\u003cp\u003e![image-20220321190444355](spring boot2å­¦ä¹ ç¬”è®°.assets\\image-20220321190444355.png)\u003c/p\u003e\n\u003ch2 id=\"äºŒä¸ºä»€ä¹ˆç”¨springboot\"\u003eäºŒ\tã€ä¸ºä»€ä¹ˆç”¨SpringBoot\u003c/h2\u003e\n\u003cp\u003eSpring Boot makes it easy to create stand-alone, production-grade Spring based Applications that you can \u0026ldquo;just run\u0026rdquo;.\u003c/p\u003e\n\u003cp\u003eèƒ½å¿«é€Ÿåˆ›å»ºå‡ºç”Ÿäº§çº§åˆ«çš„Springåº”ç”¨\u003c/p\u003e\n\u003ch3 id=\"21springbootä¼˜ç‚¹\"\u003e2.1ã€SpringBootä¼˜ç‚¹\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eCreate stand-alone Spring applications\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cul\u003e\n\u003cli\u003eåˆ›å»ºç‹¬ç«‹Springåº”ç”¨\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eEmbed Tomcat, Jetty or Undertow directly (no need to deploy WAR files)\u003c/p\u003e","title":"springbootå­¦ä¹ ç¬”è®°"},{"content":"","permalink":"https://XianCH.github.io/posts/life/life/","summary":"","title":"Life"},{"content":"","permalink":"https://XianCH.github.io/posts/read/read/","summary":"","title":"Read"},{"content":"sqlå¤‡å¿˜å½• ç»‘å®šå¤–é”® CONSTRAINT `tb_product_ibfk_1` FOREIGN KEY (`category_id`) REFERENCES `tb_product_category` (`id`) ON DELETE RESTRICT ON UPDATE RESTRICT è¯­å¥ ç»‘å®šä¸»é”®\nPRIMARY KEY (`id`) USING BTREE ç´¢å¼• B-TREEç´¢å¼•:\tUSING BTREE\næ•°æ®ç±»å‹ æ•°å€¼ç±»å‹ ï¼š\ntinyint -128~127ä¹‹é—´çš„æ•´æ•°\nsmallint\nmediumint\nint\nbigint\næµ®ç‚¹ç±»å‹ float ï¼Œ double\nå­—ç¬¦ä¸²ç±»å‹ï¼š\nvarchar ï¼Œ\ncharï¼Œï¼ˆï¼‰ä¸­ä¿å­˜ä¸€ä¸ªå­—èŠ‚\næ—¥æœŸæ—¶é—´ç±»å‹\nDATE\nTIME\nDATETIME\n``TIMESTAMP`ã€‚\næ–‡æœ¬ç±»å‹ æ–‡æœ¬ç±»å‹åŒ…æ‹¬TEXTå’ŒBLOBã€‚åœ¨MySQLä¸­ï¼ŒTEXTç±»å‹åŒ…æ‹¬TINYTEXTã€TEXTã€MEDIUMTEXTå’ŒLONGTEXTï¼Œå®ƒä»¬çš„å­˜å‚¨æ–¹å¼éƒ½æ˜¯å˜é•¿å­˜å‚¨ï¼Œå¯ä»¥å­˜å‚¨è¾ƒå¤§çš„æ–‡æœ¬æ•°æ®ï¼›è€ŒBLOBç±»å‹åŒ…æ‹¬TINYBLOBã€BLOBã€MEDIUMBLOBå’ŒLONGBLOBï¼Œå®ƒä»¬çš„å­˜å‚¨æ–¹å¼ä¹Ÿæ˜¯å˜é•¿å­˜å‚¨ï¼Œå¯ä»¥å­˜å‚¨è¾ƒå¤§çš„äºŒè¿›åˆ¶æ•°æ®ã€‚\næšä¸¾ç±»å‹å’Œé›†åˆç±»å‹ æšä¸¾ç±»å‹å’Œé›†åˆç±»å‹æ˜¯MySQLä¸­ç‰¹æœ‰çš„ç±»å‹ã€‚æšä¸¾ç±»å‹å­˜å‚¨æ—¶ä¼šå°†æšä¸¾å€¼è½¬æ¢æˆæ•´æ•°å­˜å‚¨ï¼Œè€Œé›†åˆç±»å‹å­˜å‚¨æ—¶åˆ™ä¼šå°†å¤šä¸ªæšä¸¾å€¼ç»„åˆæˆä¸€ä¸ªé›†åˆè¿›è¡Œå­˜å‚¨\nç²¾ç¡®æ•°å€¼:\nDECIMAL(M,D) Mä»£è¡¨å¤šå°‘ä¸ºæ•°ï¼ŒDä»£è¡¨å°æ•°ç‚¹åå‡ ä½ â€‹\nä¿®é¥°ç¬¦ unsigned éè´Ÿæ•°\næ—¶é—´ä¿®é¥°ç¬¦ï¼šCURRENT_TIMESTAMP(0)å½“å‰æ—¶é—´ 0 è¡¨ç¤ºå°æ•°ç‚¹åé¢çš„ä½æ•°\nDEFAULT CURRENT_TIMESTAMP(0) ON UPDATE CURRENT_TIMESTAMP(0)\nç¼–ç æ ¼å¼ åœ¨ASCIIç¼–ç ä¸­ï¼Œæ¯ä¸ªå­—ç¬¦å ç”¨1ä¸ªå­—èŠ‚ï¼›\nåœ¨UTF-8ç¼–ç ä¸­ï¼Œä¸€ä¸ªè‹±æ–‡å­—ç¬¦å ç”¨1ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªæ±‰å­—å­—ç¬¦å ç”¨3ä¸ªå­—èŠ‚ï¼›\nåœ¨UTF-16ç¼–ç ä¸­ï¼Œä¸€ä¸ªè‹±æ–‡å­—ç¬¦å ç”¨2ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªæ±‰å­—å­—ç¬¦å ç”¨2ä¸ªæˆ–4ä¸ªå­—èŠ‚ï¼›åœ¨UTF-32ç¼–ç ä¸­ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½å ç”¨4ä¸ªå­—èŠ‚ã€‚\nå­—ç¬¦æ’åºè§„åˆ™ CHARACTER SET = utf8 COLLATE = utf8_general_ciä¸åŒºåˆ†å¤§å°å†™\nä¼˜åŒ– ROW_FORMAT æ˜¯ç”¨äºæŒ‡å®šè¡¨ä¸­è¡Œçš„å­˜å‚¨æ ¼å¼çš„ä¸€ç§é€‰é¡¹\nROW_FORMAT = Dynamicæ˜¯ä¸€ç§è¡Œæ ¼å¼ï¼ŒMySQLä¼šæ ¹æ®è¡Œçš„å¤§å°è‡ªåŠ¨é€‰æ‹©è¡Œçš„å­˜å‚¨æ–¹å¼ï¼Œå¯ä»¥æ˜¯COMPACTæˆ–è€…REDUNDANTã€‚å¯¹äºæ¯”è¾ƒå°çš„è¡Œï¼ŒMySQLä¼šä½¿ç”¨æ›´ç´§å‡‘çš„å­˜å‚¨æ–¹å¼ï¼ˆCOMPACTï¼‰ï¼Œè€Œå¯¹äºè¾ƒå¤§çš„è¡Œï¼ŒMySQLä¼šä½¿ç”¨æ›´å®½æ¾çš„å­˜å‚¨æ–¹å¼ï¼ˆREDUNDANTï¼‰ï¼Œä»¥èŠ‚çœå­˜å‚¨ç©ºé—´ã€‚è¿™ç§è‡ªé€‚åº”çš„å­˜å‚¨æ–¹å¼å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæé«˜è¡¨çš„å­˜å‚¨æ•ˆç‡å’ŒæŸ¥è¯¢æ€§èƒ½\n","permalink":"https://XianCH.github.io/posts/tech/database/sql%E5%A4%87%E5%BF%98%E5%BD%95/","summary":"\u003ch1 id=\"sqlå¤‡å¿˜å½•\"\u003esqlå¤‡å¿˜å½•\u003c/h1\u003e\n\u003ch2 id=\"ç»‘å®šå¤–é”®\"\u003eç»‘å®šå¤–é”®\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCONSTRAINT\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003etb_product_ibfk_1\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eFOREIGN\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eKEY\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003ecategory_id\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eREFERENCES\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003etb_product_category\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eid\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eON\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eDELETE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eRESTRICT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eON\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eUPDATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eRESTRICT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"è¯­å¥\"\u003eè¯­å¥\u003c/h2\u003e\n\u003cp\u003eç»‘å®šä¸»é”®\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003ePRIMARY\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eKEY\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eid\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eUSING\u003c/span\u003e BTREE\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"ç´¢å¼•\"\u003eç´¢å¼•\u003c/h2\u003e\n\u003cp\u003eB-TREEç´¢å¼•:\tUSING BTREE\u003c/p\u003e\n\u003ch2 id=\"æ•°æ®ç±»å‹\"\u003eæ•°æ®ç±»å‹\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eæ•°å€¼ç±»å‹ ï¼š\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003etinyint\u003c/code\u003e -128~127ä¹‹é—´çš„æ•´æ•°\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003esmallint\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003emediumint\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eint\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ebigint\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eæµ®ç‚¹ç±»å‹ float ï¼Œ double\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eå­—ç¬¦ä¸²ç±»å‹ï¼š\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003evarchar\u003c/code\u003e ï¼Œ\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003echar\u003c/code\u003eï¼Œï¼ˆï¼‰ä¸­ä¿å­˜ä¸€ä¸ªå­—èŠ‚\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eæ—¥æœŸæ—¶é—´ç±»å‹\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eDATE\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eTIME\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eDATETIME\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e``TIMESTAMP`ã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eæ–‡æœ¬ç±»å‹ æ–‡æœ¬ç±»å‹åŒ…æ‹¬TEXTå’ŒBLOBã€‚åœ¨MySQLä¸­ï¼ŒTEXTç±»å‹åŒ…æ‹¬TINYTEXTã€TEXTã€MEDIUMTEXTå’ŒLONGTEXTï¼Œå®ƒä»¬çš„å­˜å‚¨æ–¹å¼éƒ½æ˜¯å˜é•¿å­˜å‚¨ï¼Œå¯ä»¥å­˜å‚¨è¾ƒå¤§çš„æ–‡æœ¬æ•°æ®ï¼›è€ŒBLOBç±»å‹åŒ…æ‹¬TINYBLOBã€BLOBã€MEDIUMBLOBå’ŒLONGBLOBï¼Œå®ƒä»¬çš„å­˜å‚¨æ–¹å¼ä¹Ÿæ˜¯å˜é•¿å­˜å‚¨ï¼Œå¯ä»¥å­˜å‚¨è¾ƒå¤§çš„äºŒè¿›åˆ¶æ•°æ®ã€‚\u003c/p\u003e","title":"sqlå¤‡å¿˜å½•"},{"content":"ä¸€ã€SpringMVCç®€ä»‹ 1ã€ä»€ä¹ˆæ˜¯MVC MVCæ˜¯ä¸€ç§è½¯ä»¶æ¶æ„çš„æ€æƒ³ï¼Œå°†è½¯ä»¶æŒ‰ç…§æ¨¡å‹ã€è§†å›¾ã€æ§åˆ¶å™¨æ¥åˆ’åˆ†\nMï¼šModelï¼Œæ¨¡å‹å±‚ï¼ŒæŒ‡å·¥ç¨‹ä¸­çš„JavaBeanï¼Œä½œç”¨æ˜¯å¤„ç†æ•°æ®\nJavaBeanåˆ†ä¸ºä¸¤ç±»ï¼š\nä¸€ç±»ç§°ä¸ºå®ä½“ç±»Beanï¼šä¸“é—¨å­˜å‚¨ä¸šåŠ¡æ•°æ®çš„ï¼Œå¦‚ Studentã€User ç­‰ ä¸€ç±»ç§°ä¸ºä¸šåŠ¡å¤„ç† Beanï¼šæŒ‡ Service æˆ– Dao å¯¹è±¡ï¼Œä¸“é—¨ç”¨äºå¤„ç†ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®è®¿é—®ã€‚ Vï¼šViewï¼Œè§†å›¾å±‚ï¼ŒæŒ‡å·¥ç¨‹ä¸­çš„htmlæˆ–jspç­‰é¡µé¢ï¼Œä½œç”¨æ˜¯ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’ï¼Œå±•ç¤ºæ•°æ®\nCï¼šControllerï¼Œæ§åˆ¶å±‚ï¼ŒæŒ‡å·¥ç¨‹ä¸­çš„servletï¼Œä½œç”¨æ˜¯æ¥æ”¶è¯·æ±‚å’Œå“åº”æµè§ˆå™¨\nMVCçš„å·¥ä½œæµç¨‹ï¼š ç”¨æˆ·é€šè¿‡è§†å›¾å±‚å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œåœ¨æœåŠ¡å™¨ä¸­è¯·æ±‚è¢«Controlleræ¥æ”¶ï¼ŒControllerè°ƒç”¨ç›¸åº”çš„Modelå±‚å¤„ç†è¯·æ±‚ï¼Œå¤„ç†å®Œæ¯•å°†ç»“æœè¿”å›åˆ°Controllerï¼ŒControllerå†æ ¹æ®è¯·æ±‚å¤„ç†çš„ç»“æœæ‰¾åˆ°ç›¸åº”çš„Viewè§†å›¾ï¼Œæ¸²æŸ“æ•°æ®åæœ€ç»ˆå“åº”ç»™æµè§ˆå™¨\n2ã€ä»€ä¹ˆæ˜¯SpringMVC SpringMVCæ˜¯Springçš„ä¸€ä¸ªåç»­äº§å“ï¼Œæ˜¯Springçš„ä¸€ä¸ªå­é¡¹ç›®\nSpringMVC æ˜¯ Spring ä¸ºè¡¨è¿°å±‚å¼€å‘æä¾›çš„ä¸€æ•´å¥—å®Œå¤‡çš„è§£å†³æ–¹æ¡ˆã€‚åœ¨è¡¨è¿°å±‚æ¡†æ¶å†ç» Strustã€WebWorkã€Strust2 ç­‰è¯¸å¤šäº§å“çš„å†ä»£æ›´è¿­ä¹‹åï¼Œç›®å‰ä¸šç•Œæ™®éé€‰æ‹©äº† SpringMVC ä½œä¸º Java EE é¡¹ç›®è¡¨è¿°å±‚å¼€å‘çš„é¦–é€‰æ–¹æ¡ˆã€‚\næ³¨ï¼šä¸‰å±‚æ¶æ„åˆ†ä¸ºè¡¨è¿°å±‚ï¼ˆæˆ–è¡¨ç¤ºå±‚ï¼‰ã€ä¸šåŠ¡é€»è¾‘å±‚ã€æ•°æ®è®¿é—®å±‚ï¼Œè¡¨è¿°å±‚è¡¨ç¤ºå‰å°é¡µé¢å’Œåå°servlet\n3ã€SpringMVCçš„ç‰¹ç‚¹ Spring å®¶æ—åŸç”Ÿäº§å“ï¼Œä¸ IOC å®¹å™¨ç­‰åŸºç¡€è®¾æ–½æ— ç¼å¯¹æ¥ åŸºäºåŸç”Ÿçš„Servletï¼Œé€šè¿‡äº†åŠŸèƒ½å¼ºå¤§çš„å‰ç«¯æ§åˆ¶å™¨DispatcherServletï¼Œå¯¹è¯·æ±‚å’Œå“åº”è¿›è¡Œç»Ÿä¸€å¤„ç† è¡¨è¿°å±‚å„ç»†åˆ†é¢†åŸŸéœ€è¦è§£å†³çš„é—®é¢˜å…¨æ–¹ä½è¦†ç›–ï¼Œæä¾›å…¨é¢è§£å†³æ–¹æ¡ˆ ä»£ç æ¸…æ–°ç®€æ´ï¼Œå¤§å¹…åº¦æå‡å¼€å‘æ•ˆç‡ å†…éƒ¨ç»„ä»¶åŒ–ç¨‹åº¦é«˜ï¼Œå¯æ’æ‹”å¼ç»„ä»¶å³æ’å³ç”¨ï¼Œæƒ³è¦ä»€ä¹ˆåŠŸèƒ½é…ç½®ç›¸åº”ç»„ä»¶å³å¯ æ€§èƒ½å“è‘—ï¼Œå°¤å…¶é€‚åˆç°ä»£å¤§å‹ã€è¶…å¤§å‹äº’è”ç½‘é¡¹ç›®è¦æ±‚ äºŒã€HelloWorld 1ã€å¼€å‘ç¯å¢ƒ IDEï¼šidea 2019.2\næ„å»ºå·¥å…·ï¼šmaven3.5.4\næœåŠ¡å™¨ï¼štomcat7\nSpringç‰ˆæœ¬ï¼š5.3.1\n2ã€åˆ›å»ºmavenå·¥ç¨‹ a\u0026gt;æ·»åŠ webæ¨¡å— b\u0026gt;æ‰“åŒ…æ–¹å¼ï¼šwar c\u0026gt;å¼•å…¥ä¾èµ– \u0026lt;dependencies\u0026gt; \u0026lt;!-- SpringMVC --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-webmvc\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;5.3.1\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- æ—¥å¿— --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;ch.qos.logback\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;logback-classic\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.3\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- ServletAPI --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;javax.servlet\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;javax.servlet-api\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.1.0\u0026lt;/version\u0026gt; \u0026lt;scope\u0026gt;provided\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- Spring5å’ŒThymeleafæ•´åˆåŒ… --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.thymeleaf\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;thymeleaf-spring5\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.0.12.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; æ³¨ï¼šç”±äº Maven çš„ä¼ é€’æ€§ï¼Œæˆ‘ä»¬ä¸å¿…å°†æ‰€æœ‰éœ€è¦çš„åŒ…å…¨éƒ¨é…ç½®ä¾èµ–ï¼Œè€Œæ˜¯é…ç½®æœ€é¡¶ç«¯çš„ä¾èµ–ï¼Œå…¶ä»–é ä¼ é€’æ€§å¯¼å…¥ã€‚\n3ã€é…ç½®web.xml æ³¨å†ŒSpringMVCçš„å‰ç«¯æ§åˆ¶å™¨DispatcherServlet\na\u0026gt;é»˜è®¤é…ç½®æ–¹å¼ æ­¤é…ç½®ä½œç”¨ä¸‹ï¼ŒSpringMVCçš„é…ç½®æ–‡ä»¶é»˜è®¤ä½äºWEB-INFä¸‹ï¼Œé»˜è®¤åç§°ä¸º\u0026lt;servlet-name\u0026gt;-servlet.xmlï¼Œä¾‹å¦‚ï¼Œä»¥ä¸‹é…ç½®æ‰€å¯¹åº”SpringMVCçš„é…ç½®æ–‡ä»¶ä½äºWEB-INFä¸‹ï¼Œæ–‡ä»¶åä¸ºspringMVC-servlet.xml\n\u0026lt;!-- é…ç½®SpringMVCçš„å‰ç«¯æ§åˆ¶å™¨ï¼Œå¯¹æµè§ˆå™¨å‘é€çš„è¯·æ±‚ç»Ÿä¸€è¿›è¡Œå¤„ç† --\u0026gt; \u0026lt;servlet\u0026gt; \u0026lt;servlet-name\u0026gt;springMVC\u0026lt;/servlet-name\u0026gt; \u0026lt;servlet-class\u0026gt;org.springframework.web.servlet.DispatcherServlet\u0026lt;/servlet-class\u0026gt; \u0026lt;/servlet\u0026gt; \u0026lt;servlet-mapping\u0026gt; \u0026lt;servlet-name\u0026gt;springMVC\u0026lt;/servlet-name\u0026gt; \u0026lt;!-- è®¾ç½®springMVCçš„æ ¸å¿ƒæ§åˆ¶å™¨æ‰€èƒ½å¤„ç†çš„è¯·æ±‚çš„è¯·æ±‚è·¯å¾„ /æ‰€åŒ¹é…çš„è¯·æ±‚å¯ä»¥æ˜¯/loginæˆ–.htmlæˆ–.jsæˆ–.cssæ–¹å¼çš„è¯·æ±‚è·¯å¾„ ä½†æ˜¯/ä¸èƒ½åŒ¹é….jspè¯·æ±‚è·¯å¾„çš„è¯·æ±‚ --\u0026gt; \u0026lt;url-pattern\u0026gt;/\u0026lt;/url-pattern\u0026gt; \u0026lt;/servlet-mapping\u0026gt; b\u0026gt;æ‰©å±•é…ç½®æ–¹å¼ å¯é€šè¿‡init-paramæ ‡ç­¾è®¾ç½®SpringMVCé…ç½®æ–‡ä»¶çš„ä½ç½®å’Œåç§°ï¼Œé€šè¿‡load-on-startupæ ‡ç­¾è®¾ç½®SpringMVCå‰ç«¯æ§åˆ¶å™¨DispatcherServletçš„åˆå§‹åŒ–æ—¶é—´\n\u0026lt;!-- é…ç½®SpringMVCçš„å‰ç«¯æ§åˆ¶å™¨ï¼Œå¯¹æµè§ˆå™¨å‘é€çš„è¯·æ±‚ç»Ÿä¸€è¿›è¡Œå¤„ç† --\u0026gt; \u0026lt;servlet\u0026gt; \u0026lt;servlet-name\u0026gt;springMVC\u0026lt;/servlet-name\u0026gt; \u0026lt;servlet-class\u0026gt;org.springframework.web.servlet.DispatcherServlet\u0026lt;/servlet-class\u0026gt; \u0026lt;!-- é€šè¿‡åˆå§‹åŒ–å‚æ•°æŒ‡å®šSpringMVCé…ç½®æ–‡ä»¶çš„ä½ç½®å’Œåç§° --\u0026gt; \u0026lt;init-param\u0026gt; \u0026lt;!-- contextConfigLocationä¸ºå›ºå®šå€¼ --\u0026gt; \u0026lt;param-name\u0026gt;contextConfigLocation\u0026lt;/param-name\u0026gt; \u0026lt;!-- ä½¿ç”¨classpath:è¡¨ç¤ºä»ç±»è·¯å¾„æŸ¥æ‰¾é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚mavenå·¥ç¨‹ä¸­çš„src/main/resources --\u0026gt; \u0026lt;param-value\u0026gt;classpath:springMVC.xml\u0026lt;/param-value\u0026gt; \u0026lt;/init-param\u0026gt; \u0026lt;!-- ä½œä¸ºæ¡†æ¶çš„æ ¸å¿ƒç»„ä»¶ï¼Œåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­æœ‰å¤§é‡çš„åˆå§‹åŒ–æ“ä½œè¦åš è€Œè¿™äº›æ“ä½œæ”¾åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶æ‰æ‰§è¡Œä¼šä¸¥é‡å½±å“è®¿é—®é€Ÿåº¦ å› æ­¤éœ€è¦é€šè¿‡æ­¤æ ‡ç­¾å°†å¯åŠ¨æ§åˆ¶DispatcherServletçš„åˆå§‹åŒ–æ—¶é—´æå‰åˆ°æœåŠ¡å™¨å¯åŠ¨æ—¶ --\u0026gt; \u0026lt;load-on-startup\u0026gt;1\u0026lt;/load-on-startup\u0026gt; \u0026lt;/servlet\u0026gt; \u0026lt;servlet-mapping\u0026gt; \u0026lt;servlet-name\u0026gt;springMVC\u0026lt;/servlet-name\u0026gt; \u0026lt;!-- è®¾ç½®springMVCçš„æ ¸å¿ƒæ§åˆ¶å™¨æ‰€èƒ½å¤„ç†çš„è¯·æ±‚çš„è¯·æ±‚è·¯å¾„ /æ‰€åŒ¹é…çš„è¯·æ±‚å¯ä»¥æ˜¯/loginæˆ–.htmlæˆ–.jsæˆ–.cssæ–¹å¼çš„è¯·æ±‚è·¯å¾„ ä½†æ˜¯/ä¸èƒ½åŒ¹é….jspè¯·æ±‚è·¯å¾„çš„è¯·æ±‚ --\u0026gt; \u0026lt;url-pattern\u0026gt;/\u0026lt;/url-pattern\u0026gt; \u0026lt;/servlet-mapping\u0026gt; æ³¨ï¼š\n\u0026lt;url-pattern\u0026gt;æ ‡ç­¾ä¸­ä½¿ç”¨/å’Œ/*çš„åŒºåˆ«ï¼š\n/æ‰€åŒ¹é…çš„è¯·æ±‚å¯ä»¥æ˜¯/loginæˆ–.htmlæˆ–.jsæˆ–.cssæ–¹å¼çš„è¯·æ±‚è·¯å¾„ï¼Œä½†æ˜¯/ä¸èƒ½åŒ¹é….jspè¯·æ±‚è·¯å¾„çš„è¯·æ±‚\nå› æ­¤å°±å¯ä»¥é¿å…åœ¨è®¿é—®jspé¡µé¢æ—¶ï¼Œè¯¥è¯·æ±‚è¢«DispatcherServletå¤„ç†ï¼Œä»è€Œæ‰¾ä¸åˆ°ç›¸åº”çš„é¡µé¢\n/*åˆ™èƒ½å¤ŸåŒ¹é…æ‰€æœ‰è¯·æ±‚ï¼Œä¾‹å¦‚åœ¨ä½¿ç”¨è¿‡æ»¤å™¨æ—¶ï¼Œè‹¥éœ€è¦å¯¹æ‰€æœ‰è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œå°±éœ€è¦ä½¿ç”¨/*çš„å†™æ³•\n4ã€åˆ›å»ºè¯·æ±‚æ§åˆ¶å™¨ ç”±äºå‰ç«¯æ§åˆ¶å™¨å¯¹æµè§ˆå™¨å‘é€çš„è¯·æ±‚è¿›è¡Œäº†ç»Ÿä¸€çš„å¤„ç†ï¼Œä½†æ˜¯å…·ä½“çš„è¯·æ±‚æœ‰ä¸åŒçš„å¤„ç†è¿‡ç¨‹ï¼Œå› æ­¤éœ€è¦åˆ›å»ºå¤„ç†å…·ä½“è¯·æ±‚çš„ç±»ï¼Œå³è¯·æ±‚æ§åˆ¶å™¨\nè¯·æ±‚æ§åˆ¶å™¨ä¸­æ¯ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ–¹æ³•æˆä¸ºæ§åˆ¶å™¨æ–¹æ³•\nå› ä¸ºSpringMVCçš„æ§åˆ¶å™¨ç”±ä¸€ä¸ªPOJOï¼ˆæ™®é€šçš„Javaç±»ï¼‰æ‹…ä»»ï¼Œå› æ­¤éœ€è¦é€šè¿‡@Controlleræ³¨è§£å°†å…¶æ ‡è¯†ä¸ºä¸€ä¸ªæ§åˆ¶å±‚ç»„ä»¶ï¼Œäº¤ç»™Springçš„IoCå®¹å™¨ç®¡ç†ï¼Œæ­¤æ—¶SpringMVCæ‰èƒ½å¤Ÿè¯†åˆ«æ§åˆ¶å™¨çš„å­˜åœ¨\n@Controller public class HelloController { } 5ã€åˆ›å»ºspringMVCçš„é…ç½®æ–‡ä»¶ \u0026lt;!-- è‡ªåŠ¨æ‰«æåŒ… --\u0026gt; \u0026lt;context:component-scan base-package=\u0026#34;com.atguigu.mvc.controller\u0026#34;/\u0026gt; \u0026lt;!-- é…ç½®Thymeleafè§†å›¾è§£æå™¨ --\u0026gt; \u0026lt;bean id=\u0026#34;viewResolver\u0026#34; class=\u0026#34;org.thymeleaf.spring5.view.ThymeleafViewResolver\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;order\u0026#34; value=\u0026#34;1\u0026#34;/\u0026gt; \u0026lt;property name=\u0026#34;characterEncoding\u0026#34; value=\u0026#34;UTF-8\u0026#34;/\u0026gt; \u0026lt;property name=\u0026#34;templateEngine\u0026#34;\u0026gt; \u0026lt;bean class=\u0026#34;org.thymeleaf.spring5.SpringTemplateEngine\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;templateResolver\u0026#34;\u0026gt; \u0026lt;bean class=\u0026#34;org.thymeleaf.spring5.templateresolver.SpringResourceTemplateResolver\u0026#34;\u0026gt; \u0026lt;!-- è§†å›¾å‰ç¼€ --\u0026gt; \u0026lt;property name=\u0026#34;prefix\u0026#34; value=\u0026#34;/WEB-INF/templates/\u0026#34;/\u0026gt; \u0026lt;!-- è§†å›¾åç¼€ --\u0026gt; \u0026lt;property name=\u0026#34;suffix\u0026#34; value=\u0026#34;.html\u0026#34;/\u0026gt; \u0026lt;property name=\u0026#34;templateMode\u0026#34; value=\u0026#34;HTML5\u0026#34;/\u0026gt; \u0026lt;property name=\u0026#34;characterEncoding\u0026#34; value=\u0026#34;UTF-8\u0026#34; /\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;!-- å¤„ç†é™æ€èµ„æºï¼Œä¾‹å¦‚htmlã€jsã€cssã€jpg è‹¥åªè®¾ç½®è¯¥æ ‡ç­¾ï¼Œåˆ™åªèƒ½è®¿é—®é™æ€èµ„æºï¼Œå…¶ä»–è¯·æ±‚åˆ™æ— æ³•è®¿é—® æ­¤æ—¶å¿…é¡»è®¾ç½®\u0026lt;mvc:annotation-driven/\u0026gt;è§£å†³é—®é¢˜ --\u0026gt; \u0026lt;mvc:default-servlet-handler/\u0026gt; \u0026lt;!-- å¼€å¯mvcæ³¨è§£é©±åŠ¨ --\u0026gt; \u0026lt;mvc:annotation-driven\u0026gt; \u0026lt;mvc:message-converters\u0026gt; \u0026lt;!-- å¤„ç†å“åº”ä¸­æ–‡å†…å®¹ä¹±ç  --\u0026gt; \u0026lt;bean class=\u0026#34;org.springframework.http.converter.StringHttpMessageConverter\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;defaultCharset\u0026#34; value=\u0026#34;UTF-8\u0026#34; /\u0026gt; \u0026lt;property name=\u0026#34;supportedMediaTypes\u0026#34;\u0026gt; \u0026lt;list\u0026gt; \u0026lt;value\u0026gt;text/html\u0026lt;/value\u0026gt; \u0026lt;value\u0026gt;application/json\u0026lt;/value\u0026gt; \u0026lt;/list\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;/mvc:message-converters\u0026gt; \u0026lt;/mvc:annotation-driven\u0026gt; 6ã€æµ‹è¯•HelloWorld a\u0026gt;å®ç°å¯¹é¦–é¡µçš„è®¿é—® åœ¨è¯·æ±‚æ§åˆ¶å™¨ä¸­åˆ›å»ºå¤„ç†è¯·æ±‚çš„æ–¹æ³•\n// @RequestMappingæ³¨è§£ï¼šå¤„ç†è¯·æ±‚å’Œæ§åˆ¶å™¨æ–¹æ³•ä¹‹é—´çš„æ˜ å°„å…³ç³» // @RequestMappingæ³¨è§£çš„valueå±æ€§å¯ä»¥é€šè¿‡è¯·æ±‚åœ°å€åŒ¹é…è¯·æ±‚ï¼Œ/è¡¨ç¤ºçš„å½“å‰å·¥ç¨‹çš„ä¸Šä¸‹æ–‡è·¯å¾„ // localhost:8080/springMVC/ @RequestMapping(\u0026#34;/\u0026#34;) public String index() { //è®¾ç½®è§†å›¾åç§° return \u0026#34;index\u0026#34;; } b\u0026gt;é€šè¿‡è¶…é“¾æ¥è·³è½¬åˆ°æŒ‡å®šé¡µé¢ åœ¨ä¸»é¡µindex.htmlä¸­è®¾ç½®è¶…é“¾æ¥\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34; xmlns:th=\u0026#34;http://www.thymeleaf.org\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;é¦–é¡µ\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;é¦–é¡µ\u0026lt;/h1\u0026gt; \u0026lt;a th:href=\u0026#34;@{/hello}\u0026#34;\u0026gt;HelloWorld\u0026lt;/a\u0026gt;\u0026lt;br/\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; åœ¨è¯·æ±‚æ§åˆ¶å™¨ä¸­åˆ›å»ºå¤„ç†è¯·æ±‚çš„æ–¹æ³•\n@RequestMapping(\u0026#34;/hello\u0026#34;) public String HelloWorld() { return \u0026#34;target\u0026#34;; } 7ã€æ€»ç»“ æµè§ˆå™¨å‘é€è¯·æ±‚ï¼Œè‹¥è¯·æ±‚åœ°å€ç¬¦åˆå‰ç«¯æ§åˆ¶å™¨çš„url-patternï¼Œè¯¥è¯·æ±‚å°±ä¼šè¢«å‰ç«¯æ§åˆ¶å™¨DispatcherServletå¤„ç†ã€‚å‰ç«¯æ§åˆ¶å™¨ä¼šè¯»å–SpringMVCçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œé€šè¿‡æ‰«æç»„ä»¶æ‰¾åˆ°æ§åˆ¶å™¨ï¼Œå°†è¯·æ±‚åœ°å€å’Œæ§åˆ¶å™¨ä¸­@RequestMappingæ³¨è§£çš„valueå±æ€§å€¼è¿›è¡ŒåŒ¹é…ï¼Œè‹¥åŒ¹é…æˆåŠŸï¼Œè¯¥æ³¨è§£æ‰€æ ‡è¯†çš„æ§åˆ¶å™¨æ–¹æ³•å°±æ˜¯å¤„ç†è¯·æ±‚çš„æ–¹æ³•ã€‚å¤„ç†è¯·æ±‚çš„æ–¹æ³•éœ€è¦è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„è§†å›¾åç§°ï¼Œè¯¥è§†å›¾åç§°ä¼šè¢«è§†å›¾è§£æå™¨è§£æï¼ŒåŠ ä¸Šå‰ç¼€å’Œåç¼€ç»„æˆè§†å›¾çš„è·¯å¾„ï¼Œé€šè¿‡Thymeleafå¯¹è§†å›¾è¿›è¡Œæ¸²æŸ“ï¼Œæœ€ç»ˆè½¬å‘åˆ°è§†å›¾æ‰€å¯¹åº”é¡µé¢\nä¸‰ã€@RequestMappingæ³¨è§£ 1ã€@RequestMappingæ³¨è§£çš„åŠŸèƒ½ ä»æ³¨è§£åç§°ä¸Šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ@RequestMappingæ³¨è§£çš„ä½œç”¨å°±æ˜¯å°†è¯·æ±‚å’Œå¤„ç†è¯·æ±‚çš„æ§åˆ¶å™¨æ–¹æ³•å…³è”èµ·æ¥ï¼Œå»ºç«‹æ˜ å°„å…³ç³»ã€‚\nSpringMVC æ¥æ”¶åˆ°æŒ‡å®šçš„è¯·æ±‚ï¼Œå°±ä¼šæ¥æ‰¾åˆ°åœ¨æ˜ å°„å…³ç³»ä¸­å¯¹åº”çš„æ§åˆ¶å™¨æ–¹æ³•æ¥å¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚\n2ã€@RequestMappingæ³¨è§£çš„ä½ç½® @RequestMappingæ ‡è¯†ä¸€ä¸ªç±»ï¼šè®¾ç½®æ˜ å°„è¯·æ±‚çš„è¯·æ±‚è·¯å¾„çš„åˆå§‹ä¿¡æ¯\n@RequestMappingæ ‡è¯†ä¸€ä¸ªæ–¹æ³•ï¼šè®¾ç½®æ˜ å°„è¯·æ±‚è¯·æ±‚è·¯å¾„çš„å…·ä½“ä¿¡æ¯\n@Controller @RequestMapping(\u0026#34;/test\u0026#34;) public class RequestMappingController { //æ­¤æ—¶è¯·æ±‚æ˜ å°„æ‰€æ˜ å°„çš„è¯·æ±‚çš„è¯·æ±‚è·¯å¾„ä¸ºï¼š/test/testRequestMapping @RequestMapping(\u0026#34;/testRequestMapping\u0026#34;) public String testRequestMapping(){ return \u0026#34;success\u0026#34;; } } 3ã€@RequestMappingæ³¨è§£çš„valueå±æ€§ @RequestMappingæ³¨è§£çš„valueå±æ€§é€šè¿‡è¯·æ±‚çš„è¯·æ±‚åœ°å€åŒ¹é…è¯·æ±‚æ˜ å°„\n@RequestMappingæ³¨è§£çš„valueå±æ€§æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„æ•°ç»„ï¼Œè¡¨ç¤ºè¯¥è¯·æ±‚æ˜ å°„èƒ½å¤ŸåŒ¹é…å¤šä¸ªè¯·æ±‚åœ°å€æ‰€å¯¹åº”çš„è¯·æ±‚\n@RequestMappingæ³¨è§£çš„valueå±æ€§å¿…é¡»è®¾ç½®ï¼Œè‡³å°‘é€šè¿‡è¯·æ±‚åœ°å€åŒ¹é…è¯·æ±‚æ˜ å°„\n\u0026lt;a th:href=\u0026#34;@{/testRequestMapping}\u0026#34;\u0026gt;æµ‹è¯•@RequestMappingçš„valueå±æ€§--\u0026gt;/testRequestMapping\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt; \u0026lt;a th:href=\u0026#34;@{/test}\u0026#34;\u0026gt;æµ‹è¯•@RequestMappingçš„valueå±æ€§--\u0026gt;/test\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt; @RequestMapping( value = {\u0026#34;/testRequestMapping\u0026#34;, \u0026#34;/test\u0026#34;} ) public String testRequestMapping(){ return \u0026#34;success\u0026#34;; } 4ã€@RequestMappingæ³¨è§£çš„methodå±æ€§ @RequestMappingæ³¨è§£çš„methodå±æ€§é€šè¿‡è¯·æ±‚çš„è¯·æ±‚æ–¹å¼ï¼ˆgetæˆ–postï¼‰åŒ¹é…è¯·æ±‚æ˜ å°„\n@RequestMappingæ³¨è§£çš„methodå±æ€§æ˜¯ä¸€ä¸ªRequestMethodç±»å‹çš„æ•°ç»„ï¼Œè¡¨ç¤ºè¯¥è¯·æ±‚æ˜ å°„èƒ½å¤ŸåŒ¹é…å¤šç§è¯·æ±‚æ–¹å¼çš„è¯·æ±‚\nè‹¥å½“å‰è¯·æ±‚çš„è¯·æ±‚åœ°å€æ»¡è¶³è¯·æ±‚æ˜ å°„çš„valueå±æ€§ï¼Œä½†æ˜¯è¯·æ±‚æ–¹å¼ä¸æ»¡è¶³methodå±æ€§ï¼Œåˆ™æµè§ˆå™¨æŠ¥é”™405ï¼šRequest method \u0026lsquo;POST\u0026rsquo; not supported\n\u0026lt;a th:href=\u0026#34;@{/test}\u0026#34;\u0026gt;æµ‹è¯•@RequestMappingçš„valueå±æ€§--\u0026gt;/test\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt; \u0026lt;form th:action=\u0026#34;@{/test}\u0026#34; method=\u0026#34;post\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; @RequestMapping( value = {\u0026#34;/testRequestMapping\u0026#34;, \u0026#34;/test\u0026#34;}, method = {RequestMethod.GET, RequestMethod.POST} ) public String testRequestMapping(){ return \u0026#34;success\u0026#34;; } æ³¨ï¼š\n1ã€å¯¹äºå¤„ç†æŒ‡å®šè¯·æ±‚æ–¹å¼çš„æ§åˆ¶å™¨æ–¹æ³•ï¼ŒSpringMVCä¸­æä¾›äº†@RequestMappingçš„æ´¾ç”Ÿæ³¨è§£\nå¤„ç†getè¯·æ±‚çš„æ˜ å°„\u0026ndash;\u0026gt;@GetMapping\nå¤„ç†postè¯·æ±‚çš„æ˜ å°„\u0026ndash;\u0026gt;@PostMapping\nå¤„ç†putè¯·æ±‚çš„æ˜ å°„\u0026ndash;\u0026gt;@PutMapping\nå¤„ç†deleteè¯·æ±‚çš„æ˜ å°„\u0026ndash;\u0026gt;@DeleteMapping\n2ã€å¸¸ç”¨çš„è¯·æ±‚æ–¹å¼æœ‰getï¼Œpostï¼Œputï¼Œdelete\nä½†æ˜¯ç›®å‰æµè§ˆå™¨åªæ”¯æŒgetå’Œpostï¼Œè‹¥åœ¨formè¡¨å•æäº¤æ—¶ï¼Œä¸ºmethodè®¾ç½®äº†å…¶ä»–è¯·æ±‚æ–¹å¼çš„å­—ç¬¦ä¸²ï¼ˆputæˆ–deleteï¼‰ï¼Œåˆ™æŒ‰ç…§é»˜è®¤çš„è¯·æ±‚æ–¹å¼getå¤„ç†\nè‹¥è¦å‘é€putå’Œdeleteè¯·æ±‚ï¼Œåˆ™éœ€è¦é€šè¿‡springæä¾›çš„è¿‡æ»¤å™¨HiddenHttpMethodFilterï¼Œåœ¨RESTfuléƒ¨åˆ†ä¼šè®²åˆ°\n5ã€@RequestMappingæ³¨è§£çš„paramså±æ€§ï¼ˆäº†è§£ï¼‰ @RequestMappingæ³¨è§£çš„paramså±æ€§é€šè¿‡è¯·æ±‚çš„è¯·æ±‚å‚æ•°åŒ¹é…è¯·æ±‚æ˜ å°„\n@RequestMappingæ³¨è§£çš„paramså±æ€§æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å››ç§è¡¨è¾¾å¼è®¾ç½®è¯·æ±‚å‚æ•°å’Œè¯·æ±‚æ˜ å°„çš„åŒ¹é…å…³ç³»\n\u0026ldquo;param\u0026rdquo;ï¼šè¦æ±‚è¯·æ±‚æ˜ å°„æ‰€åŒ¹é…çš„è¯·æ±‚å¿…é¡»æºå¸¦paramè¯·æ±‚å‚æ•°\n\u0026ldquo;!param\u0026rdquo;ï¼šè¦æ±‚è¯·æ±‚æ˜ å°„æ‰€åŒ¹é…çš„è¯·æ±‚å¿…é¡»ä¸èƒ½æºå¸¦paramè¯·æ±‚å‚æ•°\n\u0026ldquo;param=value\u0026rdquo;ï¼šè¦æ±‚è¯·æ±‚æ˜ å°„æ‰€åŒ¹é…çš„è¯·æ±‚å¿…é¡»æºå¸¦paramè¯·æ±‚å‚æ•°ä¸”param=value\n\u0026ldquo;param!=value\u0026rdquo;ï¼šè¦æ±‚è¯·æ±‚æ˜ å°„æ‰€åŒ¹é…çš„è¯·æ±‚å¿…é¡»æºå¸¦paramè¯·æ±‚å‚æ•°ä½†æ˜¯param!=value\n\u0026lt;a th:href=\u0026#34;@{/test(username=\u0026#39;admin\u0026#39;,password=123456)\u0026#34;\u0026gt;æµ‹è¯•@RequestMappingçš„paramså±æ€§--\u0026gt;/test\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt; @RequestMapping( value = {\u0026#34;/testRequestMapping\u0026#34;, \u0026#34;/test\u0026#34;} ,method = {RequestMethod.GET, RequestMethod.POST} ,params = {\u0026#34;username\u0026#34;,\u0026#34;password!=123456\u0026#34;} ) public String testRequestMapping(){ return \u0026#34;success\u0026#34;; } æ³¨ï¼š\nè‹¥å½“å‰è¯·æ±‚æ»¡è¶³@RequestMappingæ³¨è§£çš„valueå’Œmethodå±æ€§ï¼Œä½†æ˜¯ä¸æ»¡è¶³paramså±æ€§ï¼Œæ­¤æ—¶é¡µé¢å›æŠ¥é”™400ï¼šParameter conditions \u0026ldquo;username, password!=123456\u0026rdquo; not met for actual request parameters: username={admin}, password={123456}\n6ã€@RequestMappingæ³¨è§£çš„headerså±æ€§ï¼ˆäº†è§£ï¼‰ @RequestMappingæ³¨è§£çš„headerså±æ€§é€šè¿‡è¯·æ±‚çš„è¯·æ±‚å¤´ä¿¡æ¯åŒ¹é…è¯·æ±‚æ˜ å°„\n@RequestMappingæ³¨è§£çš„headerså±æ€§æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å››ç§è¡¨è¾¾å¼è®¾ç½®è¯·æ±‚å¤´ä¿¡æ¯å’Œè¯·æ±‚æ˜ å°„çš„åŒ¹é…å…³ç³»\n\u0026ldquo;header\u0026rdquo;ï¼šè¦æ±‚è¯·æ±‚æ˜ å°„æ‰€åŒ¹é…çš„è¯·æ±‚å¿…é¡»æºå¸¦headerè¯·æ±‚å¤´ä¿¡æ¯\n\u0026ldquo;!header\u0026rdquo;ï¼šè¦æ±‚è¯·æ±‚æ˜ å°„æ‰€åŒ¹é…çš„è¯·æ±‚å¿…é¡»ä¸èƒ½æºå¸¦headerè¯·æ±‚å¤´ä¿¡æ¯\n\u0026ldquo;header=value\u0026rdquo;ï¼šè¦æ±‚è¯·æ±‚æ˜ å°„æ‰€åŒ¹é…çš„è¯·æ±‚å¿…é¡»æºå¸¦headerè¯·æ±‚å¤´ä¿¡æ¯ä¸”header=value\n\u0026ldquo;header!=value\u0026rdquo;ï¼šè¦æ±‚è¯·æ±‚æ˜ å°„æ‰€åŒ¹é…çš„è¯·æ±‚å¿…é¡»æºå¸¦headerè¯·æ±‚å¤´ä¿¡æ¯ä¸”header!=value\nè‹¥å½“å‰è¯·æ±‚æ»¡è¶³@RequestMappingæ³¨è§£çš„valueå’Œmethodå±æ€§ï¼Œä½†æ˜¯ä¸æ»¡è¶³headerså±æ€§ï¼Œæ­¤æ—¶é¡µé¢æ˜¾ç¤º404é”™è¯¯ï¼Œå³èµ„æºæœªæ‰¾åˆ°\n7ã€SpringMVCæ”¯æŒanté£æ ¼çš„è·¯å¾„ ï¼Ÿï¼šè¡¨ç¤ºä»»æ„çš„å•ä¸ªå­—ç¬¦\n*ï¼šè¡¨ç¤ºä»»æ„çš„0ä¸ªæˆ–å¤šä¸ªå­—ç¬¦\n**ï¼šè¡¨ç¤ºä»»æ„çš„ä¸€å±‚æˆ–å¤šå±‚ç›®å½•\næ³¨æ„ï¼šåœ¨ä½¿ç”¨**æ—¶ï¼Œåªèƒ½ä½¿ç”¨/**/xxxçš„æ–¹å¼\n8ã€SpringMVCæ”¯æŒè·¯å¾„ä¸­çš„å ä½ç¬¦ï¼ˆé‡ç‚¹ï¼‰ åŸå§‹æ–¹å¼ï¼š/deleteUser?id=1\nrestæ–¹å¼ï¼š/deleteUser/1\nSpringMVCè·¯å¾„ä¸­çš„å ä½ç¬¦å¸¸ç”¨äºRESTfulé£æ ¼ä¸­ï¼Œå½“è¯·æ±‚è·¯å¾„ä¸­å°†æŸäº›æ•°æ®é€šè¿‡è·¯å¾„çš„æ–¹å¼ä¼ è¾“åˆ°æœåŠ¡å™¨ä¸­ï¼Œå°±å¯ä»¥åœ¨ç›¸åº”çš„@RequestMappingæ³¨è§£çš„valueå±æ€§ä¸­é€šè¿‡å ä½ç¬¦{xxx}è¡¨ç¤ºä¼ è¾“çš„æ•°æ®ï¼Œåœ¨é€šè¿‡@PathVariableæ³¨è§£ï¼Œå°†å ä½ç¬¦æ‰€è¡¨ç¤ºçš„æ•°æ®èµ‹å€¼ç»™æ§åˆ¶å™¨æ–¹æ³•çš„å½¢å‚\n\u0026lt;a th:href=\u0026#34;@{/testRest/1/admin}\u0026#34;\u0026gt;æµ‹è¯•è·¯å¾„ä¸­çš„å ä½ç¬¦--\u0026gt;/testRest\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt; @RequestMapping(\u0026#34;/testRest/{id}/{username}\u0026#34;) public String testRest(@PathVariable(\u0026#34;id\u0026#34;) String id, @PathVariable(\u0026#34;username\u0026#34;) String username){ System.out.println(\u0026#34;id:\u0026#34;+id+\u0026#34;,username:\u0026#34;+username); return \u0026#34;success\u0026#34;; } //æœ€ç»ˆè¾“å‡ºçš„å†…å®¹ä¸º--\u0026gt;id:1,username:admin å››ã€SpringMVCè·å–è¯·æ±‚å‚æ•° 1ã€é€šè¿‡ServletAPIè·å– å°†HttpServletRequestä½œä¸ºæ§åˆ¶å™¨æ–¹æ³•çš„å½¢å‚ï¼Œæ­¤æ—¶HttpServletRequestç±»å‹çš„å‚æ•°è¡¨ç¤ºå°è£…äº†å½“å‰è¯·æ±‚çš„è¯·æ±‚æŠ¥æ–‡çš„å¯¹è±¡\n@RequestMapping(\u0026#34;/testParam\u0026#34;) public String testParam(HttpServletRequest request){ String username = request.getParameter(\u0026#34;username\u0026#34;); String password = request.getParameter(\u0026#34;password\u0026#34;); System.out.println(\u0026#34;username:\u0026#34;+username+\u0026#34;,password:\u0026#34;+password); return \u0026#34;success\u0026#34;; } 2ã€é€šè¿‡æ§åˆ¶å™¨æ–¹æ³•çš„å½¢å‚è·å–è¯·æ±‚å‚æ•° åœ¨æ§åˆ¶å™¨æ–¹æ³•çš„å½¢å‚ä½ç½®ï¼Œè®¾ç½®å’Œè¯·æ±‚å‚æ•°åŒåçš„å½¢å‚ï¼Œå½“æµè§ˆå™¨å‘é€è¯·æ±‚ï¼ŒåŒ¹é…åˆ°è¯·æ±‚æ˜ å°„æ—¶ï¼Œåœ¨DispatcherServletä¸­å°±ä¼šå°†è¯·æ±‚å‚æ•°èµ‹å€¼ç»™ç›¸åº”çš„å½¢å‚\n\u0026lt;a th:href=\u0026#34;@{/testParam(username=\u0026#39;admin\u0026#39;,password=123456)}\u0026#34;\u0026gt;æµ‹è¯•è·å–è¯·æ±‚å‚æ•°--\u0026gt;/testParam\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt; @RequestMapping(\u0026#34;/testParam\u0026#34;) public String testParam(String username, String password){ System.out.println(\u0026#34;username:\u0026#34;+username+\u0026#34;,password:\u0026#34;+password); return \u0026#34;success\u0026#34;; } æ³¨ï¼š\nè‹¥è¯·æ±‚æ‰€ä¼ è¾“çš„è¯·æ±‚å‚æ•°ä¸­æœ‰å¤šä¸ªåŒåçš„è¯·æ±‚å‚æ•°ï¼Œæ­¤æ—¶å¯ä»¥åœ¨æ§åˆ¶å™¨æ–¹æ³•çš„å½¢å‚ä¸­è®¾ç½®å­—ç¬¦ä¸²æ•°ç»„æˆ–è€…å­—ç¬¦ä¸²ç±»å‹çš„å½¢å‚æ¥æ”¶æ­¤è¯·æ±‚å‚æ•°\nè‹¥ä½¿ç”¨å­—ç¬¦ä¸²æ•°ç»„ç±»å‹çš„å½¢å‚ï¼Œæ­¤å‚æ•°çš„æ•°ç»„ä¸­åŒ…å«äº†æ¯ä¸€ä¸ªæ•°æ®\nè‹¥ä½¿ç”¨å­—ç¬¦ä¸²ç±»å‹çš„å½¢å‚ï¼Œæ­¤å‚æ•°çš„å€¼ä¸ºæ¯ä¸ªæ•°æ®ä¸­é—´ä½¿ç”¨é€—å·æ‹¼æ¥çš„ç»“æœ\n3ã€@RequestParam @RequestParamæ˜¯å°†è¯·æ±‚å‚æ•°å’Œæ§åˆ¶å™¨æ–¹æ³•çš„å½¢å‚åˆ›å»ºæ˜ å°„å…³ç³»\n@RequestParamæ³¨è§£ä¸€å…±æœ‰ä¸‰ä¸ªå±æ€§ï¼š\nvalueï¼šæŒ‡å®šä¸ºå½¢å‚èµ‹å€¼çš„è¯·æ±‚å‚æ•°çš„å‚æ•°å\nrequiredï¼šè®¾ç½®æ˜¯å¦å¿…é¡»ä¼ è¾“æ­¤è¯·æ±‚å‚æ•°ï¼Œé»˜è®¤å€¼ä¸ºtrue\nè‹¥è®¾ç½®ä¸ºtrueæ—¶ï¼Œåˆ™å½“å‰è¯·æ±‚å¿…é¡»ä¼ è¾“valueæ‰€æŒ‡å®šçš„è¯·æ±‚å‚æ•°ï¼Œè‹¥æ²¡æœ‰ä¼ è¾“è¯¥è¯·æ±‚å‚æ•°ï¼Œä¸”æ²¡æœ‰è®¾ç½®defaultValueå±æ€§ï¼Œåˆ™é¡µé¢æŠ¥é”™400ï¼šRequired String parameter \u0026lsquo;xxx\u0026rsquo; is not presentï¼›è‹¥è®¾ç½®ä¸ºfalseï¼Œåˆ™å½“å‰è¯·æ±‚ä¸æ˜¯å¿…é¡»ä¼ è¾“valueæ‰€æŒ‡å®šçš„è¯·æ±‚å‚æ•°ï¼Œè‹¥æ²¡æœ‰ä¼ è¾“ï¼Œåˆ™æ³¨è§£æ‰€æ ‡è¯†çš„å½¢å‚çš„å€¼ä¸ºnull\ndefaultValueï¼šä¸ç®¡requiredå±æ€§å€¼ä¸ºtrueæˆ–falseï¼Œå½“valueæ‰€æŒ‡å®šçš„è¯·æ±‚å‚æ•°æ²¡æœ‰ä¼ è¾“æˆ–ä¼ è¾“çš„å€¼ä¸º\u0026quot;\u0026ldquo;æ—¶ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼ä¸ºå½¢å‚èµ‹å€¼\n4ã€@RequestHeader @RequestHeaderæ˜¯å°†è¯·æ±‚å¤´ä¿¡æ¯å’Œæ§åˆ¶å™¨æ–¹æ³•çš„å½¢å‚åˆ›å»ºæ˜ å°„å…³ç³»\n@RequestHeaderæ³¨è§£ä¸€å…±æœ‰ä¸‰ä¸ªå±æ€§ï¼švalueã€requiredã€defaultValueï¼Œç”¨æ³•åŒ@RequestParam\n5ã€@CookieValue @CookieValueæ˜¯å°†cookieæ•°æ®å’Œæ§åˆ¶å™¨æ–¹æ³•çš„å½¢å‚åˆ›å»ºæ˜ å°„å…³ç³»\n@CookieValueæ³¨è§£ä¸€å…±æœ‰ä¸‰ä¸ªå±æ€§ï¼švalueã€requiredã€defaultValueï¼Œç”¨æ³•åŒ@RequestParam\n6ã€é€šè¿‡POJOè·å–è¯·æ±‚å‚æ•° å¯ä»¥åœ¨æ§åˆ¶å™¨æ–¹æ³•çš„å½¢å‚ä½ç½®è®¾ç½®ä¸€ä¸ªå®ä½“ç±»ç±»å‹çš„å½¢å‚ï¼Œæ­¤æ—¶è‹¥æµè§ˆå™¨ä¼ è¾“çš„è¯·æ±‚å‚æ•°çš„å‚æ•°åå’Œå®ä½“ç±»ä¸­çš„å±æ€§åä¸€è‡´ï¼Œé‚£ä¹ˆè¯·æ±‚å‚æ•°å°±ä¼šä¸ºæ­¤å±æ€§èµ‹å€¼\n\u0026lt;form th:action=\u0026#34;@{/testpojo}\u0026#34; method=\u0026#34;post\u0026#34;\u0026gt; ç”¨æˆ·åï¼š\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34;\u0026gt;\u0026lt;br\u0026gt; å¯†ç ï¼š\u0026lt;input type=\u0026#34;password\u0026#34; name=\u0026#34;password\u0026#34;\u0026gt;\u0026lt;br\u0026gt; æ€§åˆ«ï¼š\u0026lt;input type=\u0026#34;radio\u0026#34; name=\u0026#34;sex\u0026#34; value=\u0026#34;ç”·\u0026#34;\u0026gt;ç”·\u0026lt;input type=\u0026#34;radio\u0026#34; name=\u0026#34;sex\u0026#34; value=\u0026#34;å¥³\u0026#34;\u0026gt;å¥³\u0026lt;br\u0026gt; å¹´é¾„ï¼š\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;age\u0026#34;\u0026gt;\u0026lt;br\u0026gt; é‚®ç®±ï¼š\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;email\u0026#34;\u0026gt;\u0026lt;br\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; @RequestMapping(\u0026#34;/testpojo\u0026#34;) public String testPOJO(User user){ System.out.println(user); return \u0026#34;success\u0026#34;; } //æœ€ç»ˆç»“æœ--\u0026gt;User{id=null, username=\u0026#39;å¼ ä¸‰\u0026#39;, password=\u0026#39;123\u0026#39;, age=23, sex=\u0026#39;ç”·\u0026#39;, email=\u0026#39;123@qq.com\u0026#39;} 7ã€è§£å†³è·å–è¯·æ±‚å‚æ•°çš„ä¹±ç é—®é¢˜ è§£å†³è·å–è¯·æ±‚å‚æ•°çš„ä¹±ç é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨SpringMVCæä¾›çš„ç¼–ç è¿‡æ»¤å™¨CharacterEncodingFilterï¼Œä½†æ˜¯å¿…é¡»åœ¨web.xmlä¸­è¿›è¡Œæ³¨å†Œ\n\u0026lt;!--é…ç½®springMVCçš„ç¼–ç è¿‡æ»¤å™¨--\u0026gt; \u0026lt;filter\u0026gt; \u0026lt;filter-name\u0026gt;CharacterEncodingFilter\u0026lt;/filter-name\u0026gt; \u0026lt;filter-class\u0026gt;org.springframework.web.filter.CharacterEncodingFilter\u0026lt;/filter-class\u0026gt; \u0026lt;init-param\u0026gt; \u0026lt;param-name\u0026gt;encoding\u0026lt;/param-name\u0026gt; \u0026lt;param-value\u0026gt;UTF-8\u0026lt;/param-value\u0026gt; \u0026lt;/init-param\u0026gt; \u0026lt;init-param\u0026gt; \u0026lt;param-name\u0026gt;forceResponseEncoding\u0026lt;/param-name\u0026gt; \u0026lt;param-value\u0026gt;true\u0026lt;/param-value\u0026gt; \u0026lt;/init-param\u0026gt; \u0026lt;/filter\u0026gt; \u0026lt;filter-mapping\u0026gt; \u0026lt;filter-name\u0026gt;CharacterEncodingFilter\u0026lt;/filter-name\u0026gt; \u0026lt;url-pattern\u0026gt;/*\u0026lt;/url-pattern\u0026gt; \u0026lt;/filter-mapping\u0026gt; æ³¨ï¼š\nSpringMVCä¸­å¤„ç†ç¼–ç çš„è¿‡æ»¤å™¨ä¸€å®šè¦é…ç½®åˆ°å…¶ä»–è¿‡æ»¤å™¨ä¹‹å‰ï¼Œå¦åˆ™æ— æ•ˆ\näº”ã€åŸŸå¯¹è±¡å…±äº«æ•°æ® 1ã€ä½¿ç”¨ServletAPIå‘requeståŸŸå¯¹è±¡å…±äº«æ•°æ® @RequestMapping(\u0026#34;/testServletAPI\u0026#34;) public String testServletAPI(HttpServletRequest request){ request.setAttribute(\u0026#34;testScope\u0026#34;, \u0026#34;hello,servletAPI\u0026#34;); return \u0026#34;success\u0026#34;; } 2ã€ä½¿ç”¨ModelAndViewå‘requeståŸŸå¯¹è±¡å…±äº«æ•°æ® @RequestMapping(\u0026#34;/testModelAndView\u0026#34;) public ModelAndView testModelAndView(){ /** * ModelAndViewæœ‰Modelå’ŒViewçš„åŠŸèƒ½ * Modelä¸»è¦ç”¨äºå‘è¯·æ±‚åŸŸå…±äº«æ•°æ® * Viewä¸»è¦ç”¨äºè®¾ç½®è§†å›¾ï¼Œå®ç°é¡µé¢è·³è½¬ */ ModelAndView mav = new ModelAndView(); //å‘è¯·æ±‚åŸŸå…±äº«æ•°æ® mav.addObject(\u0026#34;testScope\u0026#34;, \u0026#34;hello,ModelAndView\u0026#34;); //è®¾ç½®è§†å›¾ï¼Œå®ç°é¡µé¢è·³è½¬ mav.setViewName(\u0026#34;success\u0026#34;); return mav; } 3ã€ä½¿ç”¨Modelå‘requeståŸŸå¯¹è±¡å…±äº«æ•°æ® @RequestMapping(\u0026#34;/testModel\u0026#34;) public String testModel(Model model){ model.addAttribute(\u0026#34;testScope\u0026#34;, \u0026#34;hello,Model\u0026#34;); return \u0026#34;success\u0026#34;; } 4ã€ä½¿ç”¨mapå‘requeståŸŸå¯¹è±¡å…±äº«æ•°æ® @RequestMapping(\u0026#34;/testMap\u0026#34;) public String testMap(Map\u0026lt;String, Object\u0026gt; map){ map.put(\u0026#34;testScope\u0026#34;, \u0026#34;hello,Map\u0026#34;); return \u0026#34;success\u0026#34;; } 5ã€ä½¿ç”¨ModelMapå‘requeståŸŸå¯¹è±¡å…±äº«æ•°æ® @RequestMapping(\u0026#34;/testModelMap\u0026#34;) public String testModelMap(ModelMap modelMap){ modelMap.addAttribute(\u0026#34;testScope\u0026#34;, \u0026#34;hello,ModelMap\u0026#34;); return \u0026#34;success\u0026#34;; } 6ã€Modelã€ModelMapã€Mapçš„å…³ç³» Modelã€ModelMapã€Mapç±»å‹çš„å‚æ•°å…¶å®æœ¬è´¨ä¸Šéƒ½æ˜¯ BindingAwareModelMap ç±»å‹çš„\npublic interface Model{}\rpublic class ModelMap extends LinkedHashMap\u0026lt;String, Object\u0026gt; {}\rpublic class ExtendedModelMap extends ModelMap implements Model {}\rpublic class BindingAwareModelMap extends ExtendedModelMap {} 7ã€å‘sessionåŸŸå…±äº«æ•°æ® @RequestMapping(\u0026#34;/testSession\u0026#34;) public String testSession(HttpSession session){ session.setAttribute(\u0026#34;testSessionScope\u0026#34;, \u0026#34;hello,session\u0026#34;); return \u0026#34;success\u0026#34;; } 8ã€å‘applicationåŸŸå…±äº«æ•°æ® @RequestMapping(\u0026#34;/testApplication\u0026#34;) public String testApplication(HttpSession session){ ServletContext application = session.getServletContext(); application.setAttribute(\u0026#34;testApplicationScope\u0026#34;, \u0026#34;hello,application\u0026#34;); return \u0026#34;success\u0026#34;; } å…­ã€SpringMVCçš„è§†å›¾ SpringMVCä¸­çš„è§†å›¾æ˜¯Viewæ¥å£ï¼Œè§†å›¾çš„ä½œç”¨æ¸²æŸ“æ•°æ®ï¼Œå°†æ¨¡å‹Modelä¸­çš„æ•°æ®å±•ç¤ºç»™ç”¨æˆ·\nSpringMVCè§†å›¾çš„ç§ç±»å¾ˆå¤šï¼Œé»˜è®¤æœ‰è½¬å‘è§†å›¾å’Œé‡å®šå‘è§†å›¾\nå½“å·¥ç¨‹å¼•å…¥jstlçš„ä¾èµ–ï¼Œè½¬å‘è§†å›¾ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºJstlView\nè‹¥ä½¿ç”¨çš„è§†å›¾æŠ€æœ¯ä¸ºThymeleafï¼Œåœ¨SpringMVCçš„é…ç½®æ–‡ä»¶ä¸­é…ç½®äº†Thymeleafçš„è§†å›¾è§£æå™¨ï¼Œç”±æ­¤è§†å›¾è§£æå™¨è§£æä¹‹åæ‰€å¾—åˆ°çš„æ˜¯ThymeleafView\n1ã€ThymeleafView å½“æ§åˆ¶å™¨æ–¹æ³•ä¸­æ‰€è®¾ç½®çš„è§†å›¾åç§°æ²¡æœ‰ä»»ä½•å‰ç¼€æ—¶ï¼Œæ­¤æ—¶çš„è§†å›¾åç§°ä¼šè¢«SpringMVCé…ç½®æ–‡ä»¶ä¸­æ‰€é…ç½®çš„è§†å›¾è§£æå™¨è§£æï¼Œè§†å›¾åç§°æ‹¼æ¥è§†å›¾å‰ç¼€å’Œè§†å›¾åç¼€æ‰€å¾—åˆ°çš„æœ€ç»ˆè·¯å¾„ï¼Œä¼šé€šè¿‡è½¬å‘çš„æ–¹å¼å®ç°è·³è½¬\n@RequestMapping(\u0026#34;/testHello\u0026#34;) public String testHello(){ return \u0026#34;hello\u0026#34;; } 2ã€è½¬å‘è§†å›¾ SpringMVCä¸­é»˜è®¤çš„è½¬å‘è§†å›¾æ˜¯InternalResourceView\nSpringMVCä¸­åˆ›å»ºè½¬å‘è§†å›¾çš„æƒ…å†µï¼š\nå½“æ§åˆ¶å™¨æ–¹æ³•ä¸­æ‰€è®¾ç½®çš„è§†å›¾åç§°ä»¥\u0026quot;forward:\u0026ldquo;ä¸ºå‰ç¼€æ—¶ï¼Œåˆ›å»ºInternalResourceViewè§†å›¾ï¼Œæ­¤æ—¶çš„è§†å›¾åç§°ä¸ä¼šè¢«SpringMVCé…ç½®æ–‡ä»¶ä¸­æ‰€é…ç½®çš„è§†å›¾è§£æå™¨è§£æï¼Œè€Œæ˜¯ä¼šå°†å‰ç¼€\u0026quot;forward:\u0026ldquo;å»æ‰ï¼Œå‰©ä½™éƒ¨åˆ†ä½œä¸ºæœ€ç»ˆè·¯å¾„é€šè¿‡è½¬å‘çš„æ–¹å¼å®ç°è·³è½¬\nä¾‹å¦‚\u0026quot;forward:/\u0026quot;ï¼Œ\u0026ldquo;forward:/employee\u0026rdquo;\n@RequestMapping(\u0026#34;/testForward\u0026#34;) public String testForward(){ return \u0026#34;forward:/testHello\u0026#34;; } 3ã€é‡å®šå‘è§†å›¾ SpringMVCä¸­é»˜è®¤çš„é‡å®šå‘è§†å›¾æ˜¯RedirectView\nå½“æ§åˆ¶å™¨æ–¹æ³•ä¸­æ‰€è®¾ç½®çš„è§†å›¾åç§°ä»¥\u0026quot;redirect:\u0026ldquo;ä¸ºå‰ç¼€æ—¶ï¼Œåˆ›å»ºRedirectViewè§†å›¾ï¼Œæ­¤æ—¶çš„è§†å›¾åç§°ä¸ä¼šè¢«SpringMVCé…ç½®æ–‡ä»¶ä¸­æ‰€é…ç½®çš„è§†å›¾è§£æå™¨è§£æï¼Œè€Œæ˜¯ä¼šå°†å‰ç¼€\u0026quot;redirect:\u0026ldquo;å»æ‰ï¼Œå‰©ä½™éƒ¨åˆ†ä½œä¸ºæœ€ç»ˆè·¯å¾„é€šè¿‡é‡å®šå‘çš„æ–¹å¼å®ç°è·³è½¬\nä¾‹å¦‚\u0026quot;redirect:/\u0026quot;ï¼Œ\u0026ldquo;redirect:/employee\u0026rdquo;\n@RequestMapping(\u0026#34;/testRedirect\u0026#34;) public String testRedirect(){ return \u0026#34;redirect:/testHello\u0026#34;; } æ³¨ï¼š\né‡å®šå‘è§†å›¾åœ¨è§£ææ—¶ï¼Œä¼šå…ˆå°†redirect:å‰ç¼€å»æ‰ï¼Œç„¶åä¼šåˆ¤æ–­å‰©ä½™éƒ¨åˆ†æ˜¯å¦ä»¥/å¼€å¤´ï¼Œè‹¥æ˜¯åˆ™ä¼šè‡ªåŠ¨æ‹¼æ¥ä¸Šä¸‹æ–‡è·¯å¾„\n4ã€è§†å›¾æ§åˆ¶å™¨view-controller å½“æ§åˆ¶å™¨æ–¹æ³•ä¸­ï¼Œä»…ä»…ç”¨æ¥å®ç°é¡µé¢è·³è½¬ï¼Œå³åªéœ€è¦è®¾ç½®è§†å›¾åç§°æ—¶ï¼Œå¯ä»¥å°†å¤„ç†å™¨æ–¹æ³•ä½¿ç”¨view-controlleræ ‡ç­¾è¿›è¡Œè¡¨ç¤º\n\u0026lt;!-- pathï¼šè®¾ç½®å¤„ç†çš„è¯·æ±‚åœ°å€ view-nameï¼šè®¾ç½®è¯·æ±‚åœ°å€æ‰€å¯¹åº”çš„è§†å›¾åç§° --\u0026gt; \u0026lt;mvc:view-controller path=\u0026#34;/testView\u0026#34; view-name=\u0026#34;success\u0026#34;\u0026gt;\u0026lt;/mvc:view-controller\u0026gt; æ³¨ï¼š\nå½“SpringMVCä¸­è®¾ç½®ä»»ä½•ä¸€ä¸ªview-controlleræ—¶ï¼Œå…¶ä»–æ§åˆ¶å™¨ä¸­çš„è¯·æ±‚æ˜ å°„å°†å…¨éƒ¨å¤±æ•ˆï¼Œæ­¤æ—¶éœ€è¦åœ¨SpringMVCçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­è®¾ç½®å¼€å¯mvcæ³¨è§£é©±åŠ¨çš„æ ‡ç­¾ï¼š\n\u0026lt;mvc:annotation-driven /\u0026gt;\nä¸ƒã€RESTful 1ã€RESTfulç®€ä»‹ RESTï¼šRepresentational State Transferï¼Œè¡¨ç°å±‚èµ„æºçŠ¶æ€è½¬ç§»ã€‚\na\u0026gt;èµ„æº èµ„æºæ˜¯ä¸€ç§çœ‹å¾…æœåŠ¡å™¨çš„æ–¹å¼ï¼Œå³ï¼Œå°†æœåŠ¡å™¨çœ‹ä½œæ˜¯ç”±å¾ˆå¤šç¦»æ•£çš„èµ„æºç»„æˆã€‚æ¯ä¸ªèµ„æºæ˜¯æœåŠ¡å™¨ä¸Šä¸€ä¸ªå¯å‘½åçš„æŠ½è±¡æ¦‚å¿µã€‚å› ä¸ºèµ„æºæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œæ‰€ä»¥å®ƒä¸ä»…ä»…èƒ½ä»£è¡¨æœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªæ–‡ä»¶ã€æ•°æ®åº“ä¸­çš„ä¸€å¼ è¡¨ç­‰ç­‰å…·ä½“çš„ä¸œè¥¿ï¼Œå¯ä»¥å°†èµ„æºè®¾è®¡çš„è¦å¤šæŠ½è±¡æœ‰å¤šæŠ½è±¡ï¼Œåªè¦æƒ³è±¡åŠ›å…è®¸è€Œä¸”å®¢æˆ·ç«¯åº”ç”¨å¼€å‘è€…èƒ½å¤Ÿç†è§£ã€‚ä¸é¢å‘å¯¹è±¡è®¾è®¡ç±»ä¼¼ï¼Œèµ„æºæ˜¯ä»¥åè¯ä¸ºæ ¸å¿ƒæ¥ç»„ç»‡çš„ï¼Œé¦–å…ˆå…³æ³¨çš„æ˜¯åè¯ã€‚ä¸€ä¸ªèµ„æºå¯ä»¥ç”±ä¸€ä¸ªæˆ–å¤šä¸ªURIæ¥æ ‡è¯†ã€‚URIæ—¢æ˜¯èµ„æºçš„åç§°ï¼Œä¹Ÿæ˜¯èµ„æºåœ¨Webä¸Šçš„åœ°å€ã€‚å¯¹æŸä¸ªèµ„æºæ„Ÿå…´è¶£çš„å®¢æˆ·ç«¯åº”ç”¨ï¼Œå¯ä»¥é€šè¿‡èµ„æºçš„URIä¸å…¶è¿›è¡Œäº¤äº’ã€‚\nb\u0026gt;èµ„æºçš„è¡¨è¿° èµ„æºçš„è¡¨è¿°æ˜¯ä¸€æ®µå¯¹äºèµ„æºåœ¨æŸä¸ªç‰¹å®šæ—¶åˆ»çš„çŠ¶æ€çš„æè¿°ã€‚å¯ä»¥åœ¨å®¢æˆ·ç«¯-æœåŠ¡å™¨ç«¯ä¹‹é—´è½¬ç§»ï¼ˆäº¤æ¢ï¼‰ã€‚èµ„æºçš„è¡¨è¿°å¯ä»¥æœ‰å¤šç§æ ¼å¼ï¼Œä¾‹å¦‚HTML/XML/JSON/çº¯æ–‡æœ¬/å›¾ç‰‡/è§†é¢‘/éŸ³é¢‘ç­‰ç­‰ã€‚èµ„æºçš„è¡¨è¿°æ ¼å¼å¯ä»¥é€šè¿‡åå•†æœºåˆ¶æ¥ç¡®å®šã€‚è¯·æ±‚-å“åº”æ–¹å‘çš„è¡¨è¿°é€šå¸¸ä½¿ç”¨ä¸åŒçš„æ ¼å¼ã€‚\nc\u0026gt;çŠ¶æ€è½¬ç§» çŠ¶æ€è½¬ç§»è¯´çš„æ˜¯ï¼šåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¹‹é—´è½¬ç§»ï¼ˆtransferï¼‰ä»£è¡¨èµ„æºçŠ¶æ€çš„è¡¨è¿°ã€‚é€šè¿‡è½¬ç§»å’Œæ“ä½œèµ„æºçš„è¡¨è¿°ï¼Œæ¥é—´æ¥å®ç°æ“ä½œèµ„æºçš„ç›®çš„ã€‚\n2ã€RESTfulçš„å®ç° å…·ä½“è¯´ï¼Œå°±æ˜¯ HTTP åè®®é‡Œé¢ï¼Œå››ä¸ªè¡¨ç¤ºæ“ä½œæ–¹å¼çš„åŠ¨è¯ï¼šGETã€POSTã€PUTã€DELETEã€‚\nå®ƒä»¬åˆ†åˆ«å¯¹åº”å››ç§åŸºæœ¬æ“ä½œï¼šGET ç”¨æ¥è·å–èµ„æºï¼ŒPOST ç”¨æ¥æ–°å»ºèµ„æºï¼ŒPUT ç”¨æ¥æ›´æ–°èµ„æºï¼ŒDELETE ç”¨æ¥åˆ é™¤èµ„æºã€‚\nREST é£æ ¼æå€¡ URL åœ°å€ä½¿ç”¨ç»Ÿä¸€çš„é£æ ¼è®¾è®¡ï¼Œä»å‰åˆ°åå„ä¸ªå•è¯ä½¿ç”¨æ–œæ åˆ†å¼€ï¼Œä¸ä½¿ç”¨é—®å·é”®å€¼å¯¹æ–¹å¼æºå¸¦è¯·æ±‚å‚æ•°ï¼Œè€Œæ˜¯å°†è¦å‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®ä½œä¸º URL åœ°å€çš„ä¸€éƒ¨åˆ†ï¼Œä»¥ä¿è¯æ•´ä½“é£æ ¼çš„ä¸€è‡´æ€§ã€‚\næ“ä½œ ä¼ ç»Ÿæ–¹å¼ RESTé£æ ¼ æŸ¥è¯¢æ“ä½œ getUserById?id=1 user/1\u0026ndash;\u0026gt;getè¯·æ±‚æ–¹å¼ ä¿å­˜æ“ä½œ saveUser user\u0026ndash;\u0026gt;postè¯·æ±‚æ–¹å¼ åˆ é™¤æ“ä½œ deleteUser?id=1 user/1\u0026ndash;\u0026gt;deleteè¯·æ±‚æ–¹å¼ æ›´æ–°æ“ä½œ updateUser user\u0026ndash;\u0026gt;putè¯·æ±‚æ–¹å¼ 3ã€HiddenHttpMethodFilter ç”±äºæµè§ˆå™¨åªæ”¯æŒå‘é€getå’Œpostæ–¹å¼çš„è¯·æ±‚ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•å‘é€putå’Œdeleteè¯·æ±‚å‘¢ï¼Ÿ\nSpringMVC æä¾›äº† HiddenHttpMethodFilter å¸®åŠ©æˆ‘ä»¬å°† POST è¯·æ±‚è½¬æ¢ä¸º DELETE æˆ– PUT è¯·æ±‚\nHiddenHttpMethodFilter å¤„ç†putå’Œdeleteè¯·æ±‚çš„æ¡ä»¶ï¼š\na\u0026gt;å½“å‰è¯·æ±‚çš„è¯·æ±‚æ–¹å¼å¿…é¡»ä¸ºpost\nb\u0026gt;å½“å‰è¯·æ±‚å¿…é¡»ä¼ è¾“è¯·æ±‚å‚æ•°_method\næ»¡è¶³ä»¥ä¸Šæ¡ä»¶ï¼ŒHiddenHttpMethodFilter è¿‡æ»¤å™¨å°±ä¼šå°†å½“å‰è¯·æ±‚çš„è¯·æ±‚æ–¹å¼è½¬æ¢ä¸ºè¯·æ±‚å‚æ•°_methodçš„å€¼ï¼Œå› æ­¤è¯·æ±‚å‚æ•°_methodçš„å€¼æ‰æ˜¯æœ€ç»ˆçš„è¯·æ±‚æ–¹å¼\nåœ¨web.xmlä¸­æ³¨å†ŒHiddenHttpMethodFilter\n\u0026lt;filter\u0026gt; \u0026lt;filter-name\u0026gt;HiddenHttpMethodFilter\u0026lt;/filter-name\u0026gt; \u0026lt;filter-class\u0026gt;org.springframework.web.filter.HiddenHttpMethodFilter\u0026lt;/filter-class\u0026gt; \u0026lt;/filter\u0026gt; \u0026lt;filter-mapping\u0026gt; \u0026lt;filter-name\u0026gt;HiddenHttpMethodFilter\u0026lt;/filter-name\u0026gt; \u0026lt;url-pattern\u0026gt;/*\u0026lt;/url-pattern\u0026gt; \u0026lt;/filter-mapping\u0026gt; æ³¨ï¼š\nç›®å‰ä¸ºæ­¢ï¼ŒSpringMVCä¸­æä¾›äº†ä¸¤ä¸ªè¿‡æ»¤å™¨ï¼šCharacterEncodingFilterå’ŒHiddenHttpMethodFilter\nåœ¨web.xmlä¸­æ³¨å†Œæ—¶ï¼Œå¿…é¡»å…ˆæ³¨å†ŒCharacterEncodingFilterï¼Œå†æ³¨å†ŒHiddenHttpMethodFilter\nåŸå› ï¼š\nåœ¨ CharacterEncodingFilter ä¸­é€šè¿‡ request.setCharacterEncoding(encoding) æ–¹æ³•è®¾ç½®å­—ç¬¦é›†çš„\nrequest.setCharacterEncoding(encoding) æ–¹æ³•è¦æ±‚å‰é¢ä¸èƒ½æœ‰ä»»ä½•è·å–è¯·æ±‚å‚æ•°çš„æ“ä½œ\nè€Œ HiddenHttpMethodFilter æ°æ°æœ‰ä¸€ä¸ªè·å–è¯·æ±‚æ–¹å¼çš„æ“ä½œï¼š\nString paramValue = request.getParameter(this.methodParam); å…«ã€RESTfulæ¡ˆä¾‹ 1ã€å‡†å¤‡å·¥ä½œ å’Œä¼ ç»Ÿ CRUD ä¸€æ ·ï¼Œå®ç°å¯¹å‘˜å·¥ä¿¡æ¯çš„å¢åˆ æ”¹æŸ¥ã€‚\næ­å»ºç¯å¢ƒ\nå‡†å¤‡å®ä½“ç±»\npackage com.atguigu.mvc.bean; public class Employee { private Integer id; private String lastName; private String email; //1 male, 0 female private Integer gender; public Integer getId() { return id; } public void setId(Integer id) { this.id = id; } public String getLastName() { return lastName; } public void setLastName(String lastName) { this.lastName = lastName; } public String getEmail() { return email; } public void setEmail(String email) { this.email = email; } public Integer getGender() { return gender; } public void setGender(Integer gender) { this.gender = gender; } public Employee(Integer id, String lastName, String email, Integer gender) { super(); this.id = id; this.lastName = lastName; this.email = email; this.gender = gender; } public Employee() { } } å‡†å¤‡daoæ¨¡æ‹Ÿæ•°æ®\npackage com.atguigu.mvc.dao; import java.util.Collection; import java.util.HashMap; import java.util.Map; import com.atguigu.mvc.bean.Employee; import org.springframework.stereotype.Repository; @Repository public class EmployeeDao { private static Map\u0026lt;Integer, Employee\u0026gt; employees = null; static{ employees = new HashMap\u0026lt;Integer, Employee\u0026gt;(); employees.put(1001, new Employee(1001, \u0026#34;E-AA\u0026#34;, \u0026#34;aa@163.com\u0026#34;, 1)); employees.put(1002, new Employee(1002, \u0026#34;E-BB\u0026#34;, \u0026#34;bb@163.com\u0026#34;, 1)); employees.put(1003, new Employee(1003, \u0026#34;E-CC\u0026#34;, \u0026#34;cc@163.com\u0026#34;, 0)); employees.put(1004, new Employee(1004, \u0026#34;E-DD\u0026#34;, \u0026#34;dd@163.com\u0026#34;, 0)); employees.put(1005, new Employee(1005, \u0026#34;E-EE\u0026#34;, \u0026#34;ee@163.com\u0026#34;, 1)); } private static Integer initId = 1006; public void save(Employee employee){ if(employee.getId() == null){ employee.setId(initId++); } employees.put(employee.getId(), employee); } public Collection\u0026lt;Employee\u0026gt; getAll(){ return employees.values(); } public Employee get(Integer id){ return employees.get(id); } public void delete(Integer id){ employees.remove(id); } } 2ã€åŠŸèƒ½æ¸…å• åŠŸèƒ½ URL åœ°å€ è¯·æ±‚æ–¹å¼ è®¿é—®é¦–é¡µâˆš / GET æŸ¥è¯¢å…¨éƒ¨æ•°æ®âˆš /employee GET åˆ é™¤âˆš /employee/2 DELETE è·³è½¬åˆ°æ·»åŠ æ•°æ®é¡µé¢âˆš /toAdd GET æ‰§è¡Œä¿å­˜âˆš /employee POST è·³è½¬åˆ°æ›´æ–°æ•°æ®é¡µé¢âˆš /employee/2 GET æ‰§è¡Œæ›´æ–°âˆš /employee PUT 3ã€å…·ä½“åŠŸèƒ½ï¼šè®¿é—®é¦–é¡µ a\u0026gt;é…ç½®view-controller \u0026lt;mvc:view-controller path=\u0026#34;/\u0026#34; view-name=\u0026#34;index\u0026#34;/\u0026gt; b\u0026gt;åˆ›å»ºé¡µé¢ \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34; xmlns:th=\u0026#34;http://www.thymeleaf.org\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34; \u0026gt; \u0026lt;title\u0026gt;Title\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;é¦–é¡µ\u0026lt;/h1\u0026gt; \u0026lt;a th:href=\u0026#34;@{/employee}\u0026#34;\u0026gt;è®¿é—®å‘˜å·¥ä¿¡æ¯\u0026lt;/a\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; 4ã€å…·ä½“åŠŸèƒ½ï¼šæŸ¥è¯¢æ‰€æœ‰å‘˜å·¥æ•°æ® a\u0026gt;æ§åˆ¶å™¨æ–¹æ³• @RequestMapping(value = \u0026#34;/employee\u0026#34;, method = RequestMethod.GET) public String getEmployeeList(Model model){ Collection\u0026lt;Employee\u0026gt; employeeList = employeeDao.getAll(); model.addAttribute(\u0026#34;employeeList\u0026#34;, employeeList); return \u0026#34;employee_list\u0026#34;; } b\u0026gt;åˆ›å»ºemployee_list.html \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34; xmlns:th=\u0026#34;http://www.thymeleaf.org\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Employee Info\u0026lt;/title\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; th:src=\u0026#34;@{/static/js/vue.js}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;table border=\u0026#34;1\u0026#34; cellpadding=\u0026#34;0\u0026#34; cellspacing=\u0026#34;0\u0026#34; style=\u0026#34;text-align: center;\u0026#34; id=\u0026#34;dataTable\u0026#34;\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th colspan=\u0026#34;5\u0026#34;\u0026gt;Employee Info\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;tr\u0026gt; \u0026lt;th\u0026gt;id\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;lastName\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;email\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;gender\u0026lt;/th\u0026gt; \u0026lt;th\u0026gt;options(\u0026lt;a th:href=\u0026#34;@{/toAdd}\u0026#34;\u0026gt;add\u0026lt;/a\u0026gt;)\u0026lt;/th\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;tr th:each=\u0026#34;employee : ${employeeList}\u0026#34;\u0026gt; \u0026lt;td th:text=\u0026#34;${employee.id}\u0026#34;\u0026gt;\u0026lt;/td\u0026gt; \u0026lt;td th:text=\u0026#34;${employee.lastName}\u0026#34;\u0026gt;\u0026lt;/td\u0026gt; \u0026lt;td th:text=\u0026#34;${employee.email}\u0026#34;\u0026gt;\u0026lt;/td\u0026gt; \u0026lt;td th:text=\u0026#34;${employee.gender}\u0026#34;\u0026gt;\u0026lt;/td\u0026gt; \u0026lt;td\u0026gt; \u0026lt;a class=\u0026#34;deleteA\u0026#34; @click=\u0026#34;deleteEmployee\u0026#34; th:href=\u0026#34;@{\u0026#39;/employee/\u0026#39;+${employee.id}}\u0026#34;\u0026gt;delete\u0026lt;/a\u0026gt; \u0026lt;a th:href=\u0026#34;@{\u0026#39;/employee/\u0026#39;+${employee.id}}\u0026#34;\u0026gt;update\u0026lt;/a\u0026gt; \u0026lt;/td\u0026gt; \u0026lt;/tr\u0026gt; \u0026lt;/table\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; 5ã€å…·ä½“åŠŸèƒ½ï¼šåˆ é™¤ a\u0026gt;åˆ›å»ºå¤„ç†deleteè¯·æ±‚æ–¹å¼çš„è¡¨å• \u0026lt;!-- ä½œç”¨ï¼šé€šè¿‡è¶…é“¾æ¥æ§åˆ¶è¡¨å•çš„æäº¤ï¼Œå°†postè¯·æ±‚è½¬æ¢ä¸ºdeleteè¯·æ±‚ --\u0026gt; \u0026lt;form id=\u0026#34;delete_form\u0026#34; method=\u0026#34;post\u0026#34;\u0026gt; \u0026lt;!-- HiddenHttpMethodFilterè¦æ±‚ï¼šå¿…é¡»ä¼ è¾“_methodè¯·æ±‚å‚æ•°ï¼Œå¹¶ä¸”å€¼ä¸ºæœ€ç»ˆçš„è¯·æ±‚æ–¹å¼ --\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;_method\u0026#34; value=\u0026#34;delete\u0026#34;/\u0026gt; \u0026lt;/form\u0026gt; b\u0026gt;åˆ é™¤è¶…é“¾æ¥ç»‘å®šç‚¹å‡»äº‹ä»¶ å¼•å…¥vue.js\n\u0026lt;script type=\u0026#34;text/javascript\u0026#34; th:src=\u0026#34;@{/static/js/vue.js}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; åˆ é™¤è¶…é“¾æ¥\n\u0026lt;a class=\u0026#34;deleteA\u0026#34; @click=\u0026#34;deleteEmployee\u0026#34; th:href=\u0026#34;@{\u0026#39;/employee/\u0026#39;+${employee.id}}\u0026#34;\u0026gt;delete\u0026lt;/a\u0026gt; é€šè¿‡vueå¤„ç†ç‚¹å‡»äº‹ä»¶\n\u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt; var vue = new Vue({ el:\u0026#34;#dataTable\u0026#34;, methods:{ //eventè¡¨ç¤ºå½“å‰äº‹ä»¶ deleteEmployee:function (event) { //é€šè¿‡idè·å–è¡¨å•æ ‡ç­¾ var delete_form = document.getElementById(\u0026#34;delete_form\u0026#34;); //å°†è§¦å‘äº‹ä»¶çš„è¶…é“¾æ¥çš„hrefå±æ€§ä¸ºè¡¨å•çš„actionå±æ€§èµ‹å€¼ delete_form.action = event.target.href; //æäº¤è¡¨å• delete_form.submit(); //é˜»æ­¢è¶…é“¾æ¥çš„é»˜è®¤è·³è½¬è¡Œä¸º event.preventDefault(); } } }); \u0026lt;/script\u0026gt; c\u0026gt;æ§åˆ¶å™¨æ–¹æ³• @RequestMapping(value = \u0026#34;/employee/{id}\u0026#34;, method = RequestMethod.DELETE) public String deleteEmployee(@PathVariable(\u0026#34;id\u0026#34;) Integer id){ employeeDao.delete(id); return \u0026#34;redirect:/employee\u0026#34;; } 6ã€å…·ä½“åŠŸèƒ½ï¼šè·³è½¬åˆ°æ·»åŠ æ•°æ®é¡µé¢ a\u0026gt;é…ç½®view-controller \u0026lt;mvc:view-controller path=\u0026#34;/toAdd\u0026#34; view-name=\u0026#34;employee_add\u0026#34;\u0026gt;\u0026lt;/mvc:view-controller\u0026gt; b\u0026gt;åˆ›å»ºemployee_add.html \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34; xmlns:th=\u0026#34;http://www.thymeleaf.org\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Add Employee\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;form th:action=\u0026#34;@{/employee}\u0026#34; method=\u0026#34;post\u0026#34;\u0026gt; lastName:\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;lastName\u0026#34;\u0026gt;\u0026lt;br\u0026gt; email:\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;email\u0026#34;\u0026gt;\u0026lt;br\u0026gt; gender:\u0026lt;input type=\u0026#34;radio\u0026#34; name=\u0026#34;gender\u0026#34; value=\u0026#34;1\u0026#34;\u0026gt;male \u0026lt;input type=\u0026#34;radio\u0026#34; name=\u0026#34;gender\u0026#34; value=\u0026#34;0\u0026#34;\u0026gt;female\u0026lt;br\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34; value=\u0026#34;add\u0026#34;\u0026gt;\u0026lt;br\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; 7ã€å…·ä½“åŠŸèƒ½ï¼šæ‰§è¡Œä¿å­˜ a\u0026gt;æ§åˆ¶å™¨æ–¹æ³• @RequestMapping(value = \u0026#34;/employee\u0026#34;, method = RequestMethod.POST) public String addEmployee(Employee employee){ employeeDao.save(employee); return \u0026#34;redirect:/employee\u0026#34;; } 8ã€å…·ä½“åŠŸèƒ½ï¼šè·³è½¬åˆ°æ›´æ–°æ•°æ®é¡µé¢ a\u0026gt;ä¿®æ”¹è¶…é“¾æ¥ \u0026lt;a th:href=\u0026#34;@{\u0026#39;/employee/\u0026#39;+${employee.id}}\u0026#34;\u0026gt;update\u0026lt;/a\u0026gt; b\u0026gt;æ§åˆ¶å™¨æ–¹æ³• @RequestMapping(value = \u0026#34;/employee/{id}\u0026#34;, method = RequestMethod.GET) public String getEmployeeById(@PathVariable(\u0026#34;id\u0026#34;) Integer id, Model model){ Employee employee = employeeDao.get(id); model.addAttribute(\u0026#34;employee\u0026#34;, employee); return \u0026#34;employee_update\u0026#34;; } c\u0026gt;åˆ›å»ºemployee_update.html \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34; xmlns:th=\u0026#34;http://www.thymeleaf.org\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Update Employee\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;form th:action=\u0026#34;@{/employee}\u0026#34; method=\u0026#34;post\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;_method\u0026#34; value=\u0026#34;put\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;id\u0026#34; th:value=\u0026#34;${employee.id}\u0026#34;\u0026gt; lastName:\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;lastName\u0026#34; th:value=\u0026#34;${employee.lastName}\u0026#34;\u0026gt;\u0026lt;br\u0026gt; email:\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;email\u0026#34; th:value=\u0026#34;${employee.email}\u0026#34;\u0026gt;\u0026lt;br\u0026gt; \u0026lt;!-- th:field=\u0026#34;${employee.gender}\u0026#34;å¯ç”¨äºå•é€‰æ¡†æˆ–å¤é€‰æ¡†çš„å›æ˜¾ è‹¥å•é€‰æ¡†çš„valueå’Œemployee.genderçš„å€¼ä¸€è‡´ï¼Œåˆ™æ·»åŠ checked=\u0026#34;checked\u0026#34;å±æ€§ --\u0026gt; gender:\u0026lt;input type=\u0026#34;radio\u0026#34; name=\u0026#34;gender\u0026#34; value=\u0026#34;1\u0026#34; th:field=\u0026#34;${employee.gender}\u0026#34;\u0026gt;male \u0026lt;input type=\u0026#34;radio\u0026#34; name=\u0026#34;gender\u0026#34; value=\u0026#34;0\u0026#34; th:field=\u0026#34;${employee.gender}\u0026#34;\u0026gt;female\u0026lt;br\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34; value=\u0026#34;update\u0026#34;\u0026gt;\u0026lt;br\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; 9ã€å…·ä½“åŠŸèƒ½ï¼šæ‰§è¡Œæ›´æ–° a\u0026gt;æ§åˆ¶å™¨æ–¹æ³• @RequestMapping(value = \u0026#34;/employee\u0026#34;, method = RequestMethod.PUT) public String updateEmployee(Employee employee){ employeeDao.save(employee); return \u0026#34;redirect:/employee\u0026#34;; } å…«ã€HttpMessageConverter HttpMessageConverterï¼ŒæŠ¥æ–‡ä¿¡æ¯è½¬æ¢å™¨ï¼Œå°†è¯·æ±‚æŠ¥æ–‡è½¬æ¢ä¸ºJavaå¯¹è±¡ï¼Œæˆ–å°†Javaå¯¹è±¡è½¬æ¢ä¸ºå“åº”æŠ¥æ–‡\nHttpMessageConverteræä¾›äº†ä¸¤ä¸ªæ³¨è§£å’Œä¸¤ä¸ªç±»å‹ï¼š@RequestBodyï¼Œ@ResponseBodyï¼ŒRequestEntityï¼Œ\nResponseEntity\n1ã€@RequestBody @RequestBodyå¯ä»¥è·å–è¯·æ±‚ä½“ï¼Œéœ€è¦åœ¨æ§åˆ¶å™¨æ–¹æ³•è®¾ç½®ä¸€ä¸ªå½¢å‚ï¼Œä½¿ç”¨@RequestBodyè¿›è¡Œæ ‡è¯†ï¼Œå½“å‰è¯·æ±‚çš„è¯·æ±‚ä½“å°±ä¼šä¸ºå½“å‰æ³¨è§£æ‰€æ ‡è¯†çš„å½¢å‚èµ‹å€¼\n\u0026lt;form th:action=\u0026#34;@{/testRequestBody}\u0026#34; method=\u0026#34;post\u0026#34;\u0026gt; ç”¨æˆ·åï¼š\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34;\u0026gt;\u0026lt;br\u0026gt; å¯†ç ï¼š\u0026lt;input type=\u0026#34;password\u0026#34; name=\u0026#34;password\u0026#34;\u0026gt;\u0026lt;br\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; @RequestMapping(\u0026#34;/testRequestBody\u0026#34;) public String testRequestBody(@RequestBody String requestBody){ System.out.println(\u0026#34;requestBody:\u0026#34;+requestBody); return \u0026#34;success\u0026#34;; } è¾“å‡ºç»“æœï¼š\nrequestBody:username=admin\u0026amp;password=123456\n2ã€RequestEntity RequestEntityå°è£…è¯·æ±‚æŠ¥æ–‡çš„ä¸€ç§ç±»å‹ï¼Œéœ€è¦åœ¨æ§åˆ¶å™¨æ–¹æ³•çš„å½¢å‚ä¸­è®¾ç½®è¯¥ç±»å‹çš„å½¢å‚ï¼Œå½“å‰è¯·æ±‚çš„è¯·æ±‚æŠ¥æ–‡å°±ä¼šèµ‹å€¼ç»™è¯¥å½¢å‚ï¼Œå¯ä»¥é€šè¿‡getHeaders()è·å–è¯·æ±‚å¤´ä¿¡æ¯ï¼Œé€šè¿‡getBody()è·å–è¯·æ±‚ä½“ä¿¡æ¯\n@RequestMapping(\u0026#34;/testRequestEntity\u0026#34;) public String testRequestEntity(RequestEntity\u0026lt;String\u0026gt; requestEntity){ System.out.println(\u0026#34;requestHeader:\u0026#34;+requestEntity.getHeaders()); System.out.println(\u0026#34;requestBody:\u0026#34;+requestEntity.getBody()); return \u0026#34;success\u0026#34;; } è¾“å‡ºç»“æœï¼š requestHeader:[host:\u0026ldquo;localhost:8080\u0026rdquo;, connection:\u0026ldquo;keep-alive\u0026rdquo;, content-length:\u0026ldquo;27\u0026rdquo;, cache-control:\u0026ldquo;max-age=0\u0026rdquo;, sec-ch-ua:\u0026rdquo;\u0026rdquo; Not A;Brand\u0026rdquo;;v=\u0026ldquo;99\u0026rdquo;, \u0026ldquo;Chromium\u0026rdquo;;v=\u0026ldquo;90\u0026rdquo;, \u0026ldquo;Google Chrome\u0026rdquo;;v=\u0026ldquo;90\u0026quot;\u0026rdquo;, sec-ch-ua-mobile:\u0026quot;?0\u0026rdquo;, upgrade-insecure-requests:\u0026ldquo;1\u0026rdquo;, origin:\u0026ldquo;http://localhost:8080\u0026rdquo;, user-agent:\u0026ldquo;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36\u0026rdquo;] requestBody:username=admin\u0026amp;password=123\n3ã€@ResponseBody @ResponseBodyç”¨äºæ ‡è¯†ä¸€ä¸ªæ§åˆ¶å™¨æ–¹æ³•ï¼Œå¯ä»¥å°†è¯¥æ–¹æ³•çš„è¿”å›å€¼ç›´æ¥ä½œä¸ºå“åº”æŠ¥æ–‡çš„å“åº”ä½“å“åº”åˆ°æµè§ˆå™¨\n@RequestMapping(\u0026#34;/testResponseBody\u0026#34;) @ResponseBody public String testResponseBody(){ return \u0026#34;success\u0026#34;; } ç»“æœï¼šæµè§ˆå™¨é¡µé¢æ˜¾ç¤ºsuccess\n4ã€SpringMVCå¤„ç†json @ResponseBodyå¤„ç†jsonçš„æ­¥éª¤ï¼š\na\u0026gt;å¯¼å…¥jacksonçš„ä¾èµ–\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.fasterxml.jackson.core\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;jackson-databind\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.12.1\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; b\u0026gt;åœ¨SpringMVCçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­å¼€å¯mvcçš„æ³¨è§£é©±åŠ¨ï¼Œæ­¤æ—¶åœ¨HandlerAdaptorä¸­ä¼šè‡ªåŠ¨è£…é…ä¸€ä¸ªæ¶ˆæ¯è½¬æ¢å™¨ï¼šMappingJackson2HttpMessageConverterï¼Œå¯ä»¥å°†å“åº”åˆ°æµè§ˆå™¨çš„Javaå¯¹è±¡è½¬æ¢ä¸ºJsonæ ¼å¼çš„å­—ç¬¦ä¸²\n\u0026lt;mvc:annotation-driven /\u0026gt; c\u0026gt;åœ¨å¤„ç†å™¨æ–¹æ³•ä¸Šä½¿ç”¨@ResponseBodyæ³¨è§£è¿›è¡Œæ ‡è¯†\nd\u0026gt;å°†Javaå¯¹è±¡ç›´æ¥ä½œä¸ºæ§åˆ¶å™¨æ–¹æ³•çš„è¿”å›å€¼è¿”å›ï¼Œå°±ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºJsonæ ¼å¼çš„å­—ç¬¦ä¸²\n@RequestMapping(\u0026#34;/testResponseUser\u0026#34;) @ResponseBody public User testResponseUser(){ return new User(1001,\u0026#34;admin\u0026#34;,\u0026#34;123456\u0026#34;,23,\u0026#34;ç”·\u0026#34;); } æµè§ˆå™¨çš„é¡µé¢ä¸­å±•ç¤ºçš„ç»“æœï¼š\n{\u0026ldquo;id\u0026rdquo;:1001,\u0026ldquo;username\u0026rdquo;:\u0026ldquo;admin\u0026rdquo;,\u0026ldquo;password\u0026rdquo;:\u0026ldquo;123456\u0026rdquo;,\u0026ldquo;age\u0026rdquo;:23,\u0026ldquo;sex\u0026rdquo;:\u0026ldquo;ç”·\u0026rdquo;}\n5ã€SpringMVCå¤„ç†ajax a\u0026gt;è¯·æ±‚è¶…é“¾æ¥ï¼š\n\u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;a th:href=\u0026#34;@{/testAjax}\u0026#34; @click=\u0026#34;testAjax\u0026#34;\u0026gt;testAjax\u0026lt;/a\u0026gt;\u0026lt;br\u0026gt; \u0026lt;/div\u0026gt; b\u0026gt;é€šè¿‡vueå’Œaxioså¤„ç†ç‚¹å‡»äº‹ä»¶ï¼š\n\u0026lt;script type=\u0026#34;text/javascript\u0026#34; th:src=\u0026#34;@{/static/js/vue.js}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34; th:src=\u0026#34;@{/static/js/axios.min.js}\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt; var vue = new Vue({ el:\u0026#34;#app\u0026#34;, methods:{ testAjax:function (event) { axios({ method:\u0026#34;post\u0026#34;, url:event.target.href, params:{ username:\u0026#34;admin\u0026#34;, password:\u0026#34;123456\u0026#34; } }).then(function (response) { alert(response.data); }); event.preventDefault(); } } }); \u0026lt;/script\u0026gt; c\u0026gt;æ§åˆ¶å™¨æ–¹æ³•ï¼š\n@RequestMapping(\u0026#34;/testAjax\u0026#34;) @ResponseBody public String testAjax(String username, String password){ System.out.println(\u0026#34;username:\u0026#34;+username+\u0026#34;,password:\u0026#34;+password); return \u0026#34;hello,ajax\u0026#34;; } 6ã€@RestControlleræ³¨è§£ @RestControlleræ³¨è§£æ˜¯springMVCæä¾›çš„ä¸€ä¸ªå¤åˆæ³¨è§£ï¼Œæ ‡è¯†åœ¨æ§åˆ¶å™¨çš„ç±»ä¸Šï¼Œå°±ç›¸å½“äºä¸ºç±»æ·»åŠ äº†@Controlleræ³¨è§£ï¼Œå¹¶ä¸”ä¸ºå…¶ä¸­çš„æ¯ä¸ªæ–¹æ³•æ·»åŠ äº†@ResponseBodyæ³¨è§£\n7ã€ResponseEntity ResponseEntityç”¨äºæ§åˆ¶å™¨æ–¹æ³•çš„è¿”å›å€¼ç±»å‹ï¼Œè¯¥æ§åˆ¶å™¨æ–¹æ³•çš„è¿”å›å€¼å°±æ˜¯å“åº”åˆ°æµè§ˆå™¨çš„å“åº”æŠ¥æ–‡\nä¹ã€æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ 1ã€æ–‡ä»¶ä¸‹è½½ ä½¿ç”¨ResponseEntityå®ç°ä¸‹è½½æ–‡ä»¶çš„åŠŸèƒ½\n@RequestMapping(\u0026#34;/testDown\u0026#34;) public ResponseEntity\u0026lt;byte[]\u0026gt; testResponseEntity(HttpSession session) throws IOException { //è·å–ServletContextå¯¹è±¡ ServletContext servletContext = session.getServletContext(); //è·å–æœåŠ¡å™¨ä¸­æ–‡ä»¶çš„çœŸå®è·¯å¾„ String realPath = servletContext.getRealPath(\u0026#34;/static/img/1.jpg\u0026#34;); //åˆ›å»ºè¾“å…¥æµ InputStream is = new FileInputStream(realPath); //åˆ›å»ºå­—èŠ‚æ•°ç»„ byte[] bytes = new byte[is.available()]; //å°†æµè¯»åˆ°å­—èŠ‚æ•°ç»„ä¸­ is.read(bytes); //åˆ›å»ºHttpHeaderså¯¹è±¡è®¾ç½®å“åº”å¤´ä¿¡æ¯ MultiValueMap\u0026lt;String, String\u0026gt; headers = new HttpHeaders(); //è®¾ç½®è¦ä¸‹è½½æ–¹å¼ä»¥åŠä¸‹è½½æ–‡ä»¶çš„åå­— headers.add(\u0026#34;Content-Disposition\u0026#34;, \u0026#34;attachment;filename=1.jpg\u0026#34;); //è®¾ç½®å“åº”çŠ¶æ€ç  HttpStatus statusCode = HttpStatus.OK; //åˆ›å»ºResponseEntityå¯¹è±¡ ResponseEntity\u0026lt;byte[]\u0026gt; responseEntity = new ResponseEntity\u0026lt;\u0026gt;(bytes, headers, statusCode); //å…³é—­è¾“å…¥æµ is.close(); return responseEntity; } 2ã€æ–‡ä»¶ä¸Šä¼  æ–‡ä»¶ä¸Šä¼ è¦æ±‚formè¡¨å•çš„è¯·æ±‚æ–¹å¼å¿…é¡»ä¸ºpostï¼Œå¹¶ä¸”æ·»åŠ å±æ€§enctype=\u0026ldquo;multipart/form-data\u0026rdquo;\nSpringMVCä¸­å°†ä¸Šä¼ çš„æ–‡ä»¶å°è£…åˆ°MultipartFileå¯¹è±¡ä¸­ï¼Œé€šè¿‡æ­¤å¯¹è±¡å¯ä»¥è·å–æ–‡ä»¶ç›¸å…³ä¿¡æ¯\nä¸Šä¼ æ­¥éª¤ï¼š\na\u0026gt;æ·»åŠ ä¾èµ–ï¼š\n\u0026lt;!-- https://mvnrepository.com/artifact/commons-fileupload/commons-fileupload --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;commons-fileupload\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;commons-fileupload\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.3.1\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; b\u0026gt;åœ¨SpringMVCçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ é…ç½®ï¼š\n\u0026lt;!--å¿…é¡»é€šè¿‡æ–‡ä»¶è§£æå™¨çš„è§£ææ‰èƒ½å°†æ–‡ä»¶è½¬æ¢ä¸ºMultipartFileå¯¹è±¡--\u0026gt; \u0026lt;bean id=\u0026#34;multipartResolver\u0026#34; class=\u0026#34;org.springframework.web.multipart.commons.CommonsMultipartResolver\u0026#34;\u0026gt;\u0026lt;/bean\u0026gt; c\u0026gt;æ§åˆ¶å™¨æ–¹æ³•ï¼š\n@RequestMapping(\u0026#34;/testUp\u0026#34;) public String testUp(MultipartFile photo, HttpSession session) throws IOException { //è·å–ä¸Šä¼ çš„æ–‡ä»¶çš„æ–‡ä»¶å String fileName = photo.getOriginalFilename(); //å¤„ç†æ–‡ä»¶é‡åé—®é¢˜ String hzName = fileName.substring(fileName.lastIndexOf(\u0026#34;.\u0026#34;)); fileName = UUID.randomUUID().toString() + hzName; //è·å–æœåŠ¡å™¨ä¸­photoç›®å½•çš„è·¯å¾„ ServletContext servletContext = session.getServletContext(); String photoPath = servletContext.getRealPath(\u0026#34;photo\u0026#34;); File file = new File(photoPath); if(!file.exists()){ file.mkdir(); } String finalPath = photoPath + File.separator + fileName; //å®ç°ä¸Šä¼ åŠŸèƒ½ photo.transferTo(new File(finalPath)); return \u0026#34;success\u0026#34;; } åã€æ‹¦æˆªå™¨ 1ã€æ‹¦æˆªå™¨çš„é…ç½® SpringMVCä¸­çš„æ‹¦æˆªå™¨ç”¨äºæ‹¦æˆªæ§åˆ¶å™¨æ–¹æ³•çš„æ‰§è¡Œ\nSpringMVCä¸­çš„æ‹¦æˆªå™¨éœ€è¦å®ç°HandlerInterceptor\nSpringMVCçš„æ‹¦æˆªå™¨å¿…é¡»åœ¨SpringMVCçš„é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼š\n\u0026lt;bean class=\u0026#34;com.atguigu.interceptor.FirstInterceptor\u0026#34;\u0026gt;\u0026lt;/bean\u0026gt; \u0026lt;ref bean=\u0026#34;firstInterceptor\u0026#34;\u0026gt;\u0026lt;/ref\u0026gt; \u0026lt;!-- ä»¥ä¸Šä¸¤ç§é…ç½®æ–¹å¼éƒ½æ˜¯å¯¹DispatcherServletæ‰€å¤„ç†çš„æ‰€æœ‰çš„è¯·æ±‚è¿›è¡Œæ‹¦æˆª --\u0026gt; \u0026lt;mvc:interceptor\u0026gt; \u0026lt;mvc:mapping path=\u0026#34;/**\u0026#34;/\u0026gt; \u0026lt;mvc:exclude-mapping path=\u0026#34;/testRequestEntity\u0026#34;/\u0026gt; \u0026lt;ref bean=\u0026#34;firstInterceptor\u0026#34;\u0026gt;\u0026lt;/ref\u0026gt; \u0026lt;/mvc:interceptor\u0026gt; \u0026lt;!-- ä»¥ä¸Šé…ç½®æ–¹å¼å¯ä»¥é€šè¿‡refæˆ–beanæ ‡ç­¾è®¾ç½®æ‹¦æˆªå™¨ï¼Œé€šè¿‡mvc:mappingè®¾ç½®éœ€è¦æ‹¦æˆªçš„è¯·æ±‚ï¼Œé€šè¿‡mvc:exclude-mappingè®¾ç½®éœ€è¦æ’é™¤çš„è¯·æ±‚ï¼Œå³ä¸éœ€è¦æ‹¦æˆªçš„è¯·æ±‚ --\u0026gt; 2ã€æ‹¦æˆªå™¨çš„ä¸‰ä¸ªæŠ½è±¡æ–¹æ³• SpringMVCä¸­çš„æ‹¦æˆªå™¨æœ‰ä¸‰ä¸ªæŠ½è±¡æ–¹æ³•ï¼š\npreHandleï¼šæ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡ŒpreHandle()ï¼Œå…¶booleanç±»å‹çš„è¿”å›å€¼è¡¨ç¤ºæ˜¯å¦æ‹¦æˆªæˆ–æ”¾è¡Œï¼Œè¿”å›trueä¸ºæ”¾è¡Œï¼Œå³è°ƒç”¨æ§åˆ¶å™¨æ–¹æ³•ï¼›è¿”å›falseè¡¨ç¤ºæ‹¦æˆªï¼Œå³ä¸è°ƒç”¨æ§åˆ¶å™¨æ–¹æ³•\npostHandleï¼šæ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡ŒpostHandle()\nafterComplationï¼šå¤„ç†å®Œè§†å›¾å’Œæ¨¡å‹æ•°æ®ï¼Œæ¸²æŸ“è§†å›¾å®Œæ¯•ä¹‹åæ‰§è¡ŒafterComplation()\n3ã€å¤šä¸ªæ‹¦æˆªå™¨çš„æ‰§è¡Œé¡ºåº a\u0026gt;è‹¥æ¯ä¸ªæ‹¦æˆªå™¨çš„preHandle()éƒ½è¿”å›true\næ­¤æ—¶å¤šä¸ªæ‹¦æˆªå™¨çš„æ‰§è¡Œé¡ºåºå’Œæ‹¦æˆªå™¨åœ¨SpringMVCçš„é…ç½®æ–‡ä»¶çš„é…ç½®é¡ºåºæœ‰å…³ï¼š\npreHandle()ä¼šæŒ‰ç…§é…ç½®çš„é¡ºåºæ‰§è¡Œï¼Œè€ŒpostHandle()å’ŒafterComplation()ä¼šæŒ‰ç…§é…ç½®çš„ååºæ‰§è¡Œ\nb\u0026gt;è‹¥æŸä¸ªæ‹¦æˆªå™¨çš„preHandle()è¿”å›äº†false\npreHandle()è¿”å›falseå’Œå®ƒä¹‹å‰çš„æ‹¦æˆªå™¨çš„preHandle()éƒ½ä¼šæ‰§è¡Œï¼ŒpostHandle()éƒ½ä¸æ‰§è¡Œï¼Œè¿”å›falseçš„æ‹¦æˆªå™¨ä¹‹å‰çš„æ‹¦æˆªå™¨çš„afterComplation()ä¼šæ‰§è¡Œ\nåä¸€ã€å¼‚å¸¸å¤„ç†å™¨ 1ã€åŸºäºé…ç½®çš„å¼‚å¸¸å¤„ç† SpringMVCæä¾›äº†ä¸€ä¸ªå¤„ç†æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰€å‡ºç°çš„å¼‚å¸¸çš„æ¥å£ï¼šHandlerExceptionResolver\nHandlerExceptionResolveræ¥å£çš„å®ç°ç±»æœ‰ï¼šDefaultHandlerExceptionResolverå’ŒSimpleMappingExceptionResolver\nSpringMVCæä¾›äº†è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†å™¨SimpleMappingExceptionResolverï¼Œä½¿ç”¨æ–¹å¼ï¼š\n\u0026lt;bean class=\u0026#34;org.springframework.web.servlet.handler.SimpleMappingExceptionResolver\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;exceptionMappings\u0026#34;\u0026gt; \u0026lt;props\u0026gt; \u0026lt;!-- propertiesçš„é”®è¡¨ç¤ºå¤„ç†å™¨æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸ propertiesçš„å€¼è¡¨ç¤ºè‹¥å‡ºç°æŒ‡å®šå¼‚å¸¸æ—¶ï¼Œè®¾ç½®ä¸€ä¸ªæ–°çš„è§†å›¾åç§°ï¼Œè·³è½¬åˆ°æŒ‡å®šé¡µé¢ --\u0026gt; \u0026lt;prop key=\u0026#34;java.lang.ArithmeticException\u0026#34;\u0026gt;error\u0026lt;/prop\u0026gt; \u0026lt;/props\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;!-- exceptionAttributeå±æ€§è®¾ç½®ä¸€ä¸ªå±æ€§åï¼Œå°†å‡ºç°çš„å¼‚å¸¸ä¿¡æ¯åœ¨è¯·æ±‚åŸŸä¸­è¿›è¡Œå…±äº« --\u0026gt; \u0026lt;property name=\u0026#34;exceptionAttribute\u0026#34; value=\u0026#34;ex\u0026#34;\u0026gt;\u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt; 2ã€åŸºäºæ³¨è§£çš„å¼‚å¸¸å¤„ç† //@ControllerAdviceå°†å½“å‰ç±»æ ‡è¯†ä¸ºå¼‚å¸¸å¤„ç†çš„ç»„ä»¶ @ControllerAdvice public class ExceptionController { //@ExceptionHandlerç”¨äºè®¾ç½®æ‰€æ ‡è¯†æ–¹æ³•å¤„ç†çš„å¼‚å¸¸ @ExceptionHandler(ArithmeticException.class) //exè¡¨ç¤ºå½“å‰è¯·æ±‚å¤„ç†ä¸­å‡ºç°çš„å¼‚å¸¸å¯¹è±¡ public String handleArithmeticException(Exception ex, Model model){ model.addAttribute(\u0026#34;ex\u0026#34;, ex); return \u0026#34;error\u0026#34;; } } åäºŒã€æ³¨è§£é…ç½®SpringMVC ä½¿ç”¨é…ç½®ç±»å’Œæ³¨è§£ä»£æ›¿web.xmlå’ŒSpringMVCé…ç½®æ–‡ä»¶çš„åŠŸèƒ½\n1ã€åˆ›å»ºåˆå§‹åŒ–ç±»ï¼Œä»£æ›¿web.xml åœ¨Servlet3.0ç¯å¢ƒä¸­ï¼Œå®¹å™¨ä¼šåœ¨ç±»è·¯å¾„ä¸­æŸ¥æ‰¾å®ç°javax.servlet.ServletContainerInitializeræ¥å£çš„ç±»ï¼Œå¦‚æœæ‰¾åˆ°çš„è¯å°±ç”¨å®ƒæ¥é…ç½®Servletå®¹å™¨ã€‚ Springæä¾›äº†è¿™ä¸ªæ¥å£çš„å®ç°ï¼Œåä¸ºSpringServletContainerInitializerï¼Œè¿™ä¸ªç±»åè¿‡æ¥åˆä¼šæŸ¥æ‰¾å®ç°WebApplicationInitializerçš„ç±»å¹¶å°†é…ç½®çš„ä»»åŠ¡äº¤ç»™å®ƒä»¬æ¥å®Œæˆã€‚Spring3.2å¼•å…¥äº†ä¸€ä¸ªä¾¿åˆ©çš„WebApplicationInitializeråŸºç¡€å®ç°ï¼Œåä¸ºAbstractAnnotationConfigDispatcherServletInitializerï¼Œå½“æˆ‘ä»¬çš„ç±»æ‰©å±•äº†AbstractAnnotationConfigDispatcherServletInitializerå¹¶å°†å…¶éƒ¨ç½²åˆ°Servlet3.0å®¹å™¨çš„æ—¶å€™ï¼Œå®¹å™¨ä¼šè‡ªåŠ¨å‘ç°å®ƒï¼Œå¹¶ç”¨å®ƒæ¥é…ç½®Servletä¸Šä¸‹æ–‡ã€‚\npublic class WebInit extends AbstractAnnotationConfigDispatcherServletInitializer { /** * æŒ‡å®šspringçš„é…ç½®ç±» * @return */ @Override protected Class\u0026lt;?\u0026gt;[] getRootConfigClasses() { return new Class[]{SpringConfig.class}; } /** * æŒ‡å®šSpringMVCçš„é…ç½®ç±» * @return */ @Override protected Class\u0026lt;?\u0026gt;[] getServletConfigClasses() { return new Class[]{WebConfig.class}; } /** * æŒ‡å®šDispatcherServletçš„æ˜ å°„è§„åˆ™ï¼Œå³url-pattern * @return */ @Override protected String[] getServletMappings() { return new String[]{\u0026#34;/\u0026#34;}; } /** * æ·»åŠ è¿‡æ»¤å™¨ * @return */ @Override protected Filter[] getServletFilters() { CharacterEncodingFilter encodingFilter = new CharacterEncodingFilter(); encodingFilter.setEncoding(\u0026#34;UTF-8\u0026#34;); encodingFilter.setForceRequestEncoding(true); HiddenHttpMethodFilter hiddenHttpMethodFilter = new HiddenHttpMethodFilter(); return new Filter[]{encodingFilter, hiddenHttpMethodFilter}; } } 2ã€åˆ›å»ºSpringConfigé…ç½®ç±»ï¼Œä»£æ›¿springçš„é…ç½®æ–‡ä»¶ @Configuration public class SpringConfig { //ssmæ•´åˆä¹‹åï¼Œspringçš„é…ç½®ä¿¡æ¯å†™åœ¨æ­¤ç±»ä¸­ } 3ã€åˆ›å»ºWebConfigé…ç½®ç±»ï¼Œä»£æ›¿SpringMVCçš„é…ç½®æ–‡ä»¶ @Configuration //æ‰«æç»„ä»¶ @ComponentScan(\u0026#34;com.atguigu.mvc.controller\u0026#34;) //å¼€å¯MVCæ³¨è§£é©±åŠ¨ @EnableWebMvc public class WebConfig implements WebMvcConfigurer { //ä½¿ç”¨é»˜è®¤çš„servletå¤„ç†é™æ€èµ„æº @Override public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) { configurer.enable(); } //é…ç½®æ–‡ä»¶ä¸Šä¼ è§£æå™¨ @Bean public CommonsMultipartResolver multipartResolver(){ return new CommonsMultipartResolver(); } //é…ç½®æ‹¦æˆªå™¨ @Override public void addInterceptors(InterceptorRegistry registry) { FirstInterceptor firstInterceptor = new FirstInterceptor(); registry.addInterceptor(firstInterceptor).addPathPatterns(\u0026#34;/**\u0026#34;); } //é…ç½®è§†å›¾æ§åˆ¶ /*@Override public void addViewControllers(ViewControllerRegistry registry) { registry.addViewController(\u0026#34;/\u0026#34;).setViewName(\u0026#34;index\u0026#34;); }*/ //é…ç½®å¼‚å¸¸æ˜ å°„ /*@Override public void configureHandlerExceptionResolvers(List\u0026lt;HandlerExceptionResolver\u0026gt; resolvers) { SimpleMappingExceptionResolver exceptionResolver = new SimpleMappingExceptionResolver(); Properties prop = new Properties(); prop.setProperty(\u0026#34;java.lang.ArithmeticException\u0026#34;, \u0026#34;error\u0026#34;); //è®¾ç½®å¼‚å¸¸æ˜ å°„ exceptionResolver.setExceptionMappings(prop); //è®¾ç½®å…±äº«å¼‚å¸¸ä¿¡æ¯çš„é”® exceptionResolver.setExceptionAttribute(\u0026#34;ex\u0026#34;); resolvers.add(exceptionResolver); }*/ //é…ç½®ç”Ÿæˆæ¨¡æ¿è§£æå™¨ @Bean public ITemplateResolver templateResolver() { WebApplicationContext webApplicationContext = ContextLoader.getCurrentWebApplicationContext(); // ServletContextTemplateResolveréœ€è¦ä¸€ä¸ªServletContextä½œä¸ºæ„é€ å‚æ•°ï¼Œå¯é€šè¿‡WebApplicationContext çš„æ–¹æ³•è·å¾— ServletContextTemplateResolver templateResolver = new ServletContextTemplateResolver( webApplicationContext.getServletContext()); templateResolver.setPrefix(\u0026#34;/WEB-INF/templates/\u0026#34;); templateResolver.setSuffix(\u0026#34;.html\u0026#34;); templateResolver.setCharacterEncoding(\u0026#34;UTF-8\u0026#34;); templateResolver.setTemplateMode(TemplateMode.HTML); return templateResolver; } //ç”Ÿæˆæ¨¡æ¿å¼•æ“å¹¶ä¸ºæ¨¡æ¿å¼•æ“æ³¨å…¥æ¨¡æ¿è§£æå™¨ @Bean public SpringTemplateEngine templateEngine(ITemplateResolver templateResolver) { SpringTemplateEngine templateEngine = new SpringTemplateEngine(); templateEngine.setTemplateResolver(templateResolver); return templateEngine; } //ç”Ÿæˆè§†å›¾è§£æå™¨å¹¶æœªè§£æå™¨æ³¨å…¥æ¨¡æ¿å¼•æ“ @Bean public ViewResolver viewResolver(SpringTemplateEngine templateEngine) { ThymeleafViewResolver viewResolver = new ThymeleafViewResolver(); viewResolver.setCharacterEncoding(\u0026#34;UTF-8\u0026#34;); viewResolver.setTemplateEngine(templateEngine); return viewResolver; } } 4ã€æµ‹è¯•åŠŸèƒ½ @RequestMapping(\u0026#34;/\u0026#34;) public String index(){ return \u0026#34;index\u0026#34;; } åä¸‰ã€SpringMVCæ‰§è¡Œæµç¨‹ 1ã€SpringMVCå¸¸ç”¨ç»„ä»¶ DispatcherServletï¼šå‰ç«¯æ§åˆ¶å™¨ï¼Œä¸éœ€è¦å·¥ç¨‹å¸ˆå¼€å‘ï¼Œç”±æ¡†æ¶æä¾› ä½œç”¨ï¼šç»Ÿä¸€å¤„ç†è¯·æ±‚å’Œå“åº”ï¼Œæ•´ä¸ªæµç¨‹æ§åˆ¶çš„ä¸­å¿ƒï¼Œç”±å®ƒè°ƒç”¨å…¶å®ƒç»„ä»¶å¤„ç†ç”¨æˆ·çš„è¯·æ±‚\nHandlerMappingï¼šå¤„ç†å™¨æ˜ å°„å™¨ï¼Œä¸éœ€è¦å·¥ç¨‹å¸ˆå¼€å‘ï¼Œç”±æ¡†æ¶æä¾› ä½œç”¨ï¼šæ ¹æ®è¯·æ±‚çš„urlã€methodç­‰ä¿¡æ¯æŸ¥æ‰¾Handlerï¼Œå³æ§åˆ¶å™¨æ–¹æ³•\nHandlerï¼šå¤„ç†å™¨ï¼Œéœ€è¦å·¥ç¨‹å¸ˆå¼€å‘ ä½œç”¨ï¼šåœ¨DispatcherServletçš„æ§åˆ¶ä¸‹Handlerå¯¹å…·ä½“çš„ç”¨æˆ·è¯·æ±‚è¿›è¡Œå¤„ç†\nHandlerAdapterï¼šå¤„ç†å™¨é€‚é…å™¨ï¼Œä¸éœ€è¦å·¥ç¨‹å¸ˆå¼€å‘ï¼Œç”±æ¡†æ¶æä¾› ä½œç”¨ï¼šé€šè¿‡HandlerAdapterå¯¹å¤„ç†å™¨ï¼ˆæ§åˆ¶å™¨æ–¹æ³•ï¼‰è¿›è¡Œæ‰§è¡Œ\nViewResolverï¼šè§†å›¾è§£æå™¨ï¼Œä¸éœ€è¦å·¥ç¨‹å¸ˆå¼€å‘ï¼Œç”±æ¡†æ¶æä¾› ä½œç”¨ï¼šè¿›è¡Œè§†å›¾è§£æï¼Œå¾—åˆ°ç›¸åº”çš„è§†å›¾ï¼Œä¾‹å¦‚ï¼šThymeleafViewã€InternalResourceViewã€RedirectView\nViewï¼šè§†å›¾ ä½œç”¨ï¼šå°†æ¨¡å‹æ•°æ®é€šè¿‡é¡µé¢å±•ç¤ºç»™ç”¨æˆ·\n2ã€DispatcherServletåˆå§‹åŒ–è¿‡ç¨‹ DispatcherServlet æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª Servletï¼Œæ‰€ä»¥å¤©ç„¶çš„éµå¾ª Servlet çš„ç”Ÿå‘½å‘¨æœŸã€‚æ‰€ä»¥å®è§‚ä¸Šæ˜¯ Servlet ç”Ÿå‘½å‘¨æœŸæ¥è¿›è¡Œè°ƒåº¦ã€‚\na\u0026gt;åˆå§‹åŒ–WebApplicationContext æ‰€åœ¨ç±»ï¼šorg.springframework.web.servlet.FrameworkServlet\nprotected WebApplicationContext initWebApplicationContext() { WebApplicationContext rootContext = WebApplicationContextUtils.getWebApplicationContext(getServletContext()); WebApplicationContext wac = null; if (this.webApplicationContext != null) { // A context instance was injected at construction time -\u0026gt; use it wac = this.webApplicationContext; if (wac instanceof ConfigurableWebApplicationContext) { ConfigurableWebApplicationContext cwac = (ConfigurableWebApplicationContext) wac; if (!cwac.isActive()) { // The context has not yet been refreshed -\u0026gt; provide services such as // setting the parent context, setting the application context id, etc if (cwac.getParent() == null) { // The context instance was injected without an explicit parent -\u0026gt; set // the root application context (if any; may be null) as the parent cwac.setParent(rootContext); } configureAndRefreshWebApplicationContext(cwac); } } } if (wac == null) { // No context instance was injected at construction time -\u0026gt; see if one // has been registered in the servlet context. If one exists, it is assumed // that the parent context (if any) has already been set and that the // user has performed any initialization such as setting the context id wac = findWebApplicationContext(); } if (wac == null) { // No context instance is defined for this servlet -\u0026gt; create a local one // åˆ›å»ºWebApplicationContext wac = createWebApplicationContext(rootContext); } if (!this.refreshEventReceived) { // Either the context is not a ConfigurableApplicationContext with refresh // support or the context injected at construction time had already been // refreshed -\u0026gt; trigger initial onRefresh manually here. synchronized (this.onRefreshMonitor) { // åˆ·æ–°WebApplicationContext onRefresh(wac); } } if (this.publishContext) { // Publish the context as a servlet context attribute. // å°†IOCå®¹å™¨åœ¨åº”ç”¨åŸŸå…±äº« String attrName = getServletContextAttributeName(); getServletContext().setAttribute(attrName, wac); } return wac; } b\u0026gt;åˆ›å»ºWebApplicationContext æ‰€åœ¨ç±»ï¼šorg.springframework.web.servlet.FrameworkServlet\nprotected WebApplicationContext createWebApplicationContext(@Nullable ApplicationContext parent) { Class\u0026lt;?\u0026gt; contextClass = getContextClass(); if (!ConfigurableWebApplicationContext.class.isAssignableFrom(contextClass)) { throw new ApplicationContextException( \u0026#34;Fatal initialization error in servlet with name \u0026#39;\u0026#34; + getServletName() + \u0026#34;\u0026#39;: custom WebApplicationContext class [\u0026#34; + contextClass.getName() + \u0026#34;] is not of type ConfigurableWebApplicationContext\u0026#34;); } // é€šè¿‡åå°„åˆ›å»º IOC å®¹å™¨å¯¹è±¡ ConfigurableWebApplicationContext wac = (ConfigurableWebApplicationContext) BeanUtils.instantiateClass(contextClass); wac.setEnvironment(getEnvironment()); // è®¾ç½®çˆ¶å®¹å™¨ wac.setParent(parent); String configLocation = getContextConfigLocation(); if (configLocation != null) { wac.setConfigLocation(configLocation); } configureAndRefreshWebApplicationContext(wac); return wac; } c\u0026gt;DispatcherServletåˆå§‹åŒ–ç­–ç•¥ FrameworkServletåˆ›å»ºWebApplicationContextåï¼Œåˆ·æ–°å®¹å™¨ï¼Œè°ƒç”¨onRefresh(wac)ï¼Œæ­¤æ–¹æ³•åœ¨DispatcherServletä¸­è¿›è¡Œäº†é‡å†™ï¼Œè°ƒç”¨äº†initStrategies(context)æ–¹æ³•ï¼Œåˆå§‹åŒ–ç­–ç•¥ï¼Œå³åˆå§‹åŒ–DispatcherServletçš„å„ä¸ªç»„ä»¶\næ‰€åœ¨ç±»ï¼šorg.springframework.web.servlet.DispatcherServlet\nprotected void initStrategies(ApplicationContext context) { initMultipartResolver(context); initLocaleResolver(context); initThemeResolver(context); initHandlerMappings(context); initHandlerAdapters(context); initHandlerExceptionResolvers(context); initRequestToViewNameTranslator(context); initViewResolvers(context); initFlashMapManager(context); } 3ã€DispatcherServletè°ƒç”¨ç»„ä»¶å¤„ç†è¯·æ±‚ a\u0026gt;processRequest() FrameworkServleté‡å†™HttpServletä¸­çš„service()å’ŒdoXxx()ï¼Œè¿™äº›æ–¹æ³•ä¸­è°ƒç”¨äº†processRequest(request, response)\næ‰€åœ¨ç±»ï¼šorg.springframework.web.servlet.FrameworkServlet\nprotected final void processRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { long startTime = System.currentTimeMillis(); Throwable failureCause = null; LocaleContext previousLocaleContext = LocaleContextHolder.getLocaleContext(); LocaleContext localeContext = buildLocaleContext(request); RequestAttributes previousAttributes = RequestContextHolder.getRequestAttributes(); ServletRequestAttributes requestAttributes = buildRequestAttributes(request, response, previousAttributes); WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request); asyncManager.registerCallableInterceptor(FrameworkServlet.class.getName(), new RequestBindingInterceptor()); initContextHolders(request, localeContext, requestAttributes); try { // æ‰§è¡ŒæœåŠ¡ï¼ŒdoService()æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œåœ¨DispatcherServletä¸­è¿›è¡Œäº†é‡å†™ doService(request, response); } catch (ServletException | IOException ex) { failureCause = ex; throw ex; } catch (Throwable ex) { failureCause = ex; throw new NestedServletException(\u0026#34;Request processing failed\u0026#34;, ex); } finally { resetContextHolders(request, previousLocaleContext, previousAttributes); if (requestAttributes != null) { requestAttributes.requestCompleted(); } logResult(request, response, failureCause, asyncManager); publishRequestHandledEvent(request, response, startTime, failureCause); } } b\u0026gt;doService() æ‰€åœ¨ç±»ï¼šorg.springframework.web.servlet.DispatcherServlet\n@Override protected void doService(HttpServletRequest request, HttpServletResponse response) throws Exception { logRequest(request); // Keep a snapshot of the request attributes in case of an include, // to be able to restore the original attributes after the include. Map\u0026lt;String, Object\u0026gt; attributesSnapshot = null; if (WebUtils.isIncludeRequest(request)) { attributesSnapshot = new HashMap\u0026lt;\u0026gt;(); Enumeration\u0026lt;?\u0026gt; attrNames = request.getAttributeNames(); while (attrNames.hasMoreElements()) { String attrName = (String) attrNames.nextElement(); if (this.cleanupAfterInclude || attrName.startsWith(DEFAULT_STRATEGIES_PREFIX)) { attributesSnapshot.put(attrName, request.getAttribute(attrName)); } } } // Make framework objects available to handlers and view objects. request.setAttribute(WEB_APPLICATION_CONTEXT_ATTRIBUTE, getWebApplicationContext()); request.setAttribute(LOCALE_RESOLVER_ATTRIBUTE, this.localeResolver); request.setAttribute(THEME_RESOLVER_ATTRIBUTE, this.themeResolver); request.setAttribute(THEME_SOURCE_ATTRIBUTE, getThemeSource()); if (this.flashMapManager != null) { FlashMap inputFlashMap = this.flashMapManager.retrieveAndUpdate(request, response); if (inputFlashMap != null) { request.setAttribute(INPUT_FLASH_MAP_ATTRIBUTE, Collections.unmodifiableMap(inputFlashMap)); } request.setAttribute(OUTPUT_FLASH_MAP_ATTRIBUTE, new FlashMap()); request.setAttribute(FLASH_MAP_MANAGER_ATTRIBUTE, this.flashMapManager); } RequestPath requestPath = null; if (this.parseRequestPath \u0026amp;\u0026amp; !ServletRequestPathUtils.hasParsedRequestPath(request)) { requestPath = ServletRequestPathUtils.parseAndCache(request); } try { // å¤„ç†è¯·æ±‚å’Œå“åº” doDispatch(request, response); } finally { if (!WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) { // Restore the original attribute snapshot, in case of an include. if (attributesSnapshot != null) { restoreAttributesAfterInclude(request, attributesSnapshot); } } if (requestPath != null) { ServletRequestPathUtils.clearParsedRequestPath(request); } } } c\u0026gt;doDispatch() æ‰€åœ¨ç±»ï¼šorg.springframework.web.servlet.DispatcherServlet\nprotected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception { HttpServletRequest processedRequest = request; HandlerExecutionChain mappedHandler = null; boolean multipartRequestParsed = false; WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request); try { ModelAndView mv = null; Exception dispatchException = null; try { processedRequest = checkMultipart(request); multipartRequestParsed = (processedRequest != request); // Determine handler for the current request. /* mappedHandlerï¼šè°ƒç”¨é“¾ åŒ…å«handlerã€interceptorListã€interceptorIndex handlerï¼šæµè§ˆå™¨å‘é€çš„è¯·æ±‚æ‰€åŒ¹é…çš„æ§åˆ¶å™¨æ–¹æ³• interceptorListï¼šå¤„ç†æ§åˆ¶å™¨æ–¹æ³•çš„æ‰€æœ‰æ‹¦æˆªå™¨é›†åˆ interceptorIndexï¼šæ‹¦æˆªå™¨ç´¢å¼•ï¼Œæ§åˆ¶æ‹¦æˆªå™¨afterCompletion()çš„æ‰§è¡Œ */ mappedHandler = getHandler(processedRequest); if (mappedHandler == null) { noHandlerFound(processedRequest, response); return; } // Determine handler adapter for the current request. // é€šè¿‡æ§åˆ¶å™¨æ–¹æ³•åˆ›å»ºç›¸åº”çš„å¤„ç†å™¨é€‚é…å™¨ï¼Œè°ƒç”¨æ‰€å¯¹åº”çš„æ§åˆ¶å™¨æ–¹æ³• HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler()); // Process last-modified header, if supported by the handler. String method = request.getMethod(); boolean isGet = \u0026#34;GET\u0026#34;.equals(method); if (isGet || \u0026#34;HEAD\u0026#34;.equals(method)) { long lastModified = ha.getLastModified(request, mappedHandler.getHandler()); if (new ServletWebRequest(request, response).checkNotModified(lastModified) \u0026amp;\u0026amp; isGet) { return; } } // è°ƒç”¨æ‹¦æˆªå™¨çš„preHandle() if (!mappedHandler.applyPreHandle(processedRequest, response)) { return; } // Actually invoke the handler. // ç”±å¤„ç†å™¨é€‚é…å™¨è°ƒç”¨å…·ä½“çš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œæœ€ç»ˆè·å¾—ModelAndViewå¯¹è±¡ mv = ha.handle(processedRequest, response, mappedHandler.getHandler()); if (asyncManager.isConcurrentHandlingStarted()) { return; } applyDefaultViewName(processedRequest, mv); // è°ƒç”¨æ‹¦æˆªå™¨çš„postHandle() mappedHandler.applyPostHandle(processedRequest, response, mv); } catch (Exception ex) { dispatchException = ex; } catch (Throwable err) { // As of 4.3, we\u0026#39;re processing Errors thrown from handler methods as well, // making them available for @ExceptionHandler methods and other scenarios. dispatchException = new NestedServletException(\u0026#34;Handler dispatch failed\u0026#34;, err); } // åç»­å¤„ç†ï¼šå¤„ç†æ¨¡å‹æ•°æ®å’Œæ¸²æŸ“è§†å›¾ processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException); } catch (Exception ex) { triggerAfterCompletion(processedRequest, response, mappedHandler, ex); } catch (Throwable err) { triggerAfterCompletion(processedRequest, response, mappedHandler, new NestedServletException(\u0026#34;Handler processing failed\u0026#34;, err)); } finally { if (asyncManager.isConcurrentHandlingStarted()) { // Instead of postHandle and afterCompletion if (mappedHandler != null) { mappedHandler.applyAfterConcurrentHandlingStarted(processedRequest, response); } } else { // Clean up any resources used by a multipart request. if (multipartRequestParsed) { cleanupMultipart(processedRequest); } } } } d\u0026gt;processDispatchResult() private void processDispatchResult(HttpServletRequest request, HttpServletResponse response, @Nullable HandlerExecutionChain mappedHandler, @Nullable ModelAndView mv, @Nullable Exception exception) throws Exception { boolean errorView = false; if (exception != null) { if (exception instanceof ModelAndViewDefiningException) { logger.debug(\u0026#34;ModelAndViewDefiningException encountered\u0026#34;, exception); mv = ((ModelAndViewDefiningException) exception).getModelAndView(); } else { Object handler = (mappedHandler != null ? mappedHandler.getHandler() : null); mv = processHandlerException(request, response, handler, exception); errorView = (mv != null); } } // Did the handler return a view to render? if (mv != null \u0026amp;\u0026amp; !mv.wasCleared()) { // å¤„ç†æ¨¡å‹æ•°æ®å’Œæ¸²æŸ“è§†å›¾ render(mv, request, response); if (errorView) { WebUtils.clearErrorRequestAttributes(request); } } else { if (logger.isTraceEnabled()) { logger.trace(\u0026#34;No view rendering, null ModelAndView returned.\u0026#34;); } } if (WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) { // Concurrent handling started during a forward return; } if (mappedHandler != null) { // Exception (if any) is already handled.. // è°ƒç”¨æ‹¦æˆªå™¨çš„afterCompletion() mappedHandler.triggerAfterCompletion(request, response, null); } } 4ã€SpringMVCçš„æ‰§è¡Œæµç¨‹ ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè¯·æ±‚è¢«SpringMVC å‰ç«¯æ§åˆ¶å™¨ DispatcherServletæ•è·ã€‚\nDispatcherServletå¯¹è¯·æ±‚URLè¿›è¡Œè§£æï¼Œå¾—åˆ°è¯·æ±‚èµ„æºæ ‡è¯†ç¬¦ï¼ˆURIï¼‰ï¼Œåˆ¤æ–­è¯·æ±‚URIå¯¹åº”çš„æ˜ å°„ï¼š\na) ä¸å­˜åœ¨\ni. å†åˆ¤æ–­æ˜¯å¦é…ç½®äº†mvc:default-servlet-handler\nii. å¦‚æœæ²¡é…ç½®ï¼Œåˆ™æ§åˆ¶å°æŠ¥æ˜ å°„æŸ¥æ‰¾ä¸åˆ°ï¼Œå®¢æˆ·ç«¯å±•ç¤º404é”™è¯¯\niii. å¦‚æœæœ‰é…ç½®ï¼Œåˆ™è®¿é—®ç›®æ ‡èµ„æºï¼ˆä¸€èˆ¬ä¸ºé™æ€èµ„æºï¼Œå¦‚ï¼šJS,CSS,HTMLï¼‰ï¼Œæ‰¾ä¸åˆ°å®¢æˆ·ç«¯ä¹Ÿä¼šå±•ç¤º404é”™è¯¯\nb) å­˜åœ¨åˆ™æ‰§è¡Œä¸‹é¢çš„æµç¨‹\næ ¹æ®è¯¥URIï¼Œè°ƒç”¨HandlerMappingè·å¾—è¯¥Handleré…ç½®çš„æ‰€æœ‰ç›¸å…³çš„å¯¹è±¡ï¼ˆåŒ…æ‹¬Handlerå¯¹è±¡ä»¥åŠHandlerå¯¹è±¡å¯¹åº”çš„æ‹¦æˆªå™¨ï¼‰ï¼Œæœ€åä»¥HandlerExecutionChainæ‰§è¡Œé“¾å¯¹è±¡çš„å½¢å¼è¿”å›ã€‚\nDispatcherServlet æ ¹æ®è·å¾—çš„Handlerï¼Œé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„HandlerAdapterã€‚\nå¦‚æœæˆåŠŸè·å¾—HandlerAdapterï¼Œæ­¤æ—¶å°†å¼€å§‹æ‰§è¡Œæ‹¦æˆªå™¨çš„preHandler(â€¦)æ–¹æ³•ã€æ­£å‘ã€‘\næå–Requestä¸­çš„æ¨¡å‹æ•°æ®ï¼Œå¡«å……Handlerå…¥å‚ï¼Œå¼€å§‹æ‰§è¡ŒHandlerï¼ˆController)æ–¹æ³•ï¼Œå¤„ç†è¯·æ±‚ã€‚åœ¨å¡«å……Handlerçš„å…¥å‚è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®ä½ çš„é…ç½®ï¼ŒSpringå°†å¸®ä½ åšä¸€äº›é¢å¤–çš„å·¥ä½œï¼š\na) HttpMessageConveterï¼š å°†è¯·æ±‚æ¶ˆæ¯ï¼ˆå¦‚Jsonã€xmlç­‰æ•°æ®ï¼‰è½¬æ¢æˆä¸€ä¸ªå¯¹è±¡ï¼Œå°†å¯¹è±¡è½¬æ¢ä¸ºæŒ‡å®šçš„å“åº”ä¿¡æ¯\nb) æ•°æ®è½¬æ¢ï¼šå¯¹è¯·æ±‚æ¶ˆæ¯è¿›è¡Œæ•°æ®è½¬æ¢ã€‚å¦‚Stringè½¬æ¢æˆIntegerã€Doubleç­‰\nc) æ•°æ®æ ¼å¼åŒ–ï¼šå¯¹è¯·æ±‚æ¶ˆæ¯è¿›è¡Œæ•°æ®æ ¼å¼åŒ–ã€‚ å¦‚å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ ¼å¼åŒ–æ•°å­—æˆ–æ ¼å¼åŒ–æ—¥æœŸç­‰\nd) æ•°æ®éªŒè¯ï¼š éªŒè¯æ•°æ®çš„æœ‰æ•ˆæ€§ï¼ˆé•¿åº¦ã€æ ¼å¼ç­‰ï¼‰ï¼ŒéªŒè¯ç»“æœå­˜å‚¨åˆ°BindingResultæˆ–Errorä¸­\nHandleræ‰§è¡Œå®Œæˆåï¼Œå‘DispatcherServlet è¿”å›ä¸€ä¸ªModelAndViewå¯¹è±¡ã€‚\næ­¤æ—¶å°†å¼€å§‹æ‰§è¡Œæ‹¦æˆªå™¨çš„postHandle(\u0026hellip;)æ–¹æ³•ã€é€†å‘ã€‘ã€‚\næ ¹æ®è¿”å›çš„ModelAndViewï¼ˆæ­¤æ—¶ä¼šåˆ¤æ–­æ˜¯å¦å­˜åœ¨å¼‚å¸¸ï¼šå¦‚æœå­˜åœ¨å¼‚å¸¸ï¼Œåˆ™æ‰§è¡ŒHandlerExceptionResolverè¿›è¡Œå¼‚å¸¸å¤„ç†ï¼‰é€‰æ‹©ä¸€ä¸ªé€‚åˆçš„ViewResolverè¿›è¡Œè§†å›¾è§£æï¼Œæ ¹æ®Modelå’ŒViewï¼Œæ¥æ¸²æŸ“è§†å›¾ã€‚\næ¸²æŸ“è§†å›¾å®Œæ¯•æ‰§è¡Œæ‹¦æˆªå™¨çš„afterCompletion(â€¦)æ–¹æ³•ã€é€†å‘ã€‘ã€‚\nå°†æ¸²æŸ“ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚\n","permalink":"https://XianCH.github.io/posts/tech/java/springmvc/","summary":"\u003ch1 id=\"ä¸€springmvcç®€ä»‹\"\u003eä¸€ã€SpringMVCç®€ä»‹\u003c/h1\u003e\n\u003ch3 id=\"1ä»€ä¹ˆæ˜¯mvc\"\u003e1ã€ä»€ä¹ˆæ˜¯MVC\u003c/h3\u003e\n\u003cp\u003eMVCæ˜¯ä¸€ç§è½¯ä»¶æ¶æ„çš„æ€æƒ³ï¼Œå°†è½¯ä»¶æŒ‰ç…§æ¨¡å‹ã€è§†å›¾ã€æ§åˆ¶å™¨æ¥åˆ’åˆ†\u003c/p\u003e\n\u003cp\u003eMï¼šModelï¼Œæ¨¡å‹å±‚ï¼ŒæŒ‡å·¥ç¨‹ä¸­çš„JavaBeanï¼Œä½œç”¨æ˜¯å¤„ç†æ•°æ®\u003c/p\u003e\n\u003cp\u003eJavaBeanåˆ†ä¸ºä¸¤ç±»ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eä¸€ç±»ç§°ä¸ºå®ä½“ç±»Beanï¼šä¸“é—¨å­˜å‚¨ä¸šåŠ¡æ•°æ®çš„ï¼Œå¦‚ Studentã€User ç­‰\u003c/li\u003e\n\u003cli\u003eä¸€ç±»ç§°ä¸ºä¸šåŠ¡å¤„ç† Beanï¼šæŒ‡ Service æˆ– Dao å¯¹è±¡ï¼Œä¸“é—¨ç”¨äºå¤„ç†ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®è®¿é—®ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eVï¼šViewï¼Œè§†å›¾å±‚ï¼ŒæŒ‡å·¥ç¨‹ä¸­çš„htmlæˆ–jspç­‰é¡µé¢ï¼Œä½œç”¨æ˜¯ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’ï¼Œå±•ç¤ºæ•°æ®\u003c/p\u003e","title":"springmvcå­¦ä¹ ç¬”è®°ç¬”è®°"},{"content":" Sulv\u0026#39;s Blog ä¸€ä¸ªè®°å½•æŠ€æœ¯ã€é˜…è¯»ã€ç”Ÿæ´»çš„åšå®¢ ğŸ‘‰å‹é“¾æ ¼å¼ åç§°ï¼š Sulv\u0026rsquo;s Blog ç½‘å€ï¼š https://www.sulvblog.cn å›¾æ ‡ï¼š https://www.sulvblog.cn/img/Q.gif æè¿°ï¼š ä¸€ä¸ªè®°å½•æŠ€æœ¯ã€é˜…è¯»ã€ç”Ÿæ´»çš„åšå®¢ ğŸ‘‰å‹é“¾ç”³è¯·è¦æ±‚ ç§‰æ‰¿äº’æ¢å‹é“¾åŸåˆ™ã€æ–‡ç« å®šæœŸæ›´æ–°ã€ä¸èƒ½æœ‰å¤ªå¤šå¹¿å‘Šã€ä¸ªäººæè¿°å­—æ•°æ§åˆ¶åœ¨15å­—å†…\nğŸ‘‰Hugoåšå®¢äº¤æµç¾¤ 787018782\n","permalink":"https://XianCH.github.io/links/","summary":"\u003cdiv class=\"friend\"\u003e\n\u003ca target=\"_blank\" href=https://www.sulvblog.cn title=Sulv\u0026#39;s\u0026#32;Blog class=\"friendurl\"\u003e\n  \u003cdiv class=\"frienddiv\"\u003e\n    \u003cdiv class=\"frienddivleft\"\u003e\n      \u003cimg class=\"myfriend\" src=https://www.sulvblog.cn/img/Q.gif /\u003e\n    \u003c/div\u003e\n    \u003cdiv class=\"frienddivright\"\u003e\n      \u003cdiv class=\"friendname\"\u003eSulv\u0026#39;s Blog\u003c/div\u003e\n      \u003cdiv class=\"friendinfo\"\u003eä¸€ä¸ªè®°å½•æŠ€æœ¯ã€é˜…è¯»ã€ç”Ÿæ´»çš„åšå®¢\u003c/div\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n\u003c/a\u003e\n\n\u003c/div\u003e\n\u003cbr/\u003e\n\u003cbr/\u003e\n\u003cbr/\u003e\n\u003cbr/\u003e\n\u003cbr/\u003e\n\u003cdiv style=\"font-size: 20px;\" class=\"youlian\"\u003eğŸ‘‰å‹é“¾æ ¼å¼\u003c/div\u003e\n\u003cdiv style=\"font-size: 16px;\"\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e\u003c/th\u003e\n          \u003cth\u003e\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eåç§°ï¼š\u003c/td\u003e\n          \u003ctd\u003eSulv\u0026rsquo;s Blog\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eç½‘å€ï¼š\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://www.sulvblog.cn\"\u003ehttps://www.sulvblog.cn\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eå›¾æ ‡ï¼š\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://www.sulvblog.cn/img/Q.gif\"\u003ehttps://www.sulvblog.cn/img/Q.gif\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eæè¿°ï¼š\u003c/td\u003e\n          \u003ctd\u003eä¸€ä¸ªè®°å½•æŠ€æœ¯ã€é˜…è¯»ã€ç”Ÿæ´»çš„åšå®¢\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cbr/\u003e\n\u003cdiv style=\"font-size: 20px;\"\u003eğŸ‘‰å‹é“¾ç”³è¯·è¦æ±‚\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eç§‰æ‰¿äº’æ¢å‹é“¾åŸåˆ™ã€æ–‡ç« å®šæœŸæ›´æ–°\u003c!-- ã€ç½‘ç«™åœ¨å·¥ä¿¡éƒ¨å¤‡æ¡ˆ --\u003eã€ä¸èƒ½æœ‰å¤ªå¤šå¹¿å‘Šã€ä¸ªäººæè¿°å­—æ•°æ§åˆ¶åœ¨15å­—å†…\u003c/p\u003e\u003c/blockquote\u003e\n\u003cbr/\u003e\n\u003cdiv style=\"font-size: 20px;\"\u003eğŸ‘‰Hugoåšå®¢äº¤æµç¾¤\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003e787018782\u003c/p\u003e\u003c/blockquote\u003e","title":"ğŸ¤å‹é“¾"},{"content":"\nx14n 23 take it ez\u0026hellip;\u0026hellip; ","permalink":"https://XianCH.github.io/about/","summary":"\u003cp style=\"font-size: 25px;\"\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e\u003c/th\u003e\n          \u003cth\u003e\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003ex14n\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e23\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003etake it ez\u0026hellip;\u0026hellip;\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e","title":"about"}]